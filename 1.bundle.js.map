{"version":3,"sources":["webpack:///./node_modules/aframe-extras/index.js","webpack:///./node_modules/aframe-extras/src/controls/index.js","webpack:///./node_modules/aframe-extras/src/controls/checkpoint-controls.js","webpack:///./node_modules/aframe-extras/src/controls/gamepad-controls.js","webpack:///./node_modules/aframe-extras/lib/GamepadButton.js","webpack:///./node_modules/aframe-extras/lib/GamepadButtonEvent.js","webpack:///./node_modules/aframe-extras/src/controls/keyboard-controls.js","webpack:///./node_modules/aframe-extras/lib/keyboard.polyfill.js","webpack:///./node_modules/aframe-extras/src/controls/touch-controls.js","webpack:///./node_modules/aframe-extras/src/controls/movement-controls.js","webpack:///./node_modules/aframe-extras/src/controls/trackpad-controls.js","webpack:///./node_modules/aframe-extras/src/loaders/index.js","webpack:///./node_modules/aframe-extras/src/loaders/animation-mixer.js","webpack:///./node_modules/aframe-extras/src/loaders/collada-model-legacy.js","webpack:///./node_modules/aframe-extras/lib/ColladaLoader.js","webpack:///./node_modules/aframe-extras/src/loaders/fbx-model.js","webpack:///./node_modules/aframe-extras/lib/FBXLoader.js","webpack:///./node_modules/aframe-extras/src/loaders/gltf-model-legacy.js","webpack:///./node_modules/aframe-extras/lib/fetch-script.js","webpack:///./node_modules/aframe-extras/src/loaders/object-model.js","webpack:///./node_modules/aframe-extras/src/misc/index.js","webpack:///./node_modules/aframe-extras/src/misc/checkpoint.js","webpack:///./node_modules/aframe-extras/src/misc/cube-env-map.js","webpack:///./node_modules/aframe-extras/src/misc/grab.js","webpack:///./node_modules/aframe-extras/src/misc/jump-ability.js","webpack:///./node_modules/aframe-extras/src/misc/kinematic-body.js","webpack:///./node_modules/aframe-extras/src/misc/mesh-smooth.js","webpack:///./node_modules/aframe-extras/src/misc/normal-material.js","webpack:///./node_modules/aframe-extras/src/misc/sphere-collider.js","webpack:///./node_modules/aframe-extras/src/pathfinding/index.js","webpack:///./node_modules/aframe-extras/src/pathfinding/nav-mesh.js","webpack:///./node_modules/aframe-extras/src/pathfinding/nav-agent.js","webpack:///./node_modules/aframe-extras/src/pathfinding/system.js","webpack:///./node_modules/three-pathfinding/dist/three-pathfinding.module.js","webpack:///./node_modules/aframe-extras/src/primitives/index.js","webpack:///./node_modules/aframe-extras/src/primitives/a-grid.js","webpack:///./node_modules/aframe-extras/src/primitives/a-hexgrid.js","webpack:///./node_modules/aframe-extras/lib/hex-grid.min.js","webpack:///./node_modules/aframe-extras/lib/default-hex-grid.js","webpack:///./node_modules/aframe-extras/src/primitives/a-ocean.js","webpack:///./node_modules/aframe-extras/src/primitives/a-tube.js"],"names":["module","exports","AFRAME","registerComponent","schema","enabled","default","mode","oneOf","animateSpeed","init","this","active","checkpoint","isNavMeshConstrained","offset","THREE","Vector3","position","targetPosition","play","pause","setCheckpoint","el","emit","sync","distanceTo","data","setAttribute","components","updateNavLocation","isVelocityActive","getVelocity","set","setLength","copy","getAttribute","object3D","getWorldPosition","add","getOffset","sub","GamepadButton","GamepadButtonEvent","Joystick","controller","debug","camera","type","rotationSensitivity","sceneEl","system","systems","controllers","prevTime","window","performance","now","buttons","rotation","pitch","Object3D","x","Math","degToRad","yaw","y","_lookVector","Vector2","_moveVector","_dpadVector","addBehavior","update","tick","t","dt","updateButtonState","updateRotation","remove","isConnected","dpad","joystick","getDpad","getJoystick","inputX","inputY","abs","getVelocityDelta","dVelocity","z","isRotationActive","lookControls","hasLookControls","pitchObject","yawObject","lookVector","multiplyScalar","max","PI","min","gamepad","getGamepad","i","length","pressed","Object","keys","event","index","stdGamepad","navigator","getGamepads","xrController","xrGamepad","proxyControls","getButton","getAxis","axes","target","mapping","Error","DPAD_RIGHT","DPAD_LEFT","DPAD_UP","DPAD_DOWN","connected","getID","id","assign","FACE_1","FACE_2","FACE_3","FACE_4","L_SHOULDER_1","R_SHOULDER_1","L_SHOULDER_2","R_SHOULDER_2","SELECT","START","VENDOR","details","value","KeyboardEvent","localKeys","listeners","keydown","onKeyDown","bind","keyup","onKeyUp","blur","onBlur","attachEventListeners","getKeys","KeyW","ArrowUp","KeyA","ArrowLeft","KeyS","ArrowDown","KeyD","ArrowRight","clone","removeEventListeners","addEventListener","removeEventListener","utils","shouldCaptureKeyEvent","code","hasOwnProperty","console","log","isPressed","isProxied","getKeyboard","global","nativeKeyboardEvent","TypeError","DOM_KEY_LOCATION_STANDARD","DOM_KEY_LOCATION_LEFT","DOM_KEY_LOCATION_RIGHT","DOM_KEY_LOCATION_NUMPAD","STANDARD","LEFT","RIGHT","NUMPAD","contains","s","ss","String","indexOf","os","platform","userAgent","browser","vendor","browser_os","mergeIf","baseTable","select","table","forEach","keyCode","keyCodeToInfoTable","keyCap","location","keyIdentifierTable","locationTable","codeToKeyTable","ShiftLeft","key","ShiftRight","ControlLeft","ControlRight","AltLeft","AltRight","OSLeft","OSRight","NumpadEnter","Space","Digit0","shiftKey","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","KeyB","KeyC","KeyE","KeyF","KeyG","KeyH","KeyI","KeyJ","KeyK","KeyL","KeyM","KeyN","KeyO","KeyP","KeyQ","KeyR","KeyT","KeyU","KeyV","KeyX","KeyY","KeyZ","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","NumpadMultiply","NumpadAdd","NumpadComma","NumpadSubtract","NumpadDecimal","NumpadDivide","Semicolon","Equal","Comma","Minus","Period","Slash","Backquote","BracketLeft","Backslash","BracketRight","Quote","IntlBackslash","o","r","keyFixTable","Esc","Nonconvert","Left","Up","Right","Down","Del","Menu","MediaNextTrack","MediaPreviousTrack","SelectMedia","HalfWidth","FullWidth","RomanCharacters","Crsel","Exsel","Zoom","codeTable","k","item","nativeLocation","_","keyInfoForEvent","which","keyInfo","keyLocation","keyIdentifier","entry","define","p","v","defineProperty","prototype","get","desc","getOwnPropertyDescriptor","call","queryKeyCap","locale","toLowerCase","identifyKey","reverseEnabled","bindMethods","direction","addEventListeners","canvasEl","canvas","onTouchStart","onTouchEnd","e","touches","preventDefault","dependencies","controls","speed","fly","constrainToNavMesh","velocityCtrl","velocity","heading","Quaternion","navGroup","navNode","hasLoaded","injectControls","prevData","nav","addAgent","removeAgent","name","start","end","clampedEnd","updateVelocityCtrl","updateVelocity","lengthSq","getGroup","getNode","clampStep","hasAttribute","l","control","vector2","quaternion","getPositionDelta","cameraEl","premultiply","applyQuaternion","factor","enableNegX","enablePosX","enableNegZ","enablePosZ","zVel","xVel","onAxisMove","isMoving","canRecordAxis","startingAxisData","handleSwipeAxis","handleTouchAxis","axisData","detail","axis","velX","velZ","absChangeZ","LoopMode","once","LoopOnce","repeat","LoopRepeat","pingpong","LoopPingPong","regExpEscape","replace","clip","duration","clampWhenFinished","crossFadeDuration","loop","repetitions","Infinity","timeScale","model","mixer","activeActions","getObject3D","load","AnimationMixer","action","loopDelta","stopAllAction","changes","diff","stopAction","playAction","setDuration","setLoop","setEffectiveTimeScale","fadeOut","stop","clips","animations","geometry","re","RegExp","split","map","join","match","clipAction","fadeIn","push","isNaN","ColladaLoader","Component","loader","self","src","rendererSystem","renderer","colladaModel","scene","traverse","object","isMesh","material","color","applyColorCorrection","emissive","emissiveMap","setObject3D","format","removeObject3D","manager","undefined","DefaultLoadingManager","constructor","crossOrigin","url","onLoad","onProgress","onError","scope","path","LoaderUtils","extractUrlBase","FileLoader","setPath","text","parse","setResourcePath","resourcePath","options","warn","setCrossOrigin","getElementsByTagName","xml","array","childNodes","child","nodeName","parseStrings","parts","trim","Array","parseFloats","parseFloat","parseInts","parseInt","parseId","substring","isEmpty","parseAssetUnit","parseAssetUpAxis","textContent","parseLibrary","libraryName","parser","library","elements","buildLibrary","builder","build","getBuild","parseAnimationSampler","inputs","nodeType","semantic","parseAnimationChannel","shift","sid","arraySyntax","memberSyntax","member","indices","sampler","buildAnimation","tracks","channels","samplers","sources","channel","inputId","INPUT","outputId","OUTPUT","createKeyframeTracks","buildAnimationChannel","getAnimation","inputSource","outputSource","time","stride","il","j","jl","node","nodes","transform","transforms","defaultMatrix","matrix","transpose","keyframes","sort","a","b","transformAnimationData","prepareAnimationData","uuid","scale","animation","times","positionData","quaternionData","scaleData","keyframe","fromArray","decompose","w","VectorKeyframeTrack","QuaternionKeyframeTrack","property","defaultValue","empty","prev","next","getPrev","getNext","interpolate","createMissingKeyframes","buildAnimationClip","animationTracks","AnimationClip","getAnimationClip","parseSkin","bindShapeMatrix","parseSource","joints","parseJoints","vertexWeights","parseVertexWeights","vcount","buildController","geometries","skin","weights","jointOffset","JOINT","weightOffset","WEIGHT","jointSource","inverseSource","INV_BIND_MATRIX","jointCount","vertexSkinData","skinIndex","weightId","skinWeight","weight","descending","d","bindMatrix","Matrix4","identity","boneInverse","buildSkin","skinIndices","skinWeights","buildImage","init_from","getImage","images","parseEffectProfileCOMMON","surfaces","parseEffectNewparam","technique","parseEffectTechnique","extra","parseEffectExtra","parseEffectSurface","parseEffectSampler","source","parameters","parseEffectParameters","parseEffectParameter","opaque","parseEffectParameterTexture","parseEffectParameterTextureExtra","parseEffectParameterTextureExtraTechnique","toUpperCase","parseEffectExtraTechnique","buildEffect","buildMaterial","effect","effects","profile","MeshPhongMaterial","MeshLambertMaterial","MeshBasicMaterial","getTexture","textureObject","image","extension","slice","lastIndexOf","tgaLoader","textureLoader","getTextureLoader","texture","wrapS","wrapU","RepeatWrapping","ClampToEdgeWrapping","wrapT","wrapV","offsetU","offsetV","repeatU","repeatV","parameter","specular","specularMap","normalMap","lightMap","float","shininess","transparent","transparency","opacity","double_sided","side","DoubleSide","getMaterial","materials","parseCameraOptics","parseCameraTechnique","parseCameraParameters","buildCamera","optics","PerspectiveCamera","yfov","aspect_ratio","znear","zfar","ymag","xmag","aspectRatio","OrthographicCamera","getCamera","cameras","parseLightTechnique","parseLightParameters","Color","falloffAngle","f","distance","sqrt","buildLight","light","DirectionalLight","PointLight","SpotLight","AmbientLight","getLight","lights","accessor","parseGeometryVertices","parseGeometryPrimitive","primitive","count","hasUV","inputname","checkUVCoordinates","primitives","uvsNeedsFix","buildGeometry","vertices","groupedPrimitives","groupPrimitives","primitiveType","buildGeometryType","normal","uv","uv2","BufferGeometry","materialKeys","g","vc","addGroup","input","prevLength","buildGeometryData","addAttribute","Float32BufferAttribute","pushVector","sourceStride","sourceArray","c","kl","getGeometry","buildKinematicsModel","parseKinematicsTechniqueCommon","parseKinematicsJoint","links","parseKinematicsLink","parseKinematicsJointParameter","limits","static","zeroPosition","middlePosition","attachments","parseKinematicsAttachment","parseKinematicsTransform","joint","pop","obj","angle","parsePhysicsRigidBody","parsePhysicsTechniqueCommon","inertia","mass","parseKinematicsBindJointAxis","param","tmpJointIndex","jointIndex","substr","buildKinematicsScene","buildTransformList","collada","querySelector","vector","parseNode","instanceCameras","instanceControllers","instanceLights","instanceGeometries","instanceNodes","parseNodeInstance","multiply","makeTranslation","makeRotationAxis","hasNode","skeletons","instances","instance","symbol","buildSkeleton","boneData","sortedBoneData","skeleton","buildBoneHierarchy","visualScenes","children","error","bone","processed","bones","boneInverses","Skeleton","root","isBone","buildNode","objects","instanceCamera","newObjects","buildObjects","isSkinnedMesh","normalizeSkinWeights","instanceLight","Bone","Group","fallbackMaterial","resolveMaterialBinding","instanceMaterials","LineBasicMaterial","skinning","attributes","LineSegments","Line","SkinnedMesh","Mesh","buildVisualScene","group","getVisualScene","Scene","DOMParser","parseFromString","version","asset","unit","upAxis","parseAsset","TextureLoader","TGALoader","kinematics","kinematicsModels","physicsModels","kinematicsScenes","mesh","element","prepareNodes","rigidBodies","bindJointAxis","setupAnimations","kinematicsModelId","kinematicsSceneId","visualSceneId","kinematicsModel","kinematicsScene","getKinematicsScene","visualScene","jointMap","targetElement","parentVisualElement","parentElement","connect","m0","getJointValue","jointData","setJointValue","visualElement","visualElementName","setupKinematics","parseScene","setFromEuler","Euler","FBXLoader","crossorigin","fbxTree","connections","sceneGraph","FBXTreeParser","GeometryParser","AnimationParser","TextParser","BinaryParser","BinaryReader","buffer","littleEndian","dv","DataView","FBXTree","getFbxVersion","convertFBXTimeToSeconds","resourceDirectory","setResponseType","setTimeout","itemError","FBXBuffer","CORRECT","byteLength","convertArrayBufferToString","FBXText","cursor","result","isFbxFormatASCII","parseConnections","parseImages","textures","parseTextures","parseMaterials","deformers","parseDeformers","geometryMap","connectionMap","Map","Connections","rawConnection","fromID","toID","relationship","has","parents","parentRelationship","ID","childRelationship","blobs","Objects","videoNodes","Video","nodeID","videoNode","RelativeFilename","Filename","arrayBufferContent","Content","ArrayBuffer","base64Content","parseImage","filename","content","fileName","Loader","Handlers","Uint8Array","URL","createObjectURL","Blob","textureMap","textureNodes","Texture","parseTexture","textureNode","loadTexture","attrName","wrapModeU","WrapModeU","wrapModeV","WrapModeV","valueU","valueV","values","Scaling","currentPath","FileName","materialMap","materialNodes","Material","parseMaterial","materialNode","ShadingModel","parseParameters","setValues","BumpFactor","bumpScale","Diffuse","DiffuseColor","DisplacementFactor","displacementScale","Emissive","EmissiveColor","EmissiveFactor","emissiveIntensity","Opacity","ReflectionFactor","reflectivity","Shininess","Specular","SpecularColor","bumpMap","displacementMap","envMap","EquirectangularReflectionMapping","alphaMap","LayeredTexture","morphTargets","DeformerNodes","Deformer","deformerNode","relationships","attrType","parseSkeleton","geometryID","morphTarget","rawTargets","parseMorphTargets","deformerNodes","rawBones","boneNode","rawBone","Transform","transformLink","TransformLink","linkMode","Mode","Indexes","Weights","rawMorphTargets","morphTargetNode","rawMorphTarget","initialWeight","DeformPercent","fullWeights","FullWeights","geoID","modelMap","parseModels","modelNodes","Model","modelNode","setLookAtProperties","connection","parent","bindSkeleton","createAmbientLight","setupMorphMaterials","isGroup","createCamera","createLight","createMesh","createCurve","PropertyBinding","sanitizeNodeName","setModelTransforms","subBone","matrixWorld","cameraAttribute","attr","NodeAttribute","CameraProjectionType","nearClippingPlane","NearPlane","farClippingPlane","FarPlane","width","innerWidth","height","innerHeight","AspectWidth","AspectHeight","aspect","fov","FieldOfView","focalLength","FocalLength","setFocalLength","lightAttribute","LightType","intensity","Intensity","CastLightOnObject","FarAttenuationEnd","EnableFarAttenuation","InnerAngle","penumbra","OuterAngle","CastShadows","castShadow","vertexColors","VertexColors","FBX_Deformer","reduce","geo","linewidth","transformData","eulerOrder","RotationOrder","translation","Lcl_Translation","rotationOffset","RotationOffset","Lcl_Rotation","preRotation","PreRotation","postRotation","PostRotation","Lcl_Scaling","generateTransform","applyMatrix","lookAtTarget","pos","lookAt","bindMatrices","parsePoseNodes","geoConnParent","BindPoseNode","Pose","poseNodes","PoseNode","isArray","poseNode","Node","Matrix","GlobalSettings","ambientColor","AmbientColor","morphAttributes","matUuid","sharedMat","geoNodes","Geometry","parseGeometry","geoNode","parseMeshGeometry","parseNurbsGeometry","GeometricTranslation","GeometricRotation","GeometricScaling","genGeometry","preTransform","geoInfo","parseGeoNode","buffers","genBuffers","positionAttribute","vertex","applyToBufferAttribute","colors","Uint16BufferAttribute","weightsIndices","normalAttribute","Matrix3","getNormalMatrix","uvs","uvBuffer","toString","mappingType","prevMaterialIndex","materialIndex","startIndex","currentIndex","groups","lastGroup","lastIndex","addMorphTargets","vertexPositions","Vertices","vertexIndices","PolygonVertexIndex","LayerElementColor","parseVertexColors","LayerElementMaterial","parseMaterialIndices","LayerElementNormal","parseNormals","LayerElementUV","parseUVs","weightTable","polygonIndex","faceLength","displayedWeightsWarning","facePositionIndexes","faceNormals","faceColors","faceUVs","faceWeights","faceWeightIndices","vertexIndex","polygonVertexIndex","endOfFace","weightIndices","getData","wt","wIndex","Weight","weightIndex","currentWeight","comparedWeight","comparedWeightIndex","comparedWeightArray","tmp","genFace","parentGeo","parentGeoNode","rawTarget","morphGeoNode","genMorphGeometry","morphGeo","morphPositions","morphIndex","morphGeoInfo","morphBuffers","NormalNode","MappingInformationType","referenceType","ReferenceInformationType","Normals","indexBuffer","NormalIndex","NormalsIndex","dataSize","UVNode","UV","UVIndex","ColorNode","Colors","ColorIndex","MaterialNode","materialIndexBuffer","Materials","materialIndices","NURBSCurve","order","Order","startKnot","endKnot","degree","knots","KnotVector","controlPoints","pointsValues","Points","Vector4","Form","getPoints","positions","Float32Array","toArray","BufferAttribute","animationClips","rawClips","parseClips","rawClip","addClip","AnimationCurve","curveNodesMap","parseAnimationCurveNodes","parseAnimationCurves","layersMap","parseAnimationLayers","parseAnimStacks","rawCurveNodes","AnimationCurveNode","rawCurveNode","curveNode","curves","rawCurves","animationCurve","KeyTime","KeyValueFloat","animationCurveID","animationCurveRelationship","rawLayers","AnimationLayer","layerCurveNodes","modelID","rawModel","modelName","initialPosition","initialRotation","initialScale","getModelAnimTransform","preRotations","postRotations","morph","deformerID","morpherID","morphName","rawStacks","AnimationStack","layer","rawTracks","concat","generateTracks","setFromQuaternion","T","positionTrack","generateVectorTrack","R","rotationTrack","generateRotationTrack","S","scaleTrack","morphTrack","generateMorphTrack","initialValue","getTimesForAllAxes","getKeyframeTrackValues","interpolateRotations","inverse","euler","quaternionValues","val","morphNum","getObjectByName","morphTargetDictionary","NumberKeyframeTrack","filter","elem","prevValue","xIndex","yIndex","zIndex","xValue","yValue","zValue","curve","valuesSpan","absoluteSpan","numSubIntervals","step","nextValue","initialTime","interval","nextTime","interpolatedTimes","interpolatedValues","inject","getPrevNode","nodeStack","currentIndent","getCurrentNode","getCurrentProp","currentProp","pushStack","popStack","setCurrentProp","currentPropName","allNodes","line","matchComment","matchEmpty","matchBeginning","matchProperty","matchEnd","parseNodeBegin","parseNodeProperty","parseNodePropertyContinued","nodeAttrs","attrs","parseNodeAttr","currentNode","contentLine","propName","propValue","connProps","from","to","rest","append","parseNumberArray","parseNodeSpecialProperty","props","prop","innerPropName","innerPropType1","innerPropType2","innerPropFlag","innerPropValue","reader","skip","getUint32","endOfContent","size","endOffset","getUint64","numProperties","nameLen","getUint8","getString","propertyList","parseProperty","singleProperty","subNode","parseSubNode","getBoolean","getFloat64","getFloat32","getInt32","getInt64","getArrayBuffer","getInt16","arrayLength","encoding","compressedLength","getBooleanArray","getFloat64Array","getFloat32Array","getInt32Array","getInt64Array","Zlib","reader2","Inflate","decompress","low","high","nullByte","decodeText","dataArray","infoObject","tempMat","tempEuler","tempVec","getEulerOrder","makeRotationFromEuler","getInverse","setPosition","enums","a1","a2","fetchScript","loadLoader","promise","loaderPromise","then","GLTFLoader","gltfModel","removeScript","script","document","getElementById","parentNode","removeChild","fetchScriptInternal","Promise","resolve","reject","timeout","scriptId","Date","ceil","random","createElement","async","createScript","timeoutId","disableTimeout","clearTimeout","ok","firstScript","insertBefore","appendScript","settings","ObjectLoader","targetEl","fire","applyEnvMap","materialNames","needsUpdate","multiple","enableBackground","CubeTextureLoader","object3dsetHandler","oldData","addedMaterialNames","removedMaterialNames","includes","maintainedMaterialNames","setBackground","background","physics","GRABBED_STATE","grabbing","hitEl","constraint","onHit","onGripOpen","onGripClose","removeState","removeConstraint","evt","is","addState","CANNON","LockConstraint","body","addConstraint","on","playerHeight","maxJumps","numJumps","beginJump","events","bindings","collide","onCollide","initialVelocity","radius","linearDamping","enableSlopes","enableJumps","addComponent","Vec3","Body","fixedRotation","addShape","Sphere","addBody","removeBody","removeComponent","beforeStep","normalizedVelocity","currentSurfaceNormal","groundNormal","groundBody","didCollide","groundHeight","contacts","getContacts","maxInterval","contact","bi","ni","negate","bj","dot","projectOnPlane","rj","ri","normalize","raycastToGround","driver","world","gravity","ray","hitNormal","vFrom","vTo","Ray","_updateDirection","intersectBody","hasHit","hitNormalWorld","computeVertexNormals","MeshNormalMaterial","flatShading","applyMaterial","state","watch","observer","els","collisions","handleHit","handleHitEnd","MutationObserver","observe","childList","subtree","disconnect","objectEls","querySelectorAll","meshPosition","colliderScale","box","Box3","distanceMap","colliderRadius","scaleVec","clear","getWorldScale","apply","extent","isEntity","setFromObject","getSize","getCenter","hasLoadedNavMesh","loadNavMesh","navMesh","navMeshGeometry","isBufferGeometry","fromBufferGeometry","updateMatrixWorld","setNavMeshGeometry","destination","raycaster","Raycaster","vDest","vDelta","vNext","getPath","vCurrent","vWaypoint","gazeTarget","subVectors","origin","intersections","intersectObject","getNavMesh","point","Pathfinding","pathfinder","ZONE","registerSystem","agents","Set","setZoneData","createZone","agent","ctrl","delete","groupID","findPath","getClosestNode","endTarget","computeCentroids","n","faces","centroid","divideScalar","roundNumber","Number","toFixed","sample","floor","mergeVertexIds","u","setPolygonCentroid","vertexIds","cleanPolygon","h","angleTo","neighbours","isConvex","cross","distanceToSquared","isPointInPoly","isVectorInPolygon","triarea2","vequal","scoreFunction","sinkDown","bubbleUp","rescoreElement","cost","visited","closed","cleanUp","heap","search","reverse","heuristic","buildZone","_buildNavigationMesh","_buildPolygonGroups","_getSharedVerticesInOrder","portals","mergeVertices","_buildPolygonsFromGeometry","polygons","_buildPolygonNeighbours","faceVertexUvs","left","right","stringPull","zones","pow","getRandomNode","Plane","Triangle","setFromCoplanarPoints","projectPoint","closestPointToPoint","I","registerPrimitive","defaultComponents","mappings","vg","defaultHexGrid","Primitive","fetch","response","json","addMesh","grid","HexGrid","fromJSON","board","Board","generateTilemap","addMaterial","VERSION","TAU","DEG_TO_RAD","RAD_TO_DEG","SQRT3","TILE","ENT","STR","HEX","SQR","ABS","tiles","tileGroup","overlay","finder","AStarFinder","setGrid","setEntityOnTile","cellToPixel","cell","heightOffset","tile","entity","addTile","snapTileToGrid","removeTile","splice","dispose","removeAllTiles","getTileAtCell","cellToHash","cells","snapToGrid","pixelToCell","getRandomTile","Tools","randomInt","generateOverlay","reset","generateTiles","Cell","q","userData","walkable","_calcCost","_priority","_visited","_parent","uniqueID","LinkedList","generateID","equals","cellSize","numCells","extrudeSettings","autogenerated","_createVertex","cellShape","Shape","moveTo","lineTo","autoClose","cellGeo","verticesNeedUpdate","cellShapeGeo","ShapeGeometry","_cellWidth","_cellLength","_hashDelimeter","_directions","_diagonals","_list","_vec3","_cel","_conversionVec","_geoCache","_matCache","TWO_THIRDS","_cubeRound","getCellAt","getNeighbors","getRandomCell","clearPath","generateTile","amount","ExtrudeGeometry","Tile","tileScale","bevelEnabled","bevelSegments","steps","bevelSize","bevelThickness","merge","generateTilePoly","rotateOnAxis","generate","createPointsGeometry","getJSON","callback","cache","toJSON","cos","sin","round","SqrGrid","_fullCellSize","randomizeRGB","objectType","selected","highlight","structure","_emissive","getHex","setHex","deselect","toggle","free","first","last","objToNodeMap","sortArray","addNode","swapObjects","showDebug","dump","moveUp","moveDown","_listener","isOnce","context","signal","params","execute","detach","isBound","_destroy","_bindings","_prevParams","dispatch","arguments","memorize","_shouldPropagate","validateListener","_registerListener","_indexOfListener","_addBinding","addOnce","removeAll","getNumListeners","halt","forget","Signal","allowDiagonal","heuristicFilter","list","compare","PathUtil","backtrace","biBacktrace","pathLength","expandPath","smoothenPath","m","isWalkableAt","compressPath","imageLoader","LoadingManager","ImageLoader","sourceFile","MouseCaster","down","rightDown","pickedObject","selectedObject","allHits","wheel","screenPosition","_camera","_raycaster","_preventDefault","_onDocumentMouseMove","_onDocumentMouseDown","_onDocumentMouseUp","_onMouseWheel","OVER","OUT","DOWN","UP","CLICK","WHEEL","setFromCamera","ctrlKey","clientX","clientY","stopPropagation","wheelDelta","alpha","antialias","clearColor","sortObjects","fog","lightPosition","cameraType","cameraPosition","orthoZoom","minDistance","maxDistance","zoomSpeed","noZoom","WebGLRenderer","setClearColor","container","contolled","OrbitControls","domElement","top","bottom","updateProjectionMatrix","setSize","attachTo","style","setPixelRatio","devicePixelRatio","appendChild","render","updateOrthoZoom","focusOn","SelectionManager","mouse","onSelect","onDeselect","toggleSelection","onMouse","clearSelection","clamp","sign","getShortRotation","isPlainObject","nwf","Performance","elapsedTime","lastChild","radixSort","XMLHttpRequest","onreadystatechange","status","statusText","JSON","responseText","open","setRequestHeader","send","ocean","depth","density","amplitude","amplitudeVariance","speedVariance","PlaneGeometry","waves","ang","amp","shading","FlatShading","verts","vprops","tube","segments","radialSegments","CatmullRomCurve3","TubeGeometry"],"mappings":"iFAAA,EAAQ,GACR,EAAQ,IACR,EAAQ,IACR,EAAQ,IACR,EAAQ,K,gBCJR,EAAQ,IACR,EAAQ,IACR,EAAQ,IACR,EAAQ,IACR,EAAQ,IACR,EAAQ,K,cCHRA,EAAOC,QAAUC,OAAOC,kBAAkB,sBAAuB,CAC/DC,OAAQ,CACNC,QAAS,CAACC,SAAS,GACnBC,KAAM,CAACD,QAAS,WAAYE,MAAO,CAAC,WAAY,YAChDC,aAAc,CAACH,QAAS,IAG1BI,KAAM,WACJC,KAAKC,QAAS,EACdD,KAAKE,WAAa,KAElBF,KAAKG,sBAAuB,EAE5BH,KAAKI,OAAS,IAAIC,MAAMC,QACxBN,KAAKO,SAAW,IAAIF,MAAMC,QAC1BN,KAAKQ,eAAiB,IAAIH,MAAMC,SAGlCG,KAAM,WAAcT,KAAKC,QAAS,GAClCS,MAAO,WAAcV,KAAKC,QAAS,GAEnCU,cAAe,SAAUT,GACvB,MAAMU,EAAKZ,KAAKY,GAEXZ,KAAKC,QACND,KAAKE,aAAeA,IAEpBF,KAAKE,YACPU,EAAGC,KAAK,iBAAkB,CAACX,WAAYF,KAAKE,aAG9CF,KAAKE,WAAaA,EAClBF,KAAKc,OAGDd,KAAKO,SAASQ,WAAWf,KAAKQ,gBArC1B,GAsCNR,KAAKE,WAAa,MAIpBU,EAAGC,KAAK,mBAAoB,CAACX,WAAYA,IAElB,aAAnBF,KAAKgB,KAAKpB,OACZI,KAAKY,GAAGK,aAAa,WAAYjB,KAAKQ,gBACtCR,KAAKE,WAAa,KAClBU,EAAGC,KAAK,iBAAkB,CAACX,WAAYA,IACvCU,EAAGM,WAAW,qBAAqBC,wBAIvCC,iBAAkB,WAChB,SAAUpB,KAAKC,SAAUD,KAAKE,aAGhCmB,YAAa,WACX,IAAKrB,KAAKC,OAAQ,OAElB,MAAMe,EAAOhB,KAAKgB,KACZZ,EAASJ,KAAKI,OACdG,EAAWP,KAAKO,SAChBC,EAAiBR,KAAKQ,eACtBN,EAAaF,KAAKE,WAGxB,OADAF,KAAKc,OACDP,EAASQ,WAAWP,GAlEhB,IAmENR,KAAKE,WAAa,KAClBF,KAAKY,GAAGC,KAAK,iBAAkB,CAACX,WAAYA,IACrCE,EAAOkB,IAAI,EAAG,EAAG,KAE1BlB,EAAOmB,UAAUP,EAAKlB,cACfM,IAGTU,KAAM,WACJ,MAAMV,EAASJ,KAAKI,OACdG,EAAWP,KAAKO,SAChBC,EAAiBR,KAAKQ,eAE5BD,EAASiB,KAAKxB,KAAKY,GAAGa,aAAa,aACnCzB,KAAKE,WAAWwB,SAASC,iBAAiBnB,GAC1CA,EAAeoB,IAAI5B,KAAKE,WAAWgB,WAAWhB,WAAW2B,aACzDzB,EAAOoB,KAAKhB,GAAgBsB,IAAIvB,O,gBC1EpC,MAAMwB,EAAgB,EAAQ,IAC1BC,EAAqB,EAAQ,IAI3BC,EACM,EADNA,EAEM,EAGZ5C,EAAOC,QAAUC,OAAOC,kBAAkB,mBAAoB,CAM5DuC,cAAeA,EAMftC,OAAQ,CAENyC,WAAmB,CAAEvC,QAAS,EAAGE,MAAO,CAAC,EAAG,EAAG,EAAG,IAGlDH,QAAmB,CAAEC,SAAS,GAG9BwC,MAAmB,CAAExC,SAAS,GAG9ByC,OAAiB,CAAEzC,QAAS,WAAY0C,KAAM,YAG9CC,oBAAsB,CAAE3C,QAAS,IAUnCI,KAAM,WACJ,MAAMwC,EAAUvC,KAAKY,GAAG2B,QAExBvC,KAAKwC,OAASD,EAAQE,QAAQ,2BAA6B,CAACC,YAAa,IAEzE1C,KAAK2C,SAAWC,OAAOC,YAAYC,MAGnC9C,KAAK+C,QAAU,GAGf,MAAMC,EAAWhD,KAAKY,GAAGc,SAASsB,SAClChD,KAAKiD,MAAQ,IAAI5C,MAAM6C,SACvBlD,KAAKiD,MAAMD,SAASG,EAAI9C,MAAM+C,KAAKC,SAASL,EAASG,GACrDnD,KAAKsD,IAAM,IAAIjD,MAAM6C,SACrBlD,KAAKsD,IAAI/C,SAASgD,EAAI,GACtBvD,KAAKsD,IAAIN,SAASO,EAAIlD,MAAM+C,KAAKC,SAASL,EAASO,GACnDvD,KAAKsD,IAAI1B,IAAI5B,KAAKiD,OAElBjD,KAAKwD,YAAc,IAAInD,MAAMoD,QAC7BzD,KAAK0D,YAAc,IAAIrD,MAAMoD,QAC7BzD,KAAK2D,YAAc,IAAItD,MAAMoD,QAE7BlB,EAAQqB,YAAY5D,OAOtB6D,OAAQ,WAAc7D,KAAK8D,QAK3BA,KAAM,SAAUC,EAAGC,GACjBhE,KAAKiE,oBACLjE,KAAKkE,eAAeF,IAOtBG,OAAQ,aAMR/C,iBAAkB,WAChB,IAAKpB,KAAKgB,KAAKtB,UAAYM,KAAKoE,cAAe,OAAO,EAEtD,MAAMC,EAAOrE,KAAK2D,YACZW,EAAWtE,KAAK0D,YAEtB1D,KAAKuE,QAAQF,GACbrE,KAAKwE,YAAYvC,EAAmBqC,GAEpC,MAAMG,EAASJ,EAAKlB,GAAKmB,EAASnB,EAC5BuB,EAASL,EAAKd,GAAKe,EAASf,EAElC,OAAOH,KAAKuB,IAAIF,GAzGC,IAyGyBrB,KAAKuB,IAAID,GAzGlC,IA4GnBE,iBAAkB,WAChB,MAAMP,EAAOrE,KAAK2D,YACZW,EAAWtE,KAAK0D,YAEtB1D,KAAKuE,QAAQF,GACbrE,KAAKwE,YAAYvC,EAAmBqC,GAEpC,MAAMG,EAASJ,EAAKlB,GAAKmB,EAASnB,EAC5BuB,EAASL,EAAKd,GAAKe,EAASf,EAC5BsB,EAAY,IAAIxE,MAAMC,QAS5B,OAPI8C,KAAKuB,IAAIF,GAvHI,KAwHfI,EAAU1B,GAAKsB,GAEbrB,KAAKuB,IAAID,GA1HI,KA2HfG,EAAUC,GAAKJ,GAGVG,GAOTE,iBAAkB,WAChB,IAAK/E,KAAKgB,KAAKtB,UAAYM,KAAKoE,cAAe,OAAO,EAEtD,MAAME,EAAWtE,KAAKwD,YAItB,OAFAxD,KAAKwE,YAAYvC,EAAmBqC,GAE7BlB,KAAKuB,IAAIL,EAASnB,GA5IR,IA4I6BC,KAAKuB,IAAIL,EAASf,GA5I/C,IA+InBW,eAAgB,SAAUF,GACxB,IAAKhE,KAAK+E,mBAAoB,OAE9B,MAAM/D,EAAOhB,KAAKgB,KACZsC,EAAMtD,KAAKsD,IACXL,EAAQjD,KAAKiD,MACb+B,EAAehE,EAAKoB,OAAOlB,WAAW,iBACtC+D,EAAkBD,GAAgBA,EAAaE,aAAeF,EAAaG,UAG7EF,IACFhC,EAAMD,SAASxB,KAAKwD,EAAaE,YAAYlC,UAC7CM,EAAIN,SAASxB,KAAKwD,EAAaG,UAAUnC,WAG3C,MAAMoC,EAAapF,KAAKwD,YAExBxD,KAAKwE,YAAYvC,EAAmBmD,GAEhChC,KAAKuB,IAAIS,EAAWjC,IAlKP,KAkK2BiC,EAAWjC,EAAI,GACvDC,KAAKuB,IAAIS,EAAW7B,IAnKP,KAmK2B6B,EAAW7B,EAAI,GAE3D6B,EAAWC,eAAerE,EAAKsB,oBAAsB0B,EAAK,KAC1DV,EAAIN,SAASO,GAAK6B,EAAWjC,EAC7BF,EAAMD,SAASG,GAAKiC,EAAW7B,EAC/BN,EAAMD,SAASG,EAAIC,KAAKkC,KAAMlC,KAAKmC,GAAK,EAAGnC,KAAKoC,IAAIpC,KAAKmC,GAAK,EAAGtC,EAAMD,SAASG,IAChFnC,EAAKoB,OAAOV,SAASsB,SAAS1B,IAAI2B,EAAMD,SAASG,EAAGG,EAAIN,SAASO,EAAG,GAGhE0B,IACFD,EAAaE,YAAYlC,SAASxB,KAAKyB,EAAMD,UAC7CgC,EAAaG,UAAUnC,SAASxB,KAAK8B,EAAIN,YAQ7CiB,kBAAmB,WACjB,MAAMwB,EAAUzF,KAAK0F,aACrB,GAAI1F,KAAKgB,KAAKtB,SAAW+F,EAGvB,IAAK,IAAIE,EAAI,EAAGA,EAAIF,EAAQ1C,QAAQ6C,OAAQD,IACtCF,EAAQ1C,QAAQ4C,GAAGE,UAAY7F,KAAK+C,QAAQ4C,GAC9C3F,KAAKa,KAAK,IAAImB,EAAmB,oBAAqB2D,EAAGF,EAAQ1C,QAAQ4C,MAC/DF,EAAQ1C,QAAQ4C,GAAGE,SAAW7F,KAAK+C,QAAQ4C,IACrD3F,KAAKa,KAAK,IAAImB,EAAmB,kBAAmB2D,EAAGF,EAAQ1C,QAAQ4C,KAEzE3F,KAAK+C,QAAQ4C,GAAKF,EAAQ1C,QAAQ4C,GAAGE,aAG9BC,OAAOC,KAAK/F,KAAK+C,WAE1B/C,KAAK+C,QAAU,KAInBlC,KAAM,SAAUmF,GAEdhG,KAAKY,GAAGC,KAAKmF,EAAM3D,KAAM2D,GAGzBhG,KAAKY,GAAGC,KACNmF,EAAM3D,KAAO,IAAM2D,EAAMC,MACzB,IAAIjE,EAAmBgE,EAAM3D,KAAM2D,EAAMC,MAAOD,KAepDN,WAAY,WACV,MAAMQ,EAAaC,UAAUC,aACpBD,UAAUC,cAAcpG,KAAKgB,KAAKkB,YACvCmE,EAAerG,KAAKwC,OAAOE,YAAY1C,KAAKgB,KAAKkB,YACjDoE,EAAYD,GAAgBA,EAAaZ,QACzCc,EAAgBvG,KAAKY,GAAG2B,QAAQrB,WAAW,kBAG/C,OAFmBqF,GAAiBA,EAAcnC,eACzCmC,EAAcb,WAAW1F,KAAKgB,KAAKkB,aACrBoE,GAAaJ,GAQtCM,UAAW,SAAUP,GACnB,OAAOjG,KAAK0F,aAAa3C,QAAQkD,IASnCQ,QAAS,SAAUR,GACjB,OAAOjG,KAAK0F,aAAagB,KAAKT,IAShCzB,YAAa,SAAUyB,EAAOU,GAC5B,MAAMlB,EAAUzF,KAAK0F,aACrB,GAAwB,gBAApBD,EAAQmB,QAEV,OAAQX,GACN,KAAKhE,EAAmB,OAAO0E,EAAOrF,IAAImE,EAAQiB,KAAK,GAAIjB,EAAQiB,KAAK,IACxE,KAAKzE,EAAmB,OAAO0E,EAAOrF,IAAImE,EAAQiB,KAAK,GAAIjB,EAAQiB,KAAK,SAG1E,OAAQT,GACN,KAAKhE,EAAmB,OAAO0E,EAAOrF,IAAImE,EAAQiB,KAAK,GAAIjB,EAAQiB,KAAK,IACxE,KAAKzE,EAAmB,OAAO0E,EAAOrF,IAAImE,EAAQiB,KAAK,GAAIjB,EAAQiB,KAAK,IAG5E,MAAM,IAAIG,MAAM,kCAAmCZ,IAQrD1B,QAAS,SAAUoC,GACjB,MAAMlB,EAAUzF,KAAK0F,aACrB,OAAKD,EAAQ1C,QAAQhB,EAAc+E,YAG5BH,EAAOrF,KACXmE,EAAQ1C,QAAQhB,EAAc+E,YAAYjB,QAAU,EAAI,IACtDJ,EAAQ1C,QAAQhB,EAAcgF,WAAWlB,SAAW,EAAI,IAC1DJ,EAAQ1C,QAAQhB,EAAciF,SAASnB,SAAW,EAAI,IACpDJ,EAAQ1C,QAAQhB,EAAckF,WAAWpB,QAAU,EAAI,IANnDc,EAAOrF,IAAI,EAAG,IAczB8C,YAAa,WACX,MAAMqB,EAAUzF,KAAK0F,aACrB,SAAUD,IAAWA,EAAQyB,YAQ/BC,MAAO,WACL,OAAOnH,KAAK0F,aAAa0B,O,cClU7B/H,EAAOC,QAAUwG,OAAOuB,QAAO,cAA8B,CAC5DC,OAAQ,EACRC,OAAQ,EACRC,OAAQ,EACRC,OAAQ,EAERC,aAAc,EACdC,aAAc,EACdC,aAAc,EACdC,aAAc,EAEdC,OAAQ,EACRC,MAAO,EAEPf,QAAS,GACTC,UAAW,GACXF,UAAW,GACXD,WAAY,GAEZkB,OAAQ,M,cCZT3I,EAAOC,QAPP,SAA6B+C,EAAM4D,EAAOgC,GACxCjI,KAAKqC,KAAOA,EACZrC,KAAKiG,MAAQA,EACbjG,KAAK6F,QAAUoC,EAAQpC,QACvB7F,KAAKkI,MAAQD,EAAQC,Q,gBCJvB,EAAQ,IAER,MAGMC,EAAgBvF,OAAOuF,cAsB7B9I,EAAOC,QAAUC,OAAOC,kBAAkB,oBAAqB,CAC7DC,OAAQ,CACNC,QAAmB,CAAEC,SAAS,GAC9BwC,MAAmB,CAAExC,SAAS,IAGhCI,KAAM,WACJC,KAAK6E,UAAY,IAAIxE,MAAMC,QAC3BN,KAAKoI,UAAY,GACjBpI,KAAKqI,UAAY,CACfC,QAAStI,KAAKuI,UAAUC,KAAKxI,MAC7ByI,MAAOzI,KAAK0I,QAAQF,KAAKxI,MACzB2I,KAAM3I,KAAK4I,OAAOJ,KAAKxI,OAEzBA,KAAK6I,wBAOPzH,iBAAkB,WAChB,OAAOpB,KAAKgB,KAAKtB,WAAaoG,OAAOC,KAAK/F,KAAK8I,WAAWlD,QAG5DhB,iBAAkB,WAChB,MAAM5D,EAAOhB,KAAKgB,KACd+E,EAAO/F,KAAK8I,UAUhB,OARA9I,KAAK6E,UAAUvD,IAAI,EAAG,EAAG,GACrBN,EAAKtB,WACHqG,EAAKgD,MAAQhD,EAAKiD,WAAchJ,KAAK6E,UAAUC,GAAK,IACpDiB,EAAKkD,MAAQlD,EAAKmD,aAAclJ,KAAK6E,UAAU1B,GAAK,IACpD4C,EAAKoD,MAAQpD,EAAKqD,aAAcpJ,KAAK6E,UAAUC,GAAK,IACpDiB,EAAKsD,MAAQtD,EAAKuD,cAActJ,KAAK6E,UAAU1B,GAAK,IAGnDnD,KAAK6E,UAAU0E,SAOxB9I,KAAM,WACJT,KAAK6I,wBAGPnI,MAAO,WACLV,KAAKwJ,wBAGPrF,OAAQ,WACNnE,KAAKU,SAGPmI,qBAAsB,WACpBjG,OAAO6G,iBAAiB,UAAWzJ,KAAKqI,UAAUC,SAAS,GAC3D1F,OAAO6G,iBAAiB,QAASzJ,KAAKqI,UAAUI,OAAO,GACvD7F,OAAO6G,iBAAiB,OAAQzJ,KAAKqI,UAAUM,MAAM,IAGvDa,qBAAsB,WACpB5G,OAAO8G,oBAAoB,UAAW1J,KAAKqI,UAAUC,SACrD1F,OAAO8G,oBAAoB,QAAS1J,KAAKqI,UAAUI,OACnD7F,OAAO8G,oBAAoB,OAAQ1J,KAAKqI,UAAUM,OAGpDJ,UAAW,SAAUvC,GACfzG,OAAOoK,MAAMC,sBAAsB5D,KACrChG,KAAKoI,UAAUpC,EAAM6D,OAAQ,EAC7B7J,KAAKa,KAAKmF,KAId0C,QAAS,SAAU1C,GACbzG,OAAOoK,MAAMC,sBAAsB5D,YAC9BhG,KAAKoI,UAAUpC,EAAM6D,MAC5B7J,KAAKa,KAAKmF,KAId4C,OAAQ,WACN,IAAK,IAAIiB,KAAQ7J,KAAKoI,UAChBpI,KAAKoI,UAAU0B,eAAeD,WACzB7J,KAAKoI,UAAUyB,IAK5BhJ,KAAM,SAAUmF,GAlHD,8BAuHKA,GAEhBhG,KAAKY,GAAGC,KAAKmF,EAAM3D,KAAM2D,GAI3BhG,KAAKY,GAAGC,KAAKmF,EAAM3D,KAAO,IAAM2D,EAAM6D,KAAM,IAAI1B,EAAcnC,EAAM3D,KAAM2D,IACtEhG,KAAKgB,KAAKmB,OAAO4H,QAAQC,IAAIhE,EAAM3D,KAAO,IAAM2D,EAAM6D,OAO5DI,UAAW,SAAUJ,GACnB,OAAOA,KAAQ7J,KAAK8I,WAGtBA,QAAS,WACP,OAAI9I,KAAKkK,YACAlK,KAAKY,GAAG2B,QAAQrB,WAAW,kBAAkBiJ,cAE/CnK,KAAKoI,WAGd8B,UAAW,WACT,MAAM3D,EAAgBvG,KAAKY,GAAG2B,QAAQrB,WAAW,kBACjD,OAAOqF,GAAiBA,EAAcnC,kB,iBC/IzC,SAASgG,GACR,IAAIC,EAAuB,kBAAmBD,EACzCC,IACHD,EAAOjC,cAAgB,WAA2B,MAAMmC,UAAU,yBAE9D,8BAA+BF,EAAOjC,gBAAgBiC,EAAOjC,cAAcoC,0BAA4B,GACvG,0BAA2BH,EAAOjC,gBAAgBiC,EAAOjC,cAAcqC,sBAAiC,GACxG,2BAA4BJ,EAAOjC,gBAAgBiC,EAAOjC,cAAcsC,uBAAiC,GACzG,4BAA6BL,EAAOjC,gBAAgBiC,EAAOjC,cAAcuC,wBAAiC,GAEhH,IAAIC,EAAW/H,OAAOuF,cAAcoC,0BAChCK,EAAOhI,OAAOuF,cAAcqC,sBAC5BK,EAAQjI,OAAOuF,cAAcsC,uBAC7BK,EAASlI,OAAOuF,cAAcuC,wBAQlC,SAASK,EAASC,EAAGC,GAAM,OAAkC,IAA3BC,OAAOF,GAAGG,QAAQF,GAEpD,IAAIG,EACEL,EAAS5E,UAAUkF,SAAU,OAAiB,MAC9CN,EAAS5E,UAAUkF,SAAU,OAAiB,MAC9CN,EAAS5E,UAAUkF,SAAU,QAAkB,OAC/CN,EAAS5E,UAAUkF,SAAU,SAAmB,QAChDN,EAAS5E,UAAUmF,UAAW,SAAWP,EAAS5E,UAAUkF,SAAU,SAAWN,EAAS5E,UAAUkF,SAAU,UAAoB,MAC/H,GAGLE,EACER,EAAS5E,UAAUmF,UAAW,WAAqB,SACnDP,EAAS5E,UAAUqF,OAAQ,SAAmB,SAC9CT,EAAS5E,UAAUmF,UAAW,QAAkB,KAChDP,EAAS5E,UAAUmF,UAAW,UAAoB,MAClDP,EAAS5E,UAAUmF,UAAW,UAAoB,QAC/C,GAGLG,EAAaF,EAAU,IAAMH,EAEjC,SAASM,EAAQC,EAAWC,EAAQC,GAC9BJ,IAAeG,GAAUL,IAAYK,GAAUR,IAAOQ,GACxD9F,OAAOC,KAAK8F,GAAOC,SAAQ,SAASC,GAClCJ,EAAUI,GAAWF,EAAME,MAsCjC,IAAIC,EAAqB,CAGvB,EAAM,CAAEnC,KAAM,UAId,EAAM,CAAEA,KAAM,QAEd,EAAM,CAAEA,KAAM,aACd,EAAM,CAAEA,KAAM,OAEd,GAAM,CAAEA,KAAM,SACd,GAAM,CAAEA,KAAM,SAGd,GAAM,CAAEA,KAAM,SACd,GAAM,CAAEA,KAAM,WACd,GAAM,CAAEA,KAAM,OACd,GAAM,CAAEA,KAAM,SACd,GAAM,CAAEA,KAAM,YACd,GAAM,CAAEA,KAAM,YACd,GAAM,CAAEA,KAAM,cACd,GAAM,CAAEA,KAAM,aACd,GAAM,CAAEA,KAAM,aACd,GAAM,CAAEA,KAAM,aAEd,GAAM,CAAEA,KAAM,UACd,GAAM,CAAEA,KAAM,WACd,GAAM,CAAEA,KAAM,cACd,GAAM,CAAEA,KAAM,UACd,GAAM,CAAEA,KAAM,cAEd,GAAM,CAAEA,KAAM,SACd,GAAM,CAAEA,KAAM,UACd,GAAM,CAAEA,KAAM,YACd,GAAM,CAAEA,KAAM,OACd,GAAM,CAAEA,KAAM,QACd,GAAM,CAAEA,KAAM,aACd,GAAM,CAAEA,KAAM,WACd,GAAM,CAAEA,KAAM,cACd,GAAM,CAAEA,KAAM,aACd,GAAM,CAAEA,KAAM,UACd,GAAM,CAAEA,KAAM,SACd,GAAM,CAAEA,KAAM,WACd,GAAM,CAAEA,KAAM,eACd,GAAM,CAAEA,KAAM,UACd,GAAM,CAAEA,KAAM,UACd,GAAM,CAAEA,KAAM,QAEd,GAAM,CAAEA,KAAM,SAAUoC,OAAQ,KAChC,GAAM,CAAEpC,KAAM,SAAUoC,OAAQ,KAChC,GAAM,CAAEpC,KAAM,SAAUoC,OAAQ,KAChC,GAAM,CAAEpC,KAAM,SAAUoC,OAAQ,KAChC,GAAM,CAAEpC,KAAM,SAAUoC,OAAQ,KAChC,GAAM,CAAEpC,KAAM,SAAUoC,OAAQ,KAChC,GAAM,CAAEpC,KAAM,SAAUoC,OAAQ,KAChC,GAAM,CAAEpC,KAAM,SAAUoC,OAAQ,KAChC,GAAM,CAAEpC,KAAM,SAAUoC,OAAQ,KAChC,GAAM,CAAEpC,KAAM,SAAUoC,OAAQ,KAGhC,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAE9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,OAAQoC,OAAQ,KAC9B,GAAM,CAAEpC,KAAM,SAAUqC,SAAUtB,GAClC,GAAM,CAAEf,KAAM,UAAWqC,SAAUrB,GACnC,GAAM,CAAEhB,KAAM,eAEd,GAAM,CAAEA,KAAM,WAEd,GAAM,CAAEA,KAAM,UAAWoC,OAAQ,IAAKC,SAAUpB,GAChD,GAAM,CAAEjB,KAAM,UAAWoC,OAAQ,IAAKC,SAAUpB,GAChD,GAAM,CAAEjB,KAAM,UAAWoC,OAAQ,IAAKC,SAAUpB,GAChD,GAAM,CAAEjB,KAAM,UAAWoC,OAAQ,IAAKC,SAAUpB,GAChD,IAAM,CAAEjB,KAAM,UAAWoC,OAAQ,IAAKC,SAAUpB,GAChD,IAAM,CAAEjB,KAAM,UAAWoC,OAAQ,IAAKC,SAAUpB,GAChD,IAAM,CAAEjB,KAAM,UAAWoC,OAAQ,IAAKC,SAAUpB,GAChD,IAAM,CAAEjB,KAAM,UAAWoC,OAAQ,IAAKC,SAAUpB,GAChD,IAAM,CAAEjB,KAAM,UAAWoC,OAAQ,IAAKC,SAAUpB,GAChD,IAAM,CAAEjB,KAAM,UAAWoC,OAAQ,IAAKC,SAAUpB,GAChD,IAAM,CAAEjB,KAAM,iBAAkBoC,OAAQ,IAAKC,SAAUpB,GACvD,IAAM,CAAEjB,KAAM,YAAaoC,OAAQ,IAAKC,SAAUpB,GAClD,IAAM,CAAEjB,KAAM,cAAeoC,OAAQ,IAAKC,SAAUpB,GACpD,IAAM,CAAEjB,KAAM,iBAAkBoC,OAAQ,IAAKC,SAAUpB,GACvD,IAAM,CAAEjB,KAAM,gBAAiBoC,OAAQ,IAAKC,SAAUpB,GACtD,IAAM,CAAEjB,KAAM,eAAgBoC,OAAQ,IAAKC,SAAUpB,GAErD,IAAM,CAAEjB,KAAM,MACd,IAAM,CAAEA,KAAM,MACd,IAAM,CAAEA,KAAM,MACd,IAAM,CAAEA,KAAM,MACd,IAAM,CAAEA,KAAM,MACd,IAAM,CAAEA,KAAM,MACd,IAAM,CAAEA,KAAM,MACd,IAAM,CAAEA,KAAM,MACd,IAAM,CAAEA,KAAM,MACd,IAAM,CAAEA,KAAM,OACd,IAAM,CAAEA,KAAM,OACd,IAAM,CAAEA,KAAM,OACd,IAAM,CAAEA,KAAM,OACd,IAAM,CAAEA,KAAM,OACd,IAAM,CAAEA,KAAM,OACd,IAAM,CAAEA,KAAM,OAEd,IAAM,CAAEA,KAAM,OACd,IAAM,CAAEA,KAAM,OACd,IAAM,CAAEA,KAAM,OACd,IAAM,CAAEA,KAAM,OACd,IAAM,CAAEA,KAAM,OACd,IAAM,CAAEA,KAAM,OACd,IAAM,CAAEA,KAAM,OACd,IAAM,CAAEA,KAAM,OAGd,IAAM,CAAEA,KAAM,UAAWqC,SAAUpB,GACnC,IAAM,CAAEjB,KAAM,cAKd,IAAM,CAAEA,KAAM,YAAaqC,SAAUtB,GACrC,IAAM,CAAEf,KAAM,aAAcqC,SAAUrB,GACtC,IAAM,CAAEhB,KAAM,cAAeqC,SAAUtB,GACvC,IAAM,CAAEf,KAAM,eAAgBqC,SAAUrB,GACxC,IAAM,CAAEhB,KAAM,UAAWqC,SAAUtB,GACnC,IAAM,CAAEf,KAAM,WAAYqC,SAAUrB,GAEpC,IAAM,CAAEhB,KAAM,eACd,IAAM,CAAEA,KAAM,kBACd,IAAM,CAAEA,KAAM,kBACd,IAAM,CAAEA,KAAM,eACd,IAAM,CAAEA,KAAM,iBACd,IAAM,CAAEA,KAAM,oBACd,IAAM,CAAEA,KAAM,eACd,IAAM,CAAEA,KAAM,cACd,IAAM,CAAEA,KAAM,cACd,IAAM,CAAEA,KAAM,YAEd,IAAM,CAAEA,KAAM,kBACd,IAAM,CAAEA,KAAM,sBACd,IAAM,CAAEA,KAAM,aACd,IAAM,CAAEA,KAAM,kBACd,IAAM,CAAEA,KAAM,cACd,IAAM,CAAEA,KAAM,eACd,IAAM,CAAEA,KAAM,cACd,IAAM,CAAEA,KAAM,cAEd,IAAM,CAAEA,KAAM,YAAcoC,OAAQ,KACpC,IAAM,CAAEpC,KAAM,QAASoC,OAAQ,KAC/B,IAAM,CAAEpC,KAAM,QAASoC,OAAQ,KAC/B,IAAM,CAAEpC,KAAM,QAASoC,OAAQ,KAC/B,IAAM,CAAEpC,KAAM,SAAUoC,OAAQ,KAChC,IAAM,CAAEpC,KAAM,QAASoC,OAAQ,KAE/B,IAAM,CAAEpC,KAAM,YAAaoC,OAAQ,KAKnC,IAAM,CAAEpC,KAAM,cAAeoC,OAAQ,KACrC,IAAM,CAAEpC,KAAM,YAAcoC,OAAQ,MACpC,IAAM,CAAEpC,KAAM,eAAgBoC,OAAQ,KACtC,IAAM,CAAEpC,KAAM,QAASoC,OAAQ,KAK/B,IAAM,CAAEpC,KAAM,gBAAkBoC,OAAQ,MAExC,IAAM,CAAEpC,KAAM,WAOd,IAAM,CAAEA,KAAM,QACd,IAAM,CAAEA,KAAM,SACd,IAAM,CAAEA,KAAM,SACd,IAAM,CAAEA,KAAM,YACd,IAAM,CAAEA,KAAM,QACd,IAAM,CAAEA,KAAM,cAGd,IAAM,CAAEA,KAAM,UA0BhB6B,EAAQM,EACA,MAAO,CACL,GAAM,CAAEnC,KAAM,YAAaoC,OAAQ,KACnC,GAAM,CAAEpC,KAAM,QAASoC,OAAQ,KAC/B,IAAM,CAAEpC,KAAM,QAASoC,OAAQ,KAC/B,IAAM,CAAEpC,KAAM,QAASoC,OAAQ,KAC/B,IAAM,CAAEpC,KAAM,YAAaoC,OAAQ,IAAKC,SAAUpB,GAClD,IAAM,CAAEjB,KAAM,iBAAkBoC,OAAQ,IAAKC,SAAUpB,KAGjEY,EAAQM,EACA,UAAW,CACT,GAAM,CAAEnC,KAAM,UAAWqC,SAAUpB,GACnC,IAAM,CAAEjB,KAAM,QAASoC,OAAQ,OAGzCP,EAAQM,EACA,UAAW,CACT,IAAM,CAAEnC,KAAM,QAASoC,OAAQ,OAGzCP,EAAQM,EACA,aAAc,CACZ,GAAM,CAAEnC,KAAM,UAAWqC,SAAUrB,KAoB7Ca,EAAQM,EACA,SAAU,CACR,EAAM,CAAEnC,KAAM,SACd,GAAM,CAAEA,KAAM,SAGxB6B,EAAQM,EACA,MAAO,CACL,GAAM,CAAEnC,KAAM,QAASqC,SAAUvB,KAG3Ce,EAAQM,EACA,aAAc,CACZ,GAAM,CAAEnC,KAAM,SAAUqC,SAAUtB,GAClC,GAAM,CAAEf,KAAM,UAAWqC,SAAUrB,GACnC,IAAM,CAAEhB,KAAM,OAAQoC,OAAQ,OAcxC,IAAIE,EAAqB,GACrB,SAAWf,IACbe,EAAmB,UAAY,CAAEtC,KAAM,YAAaqC,SAAUtB,GAC9DuB,EAAmB,UAAY,CAAEtC,KAAM,aAAcqC,SAAUrB,GAC/DsB,EAAmB,UAAY,CAAEtC,KAAM,cAAeqC,SAAUtB,GAChEuB,EAAmB,UAAY,CAAEtC,KAAM,eAAgBqC,SAAUrB,GACjEsB,EAAmB,UAAY,CAAEtC,KAAM,UAAWqC,SAAUtB,GAC5DuB,EAAmB,UAAY,CAAEtC,KAAM,WAAYqC,SAAUrB,IAE3D,eAAiBY,IACnBU,EAAmB,UAAY,CAAEtC,KAAM,gBAErC,eAAiB4B,IACnBU,EAAmB,UAAY,CAAEtC,KAAM,gBAErC,QAAUuB,IAEZe,EAAmB,UAAY,CAAEtC,KAAM,YAEvCsC,EAAmB,UAAY,CAAEtC,KAAM,aACvCsC,EAAmB,UAAY,CAAEtC,KAAM,cACvCsC,EAAmB,UAAY,CAAEtC,KAAM,WACvCsC,EAAmB,UAAY,CAAEtC,KAAM,aAEvCsC,EAAmB,UAAY,CAAEtC,KAAM,QACvCsC,EAAmB,UAAY,CAAEtC,KAAM,OACvCsC,EAAmB,UAAY,CAAEtC,KAAM,UACvCsC,EAAmB,UAAY,CAAEtC,KAAM,aAazC,IAAIuC,EAAgB,GACpBA,EAAcxB,GAAQ,CACpB,GAAM,CAAEf,KAAM,YAAaqC,SAAUtB,GACrC,GAAM,CAAEf,KAAM,cAAeqC,SAAUtB,GACvC,GAAM,CAAEf,KAAM,UAAWqC,SAAUtB,IAErCwB,EAAcvB,GAAS,CACrB,GAAM,CAAEhB,KAAM,aAAcqC,SAAUrB,GACtC,GAAM,CAAEhB,KAAM,eAAgBqC,SAAUrB,GACxC,GAAM,CAAEhB,KAAM,WAAYqC,SAAUrB,IAEtCuB,EAActB,GAAU,CACtB,GAAM,CAAEjB,KAAM,cAAeqC,SAAUpB,IAGzCY,EAAQU,EAActB,GAAS,MAAO,CACpC,IAAM,CAAEjB,KAAM,iBAAkBqC,SAAUpB,GAC1C,IAAM,CAAEjB,KAAM,YAAaqC,SAAUpB,KAEvCY,EAAQU,EAAcxB,GAAO,UAAW,CACtC,IAAM,CAAEf,KAAM,SAAUqC,SAAUtB,KAEpCc,EAAQU,EAAcvB,GAAQ,UAAW,CACvC,IAAM,CAAEhB,KAAM,UAAWqC,SAAUrB,KAErCa,EAAQU,EAAcvB,GAAQ,UAAW,CACvC,GAAM,CAAEhB,KAAM,UAAWqC,SAAUrB,KAIrCa,EAAQU,EAAcvB,GAAQ,MAAO,CACnC,GAAM,CAAEhB,KAAM,UAAWqC,SAAUrB,KAGrCa,EAAQU,EAActB,GAAS,aAAc,CAC3C,GAAM,CAAEjB,KAAM,UAAWqC,SAAUpB,KAGrCY,EAAQU,EAActB,GAAS,aAAc,CAC3C,GAAM,CAAEjB,KAAM,UAAWqC,SAAUpB,GACnC,IAAM,CAAEjB,KAAM,YAAaqC,SAAUpB,GACrC,IAAM,CAAEjB,KAAM,iBAAkBqC,SAAUpB,GAC1C,IAAM,CAAEjB,KAAM,gBAAiBqC,SAAUpB,GACzC,IAAM,CAAEjB,KAAM,eAAgBqC,SAAUpB,KAgB1C,IAAIuB,EAAiB,CAEnBC,UAAW,CAAEC,IAAK,SAClBC,WAAY,CAAED,IAAK,SACnBE,YAAa,CAAEF,IAAK,WACpBG,aAAc,CAAEH,IAAK,WACrBI,QAAS,CAAEJ,IAAK,OAChBK,SAAU,CAAEL,IAAK,OACjBM,OAAQ,CAAEN,IAAK,MACfO,QAAS,CAAEP,IAAK,MAGhBQ,YAAa,CAAER,IAAK,SACpBS,MAAO,CAAET,IAAK,KAGdU,OAAQ,CAAEV,IAAK,IAAKW,SAAU,KAC9BC,OAAQ,CAAEZ,IAAK,IAAKW,SAAU,KAC9BE,OAAQ,CAAEb,IAAK,IAAKW,SAAU,KAC9BG,OAAQ,CAAEd,IAAK,IAAKW,SAAU,KAC9BI,OAAQ,CAAEf,IAAK,IAAKW,SAAU,KAC9BK,OAAQ,CAAEhB,IAAK,IAAKW,SAAU,KAC9BM,OAAQ,CAAEjB,IAAK,IAAKW,SAAU,KAC9BO,OAAQ,CAAElB,IAAK,IAAKW,SAAU,KAC9BQ,OAAQ,CAAEnB,IAAK,IAAKW,SAAU,KAC9BS,OAAQ,CAAEpB,IAAK,IAAKW,SAAU,KAC9BjE,KAAM,CAAEsD,IAAK,IAAKW,SAAU,KAC5BU,KAAM,CAAErB,IAAK,IAAKW,SAAU,KAC5BW,KAAM,CAAEtB,IAAK,IAAKW,SAAU,KAC5B7D,KAAM,CAAEkD,IAAK,IAAKW,SAAU,KAC5BY,KAAM,CAAEvB,IAAK,IAAKW,SAAU,KAC5Ba,KAAM,CAAExB,IAAK,IAAKW,SAAU,KAC5Bc,KAAM,CAAEzB,IAAK,IAAKW,SAAU,KAC5Be,KAAM,CAAE1B,IAAK,IAAKW,SAAU,KAC5BgB,KAAM,CAAE3B,IAAK,IAAKW,SAAU,KAC5BiB,KAAM,CAAE5B,IAAK,IAAKW,SAAU,KAC5BkB,KAAM,CAAE7B,IAAK,IAAKW,SAAU,KAC5BmB,KAAM,CAAE9B,IAAK,IAAKW,SAAU,KAC5BoB,KAAM,CAAE/B,IAAK,IAAKW,SAAU,KAC5BqB,KAAM,CAAEhC,IAAK,IAAKW,SAAU,KAC5BsB,KAAM,CAAEjC,IAAK,IAAKW,SAAU,KAC5BuB,KAAM,CAAElC,IAAK,IAAKW,SAAU,KAC5BwB,KAAM,CAAEnC,IAAK,IAAKW,SAAU,KAC5ByB,KAAM,CAAEpC,IAAK,IAAKW,SAAU,KAC5B/D,KAAM,CAAEoD,IAAK,IAAKW,SAAU,KAC5B0B,KAAM,CAAErC,IAAK,IAAKW,SAAU,KAC5B2B,KAAM,CAAEtC,IAAK,IAAKW,SAAU,KAC5B4B,KAAM,CAAEvC,IAAK,IAAKW,SAAU,KAC5BnE,KAAM,CAAEwD,IAAK,IAAKW,SAAU,KAC5B6B,KAAM,CAAExC,IAAK,IAAKW,SAAU,KAC5B8B,KAAM,CAAEzC,IAAK,IAAKW,SAAU,KAC5B+B,KAAM,CAAE1C,IAAK,IAAKW,SAAU,KAC5BgC,QAAS,CAAE3C,IAAK,KAChB4C,QAAS,CAAE5C,IAAK,KAChB6C,QAAS,CAAE7C,IAAK,KAChB8C,QAAS,CAAE9C,IAAK,KAChB+C,QAAS,CAAE/C,IAAK,KAChBgD,QAAS,CAAEhD,IAAK,KAChBiD,QAAS,CAAEjD,IAAK,KAChBkD,QAAS,CAAElD,IAAK,KAChBmD,QAAS,CAAEnD,IAAK,KAChBoD,QAAS,CAAEpD,IAAK,KAChBqD,eAAgB,CAAErD,IAAK,KACvBsD,UAAW,CAAEtD,IAAK,KAClBuD,YAAa,CAAEvD,IAAK,KACpBwD,eAAgB,CAAExD,IAAK,KACvByD,cAAe,CAAEzD,IAAK,KACtB0D,aAAc,CAAE1D,IAAK,KACrB2D,UAAW,CAAE3D,IAAK,IAAKW,SAAU,KACjCiD,MAAO,CAAE5D,IAAK,IAAKW,SAAU,KAC7BkD,MAAO,CAAE7D,IAAK,IAAKW,SAAU,KAC7BmD,MAAO,CAAE9D,IAAK,IAAKW,SAAU,KAC7BoD,OAAQ,CAAE/D,IAAK,IAAKW,SAAU,KAC9BqD,MAAO,CAAEhE,IAAK,IAAKW,SAAU,KAC7BsD,UAAW,CAAEjE,IAAK,IAAKW,SAAU,KACjCuD,YAAa,CAAElE,IAAK,IAAKW,SAAU,KACnCwD,UAAW,CAAEnE,IAAK,KAAMW,SAAU,KAClCyD,aAAc,CAAEpE,IAAK,IAAKW,SAAU,KACpC0D,MAAO,CAAErE,IAAK,IAAMW,SAAU,KAC9B2D,cAAe,CAAEtE,IAAK,KAAMW,SAAU,MAGxCxB,EAAQW,EAAgB,MAAO,CAC7BQ,OAAQ,CAAEN,IAAK,QACfO,QAAS,CAAEP,IAAK,UAKlB,IAhhBeuE,EAAGvE,EACZwE,EA+gBFC,EAAc,CAChBC,IAAK,SACLC,WAAY,aACZC,KAAM,YACNC,GAAI,UACJC,MAAO,aACPC,KAAM,YACNC,IAAK,SACLC,KAAM,cACNC,eAAgB,iBAChBC,mBAAoB,qBACpBC,YAAa,cACbC,UAAW,UACXC,UAAW,UACXC,gBAAiB,SACjBC,MAAO,QACPC,MAAO,QACPC,KAAM,cAUJC,GA3iBWpB,EA2iBO9E,EA3iBJO,EA2iBwB,OA1iBpCwE,EAAI,GACRjL,OAAOC,KAAK+K,GAAGhF,SAAQ,SAASqG,GAC9B,IAAIC,EAAOtB,EAAEqB,GACT5F,KAAO6F,IACTrB,EAAEqB,EAAK7F,IAAQ6F,MAGZrB,GAqiBT,IACE,IAAIsB,EAAiBhI,GAAwB,aAAc,IAAIlC,cAAc,IAC7E,MAAOmK,IAET,SAASC,EAAgBvM,GACvB,IAAI+F,EAAU,YAAa/F,EAAQA,EAAM+F,QAAU,UAAW/F,EAAQA,EAAMwM,MAAQ,EAEhFC,EAAW,WACb,GAAIJ,GAAkB,gBAAiBrM,EAAO,CAC5C,IAAIkG,EAAWmG,EAAiBrM,EAAMkG,SAAWlG,EAAM0M,YACvD,GAAIxG,GAAYH,KAAWK,EAAcF,GACvC,OAAOE,EAAcF,GAAUH,GAGnC,MAAI,kBAAmB/F,GAASA,EAAM2M,iBAAiBxG,EAC9CA,EAAmBnG,EAAM2M,eAE9B5G,KAAWC,EACNA,EAAmBD,GAErB,KAbK,GA8Bd,IAAK0G,EACH,OAAO,KAET,IACMG,EADFrG,GACEqG,EAAQvG,EAAeoG,EAAQ5I,OAE3B7D,EAAMkH,UAAY,aAAc0F,EAASA,EAAM1F,SAAW0F,EAAMrG,IADrDkG,EAAQ5I,KAI7B,MAAO,CACLA,KAAM4I,EAAQ5I,KACd0C,IAAKA,EACLL,SAAUuG,EAAQvG,SAClBD,OAAQwG,EAAQxG,QAYhB,kBAAmB7B,GAAU,mBAAoBtE,QAClD,WACC,SAAS+M,EAAO/B,EAAGgC,EAAGC,GAChBD,KAAKhC,GACThL,OAAOkN,eAAelC,EAAGgC,EAAGC,GAS9B,GANAF,EAAO1K,cAAc8K,UAAW,OAAQ,CAAEC,IAAK,WAC7C,IAAIT,EAAUF,EAAgBvS,MAC9B,OAAOyS,EAAUA,EAAQ5I,KAAO,MAI9B,QAAS1B,cAAc8K,UAAW,CACpC,IAAIE,EAAOrN,OAAOsN,yBAAyBjL,cAAc8K,UAAW,OACpEnN,OAAOkN,eAAe7K,cAAc8K,UAAW,MAAO,CAAEC,IAAK,WAC3D,IAAI3G,EAAM4G,EAAKD,IAAIG,KAAKrT,MACxB,OAAOgR,EAAYlH,eAAeyC,GAAOyE,EAAYzE,GAAOA,KAIhEsG,EAAO1K,cAAc8K,UAAW,MAAO,CAAEC,IAAK,WAC5C,IAAIT,EAAUF,EAAgBvS,MAC9B,OAAQyS,GAAW,QAASA,EAAWA,EAAQlG,IAAM,kBAGvDsG,EAAO1K,cAAc8K,UAAW,WAAY,CAAEC,IAAK,WACjD,IAAIT,EAAUF,EAAgBvS,MAC9B,OAAQyS,GAAW,aAAcA,EAAWA,EAAQvG,SAAWvB,KAGjEkI,EAAO1K,cAAc8K,UAAW,SAAU,CAAEC,IAAK,WAC/C,MAAO,MA/BX,GAoCI,gBAAiB9I,EAAOjC,gBAC5BiC,EAAOjC,cAAcmL,YA9CvB,SAAqBzJ,EAAM0J,GAEzB,GADA1J,EAAOqB,OAAOrB,IACTqI,EAAUpI,eAAeD,GAAO,MAAO,YAC5C,GAAI0J,GAA2C,UAAjCrI,OAAOqI,GAAQC,cAA2B,MAAM3M,MAAM,sBACpE,IAAI4L,EAAUP,EAAUrI,GACxB,OAAO4I,EAAQxG,QAAUwG,EAAQ5I,MAAQ,cA4C3CO,EAAOqJ,YAAc,SAASzN,GAC5B,KAAI,SAAUA,GAAd,CAGA,IAAIyM,EAAUF,EAAgBvM,GAC9BA,EAAM6D,KAAO4I,EAAUA,EAAQ5I,KAAO,GACtC7D,EAAMuG,IAAOkG,GAAW,QAASA,EAAWA,EAAQlG,IAAM,eAC1DvG,EAAMkG,SAAY,aAAclG,EAASA,EAAMkG,SAC5C,gBAAiBlG,EAASA,EAAM0M,YAChCD,GAAW,aAAcA,EAAWA,EAAQvG,SAAWvB,EAC1D3E,EAAMuN,OAAS,KAjtBnB,CAotBG3Q,S,cCvtBHvD,EAAOC,QAAUC,OAAOC,kBAAkB,iBAAkB,CAC1DC,OAAQ,CACNC,QAAS,CAAEC,SAAS,GACpB+T,eAAgB,CAAE/T,SAAS,IAG7BI,KAAM,WACJC,KAAK6E,UAAY,IAAIxE,MAAMC,QAC3BN,KAAK2T,cACL3T,KAAK4T,UAAY,GAGnBnT,KAAM,WACJT,KAAK6T,qBAGPnT,MAAO,WACLV,KAAKwJ,uBACLxJ,KAAK6E,UAAUvD,IAAI,EAAG,EAAG,IAG3B6C,OAAQ,WACNnE,KAAKU,SAGPmT,kBAAmB,WACjB,MAAMtR,EAAUvC,KAAKY,GAAG2B,QAClBuR,EAAWvR,EAAQwR,OAEpBD,GAKLA,EAASrK,iBAAiB,aAAczJ,KAAKgU,cAC7CF,EAASrK,iBAAiB,WAAYzJ,KAAKiU,aALzC1R,EAAQkH,iBAAiB,uBAAwBzJ,KAAK6T,kBAAkBrL,KAAKxI,QAQjFwJ,qBAAsB,WACpB,MAAMsK,EAAW9T,KAAKY,GAAG2B,SAAWvC,KAAKY,GAAG2B,QAAQwR,OAC/CD,IAELA,EAASpK,oBAAoB,aAAc1J,KAAKgU,cAChDF,EAASpK,oBAAoB,WAAY1J,KAAKiU,cAGhD7S,iBAAkB,WAChB,OAAOpB,KAAKgB,KAAKtB,WAAaM,KAAK4T,WAGrChP,iBAAkB,WAEhB,OADA5E,KAAK6E,UAAUC,EAAI9E,KAAK4T,UACjB5T,KAAK6E,UAAU0E,SAGxBoK,YAAa,WACX3T,KAAKgU,aAAehU,KAAKgU,aAAaxL,KAAKxI,MAC3CA,KAAKiU,WAAajU,KAAKiU,WAAWzL,KAAKxI,OAGzCgU,aAAc,SAAUE,GACtBlU,KAAK4T,WAAa,EACd5T,KAAKgB,KAAK0S,gBAAuC,IAArBQ,EAAEC,QAAQvO,SACxC5F,KAAK4T,UAAY,GAEnBM,EAAEE,kBAGJH,WAAY,SAAUC,GACpBlU,KAAK4T,UAAY,EACjBM,EAAEE,qB,cC/DN/U,EAAOC,QAAUC,OAAOC,kBAAkB,oBAAqB,CAM7D6U,aAAc,CAAC,YAEf5U,OAAQ,CACNC,QAAoB,CAAEC,SAAS,GAC/B2U,SAAoB,CAAE3U,QAAS,CAAC,UAAW,WAAY,WAAY,UACnE4U,MAAoB,CAAE5U,QAAS,GAAK6F,IAAK,GACzCgP,IAAoB,CAAE7U,SAAS,GAC/B8U,mBAAoB,CAAE9U,SAAS,GAC/ByC,OAAoB,CAAEzC,QAAS,+BAAgC0C,KAAM,aAOvEtC,KAAM,WACJ,MAAMa,EAAKZ,KAAKY,GAEhBZ,KAAK0U,aAAe,KAEpB1U,KAAK2U,SAAW,IAAItU,MAAMC,QAC1BN,KAAK4U,QAAU,IAAIvU,MAAMwU,WAGzB7U,KAAK8U,SAAW,KAChB9U,KAAK+U,QAAU,KAEXnU,EAAG2B,QAAQyS,UACbhV,KAAKiV,iBAELrU,EAAG2B,QAAQkH,iBAAiB,SAAUzJ,KAAKiV,eAAezM,KAAKxI,QAInE6D,OAAQ,SAAUqR,GAChB,MAAMtU,EAAKZ,KAAKY,GACVI,EAAOhB,KAAKgB,KACZmU,EAAMvU,EAAG2B,QAAQE,QAAQ0S,IAC3BvU,EAAG2B,QAAQyS,WACbhV,KAAKiV,iBAEHE,GAAOnU,EAAKyT,qBAAuBS,EAAST,qBAC9CzT,EAAKyT,mBACDU,EAAIC,SAASpV,MACbmV,EAAIE,YAAYrV,QAIxBiV,eAAgB,WACd,MAAMjU,EAAOhB,KAAKgB,KAClB,IAAIsU,EAEJ,IAAK,IAAI3P,EAAI,EAAGA,EAAI3E,EAAKsT,SAAS1O,OAAQD,IACxC2P,EAAOtU,EAAKsT,SAAS3O,GA/DF,YAgEd3F,KAAKY,GAAGM,WAAWoU,IACtBtV,KAAKY,GAAGK,aAAaqU,EAAM,KAKjCnU,kBAAmB,WACjBnB,KAAK8U,SAAW,KAChB9U,KAAK+U,QAAU,MAOjBjR,KAAO,WACL,MAAMyR,EAAQ,IAAIlV,MAAMC,QAClBkV,EAAM,IAAInV,MAAMC,QAChBmV,EAAa,IAAIpV,MAAMC,QAE7B,OAAO,SAAUyD,EAAGC,GAClB,IAAKA,EAAI,OAET,MAAMpD,EAAKZ,KAAKY,GACVI,EAAOhB,KAAKgB,KAElB,IAAKA,EAAKtB,QAAS,OAEnBM,KAAK0V,qBACL,MAAMhB,EAAe1U,KAAK0U,aACpBC,EAAW3U,KAAK2U,SAEtB,GAAKD,EASL,GANI1Q,EAAK,IAlGC,GAmGR2Q,EAASrT,IAAI,EAAG,EAAG,GAEnBtB,KAAK2V,eAAe3R,GAGlBhD,EAAKyT,qBACoC,IAAtCC,EAAavU,qBAAgC,CAElD,GAAIwU,EAASiB,WA1GX,KA0G6B,OAE/BL,EAAM/T,KAAKZ,EAAGc,SAASnB,UACvBiV,EACGhU,KAAKmT,GACLtP,eAAerB,EAAK,KACpBpC,IAAI2T,GAEP,MAAMJ,EAAMvU,EAAG2B,QAAQE,QAAQ0S,IAC/BnV,KAAK8U,SAA6B,OAAlB9U,KAAK8U,SAAoBK,EAAIU,SAASN,GAASvV,KAAK8U,SACpE9U,KAAK+U,QAAU/U,KAAK+U,SAAWI,EAAIW,QAAQP,EAAOvV,KAAK8U,UACvD9U,KAAK+U,QAAUI,EAAIY,UAAUR,EAAOC,EAAKxV,KAAK8U,SAAU9U,KAAK+U,QAASU,GACtE7U,EAAGc,SAASnB,SAASiB,KAAKiU,QACjB7U,EAAGoV,aAAa,YACzBpV,EAAGK,aAAa,WAAY0T,IAE5B/T,EAAGc,SAASnB,SAAS4C,GAAKwR,EAASxR,EAAIa,EAAK,IAC5CpD,EAAGc,SAASnB,SAASgD,GAAKoR,EAASpR,EAAIS,EAAK,IAC5CpD,EAAGc,SAASnB,SAASuE,GAAK6P,EAAS7P,EAAId,EAAK,MA/C5C,GAyDN0R,mBAAoB,WAClB,MAAM1U,EAAOhB,KAAKgB,KAClB,GAAIA,EAAKtB,QAAS,CAChB,IAAK,IAAIiG,EAAI,EAAGsQ,EAAIjV,EAAKsT,SAAS1O,OAAQD,EAAIsQ,EAAGtQ,IAAK,CACpD,MAAMuQ,EAAUlW,KAAKY,GAAGM,WAAWF,EAAKsT,SAAS3O,GA5IhC,aA6IjB,GAAIuQ,GAAWA,EAAQ9U,mBAErB,YADApB,KAAK0U,aAAewB,GAIxBlW,KAAK0U,aAAe,OAIxBiB,eAAiB,WACf,MAAMQ,EAAU,IAAI9V,MAAMoD,QACpB2S,EAAa,IAAI/V,MAAMwU,WAE7B,OAAO,SAAU7Q,GACf,IAAIa,EACJ,MAAMjE,EAAKZ,KAAKY,GACVsV,EAAUlW,KAAK0U,aACfC,EAAW3U,KAAK2U,SAChB3T,EAAOhB,KAAKgB,KAElB,GAAIkV,EAAS,CACX,IAAIA,EAAQtR,iBAEL,IAAIsR,EAAQ7U,YAEjB,YADAsT,EAASnT,KAAK0U,EAAQ7U,eAEjB,GAAI6U,EAAQG,iBAEjB,YADA1B,EAASnT,KAAK0U,EAAQG,iBAAiBrS,GAAIqB,eAAe,IAAOrB,IAGjE,MAAM,IAAI6C,MAAM,mCAAoCqP,GARpDrR,EAAYqR,EAAQtR,iBAAiBZ,GAgBzC,GAJIpD,EAAGoV,aAAa,cAAgBhV,EAAKyT,oBACvCE,EAASnT,KAAKxB,KAAKY,GAAGa,aAAa,aAGjCoD,GAAa7D,EAAKtB,QAAS,CAC7B,MAAM4W,EAAWtV,EAAKoB,OAGtBgU,EAAW5U,KAAK8U,EAAS5U,SAAS0U,YAClCA,EAAWG,YAAY3V,EAAGc,SAAS0U,YACnCvR,EAAU2R,gBAAgBJ,GAE1B,MAAMK,EAAS5R,EAAUe,SACrB5E,EAAKwT,KACPG,EAASnT,KAAKqD,GACd8P,EAAStP,eAAiC,SAAlBrF,KAAKgB,KAAKuT,SAElC4B,EAAQ7U,IAAIuD,EAAU1B,EAAG0B,EAAUC,GACnCqR,EAAQ5U,UAAUkV,EAASzW,KAAKgB,KAAKuT,MAAQ,UAC7CI,EAASxR,EAAIgT,EAAQhT,EACrBwR,EAAS7P,EAAIqR,EAAQ5S,KA7Cb,M,cCzJlBlE,EAAOC,QAAUC,OAAOC,kBAAkB,oBAAqB,CAC7DC,OAAQ,CACNC,QAAS,CAAEC,SAAS,GACpB+W,WAAY,CAAE/W,SAAS,GACvBgX,WAAY,CAAEhX,SAAS,GACvBiX,WAAY,CAAEjX,SAAS,GACvBkX,WAAY,CAAElX,SAAS,GACvBC,KAAM,CAAED,QAAS,QAASE,MAAO,CAAC,QAAS,QAAS,WAItDE,KAAM,WACJC,KAAK6E,UAAY,IAAIxE,MAAMC,QAC3BN,KAAK8W,KAAY,EACjB9W,KAAK+W,KAAY,EACjB/W,KAAK2T,eAGPlT,KAAM,WACJT,KAAK6T,qBAGPnT,MAAO,WACLV,KAAKwJ,uBACLxJ,KAAK6E,UAAUvD,IAAI,EAAG,EAAG,IAG3B6C,OAAQ,WACNnE,KAAKU,SAGPmT,kBAAmB,WACjB,MAAM7S,EAAOhB,KAAKgB,KACZuB,EAAUvC,KAAKY,GAAG2B,QAIxB,OAFAA,EAAQkH,iBAAiB,WAAYzJ,KAAKgX,YAElChW,EAAKpB,MACX,IAAK,QACL,IAAK,QACH2C,EAAQkH,iBAAiB,qBAAsBzJ,KAAKgU,cACpDzR,EAAQkH,iBAAiB,mBAAoBzJ,KAAKiU,YAClD,MAEF,IAAK,QACH1R,EAAQkH,iBAAiB,eAAgBzJ,KAAKgU,cAC9CzR,EAAQkH,iBAAiB,aAAczJ,KAAKiU,cAMlDzK,qBAAsB,WACpB,MAAMjH,EAAUvC,KAAKY,GAAG2B,QAExBA,EAAQmH,oBAAoB,WAAY1J,KAAKgX,YAC7CzU,EAAQmH,oBAAoB,qBAAsB1J,KAAKgU,cACvDzR,EAAQmH,oBAAoB,mBAAoB1J,KAAKiU,YACrD1R,EAAQmH,oBAAoB,eAAgB1J,KAAKgU,cACjDzR,EAAQmH,oBAAoB,aAAc1J,KAAKiU,aAGjD7S,iBAAkB,WAChB,OAAOpB,KAAKgB,KAAKtB,SAAWM,KAAKiX,UAGnCrS,iBAAkB,WAGhB,OAFA5E,KAAK6E,UAAUC,EAAI9E,KAAKiX,UAAYjX,KAAK8W,KAAO,EAChD9W,KAAK6E,UAAU1B,EAAInD,KAAKiX,SAAWjX,KAAK+W,KAAO,EACxC/W,KAAK6E,UAAU0E,SAGxBoK,YAAa,WACX3T,KAAKgU,aAAehU,KAAKgU,aAAaxL,KAAKxI,MAC3CA,KAAKiU,WAAajU,KAAKiU,WAAWzL,KAAKxI,MACvCA,KAAKgX,WAAahX,KAAKgX,WAAWxO,KAAKxI,OAGzCgU,aAAc,SAAUE,GACtB,OAAOlU,KAAKgB,KAAKpB,MACf,IAAK,QACHI,KAAKkX,eAAgB,EACrBlX,KAAKmX,iBAAmB,GACxB,MACF,IAAK,QAGL,IAAK,QACHnX,KAAKiX,UAAW,EAIpB/C,EAAEE,kBAGJH,WAAY,SAAUC,GACC,SAAlBlU,KAAKgB,KAAKpB,OACTI,KAAKmX,iBAAmB,IAG5BnX,KAAKiX,UAAW,EAChB/C,EAAEE,kBAGJ4C,WAAY,SAAS9C,GACnB,OAAQlU,KAAKgB,KAAKpB,MAChB,IAAK,QACH,OAAOI,KAAKoX,gBAAgBlD,GAC9B,IAAK,QACL,IAAK,QACH,OAAOlU,KAAKqX,gBAAgBnD,KAIlCkD,gBAAiB,SAASlD,GACxB,MAAMlT,EAAOhB,KAAKgB,KACZsW,EAAWpD,EAAEqD,OAAOC,KAQ1B,GANoC,IAAjCxX,KAAKmX,iBAAiBvR,QAAgB5F,KAAKkX,gBAC5ClX,KAAKkX,eAAgB,EACrBlX,KAAKmX,iBAAiB,GAAKG,EAAS,GACpCtX,KAAKmX,iBAAiB,GAAKG,EAAS,IAGnCtX,KAAKmX,iBAAiBvR,OAAS,EAAE,CAClC,IAAI6R,EAAO,EACPC,EAAO,EAEP1W,EAAK0V,YAAcY,EAAS,GAAKtX,KAAKmX,iBAAiB,KACzDM,GAAQ,GAGNzW,EAAK2V,YAAcW,EAAS,GAAKtX,KAAKmX,iBAAiB,KACzDM,EAAO,GAGLzW,EAAK6V,YAAcS,EAAS,GAAKtX,KAAKmX,iBAAiB,KACzDO,GAAQ,GAGN1W,EAAK4V,YAAcU,EAAS,GAAKtX,KAAKmX,iBAAiB,KACzDO,EAAO,GAGT,MAAMC,EAAcvU,KAAKuB,IAAI3E,KAAKmX,iBAAiB,GAAKG,EAAS,IAC7ClU,KAAKuB,IAAI3E,KAAKmX,iBAAiB,GAAKG,EAAS,IAEhDK,GACf3X,KAAK8W,KAAO,EACZ9W,KAAK+W,KAAOU,EACZzX,KAAKiX,UAAW,IAEhBjX,KAAK+W,KAAO,EACZ/W,KAAK8W,KAAOY,EACZ1X,KAAKiX,UAAW,KAMtBI,gBAAiB,SAASnD,GACxB,MAAMlT,EAAOhB,KAAKgB,KACZsW,EAAWpD,EAAEqD,OAAOC,KAE1B,IAAIC,EAAO,EACPC,EAAO,EAEP1W,EAAK0V,YAAcY,EAAS,GAAK,IACnCG,GAAQ,GAGNzW,EAAK2V,YAAcW,EAAS,GAAK,IACnCG,EAAO,GAGLzW,EAAK6V,YAAcS,EAAS,GAAK,IACnCI,GAAQ,GAGN1W,EAAK4V,YAAcU,EAAS,GAAK,IACnCI,EAAO,GAGLtU,KAAKuB,IAAI2S,EAAS,IAAMlU,KAAKuB,IAAI2S,EAAS,KAC5CtX,KAAK8W,KAAO,EACZ9W,KAAK+W,KAAOU,IAEZzX,KAAK+W,KAAO,EACZ/W,KAAK8W,KAAOY,O,gBC/LlB,EAAQ,IACR,EAAQ,IACR,EAAQ,IACR,EAAQ,IACR,EAAQ,K,cCJR,MAAME,EAAW,CACfC,KAAMxX,MAAMyX,SACZC,OAAQ1X,MAAM2X,WACdC,SAAU5X,MAAM6X,cA4IlB,SAASC,EAAcnN,GACrB,OAAOA,EAAEoN,QAAQ,sBAAuB,QAnI1C/Y,EAAOC,QAAUC,OAAOC,kBAAkB,kBAAmB,CAC3DC,OAAQ,CACN4Y,KAAO,CAAC1Y,QAAS,KACjB2Y,SAAU,CAAC3Y,QAAS,GACpB4Y,kBAAmB,CAAC5Y,SAAS,EAAO0C,KAAM,WAC1CmW,kBAAmB,CAAC7Y,QAAS,GAC7B8Y,KAAM,CAAC9Y,QAAS,SAAUE,MAAOiG,OAAOC,KAAK6R,IAC7Cc,YAAa,CAAC/Y,QAASgZ,IAAUnT,IAAK,GACtCoT,UAAW,CAACjZ,QAAS,IAGvBI,KAAM,WAEJC,KAAK6Y,MAAQ,KAEb7Y,KAAK8Y,MAAQ,KAEb9Y,KAAK+Y,cAAgB,GAErB,MAAMF,EAAQ7Y,KAAKY,GAAGoY,YAAY,QAE9BH,EACF7Y,KAAKiZ,KAAKJ,GAEV7Y,KAAKY,GAAG6I,iBAAiB,eAAiByK,IACxClU,KAAKiZ,KAAK/E,EAAEqD,OAAOsB,UAKzBI,KAAM,SAAUJ,GACd,MAAMjY,EAAKZ,KAAKY,GAChBZ,KAAK6Y,MAAQA,EACb7Y,KAAK8Y,MAAQ,IAAIzY,MAAM6Y,eAAeL,GACtC7Y,KAAK8Y,MAAMrP,iBAAiB,OAASyK,IACnCtT,EAAGC,KAAK,iBAAkB,CAACsY,OAAQjF,EAAEiF,OAAQC,UAAWlF,EAAEkF,cAE5DpZ,KAAK8Y,MAAMrP,iBAAiB,WAAayK,IACvCtT,EAAGC,KAAK,qBAAsB,CAACsY,OAAQjF,EAAEiF,OAAQvF,UAAWM,EAAEN,cAE5D5T,KAAKgB,KAAKqX,MAAMrY,KAAK6D,OAAO,KAGlCM,OAAQ,WACFnE,KAAK8Y,OAAO9Y,KAAK8Y,MAAMO,iBAG7BxV,OAAQ,SAAUqR,GAChB,IAAKA,EAAU,OAEf,MAAMlU,EAAOhB,KAAKgB,KACZsY,EAAU/Z,OAAOoK,MAAM4P,KAAKvY,EAAMkU,GAGxC,GAAI,SAAUoE,EAGZ,OAFAtZ,KAAKwZ,kBACDxY,EAAKqX,MAAMrY,KAAKyZ,cAKtBzZ,KAAK+Y,cAAcjN,QAASqN,IACtB,aAAcG,GAAWtY,EAAKsX,UAChCa,EAAOO,YAAY1Y,EAAKsX,UAEtB,sBAAuBgB,IACzBH,EAAOZ,kBAAoBvX,EAAKuX,oBAE9B,SAAUe,GAAW,gBAAiBA,IACxCH,EAAOQ,QAAQ/B,EAAS5W,EAAKyX,MAAOzX,EAAK0X,aAEvC,cAAeY,GACjBH,EAAOS,sBAAsB5Y,EAAK4X,cAKxCY,WAAY,WACV,MAAMxY,EAAOhB,KAAKgB,KAClB,IAAK,IAAI2E,EAAI,EAAGA,EAAI3F,KAAK+Y,cAAcnT,OAAQD,IAC7C3E,EAAKwX,kBACDxY,KAAK+Y,cAAcpT,GAAGkU,QAAQ7Y,EAAKwX,mBACnCxY,KAAK+Y,cAAcpT,GAAGmU,OAE5B9Z,KAAK+Y,cAAcnT,OAAS,GAG9B6T,WAAY,WACV,IAAKzZ,KAAK8Y,MAAO,OAEjB,MAAMD,EAAQ7Y,KAAK6Y,MACf7X,EAAOhB,KAAKgB,KACZ+Y,EAAQlB,EAAMmB,aAAenB,EAAMoB,UAAY,IAAID,YAAc,GAErE,IAAKD,EAAMnU,OAAQ,OAEnB,MAAMsU,GA2BiBlP,EA3BKhK,EAAKqX,KA4B5B,IAAI8B,OAAO,IAAMnP,EAAEoP,MAAM,OAAOC,IAAIlC,GAAcmC,KAAK,MAAQ,MADxE,IAA2BtP,EAzBvB,IAAK,IAAIqN,EAAM1S,EAAI,EAAI0S,EAAO0B,EAAMpU,GAAKA,IACvC,GAAI0S,EAAK/C,KAAKiF,MAAML,GAAK,CACvB,MAAMf,EAASnZ,KAAK8Y,MAAM0B,WAAWnC,EAAMQ,GAC3CM,EAAOzZ,SAAU,EACjByZ,EAAOZ,kBAAoBvX,EAAKuX,kBAC5BvX,EAAKsX,UAAUa,EAAOO,YAAY1Y,EAAKsX,UACpB,IAAnBtX,EAAK4X,WAAiBO,EAAOS,sBAAsB5Y,EAAK4X,WAC5DO,EACGQ,QAAQ/B,EAAS5W,EAAKyX,MAAOzX,EAAK0X,aAClC+B,OAAOzZ,EAAKwX,mBACZ/X,OACHT,KAAK+Y,cAAc2B,KAAKvB,KAK9BrV,KAAM,SAAUC,EAAGC,GACbhE,KAAK8Y,QAAU6B,MAAM3W,IAAKhE,KAAK8Y,MAAMjV,OAAOG,EAAK,S,gBChIzD3D,MAAMua,cAAgB,EAAQ,IAO9Bvb,EAAOC,QAAQub,UAAYtb,OAAOC,kBAAkB,uBAAwB,CAC1EC,OAAQ,CAAC4C,KAAM,SAEftC,KAAM,WACJC,KAAK6Y,MAAQ,KACb7Y,KAAK8a,OAAS,IAAIza,MAAMua,eAG1B/W,OAAQ,WACN,IAAIkX,EAAO/a,KACPY,EAAKZ,KAAKY,GACVoa,EAAMhb,KAAKgB,KACXia,EAAiBjb,KAAKY,GAAG2B,QAAQE,QAAQyY,SAExCF,IAELhb,KAAKmE,SAELnE,KAAK8a,OAAO7B,KAAK+B,GAAK,SAAUG,GAC9BJ,EAAKlC,MAAQsC,EAAaC,MAC1BL,EAAKlC,MAAMwC,UAAS,SAAUC,GAC5B,GAAIA,EAAOC,OAAQ,CACjB,IAAIC,EAAWF,EAAOE,SAClBA,EAASC,OAAOR,EAAeS,qBAAqBF,EAASC,OAC7DD,EAASnB,KAAKY,EAAeS,qBAAqBF,EAASnB,KAC3DmB,EAASG,UAAUV,EAAeS,qBAAqBF,EAASG,UAChEH,EAASI,aAAaX,EAAeS,qBAAqBF,EAASI,iBAG3Ehb,EAAGib,YAAY,OAAQd,EAAKlC,OAC5BjY,EAAGC,KAAK,eAAgB,CAACib,OAAQ,UAAWjD,MAAOkC,EAAKlC,aAI5D1U,OAAQ,WACDnE,KAAK6Y,OACV7Y,KAAKY,GAAGmb,eAAe,Y,cCtC3B1c,EAAOC,QAAUe,MAAMua,cAAgB,SAAWoB,GAEhDhc,KAAKgc,aAAwBC,IAAZD,EAA0BA,EAAU3b,MAAM6b,uBAI7D7b,MAAMua,cAAc3H,UAAY,CAE9BkJ,YAAa9b,MAAMua,cAEnBwB,YAAa,YAEbnD,KAAM,SAAWoD,EAAKC,EAAQC,EAAYC,GAExC,IAAIC,EAAQzc,KAER0c,OAAwBT,IAAfQ,EAAMC,KAAuBrc,MAAMsc,YAAYC,eAAgBP,GAAQI,EAAMC,KAEtF5B,EAAS,IAAIza,MAAMwc,WAAYJ,EAAMT,SACzClB,EAAOgC,QAASL,EAAMC,MACtB5B,EAAO7B,KAAMoD,GAAK,SAAWU,GAE3BT,EAAQG,EAAMO,MAAOD,EAAML,MAE1BH,EAAYC,IAIjBM,QAAS,SAAW5U,GAGlB,OADAlI,KAAK0c,KAAOxU,EACLlI,MAITid,gBAAiB,SAAW/U,GAG1B,OADAlI,KAAKkd,aAAehV,EACblI,MAITmd,QAAS,CAEP,kBAAmBjV,GAEjB6B,QAAQqT,KAAM,wGAMlBC,eAAgB,SAAWnV,GAGzB,OADAlI,KAAKoc,YAAclU,EACZlI,MAITgd,MAAO,SAAWD,EAAML,GAEtB,SAASY,EAAsBC,EAAKjI,GAOlC,IAHA,IAAIkI,EAAQ,GACRC,EAAaF,EAAIE,WAEX9X,EAAI,EAAGsQ,EAAIwH,EAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAEpD,IAAI+X,EAAQD,EAAY9X,GAEnB+X,EAAMC,WAAarI,GAEtBkI,EAAM9C,KAAMgD,GAMhB,OAAOF,EAIT,SAASI,EAAcb,GAErB,GAAqB,IAAhBA,EAAKnX,OAAe,MAAO,GAKhC,IAHA,IAAIiY,EAAQd,EAAKe,OAAO1D,MAAO,OAC3BoD,EAAQ,IAAIO,MAAOF,EAAMjY,QAEnBD,EAAI,EAAGsQ,EAAI4H,EAAMjY,OAAQD,EAAIsQ,EAAGtQ,IAExC6X,EAAO7X,GAAMkY,EAAOlY,GAItB,OAAO6X,EAIT,SAASQ,EAAajB,GAEpB,GAAqB,IAAhBA,EAAKnX,OAAe,MAAO,GAKhC,IAHA,IAAIiY,EAAQd,EAAKe,OAAO1D,MAAO,OAC3BoD,EAAQ,IAAIO,MAAOF,EAAMjY,QAEnBD,EAAI,EAAGsQ,EAAI4H,EAAMjY,OAAQD,EAAIsQ,EAAGtQ,IAExC6X,EAAO7X,GAAMsY,WAAYJ,EAAOlY,IAIlC,OAAO6X,EAIT,SAASU,EAAWnB,GAElB,GAAqB,IAAhBA,EAAKnX,OAAe,MAAO,GAKhC,IAHA,IAAIiY,EAAQd,EAAKe,OAAO1D,MAAO,OAC3BoD,EAAQ,IAAIO,MAAOF,EAAMjY,QAEnBD,EAAI,EAAGsQ,EAAI4H,EAAMjY,OAAQD,EAAIsQ,EAAGtQ,IAExC6X,EAAO7X,GAAMwY,SAAUN,EAAOlY,IAIhC,OAAO6X,EAIT,SAASY,EAASrB,GAEhB,OAAOA,EAAKsB,UAAW,GAUzB,SAASC,EAAShD,GAEhB,OAAwC,IAAjCxV,OAAOC,KAAMuV,GAAS1V,OAe/B,SAAS2Y,EAAgBhB,GAEvB,YAAetB,IAARsB,IAAyD,IAAhCA,EAAIvH,aAAc,SAEzCiI,WAAYV,EAAI9b,aAAc,UAI9B,EAMX,SAAS+c,EAAkBjB,GAEzB,YAAetB,IAARsB,EAAoBA,EAAIkB,YAAc,OAM/C,SAASC,EAAcnB,EAAKoB,EAAahB,EAAUiB,GAEjD,IAAIC,EAAUvB,EAAsBC,EAAKoB,GAAe,GAExD,QAAiB1C,IAAZ4C,EAIH,IAFA,IAAIC,EAAWxB,EAAsBuB,EAASlB,GAEpChY,EAAI,EAAGA,EAAImZ,EAASlZ,OAAQD,IAEpCiZ,EAAQE,EAAUnZ,IAQxB,SAASoZ,EAAc/d,EAAMge,GAE3B,IAAM,IAAI1J,KAAQtU,EAAO,CAEVA,EAAMsU,GACZ2J,MAAQD,EAAShe,EAAMsU,KAQlC,SAAS4J,EAAUle,EAAMge,GAEvB,YAAoB/C,IAAfjb,EAAKie,MAA6Bje,EAAKie,OAE5Cje,EAAKie,MAAQD,EAAShe,GAEfA,EAAKie,OAkDd,SAASE,EAAuB5B,GAM9B,IAJA,IAAIvc,EAAO,CACToe,OAAQ,IAGAzZ,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,QACH,IAAIvW,EAAKgX,EAASV,EAAMjc,aAAc,WAClC6d,EAAW5B,EAAMjc,aAAc,YACnCT,EAAKoe,OAAQE,GAAalY,GAOhC,OAAOpG,EAIT,SAASue,EAAuBhC,GAE9B,IAAIvc,EAAO,GAMP6c,EAJSN,EAAI9b,aAAc,UAIZ2Y,MAAO,KAEtBhT,EAAKyW,EAAM2B,QACXC,EAAM5B,EAAM2B,QAIZE,GAAyC,IAAzBD,EAAItU,QAAS,KAC7BwU,GAA0C,IAAzBF,EAAItU,QAAS,KAElC,GAAKwU,EAIH9B,EAAQ4B,EAAIrF,MAAO,KACnBqF,EAAM5B,EAAM2B,QACZxe,EAAK4e,OAAS/B,EAAM2B,aAEf,GAAKE,EAAc,CAIxB,IAAIG,EAAUJ,EAAIrF,MAAO,KACzBqF,EAAMI,EAAQL,QAEd,IAAM,IAAI7Z,EAAI,EAAGA,EAAIka,EAAQja,OAAQD,IAEnCka,EAASla,GAAMwY,SAAU0B,EAASla,GAAIyS,QAAS,KAAM,KAIvDpX,EAAK6e,QAAUA,EAYjB,OARA7e,EAAKoG,GAAKA,EACVpG,EAAKye,IAAMA,EAEXze,EAAK0e,YAAcA,EACnB1e,EAAK2e,aAAeA,EAEpB3e,EAAK8e,QAAU1B,EAASb,EAAI9b,aAAc,WAEnCT,EAIT,SAAS+e,EAAgB/e,GAEvB,IAAIgf,EAAS,GAETC,EAAWjf,EAAKif,SAChBC,EAAWlf,EAAKkf,SAChBC,EAAUnf,EAAKmf,QAEnB,IAAM,IAAIxZ,KAAUsZ,EAElB,GAAKA,EAASnW,eAAgBnD,GAAW,CAEvC,IAAIyZ,EAAUH,EAAUtZ,GACpBmZ,EAAUI,EAAUE,EAAQN,SAE5BO,EAAUP,EAAQV,OAAOkB,MACzBC,EAAWT,EAAQV,OAAOoB,OAO9BC,EAFgBC,EAAuBN,EAHrBD,EAASE,GACRF,EAASI,IAIKP,GAMrC,OAAOA,EAIT,SAASW,EAAcvZ,GAErB,OAAO8X,EAAUL,GAAQ7E,WAAY5S,GAAM2Y,GAI7C,SAASW,EAAuBN,EAASQ,EAAaC,GAEpD,IAMIC,EAAMC,EACNpb,EAAGqb,EAAIC,EAAGC,EAPVC,EAAOtC,GAAQuC,MAAOhB,EAAQhZ,IAC9B1F,EAAWoU,GAASqL,EAAK/Z,IAEzBia,EAAYF,EAAKG,WAAYlB,EAAQX,KACrC8B,EAAgBJ,EAAKK,OAAOjY,QAAQkY,YAKpCzgB,EAAO,GAKX,OAASqgB,GAEP,IAAK,SAEH,IAAM1b,EAAI,EAAGqb,EAAKJ,EAAYpD,MAAM5X,OAAQD,EAAIqb,EAAIrb,IAOlD,GALAmb,EAAOF,EAAYpD,MAAO7X,GAC1Bob,EAASpb,EAAIkb,EAAaE,YAEJ9E,IAAjBjb,EAAM8f,KAAuB9f,EAAM8f,GAAS,KAEpB,IAAxBV,EAAQV,YAAuB,CAElC,IAAIxX,EAAQ2Y,EAAarD,MAAOuD,GAC5B9a,EAAQma,EAAQP,QAAS,GAAM,EAAIO,EAAQP,QAAS,GAExD7e,EAAM8f,GAAQ7a,GAAUiC,OAIxB,IAAM+Y,EAAI,EAAGC,EAAKL,EAAaE,OAAQE,EAAIC,EAAID,IAE7CjgB,EAAM8f,GAAQG,GAAMJ,EAAarD,MAAOuD,EAASE,GAQvD,MAEF,IAAK,YAIL,IAAK,SAIL,IAAK,QACHlX,QAAQqT,KAAM,0EAA2EiE,GAK7F,IAAIK,EAWN,SAA+B1gB,EAAMugB,GAEnC,IAAIG,EAAY,GAIhB,IAAM,IAAIZ,KAAQ9f,EAEhB0gB,EAAUhH,KAAM,CAAEoG,KAAM7C,WAAY6C,GAAQ5Y,MAAOlH,EAAM8f,KAM3DY,EAAUC,MAcV,SAAoBC,EAAGC,GAErB,OAAOD,EAAEd,KAAOe,EAAEf,QAZpB,IAAM,IAAInb,EAAI,EAAGA,EAAI,GAAIA,IAEvBmc,EAAwBJ,EAAW/b,EAAG4b,EAAczC,SAAUnZ,IAIhE,OAAO+b,EAnCSK,CAAsB/gB,EAAMugB,GAO5C,MALgB,CACdjM,KAAM5T,EAASsgB,KACfN,UAAWA,GA2Cf,IAAInhB,EAAW,IAAIF,MAAMC,QACrB2hB,EAAQ,IAAI5hB,MAAMC,QAClB8V,EAAa,IAAI/V,MAAMwU,WAE3B,SAAS4L,EAAsByB,EAAWlC,GAUxC,IARA,IAAI0B,EAAYQ,EAAUR,UACtBpM,EAAO4M,EAAU5M,KAEjB6M,EAAQ,GACRC,EAAe,GACfC,EAAiB,GACjBC,EAAY,GAEN3c,EAAI,EAAGsQ,EAAIyL,EAAU9b,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAEnD,IAAI4c,EAAWb,EAAW/b,GAEtBmb,EAAOyB,EAASzB,KAChB5Y,EAAQqa,EAASra,MAErBsZ,GAAOgB,UAAWta,GAAQuZ,YAC1BD,GAAOiB,UAAWliB,EAAU6V,EAAY6L,GAExCE,EAAMzH,KAAMoG,GACZsB,EAAa1H,KAAMna,EAAS4C,EAAG5C,EAASgD,EAAGhD,EAASuE,GACpDud,EAAe3H,KAAMtE,EAAWjT,EAAGiT,EAAW7S,EAAG6S,EAAWtR,EAAGsR,EAAWsM,GAC1EJ,EAAU5H,KAAMuH,EAAM9e,EAAG8e,EAAM1e,EAAG0e,EAAMnd,GAQ1C,OAJKsd,EAAaxc,OAAS,GAAIoa,EAAOtF,KAAM,IAAIra,MAAMsiB,oBAAqBrN,EAAO,YAAa6M,EAAOC,IACjGC,EAAezc,OAAS,GAAIoa,EAAOtF,KAAM,IAAIra,MAAMuiB,wBAAyBtN,EAAO,cAAe6M,EAAOE,IACzGC,EAAU1c,OAAS,GAAIoa,EAAOtF,KAAM,IAAIra,MAAMsiB,oBAAqBrN,EAAO,SAAU6M,EAAOG,IAEzFtC,EAIT,SAAS8B,EAAwBJ,EAAWmB,EAAUC,GAEpD,IAAIP,EAGA5c,EAAGsQ,EADH8M,GAAQ,EAKZ,IAAMpd,EAAI,EAAGsQ,EAAIyL,EAAU9b,OAAQD,EAAIsQ,EAAGtQ,SAIJsW,KAFpCsG,EAAWb,EAAW/b,IAERuC,MAAO2a,GAEnBN,EAASra,MAAO2a,GAAa,KAI7BE,GAAQ,EAMZ,IAAe,IAAVA,EAIH,IAAMpd,EAAI,EAAGsQ,EAAIyL,EAAU9b,OAAQD,EAAIsQ,EAAGtQ,KAExC4c,EAAWb,EAAW/b,IAEbuC,MAAO2a,GAAaC,OAcnC,SAAiCpB,EAAWmB,GAI1C,IAFA,IAAIG,EAAMC,EAEAtd,EAAI,EAAGsQ,EAAIyL,EAAU9b,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAEnD,IAAI4c,EAAWb,EAAW/b,GAE1B,GAAoC,OAA/B4c,EAASra,MAAO2a,GAAsB,CAKzC,GAHAG,EAAOE,EAASxB,EAAW/b,EAAGkd,GAC9BI,EAAOE,EAASzB,EAAW/b,EAAGkd,GAEhB,OAATG,EAAgB,CAEnBT,EAASra,MAAO2a,GAAaI,EAAK/a,MAAO2a,GACzC,SAIF,GAAc,OAATI,EAAgB,CAEnBV,EAASra,MAAO2a,GAAaG,EAAK9a,MAAO2a,GACzC,SAIFO,EAAab,EAAUS,EAAMC,EAAMJ,KAjCrCQ,CAAwB3B,EAAWmB,GAyCvC,SAASK,EAASxB,EAAW/b,EAAGkd,GAE9B,KAAQld,GAAK,GAAI,CAEf,IAAI4c,EAAWb,EAAW/b,GAE1B,GAAoC,OAA/B4c,EAASra,MAAO2a,GAAsB,OAAON,EAElD5c,IAIF,OAAO,KAIT,SAASwd,EAASzB,EAAW/b,EAAGkd,GAE9B,KAAQld,EAAI+b,EAAU9b,QAAS,CAE7B,IAAI2c,EAAWb,EAAW/b,GAE1B,GAAoC,OAA/B4c,EAASra,MAAO2a,GAAsB,OAAON,EAElD5c,IAIF,OAAO,KAIT,SAASyd,EAAa7W,EAAKyW,EAAMC,EAAMJ,GAE9BI,EAAKnC,KAAOkC,EAAKlC,MAAW,EAOnCvU,EAAIrE,MAAO2a,IAAiBtW,EAAIuU,KAAOkC,EAAKlC,OAAWmC,EAAK/a,MAAO2a,GAAaG,EAAK9a,MAAO2a,KAAiBI,EAAKnC,KAAOkC,EAAKlC,MAAWkC,EAAK9a,MAAO2a,GALnJtW,EAAIrE,MAAO2a,GAAaG,EAAK9a,MAAO2a,GAwCxC,SAASS,EAAoBtiB,GAQ3B,IANA,IAAIgf,EAAS,GAET1K,EAAOtU,EAAKsU,KACZgD,EAAatX,EAAKwU,IAAMxU,EAAKuU,QAAa,EAC1CyE,EAAahZ,EAAKgZ,WAEZrU,EAAI,EAAGqb,EAAKhH,EAAWpU,OAAQD,EAAIqb,EAAIrb,IAI/C,IAFA,IAAI4d,EAAkB5C,EAAc3G,EAAYrU,IAEtCsb,EAAI,EAAGC,EAAKqC,EAAgB3d,OAAQqb,EAAIC,EAAID,IAEpDjB,EAAOtF,KAAM6I,EAAiBtC,IAMlC,OAAO,IAAI5gB,MAAMmjB,cAAelO,EAAMgD,EAAU0H,GAIlD,SAASyD,EAAkBrc,GAEzB,OAAO8X,EAAUL,GAAQ9E,MAAO3S,GAAMkc,GAqCxC,SAASI,EAAWnG,GAMlB,IAJA,IAAIvc,EAAO,CACTmf,QAAS,IAGDxa,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,oBACH3c,EAAK2iB,gBAAkB3F,EAAaN,EAAMe,aAC1C,MAEF,IAAK,SACH,IAAIrX,EAAKsW,EAAMjc,aAAc,MAC7BT,EAAKmf,QAAS/Y,GAAOwc,GAAalG,GAClC,MAEF,IAAK,SACH1c,EAAK6iB,OAASC,EAAapG,GAC3B,MAEF,IAAK,iBACH1c,EAAK+iB,cAAgBC,EAAoBtG,IAO/C,OAAO1c,EAIT,SAAS8iB,EAAavG,GAMpB,IAJA,IAAIvc,EAAO,CACToe,OAAQ,IAGAzZ,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,QACH,IAAI2B,EAAW5B,EAAMjc,aAAc,YAC/B2F,EAAKgX,EAASV,EAAMjc,aAAc,WACtCT,EAAKoe,OAAQE,GAAalY,GAOhC,OAAOpG,EAIT,SAASgjB,EAAoBzG,GAM3B,IAJA,IAAIvc,EAAO,CACToe,OAAQ,IAGAzZ,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,QACH,IAAI2B,EAAW5B,EAAMjc,aAAc,YAC/B2F,EAAKgX,EAASV,EAAMjc,aAAc,WAClCrB,EAAS+d,SAAUT,EAAMjc,aAAc,WAC3CT,EAAKoe,OAAQE,GAAa,CAAElY,GAAIA,EAAIhH,OAAQA,GAC5C,MAEF,IAAK,SACHY,EAAKijB,OAAS/F,EAAWR,EAAMe,aAC/B,MAEF,IAAK,IACHzd,EAAK+R,EAAImL,EAAWR,EAAMe,cAOhC,OAAOzd,EAIT,SAASkjB,EAAiBljB,GAExB,IAAIie,EAAQ,CACV7X,GAAIpG,EAAKoG,IAGP6S,EAAW4E,GAAQsF,WAAYlF,EAAM7X,IAazC,YAXmB6U,IAAdjb,EAAKojB,OAERnF,EAAMmF,KAaV,SAAoBpjB,GAElB,IA4BI2E,EAAGsb,EAAGhL,EA1BNgJ,EAAQ,CACV4E,OAAQ,GACRhE,QAAS,CACPrC,MAAO,GACPuD,OANa,GAQfsD,QAAS,CACP7G,MAAO,GACPuD,OAVa,IAcbZ,EAAUnf,EAAKmf,QACf4D,EAAgB/iB,EAAK+iB,cAErBE,EAASF,EAAcE,OACvBlR,EAAIgR,EAAchR,EAClBuR,EAAcP,EAAc3E,OAAOmF,MAAMnkB,OACzCokB,EAAeT,EAAc3E,OAAOqF,OAAOrkB,OAE3CskB,EAAc1jB,EAAKmf,QAASnf,EAAK6iB,OAAOzE,OAAOmF,OAC/CI,EAAgB3jB,EAAKmf,QAASnf,EAAK6iB,OAAOzE,OAAOwF,iBAEjDP,EAAUlE,EAAS4D,EAAc3E,OAAOqF,OAAOrd,IAAKoW,MACpDuD,EAAS,EAMb,IAAMpb,EAAI,EAAGsQ,EAAIgO,EAAOre,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAE5C,IAAIkf,EAAaZ,EAAQte,GACrBmf,EAAiB,GAErB,IAAM7D,EAAI,EAAGA,EAAI4D,EAAY5D,IAAO,CAElC,IAAI8D,EAAYhS,EAAGgO,EAASuD,GACxBU,EAAWjS,EAAGgO,EAASyD,GACvBS,EAAaZ,EAASW,GAE1BF,EAAepK,KAAM,CAAEzU,MAAO8e,EAAWG,OAAQD,IAEjDlE,GAAU,EAYZ,IALA+D,EAAenD,KAAMwD,GAKflE,EAAI,EAAGA,EAzDE,EAyDcA,IAAO,CAElC,IAAImE,EAAIN,EAAgB7D,QAEbhF,IAANmJ,GAEHnG,EAAMY,QAAQrC,MAAM9C,KAAM0K,EAAEnf,OAC5BgZ,EAAMoF,QAAQ7G,MAAM9C,KAAM0K,EAAEF,UAI5BjG,EAAMY,QAAQrC,MAAM9C,KAAM,GAC1BuE,EAAMoF,QAAQ7G,MAAM9C,KAAM,KAU3B1Z,EAAK2iB,gBAER1E,EAAMoG,YAAa,IAAIhlB,MAAMilB,SAAU9C,UAAWxhB,EAAK2iB,iBAAkBlC,YAIzExC,EAAMoG,YAAa,IAAIhlB,MAAMilB,SAAUC,WAMzC,IAAM5f,EAAI,EAAGsQ,EAAIyO,EAAYlH,MAAM5X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAEvD,IAAI2P,EAAOoP,EAAYlH,MAAO7X,GAC1B6f,GAAc,IAAInlB,MAAMilB,SAAU9C,UAAWmC,EAAcnH,MAAO7X,EAAIgf,EAAc5D,QAASU,YAEjGxC,EAAM4E,OAAOnJ,KAAM,CAAEpF,KAAMA,EAAMkQ,YAAaA,IAIhD,OAAOvG,EAIP,SAASkG,EAAYvD,EAAGC,GAEtB,OAAOA,EAAEqD,OAAStD,EAAEsD,QAzHPO,CAAWzkB,EAAKojB,MAI7BnK,EAASkG,QAAQuF,YAAczG,EAAMmF,KAAKvE,QAC1C5F,EAASkG,QAAQwF,YAAc1G,EAAMmF,KAAKC,SAIrCpF,EAwIT,SAAS2G,EAAY5kB,GAEnB,YAAoBib,IAAfjb,EAAKie,MAA6Bje,EAAKie,MAErCje,EAAK6kB,UAId,SAASC,EAAU1e,GAEjB,IAAIpG,EAAO6d,GAAQkH,OAAQ3e,GAE3B,YAAc6U,IAATjb,EAEIke,EAAUle,EAAM4kB,IAIzB7b,QAAQqT,KAAM,oDAAsDhW,GAE7D,MA8BT,SAAS4e,EAA0BzI,GAOjC,IALA,IAAIvc,EAAO,CACTilB,SAAU,GACV/F,SAAU,IAGFva,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,WACHuI,EAAqBxI,EAAO1c,GAC5B,MAEF,IAAK,YACHA,EAAKmlB,UAAYC,EAAsB1I,GACvC,MAEF,IAAK,QACH1c,EAAKqlB,MAAQC,EAAkB5I,IAOrC,OAAO1c,EAIT,SAASklB,EAAqB3I,EAAKvc,GAIjC,IAFA,IAAIye,EAAMlC,EAAI9b,aAAc,OAElBkE,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,UACH3c,EAAKilB,SAAUxG,GAAQ8G,EAAoB7I,GAC3C,MAEF,IAAK,YACH1c,EAAKkf,SAAUT,GAAQ+G,EAAoB9I,KASnD,SAAS6I,EAAoBhJ,GAI3B,IAFA,IAAIvc,EAAO,GAED2E,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,YACH3c,EAAK6kB,UAAYnI,EAAMe,aAO7B,OAAOzd,EAIT,SAASwlB,EAAoBjJ,GAI3B,IAFA,IAAIvc,EAAO,GAED2E,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,SACH3c,EAAKylB,OAAS/I,EAAMe,aAO1B,OAAOzd,EAIT,SAASolB,EAAsB7I,GAI7B,IAFA,IAAIvc,EAAO,GAED2E,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,WACL,IAAK,UACL,IAAK,QACL,IAAK,QACH3c,EAAKqB,KAAOqb,EAAMC,SAClB3c,EAAK0lB,WAAaC,EAAuBjJ,IAO/C,OAAO1c,EAIT,SAAS2lB,EAAuBpJ,GAI9B,IAFA,IAAIvc,EAAO,GAED2E,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,WACL,IAAK,UACL,IAAK,WACL,IAAK,OACL,IAAK,UACL,IAAK,YACL,IAAK,eACH3c,EAAM0c,EAAMC,UAAaiJ,EAAsBlJ,GAC/C,MACF,IAAK,cACH1c,EAAM0c,EAAMC,UAAa,CACvBkJ,OAAQnJ,EAAMjc,aAAc,UAC5BT,KAAM4lB,EAAsBlJ,KAQpC,OAAO1c,EAIT,SAAS4lB,EAAsBrJ,GAI7B,IAFA,IAAIvc,EAAO,GAED2E,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,QACH3c,EAAM0c,EAAMC,UAAaK,EAAaN,EAAMe,aAC5C,MAEF,IAAK,QACHzd,EAAM0c,EAAMC,UAAaM,WAAYP,EAAMe,aAC3C,MAEF,IAAK,UACHzd,EAAM0c,EAAMC,UAAa,CAAEvW,GAAIsW,EAAMjc,aAAc,WAAa4kB,MAAOS,EAA6BpJ,KAO1G,OAAO1c,EAIT,SAAS8lB,EAA6BvJ,GAMpC,IAJA,IAAIvc,EAAO,CACTmlB,UAAW,IAGHxgB,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,QACHoJ,EAAkCrJ,EAAO1c,IAO/C,OAAOA,EAIT,SAAS+lB,EAAkCxJ,EAAKvc,GAE9C,IAAM,IAAI2E,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,YACHqJ,EAA2CtJ,EAAO1c,KAS1D,SAASgmB,EAA2CzJ,EAAKvc,GAEvD,IAAM,IAAI2E,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACH3c,EAAKmlB,UAAWzI,EAAMC,UAAaM,WAAYP,EAAMe,aACrD,MAEF,IAAK,QACL,IAAK,QAIsC,SAApCf,EAAMe,YAAYwI,cAErBjmB,EAAKmlB,UAAWzI,EAAMC,UAAa,EAEW,UAApCD,EAAMe,YAAYwI,cAE5BjmB,EAAKmlB,UAAWzI,EAAMC,UAAa,EAInC3c,EAAKmlB,UAAWzI,EAAMC,UAAaQ,SAAUT,EAAMe,eAY7D,SAAS6H,EAAkB/I,GAIzB,IAFA,IAAIvc,EAAO,GAED2E,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,YACH3c,EAAKmlB,UAAYe,EAA2BxJ,IAOlD,OAAO1c,EAIT,SAASkmB,EAA2B3J,GAIlC,IAFA,IAAIvc,EAAO,GAED2E,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,eACH3c,EAAM0c,EAAMC,UAAaQ,SAAUT,EAAMe,cAO/C,OAAOzd,EAIT,SAASmmB,EAAanmB,GAEpB,OAAOA,EA4DT,SAASomB,EAAepmB,GAEtB,IA1DkBoG,EA8DdoU,EAJA6L,GA1DcjgB,EA0DMpG,EAAKqb,IAxDtB6C,EAAUL,GAAQyI,QAASlgB,GAAM+f,IAyDpChB,EAAYkB,EAAOE,QAAQpB,UAC3BE,EAAQgB,EAAOE,QAAQlB,MAI3B,OAASF,EAAU9jB,MAEjB,IAAK,QACL,IAAK,QACHmZ,EAAW,IAAInb,MAAMmnB,kBACrB,MAEF,IAAK,UACHhM,EAAW,IAAInb,MAAMonB,oBACrB,MAEF,QACEjM,EAAW,IAAInb,MAAMqnB,kBAOzB,SAASC,EAAYC,GAEnB,IAAI9H,EAAUuH,EAAOE,QAAQrH,SAAU0H,EAAcxgB,IACjDygB,EAAQ,UAIK5L,IAAZ6D,EAGH+H,EAAQ/B,EADMuB,EAAOE,QAAQtB,SAAUnG,EAAQ2G,QACrBZ,YAI1B9b,QAAQqT,KAAM,+EACdyK,EAAQ/B,EAAU8B,EAAcxgB,KAMlC,GAAe,OAAVygB,EAAiB,CAEpB,IAAI/M,EAxEV,SAA2B+M,GAEzB,IAAI/M,EAEAgN,EAAYD,EAAME,MAAgD,GAAvCF,EAAMG,YAAa,KAAQ,IAAM,IAGhE,OAFAF,EAAYA,EAAUtU,eAIpB,IAAK,MACHsH,EAASmN,GACT,MAEF,QACEnN,EAASoN,GAIb,OAAOpN,EAsDUqN,CAAkBN,GAE/B,QAAgB5L,IAAXnB,EAAuB,CAE1B,IAAIsN,EAAUtN,EAAO7B,KAAM4O,GAEvBxB,EAAQuB,EAAcvB,MAE1B,QAAepK,IAAVoK,QAA2CpK,IAApBoK,EAAMF,YAA0D,IAA/B7H,EAAS+H,EAAMF,WAAwB,CAElG,IAAIA,EAAYE,EAAMF,UAEtBiC,EAAQC,MAAQlC,EAAUmC,MAAQjoB,MAAMkoB,eAAiBloB,MAAMmoB,oBAC/DJ,EAAQK,MAAQtC,EAAUuC,MAAQroB,MAAMkoB,eAAiBloB,MAAMmoB,oBAE/DJ,EAAQhoB,OAAOkB,IAAK6kB,EAAUwC,SAAW,EAAGxC,EAAUyC,SAAW,GACjER,EAAQrQ,OAAOzW,IAAK6kB,EAAU0C,SAAW,EAAG1C,EAAU2C,SAAW,QAIjEV,EAAQC,MAAQhoB,MAAMkoB,eACtBH,EAAQK,MAAQpoB,MAAMkoB,eAIxB,OAAOH,EAMP,OAFAre,QAAQqT,KAAM,wDAAyDyK,GAEhE,KAQT,OAFA9d,QAAQqT,KAAM,wDAA0DwK,EAAcxgB,IAE/E,KAhEXoU,EAASlG,KAAOtU,EAAKsU,KAsErB,IAAIoR,EAAaP,EAAUO,WAE3B,IAAM,IAAIna,KAAOma,EAAa,CAE5B,IAAIqC,EAAYrC,EAAYna,GAE5B,OAASA,GAEP,IAAK,UACEwc,EAAUtN,OAAQD,EAASC,MAAM+G,UAAWuG,EAAUtN,OACtDsN,EAAUX,UAAU5M,EAASnB,IAAMsN,EAAYoB,EAAUX,UAC9D,MACF,IAAK,WACEW,EAAUtN,OAASD,EAASwN,UAAWxN,EAASwN,SAASxG,UAAWuG,EAAUtN,OAC9EsN,EAAUX,UAAU5M,EAASyN,YAActB,EAAYoB,EAAUX,UACtE,MACF,IAAK,OACEW,EAAUX,UAAU5M,EAAS0N,UAAYvB,EAAYoB,EAAUX,UACpE,MACF,IAAK,UACEW,EAAUX,UAAU5M,EAAS2N,SAAWxB,EAAYoB,EAAUX,UACnE,MACF,IAAK,YACEW,EAAUK,OAAS5N,EAAS6N,YAAY7N,EAAS6N,UAAYN,EAAUK,OAC5E,MACF,IAAK,WACEL,EAAUtN,OAASD,EAASG,UAAWH,EAASG,SAAS6G,UAAWuG,EAAUtN,OAC9EsN,EAAUX,UAAU5M,EAASI,YAAc+L,EAAYoB,EAAUX,WAS5E,IAAIkB,EAAc5C,EAA0B,YACxC6C,EAAe7C,EAA2B,aAwB9C,QApBsBzK,IAAjBsN,GAA8BD,IAEjCC,EAAe,CACbH,MAAO,SAOUnN,IAAhBqN,GAA6BC,IAEhCD,EAAc,CACZzC,OAAQ,QACR7lB,KAAM,CACJya,MAAO,CAAE,EAAG,EAAG,EAAG,MAKnB6N,GAAeC,EAIlB,GAAKD,EAAYtoB,KAAKonB,QAIpB5M,EAAS8N,aAAc,MAElB,CAEL,IAAI7N,EAAQ6N,EAAYtoB,KAAKya,MAE7B,OAAS6N,EAAYzC,QAEnB,IAAK,QACHrL,EAASgO,QAAU/N,EAAO,GAAM8N,EAAaH,MAC7C,MACF,IAAK,WACH5N,EAASgO,QAAU,EAAM/N,EAAO,GAAM8N,EAAaH,MACnD,MACF,IAAK,SACH5N,EAASgO,QAAU,EAAM/N,EAAO,GAAM8N,EAAaH,MACnD,MACF,IAAK,UACH5N,EAASgO,QAAU/N,EAAO,GAAM8N,EAAaH,MAC7C,MACF,QACErf,QAAQqT,KAAM,oEAAqEkM,EAAYzC,QAI9FrL,EAASgO,QAAU,IAAIhO,EAAS8N,aAAc,GAcvD,YANerN,IAAVoK,QAA2CpK,IAApBoK,EAAMF,WAA4D,IAAjCE,EAAMF,UAAUsD,eAE3EjO,EAASkO,KAAOrpB,MAAMspB,YAIjBnO,EAIT,SAASoO,EAAaxiB,GAEpB,OAAO8X,EAAUL,GAAQgL,UAAWziB,GAAMggB,GAgC5C,SAAS0C,EAAmBvM,GAE1B,IAAM,IAAI5X,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,OAAS+X,EAAMC,UAEb,IAAK,mBACH,OAAOoM,EAAsBrM,IAMnC,MAAO,GAIT,SAASqM,EAAsBxM,GAI7B,IAFA,IAAIvc,EAAO,GAED2E,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,OAAS+X,EAAMC,UAEb,IAAK,cACL,IAAK,eAEH3c,EAAKmlB,UAAYzI,EAAMC,SACvB3c,EAAK0lB,WAAasD,EAAuBtM,IAQ/C,OAAO1c,EAIT,SAASgpB,EAAuBzM,GAI9B,IAFA,IAAIvc,EAAO,GAED2E,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,OAAS+X,EAAMC,UAEb,IAAK,OACL,IAAK,OACL,IAAK,OACL,IAAK,OACL,IAAK,QACL,IAAK,OACL,IAAK,eACH3c,EAAM0c,EAAMC,UAAaM,WAAYP,EAAMe,cAOjD,OAAOzd,EAIT,SAASipB,EAAajpB,GAEpB,IAAIoB,EAEJ,OAASpB,EAAKkpB,OAAO/D,WAEnB,IAAK,cACH/jB,EAAS,IAAI/B,MAAM8pB,kBACjBnpB,EAAKkpB,OAAOxD,WAAW0D,KACvBppB,EAAKkpB,OAAOxD,WAAW2D,aACvBrpB,EAAKkpB,OAAOxD,WAAW4D,MACvBtpB,EAAKkpB,OAAOxD,WAAW6D,MAEzB,MAEF,IAAK,eACH,IAAIC,EAAOxpB,EAAKkpB,OAAOxD,WAAW8D,KAC9BC,EAAOzpB,EAAKkpB,OAAOxD,WAAW+D,KAC9BC,EAAc1pB,EAAKkpB,OAAOxD,WAAW2D,aAEzCI,OAAkBxO,IAATwO,EAAyBD,EAAOE,EAAgBD,EACzDD,OAAkBvO,IAATuO,EAAyBC,EAAOC,EAAgBF,EAEzDC,GAAQ,GACRD,GAAQ,GAERpoB,EAAS,IAAI/B,MAAMsqB,oBACfF,EAAMA,EAAMD,GAAQA,EACtBxpB,EAAKkpB,OAAOxD,WAAW4D,MACvBtpB,EAAKkpB,OAAOxD,WAAW6D,MAEzB,MAEF,QACEnoB,EAAS,IAAI/B,MAAM8pB,kBAOvB,OAFA/nB,EAAOkT,KAAOtU,EAAKsU,KAEZlT,EAIT,SAASwoB,EAAWxjB,GAElB,IAAIpG,EAAO6d,GAAQgM,QAASzjB,GAE5B,YAAc6U,IAATjb,EAEIke,EAAUle,EAAMipB,IAIzBlgB,QAAQqT,KAAM,qDAAuDhW,GAE9D,MA8BT,SAAS0jB,GAAqBvN,GAI5B,IAFA,IAAIvc,EAAO,GAED2E,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,cACL,IAAK,QACL,IAAK,OACL,IAAK,UAEH3c,EAAKmlB,UAAYzI,EAAMC,SACvB3c,EAAK0lB,WAAaqE,GAAsBrN,IAM9C,OAAO1c,EAIT,SAAS+pB,GAAsBxN,GAI7B,IAFA,IAAIvc,EAAO,GAED2E,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,QACH,IAAIH,EAAQQ,EAAaN,EAAMe,aAC/Bzd,EAAKya,OAAQ,IAAIpb,MAAM2qB,OAAQxI,UAAWhF,GAC1C,MAEF,IAAK,gBACHxc,EAAKiqB,aAAehN,WAAYP,EAAMe,aACtC,MAEF,IAAK,wBACH,IAAIyM,EAAIjN,WAAYP,EAAMe,aAC1Bzd,EAAKmqB,SAAWD,EAAI9nB,KAAKgoB,KAAM,EAAIF,GAAM,GAO/C,OAAOlqB,EAIT,SAASqqB,GAAYrqB,GAEnB,IAAIsqB,EAEJ,OAAStqB,EAAKmlB,WAEZ,IAAK,cACHmF,EAAQ,IAAIjrB,MAAMkrB,iBAClB,MAEF,IAAK,QACHD,EAAQ,IAAIjrB,MAAMmrB,WAClB,MAEF,IAAK,OACHF,EAAQ,IAAIjrB,MAAMorB,UAClB,MAEF,IAAK,UACHH,EAAQ,IAAIjrB,MAAMqrB,aAQtB,OAHK1qB,EAAK0lB,WAAWjL,OAAQ6P,EAAM7P,MAAMja,KAAMR,EAAK0lB,WAAWjL,OAC1Dza,EAAK0lB,WAAWyE,WAAWG,EAAMH,SAAWnqB,EAAK0lB,WAAWyE,UAE1DG,EAIT,SAASK,GAAUvkB,GAEjB,IAAIpG,EAAO6d,GAAQ+M,OAAQxkB,GAE3B,YAAc6U,IAATjb,EAEIke,EAAUle,EAAMqqB,KAIzBthB,QAAQqT,KAAM,oDAAsDhW,GAE7D,MA6DT,SAASwc,GAAarG,GAOpB,IALA,IAAIvc,EAAO,CACTwc,MAAO,GACPuD,OAAQ,GAGApb,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,cACH3c,EAAKwc,MAAQQ,EAAaN,EAAMe,aAChC,MAEF,IAAK,aACHzd,EAAKwc,MAAQI,EAAcF,EAAMe,aACjC,MAEF,IAAK,mBACH,IAAIoN,EAAWvO,EAAsBI,EAAO,YAAc,QAExCzB,IAAb4P,IAEH7qB,EAAK+f,OAAS5C,SAAU0N,EAASpqB,aAAc,aASvD,OAAOT,EAIT,SAAS8qB,GAAuBvO,GAI9B,IAFA,IAAIvc,EAAO,GAED2E,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAEJ,IAAnB+X,EAAM2B,WAEXre,EAAM0c,EAAMjc,aAAc,aAAiB2c,EAASV,EAAMjc,aAAc,YAI1E,OAAOT,EAIT,SAAS+qB,GAAwBxO,GAW/B,IATA,IAAIyO,EAAY,CACd3pB,KAAMkb,EAAII,SACVnC,SAAU+B,EAAI9b,aAAc,YAC5BwqB,MAAO9N,SAAUZ,EAAI9b,aAAc,UACnC2d,OAAQ,GACR2B,OAAQ,EACRmL,OAAO,GAGCvmB,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,QACH,IAAIvW,EAAKgX,EAASV,EAAMjc,aAAc,WAClC6d,EAAW5B,EAAMjc,aAAc,YAC/BrB,EAAS+d,SAAUT,EAAMjc,aAAc,WACvCH,EAAM6c,SAAUT,EAAMjc,aAAc,QACpC0qB,EAAc7qB,EAAM,EAAIge,EAAWhe,EAAMge,EAC7C0M,EAAU5M,OAAQ+M,GAAc,CAAE/kB,GAAIA,EAAIhH,OAAQA,GAClD4rB,EAAUjL,OAAS3d,KAAKkC,IAAK0mB,EAAUjL,OAAQ3gB,EAAS,GACtC,aAAbkf,IAA0B0M,EAAUE,OAAQ,GACjD,MAEF,IAAK,SACHF,EAAU/H,OAAS/F,EAAWR,EAAMe,aACpC,MAEF,IAAK,IACHuN,EAAUlZ,EAAIoL,EAAWR,EAAMe,cAOrC,OAAOuN,EAsBT,SAASI,GAAoBC,GAI3B,IAFA,IAAIJ,EAAQ,EAEFtmB,EAAI,EAAGsQ,EAAIoW,EAAWzmB,OAAQD,EAAIsQ,EAAGtQ,IAAO,EAI3B,IAFT0mB,EAAY1mB,GAEbumB,OAEbD,IAMCA,EAAQ,GAAKA,EAAQI,EAAWzmB,SAEnCymB,EAAWC,aAAc,GAM7B,SAASC,GAAevrB,GAEtB,IAAIie,EAAQ,GAERkB,EAAUnf,EAAKmf,QACfqM,EAAWxrB,EAAKwrB,SAChBH,EAAarrB,EAAKqrB,WAEtB,GAA2B,IAAtBA,EAAWzmB,OAAe,MAAO,GAKtC,IAAI6mB,EAvDN,SAA0BJ,GAIxB,IAFA,IAAIpN,EAAQ,GAEFtZ,EAAI,EAAGA,EAAI0mB,EAAWzmB,OAAQD,IAAO,CAE7C,IAAIqmB,EAAYK,EAAY1mB,QAEKsW,IAA5BgD,EAAO+M,EAAU3pB,QAAuB4c,EAAO+M,EAAU3pB,MAAS,IAEvE4c,EAAO+M,EAAU3pB,MAAOqY,KAAMsR,GAIhC,OAAO/M,EAyCiByN,CAAiBL,GAEzC,IAAM,IAAIhqB,KAAQoqB,EAAoB,CAEpC,IAAIE,EAAgBF,EAAmBpqB,GAIvC+pB,GAAoBO,GAIpB1N,EAAO5c,GAASuqB,GAAmBD,EAAexM,EAASqM,GAI7D,OAAOvN,EAIT,SAAS2N,GAAmBP,EAAYlM,EAASqM,GAmB/C,IAjBA,IAAIvN,EAAQ,GAER1e,EAAW,CAAEid,MAAO,GAAIuD,OAAQ,GAChC8L,EAAS,CAAErP,MAAO,GAAIuD,OAAQ,GAC9B+L,EAAK,CAAEtP,MAAO,GAAIuD,OAAQ,GAC1BgM,EAAM,CAAEvP,MAAO,GAAIuD,OAAQ,GAC3BtF,EAAQ,CAAE+B,MAAO,GAAIuD,OAAQ,GAE7BgE,EAAqB,GAArBA,EAAiC,EACjCE,EAAsB,GAAtBA,EAAkC,EAElChL,EAAW,IAAI5Z,MAAM2sB,eAErBC,EAAe,GAEf1X,EAAQ,EAEFzC,EAAI,EAAGA,EAAIuZ,EAAWzmB,OAAQkN,IAAO,CAE7C,IAAIkZ,EAAYK,EAAYvZ,GACxBsM,EAAS4M,EAAU5M,OAInB6M,EAAQ,EAEZ,OAASD,EAAU3pB,MAEjB,IAAK,QACL,IAAK,aACH4pB,EAA0B,EAAlBD,EAAUC,MAClB,MAEF,IAAK,YACHA,EAA0B,EAAlBD,EAAUC,MAClB,MAEF,IAAK,WAEH,IAAM,IAAIiB,EAAI,EAAGA,EAAIlB,EAAUC,MAAOiB,IAAO,CAE3C,IAAIC,EAAKnB,EAAU/H,OAAQiJ,GAE3B,OAASC,GAEP,KAAK,EACHlB,GAAS,EACT,MAEF,KAAK,EACHA,GAAS,EACT,MAEF,QACEA,GAAsB,GAAXkB,EAAK,IAOtB,MAEF,QACEpjB,QAAQqT,KAAM,8CAA+C4O,EAAU3pB,MAiB3E,IAAM,IAAIiT,KAbV2E,EAASmT,SAAU7X,EAAO0W,EAAOnZ,GACjCyC,GAAS0W,EAIJD,EAAUxQ,UAEbyR,EAAavS,KAAMsR,EAAUxQ,UAMb4D,EAAS,CAEzB,IAAIiO,EAAQjO,EAAQ9J,GAEpB,OAASA,GAEP,IAAK,SACH,IAAM,IAAI/I,KAAOigB,EAAW,CAE1B,IAAIplB,EAAKolB,EAAUjgB,GAEnB,OAASA,GAEP,IAAK,WACH,IAAI+gB,EAAa/sB,EAASid,MAAM5X,OAahC,GAZA2nB,GAAmBvB,EAAW7L,EAAS/Y,GAAMimB,EAAMjtB,OAAQG,EAASid,OACpEjd,EAASwgB,OAASZ,EAAS/Y,GAAK2Z,OAE3BZ,EAAQwF,aAAexF,EAAQuF,cAElC6H,GAAmBvB,EAAW7L,EAAQuF,YAAa2H,EAAMjtB,OAAQ2kB,GACjEwI,GAAmBvB,EAAW7L,EAAQwF,YAAa0H,EAAMjtB,OAAQ6kB,KAM1C,IAApB+G,EAAUE,QAA8C,IAA3BG,EAAWC,YAE3C,CAAIL,GAAU1rB,EAASid,MAAM5X,OAAS0nB,GAAe/sB,EAASwgB,OAE9D,IAFA,IAEUpb,EAAI,EAAGA,EAAIsmB,EAAOtmB,IAI1BmnB,EAAGtP,MAAM9C,KAAM,EAAG,GAKtB,MAEF,IAAK,SACH6S,GAAmBvB,EAAW7L,EAAS/Y,GAAMimB,EAAMjtB,OAAQysB,EAAOrP,OAClEqP,EAAO9L,OAASZ,EAAS/Y,GAAK2Z,OAC9B,MAEF,IAAK,QACHwM,GAAmBvB,EAAW7L,EAAS/Y,GAAMimB,EAAMjtB,OAAQqb,EAAM+B,OACjE/B,EAAMsF,OAASZ,EAAS/Y,GAAK2Z,OAC7B,MAEF,IAAK,WACHwM,GAAmBvB,EAAW7L,EAAS/Y,GAAMimB,EAAMjtB,OAAQ0sB,EAAGtP,OAC9DsP,EAAG/L,OAASZ,EAAS/Y,GAAK2Z,OAC1B,MAEF,IAAK,YACHwM,GAAmBvB,EAAW7L,EAAS/Y,GAAMimB,EAAMjtB,OAAQ2sB,EAAIvP,OAC/DsP,EAAG/L,OAASZ,EAAS/Y,GAAK2Z,OAC1B,MAEF,QACEhX,QAAQqT,KAAM,4EAA6E7Q,IAKjG,MAEF,IAAK,SACHghB,GAAmBvB,EAAW7L,EAASkN,EAAMjmB,IAAMimB,EAAMjtB,OAAQysB,EAAOrP,OACxEqP,EAAO9L,OAASZ,EAASkN,EAAMjmB,IAAK2Z,OACpC,MAEF,IAAK,QACHwM,GAAmBvB,EAAW7L,EAASkN,EAAMjmB,IAAMimB,EAAMjtB,OAAQqb,EAAM+B,OACvE/B,EAAMsF,OAASZ,EAASkN,EAAMjmB,IAAK2Z,OACnC,MAEF,IAAK,WACHwM,GAAmBvB,EAAW7L,EAASkN,EAAMjmB,IAAMimB,EAAMjtB,OAAQ0sB,EAAGtP,OACpEsP,EAAG/L,OAASZ,EAASkN,EAAMjmB,IAAK2Z,OAChC,MAEF,IAAK,YACHwM,GAAmBvB,EAAW7L,EAASkN,EAAMjmB,IAAMimB,EAAMjtB,OAAQ2sB,EAAIvP,OACrEuP,EAAIhM,OAASZ,EAASkN,EAAMjmB,IAAK2Z,SAwBzC,OAbKxgB,EAASid,MAAM5X,OAAS,GAAIqU,EAASuT,aAAc,WAAY,IAAIntB,MAAMotB,uBAAwBltB,EAASid,MAAOjd,EAASwgB,SAC1H8L,EAAOrP,MAAM5X,OAAS,GAAIqU,EAASuT,aAAc,SAAU,IAAIntB,MAAMotB,uBAAwBZ,EAAOrP,MAAOqP,EAAO9L,SAClHtF,EAAM+B,MAAM5X,OAAS,GAAIqU,EAASuT,aAAc,QAAS,IAAIntB,MAAMotB,uBAAwBhS,EAAM+B,MAAO/B,EAAMsF,SAC9G+L,EAAGtP,MAAM5X,OAAS,GAAIqU,EAASuT,aAAc,KAAM,IAAIntB,MAAMotB,uBAAwBX,EAAGtP,MAAOsP,EAAG/L,SAClGgM,EAAIvP,MAAM5X,OAAS,GAAIqU,EAASuT,aAAc,MAAO,IAAIntB,MAAMotB,uBAAwBV,EAAIvP,MAAOuP,EAAIhM,SAEtGgE,EAAgBnf,OAAS,GAAIqU,EAASuT,aAAc,YAAa,IAAIntB,MAAMotB,uBAAwB1I,EAAiBA,IACpHE,EAAiBrf,OAAS,GAAIqU,EAASuT,aAAc,aAAc,IAAIntB,MAAMotB,uBAAwBxI,EAAkBA,IAE5HhG,EAAMje,KAAOiZ,EACbgF,EAAM5c,KAAOgqB,EAAY,GAAIhqB,KAC7B4c,EAAMgO,aAAeA,EAEdhO,EAIT,SAASsO,GAAmBvB,EAAWvF,EAAQrmB,EAAQod,GAErD,IAAIqC,EAAUmM,EAAUlZ,EACpBiO,EAASiL,EAAUjL,OACnBkD,EAAS+H,EAAU/H,OAEvB,SAASyJ,EAAY/nB,GAKnB,IAHA,IAAIM,EAAQ4Z,EAASla,EAAIvF,GAAWutB,EAChC/nB,EAASK,EAAQ0nB,EAEb1nB,EAAQL,EAAQK,IAEtBuX,EAAM9C,KAAMkT,EAAa3nB,IAM7B,IAAI2nB,EAAcnH,EAAOjJ,MACrBmQ,EAAelH,EAAO1F,OAE1B,QAA0B9E,IAArB+P,EAAU/H,OAIb,IAFA,IAAIhe,EAAQ,EAEFN,EAAI,EAAGsQ,EAAIgO,EAAOre,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAEhD,IAAIsmB,EAAQhI,EAAQte,GAEpB,GAAe,IAAVsmB,EAAc,CAEjB,IACIpK,EAAI5b,EAAiB,EAAT8a,EACZ8M,EAAI5nB,EAAiB,EAAT8a,EACZqE,EAAInf,EAAiB,EAAT8a,EAEhB2M,EALQznB,EAAiB,EAAT8a,GAKC2M,EAAY7L,GAAK6L,EAAYtI,GAC9CsI,EAAY7L,GAAK6L,EAAYG,GAAKH,EAAYtI,QAEzC,GAAe,IAAV6G,EAAc,CAGpBpK,EAAI5b,EAAiB,EAAT8a,EACZ8M,EAAI5nB,EAAiB,EAAT8a,EAEhB2M,EAJQznB,EAAiB,EAAT8a,GAIC2M,EAAY7L,GAAK6L,EAAYG,QAEzC,GAAK5B,EAAQ,EAElB,IAAM,IAAI9Z,EAAI,EAAG2b,EAAO7B,EAAQ,EAAK9Z,GAAK2b,EAAI3b,IAAO,CAG/C0P,EAAI5b,EAAQ8a,EAAS5O,EACrB0b,EAAI5nB,EAAQ8a,GAAW5O,EAAI,GAE/Bub,EAJQznB,EAAiB,EAAT8a,GAIC2M,EAAY7L,GAAK6L,EAAYG,GAMlD5nB,GAAS8a,EAASkL,OAMpB,IAAUtmB,EAAI,EAAGsQ,EAAI4J,EAAQja,OAAQD,EAAIsQ,EAAGtQ,GAAKob,EAE/C2M,EAAY/nB,GAQlB,SAASooB,GAAa3mB,GAEpB,OAAO8X,EAAUL,GAAQsF,WAAY/c,GAAMmlB,IAkC7C,SAASyB,GAAsBhtB,GAE7B,YAAoBib,IAAfjb,EAAKie,MAA6Bje,EAAKie,MAErCje,EAUT,SAASitB,GAAgC1Q,EAAKvc,GAE5C,IAAM,IAAI2E,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,QACH3c,EAAK6iB,OAAQnG,EAAMjc,aAAc,QAAYysB,GAAsBxQ,GACnE,MAEF,IAAK,OACH1c,EAAKmtB,MAAMzT,KAAM0T,GAAqB1Q,MAS9C,SAASwQ,GAAsB3Q,GAI7B,IAFA,IAAIvc,EAEM2E,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,YACL,IAAK,WACH3c,EAAOqtB,GAA+B3Q,IAO5C,OAAO1c,EAIT,SAASqtB,GAA+B9Q,EAAKvc,GAEvCA,EAAO,CACTye,IAAKlC,EAAI9b,aAAc,OACvB6T,KAAMiI,EAAI9b,aAAc,SAAY,GACpC+V,KAAM,IAAInX,MAAMC,QAChBguB,OAAQ,CACN9oB,IAAK,EACLF,IAAK,GAEPjD,KAAMkb,EAAII,SACV4Q,QAAQ,EACRC,aAAc,EACdC,eAAgB,GAGlB,IAdA,IAcU9oB,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,OACH,IAAIH,EAAQQ,EAAaN,EAAMe,aAC/Bzd,EAAKwW,KAAKgL,UAAWhF,GACrB,MACF,IAAK,SACH,IAAIlY,EAAMoY,EAAMJ,qBAAsB,OAAS,GAC3C9X,EAAMkY,EAAMJ,qBAAsB,OAAS,GAE/Ctc,EAAKstB,OAAOhpB,IAAM2Y,WAAY3Y,EAAImZ,aAClCzd,EAAKstB,OAAO9oB,IAAMyY,WAAYzY,EAAIiZ,cAmBxC,OAVKzd,EAAKstB,OAAO9oB,KAAOxE,EAAKstB,OAAOhpB,MAElCtE,EAAKutB,QAAS,GAMhBvtB,EAAKytB,gBAAmBztB,EAAKstB,OAAO9oB,IAAMxE,EAAKstB,OAAOhpB,KAAQ,EAEvDtE,EAIT,SAASotB,GAAqB7Q,GAS5B,IAPA,IAAIvc,EAAO,CACTye,IAAKlC,EAAI9b,aAAc,OACvB6T,KAAMiI,EAAI9b,aAAc,SAAY,GACpCitB,YAAa,GACbpN,WAAY,IAGJ3b,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,kBACH3c,EAAK0tB,YAAYhU,KAAMiU,GAA2BjR,IAClD,MAEF,IAAK,SACL,IAAK,YACL,IAAK,SACH1c,EAAKsgB,WAAW5G,KAAMkU,GAA0BlR,KAOtD,OAAO1c,EAIT,SAAS2tB,GAA2BpR,GAQlC,IANA,IAAIvc,EAAO,CACT6tB,MAAOtR,EAAI9b,aAAc,SAAU2Y,MAAO,KAAM0U,MAChDxN,WAAY,GACZ6M,MAAO,IAGCxoB,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,OACH3c,EAAKmtB,MAAMzT,KAAM0T,GAAqB1Q,IACtC,MAEF,IAAK,SACL,IAAK,YACL,IAAK,SACH1c,EAAKsgB,WAAW5G,KAAMkU,GAA0BlR,KAOtD,OAAO1c,EAIT,SAAS4tB,GAA0BrR,GAEjC,IAAIvc,EAAO,CACTqB,KAAMkb,EAAII,UAGRH,EAAQQ,EAAaT,EAAIkB,aAE7B,OAASzd,EAAKqB,MAEZ,IAAK,SACHrB,EAAK+tB,IAAM,IAAI1uB,MAAMilB,QACrBtkB,EAAK+tB,IAAIvM,UAAWhF,GAAQiE,YAC5B,MAEF,IAAK,YACHzgB,EAAK+tB,IAAM,IAAI1uB,MAAMC,QACrBU,EAAK+tB,IAAIvM,UAAWhF,GACpB,MAEF,IAAK,SACHxc,EAAK+tB,IAAM,IAAI1uB,MAAMC,QACrBU,EAAK+tB,IAAIvM,UAAWhF,GACpBxc,EAAKguB,MAAQ3uB,MAAM+C,KAAKC,SAAUma,EAAO,IAK7C,OAAOxc,EAkCT,SAASiuB,GAAuB1R,EAAKvc,GAEnC,IAAM,IAAI2E,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,mBACHuR,GAA6BxR,EAAO1c,KAS5C,SAASkuB,GAA6B3R,EAAKvc,GAEzC,IAAM,IAAI2E,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,UACH3c,EAAKmuB,QAAUnR,EAAaN,EAAMe,aAClC,MAEF,IAAK,OACHzd,EAAKouB,KAAOpR,EAAaN,EAAMe,aAAe,KAqCtD,SAAS4Q,GAA8B9R,GAMrC,IAJA,IAAIvc,EAAO,CACT2F,OAAQ4W,EAAI9b,aAAc,UAAW2Y,MAAO,KAAM0U,OAG1CnpB,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,OACH,IAAI2R,EAAQ5R,EAAMJ,qBAAsB,SAAW,GACnDtc,EAAKwW,KAAO8X,EAAM7Q,YAClB,IAAI8Q,EAAgBvuB,EAAKwW,KAAK4C,MAAO,SAAU0U,MAAM1U,MAAO,QAAU,GACtEpZ,EAAKwuB,WAAaD,EAAcE,OAAQ,EAAGF,EAAc3pB,OAAS,IAOxE,OAAO5E,EAIT,SAAS0uB,GAAsB1uB,GAE7B,YAAoBib,IAAfjb,EAAKie,MAA6Bje,EAAKie,MAErCje,EA0LT,SAAS2uB,GAAoBxO,GAM3B,IAJA,IAAIG,EAAa,GAEb/D,EAAMqS,GAAQC,cAAe,QAAU1O,EAAK/Z,GAAK,MAE3CzB,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,SACH,IAAIH,EAAQQ,EAAaN,EAAMe,aAC3B+C,GAAS,IAAInhB,MAAMilB,SAAU9C,UAAWhF,GAAQiE,YACpDH,EAAW5G,KAAM,CACf+E,IAAK/B,EAAMjc,aAAc,OACzBY,KAAMqb,EAAMC,SACZoR,IAAKvN,IAEP,MAEF,IAAK,YACL,IAAK,QACChE,EAAQQ,EAAaN,EAAMe,aAA/B,IACIqR,GAAS,IAAIzvB,MAAMC,SAAUkiB,UAAWhF,GAC5C8D,EAAW5G,KAAM,CACf+E,IAAK/B,EAAMjc,aAAc,OACzBY,KAAMqb,EAAMC,SACZoR,IAAKe,IAEP,MAEF,IAAK,SACCtS,EAAQQ,EAAaN,EAAMe,aAC3BqR,GAAS,IAAIzvB,MAAMC,SAAUkiB,UAAWhF,GAD5C,IAEIwR,EAAQ3uB,MAAM+C,KAAKC,SAAUma,EAAO,IACxC8D,EAAW5G,KAAM,CACf+E,IAAK/B,EAAMjc,aAAc,OACzBY,KAAMqb,EAAMC,SACZoR,IAAKe,EACLd,MAAOA,KAQf,OAAO1N,EA0BT,IAAIE,GAAS,IAAInhB,MAAMilB,QACnBwK,GAAS,IAAIzvB,MAAMC,QAEvB,SAASyvB,GAAWxS,GAiBlB,IAfA,IAAIvc,EAAO,CACTsU,KAAMiI,EAAI9b,aAAc,SAAY,GACpCY,KAAMkb,EAAI9b,aAAc,QACxB2F,GAAImW,EAAI9b,aAAc,MACtBge,IAAKlC,EAAI9b,aAAc,OACvB+f,OAAQ,IAAInhB,MAAMilB,QAClBlE,MAAO,GACP4O,gBAAiB,GACjBC,oBAAqB,GACrBC,eAAgB,GAChBC,mBAAoB,GACpBC,cAAe,GACf9O,WAAY,IAGJ3b,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,OACH3c,EAAKogB,MAAM1G,KAAMgD,EAAMjc,aAAc,OACrCsuB,GAAWrS,GACX,MAEF,IAAK,kBACH1c,EAAKgvB,gBAAgBtV,KAAM0D,EAASV,EAAMjc,aAAc,SACxD,MAEF,IAAK,sBACHT,EAAKivB,oBAAoBvV,KAAM2V,GAAmB3S,IAClD,MAEF,IAAK,iBACH1c,EAAKkvB,eAAexV,KAAM0D,EAASV,EAAMjc,aAAc,SACvD,MAEF,IAAK,oBACHT,EAAKmvB,mBAAmBzV,KAAM2V,GAAmB3S,IACjD,MAEF,IAAK,gBACH1c,EAAKovB,cAAc1V,KAAM0D,EAASV,EAAMjc,aAAc,SACtD,MAEF,IAAK,SACH,IAAI+b,EAAQQ,EAAaN,EAAMe,aAC/Bzd,EAAKwgB,OAAO8O,SAAU9O,GAAOgB,UAAWhF,GAAQiE,aAChDzgB,EAAKsgB,WAAY5D,EAAMjc,aAAc,QAAYic,EAAMC,SACvD,MAEF,IAAK,YACCH,EAAQQ,EAAaN,EAAMe,aAC/BqR,GAAOtN,UAAWhF,GAClBxc,EAAKwgB,OAAO8O,SAAU9O,GAAO+O,gBAAiBT,GAAO3sB,EAAG2sB,GAAOvsB,EAAGusB,GAAOhrB,IACzE9D,EAAKsgB,WAAY5D,EAAMjc,aAAc,QAAYic,EAAMC,SACvD,MAEF,IAAK,SACCH,EAAQQ,EAAaN,EAAMe,aAA/B,IACIuQ,EAAQ3uB,MAAM+C,KAAKC,SAAUma,EAAO,IACxCxc,EAAKwgB,OAAO8O,SAAU9O,GAAOgP,iBAAkBV,GAAOtN,UAAWhF,GAASwR,IAC1EhuB,EAAKsgB,WAAY5D,EAAMjc,aAAc,QAAYic,EAAMC,SACvD,MAEF,IAAK,QACCH,EAAQQ,EAAaN,EAAMe,aAC/Bzd,EAAKwgB,OAAOS,MAAO6N,GAAOtN,UAAWhF,IACrCxc,EAAKsgB,WAAY5D,EAAMjc,aAAc,QAAYic,EAAMC,SACvD,MAEF,IAAK,QACH,MAEF,QACE5T,QAAQC,IAAK0T,IAgBnB,OAVK+S,GAASzvB,EAAKoG,IAEjB2C,QAAQqT,KAAM,yGAA0Gpc,EAAKoG,IAI7HyX,GAAQuC,MAAOpgB,EAAKoG,IAAOpG,EAItBA,EAIT,SAASqvB,GAAmB9S,GAQ1B,IANA,IAAIvc,EAAO,CACToG,GAAIgX,EAASb,EAAI9b,aAAc,QAC/BooB,UAAW,GACX6G,UAAW,IAGH/qB,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,OAAS+X,EAAMC,UAEb,IAAK,gBAGH,IAFA,IAAIgT,EAAYjT,EAAMJ,qBAAsB,qBAElC2D,EAAI,EAAGA,EAAI0P,EAAU/qB,OAAQqb,IAAO,CAE5C,IAAI2P,EAAWD,EAAW1P,GACtB4P,EAASD,EAASnvB,aAAc,UAChCkF,EAASiqB,EAASnvB,aAAc,UAEpCT,EAAK6oB,UAAWgH,GAAWzS,EAASzX,GAItC,MAEF,IAAK,WACH3F,EAAK0vB,UAAUhW,KAAM0D,EAASV,EAAMe,eAU1C,OAAOzd,EAIT,SAAS8vB,GAAeJ,EAAW7M,GAEjC,IAGIle,EAAM3E,EA2baoG,EA9bnB2pB,EAAW,GACXC,EAAiB,GAOrB,IAAMrrB,EAAI,EAAGA,EAAI+qB,EAAU9qB,OAAQD,IAAO,CAExC,IAAIsrB,EAAWP,EAAW/qB,GAI1B,GAAK8qB,GAASQ,GAGZC,GADOpb,GAASmb,GACUpN,EAAQkN,QAE7B,GA2ac3pB,EA3aO6pB,OA6aQhV,IAA/B4C,GAAQsS,aAAc/pB,GAtazB,IAHA,IACIgqB,EADcvS,GAAQsS,aAAcF,GACbG,SAEjBnQ,EAAI,EAAGA,EAAImQ,EAASxrB,OAAQqb,IAAO,CAE3C,IAAIvD,EAAQ0T,EAAUnQ,GAEtB,GAAoB,UAAfvD,EAAMrb,KAGT6uB,GADWpb,GAAS4H,EAAMtW,IACAyc,EAAQkN,QAQtChnB,QAAQsnB,MAAO,qEAAsEJ,GAQzF,IAAMtrB,EAAI,EAAGA,EAAIke,EAAOje,OAAQD,IAE9B,IAAMsb,EAAI,EAAGA,EAAI8P,EAASnrB,OAAQqb,IAIhC,IAFAjgB,EAAO+vB,EAAU9P,IAEPqQ,KAAKhc,OAASuO,EAAQle,GAAI2P,KAAO,CAEzC0b,EAAgBrrB,GAAM3E,EACtBA,EAAKuwB,WAAY,EACjB,MAUN,IAAM5rB,EAAI,EAAGA,EAAIorB,EAASnrB,OAAQD,KAIR,KAFxB3E,EAAO+vB,EAAUprB,IAEP4rB,YAERP,EAAetW,KAAM1Z,GACrBA,EAAKuwB,WAAY,GAQrB,IAAIC,EAAQ,GACRC,EAAe,GAEnB,IAAM9rB,EAAI,EAAGA,EAAIqrB,EAAeprB,OAAQD,IAEtC3E,EAAOgwB,EAAgBrrB,GAEvB6rB,EAAM9W,KAAM1Z,EAAKswB,MACjBG,EAAa/W,KAAM1Z,EAAKwkB,aAI1B,OAAO,IAAInlB,MAAMqxB,SAAUF,EAAOC,GAIpC,SAASP,GAAoBS,EAAM9N,EAAQkN,GAIzCY,EAAKtW,UAAU,SAAWC,GAExB,IAAuB,IAAlBA,EAAOsW,OAAkB,CAM5B,IAJA,IAAIpM,EAIM7f,EAAI,EAAGA,EAAIke,EAAOje,OAAQD,IAAO,CAEzC,IAAIkpB,EAAQhL,EAAQle,GAEpB,GAAKkpB,EAAMvZ,OAASgG,EAAOhG,KAAO,CAEhCkQ,EAAcqJ,EAAMrJ,YACpB,YAMiBvJ,IAAhBuJ,IAQHA,EAAc,IAAInlB,MAAMilB,SAI1ByL,EAASrW,KAAM,CAAE4W,KAAMhW,EAAQkK,YAAaA,EAAa+L,WAAW,QAQ1E,SAASM,GAAW7wB,GAelB,IAbA,IA94EsBoG,EA84ElB0qB,EAAU,GAEVtQ,EAASxgB,EAAKwgB,OACdJ,EAAQpgB,EAAKogB,MACb/e,EAAOrB,EAAKqB,KACZ2tB,EAAkBhvB,EAAKgvB,gBACvBC,EAAsBjvB,EAAKivB,oBAC3BC,EAAiBlvB,EAAKkvB,eACtBC,EAAqBnvB,EAAKmvB,mBAC1BC,EAAgBpvB,EAAKovB,cAIfzqB,EAAI,EAAGsQ,EAAImL,EAAMxb,OAAQD,EAAIsQ,EAAGtQ,IAExCmsB,EAAQpX,KAAM5E,GAASsL,EAAOzb,KAMhC,IAAUA,EAAI,EAAGsQ,EAAI+Z,EAAgBpqB,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAEzD,IAAIosB,EAAiBnH,EAAWoF,EAAiBrqB,IAEzB,OAAnBosB,GAEHD,EAAQpX,KAAMqX,EAAexoB,SAQjC,IAAU5D,EAAI,EAAGsQ,EAAIga,EAAoBrqB,OAAQD,EAAIsQ,EAAGtQ,IAYtD,IAVA,IAAIirB,EAAWX,EAAqBtqB,GAChCzD,GAp7EgBkF,EAo7EYwpB,EAASxpB,GAl7EpC8X,EAAUL,GAAQnc,YAAa0E,GAAM8c,IAo7EtC8N,EAAaC,GADAlE,GAAa7rB,EAAWkF,IACEwpB,EAAS/G,WAKhDoH,EAAWH,GAHCF,EAASF,UACZxuB,EAAWkiB,KAAKP,QAInB5C,EAAI,EAAGC,EAAK8Q,EAAWpsB,OAAQqb,EAAIC,EAAID,IAAO,CAEtD,IAAI3F,KAAS0W,EAAY/Q,IAEbiR,gBAEV5W,EAAO9S,KAAMyoB,EAAU/uB,EAAWkiB,KAAKiB,YACvC/J,EAAO6W,wBAITL,EAAQpX,KAAMY,GAQlB,IAAU3V,EAAI,EAAGsQ,EAAIia,EAAetqB,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAIysB,EAAgBzG,GAAUuE,EAAgBvqB,IAEvB,OAAlBysB,GAEHN,EAAQpX,KAAM0X,EAAc7oB,SAQhC,IAAU5D,EAAI,EAAGsQ,EAAIka,EAAmBvqB,OAAQD,EAAIsQ,EAAGtQ,IAUrD,IAAUsb,EAAI,EAAGC,GAFb8Q,EAAaC,GADAlE,IALb6C,EAAWT,EAAoBxqB,IAKIyB,IACIwpB,EAAS/G,YAEnBjkB,OAAQqb,EAAIC,EAAID,IAE/C6Q,EAAQpX,KAAMsX,EAAY/Q,IAQ9B,IAAUtb,EAAI,EAAGsQ,EAAIma,EAAcxqB,OAAQD,EAAIsQ,EAAGtQ,IAEhDmsB,EAAQpX,KAAM5E,GAASsa,EAAezqB,IAAM4D,SAM9C,GAAsB,IAAjB6X,EAAMxb,QAAmC,IAAnBksB,EAAQlsB,OAEjC0V,EAASwW,EAAS,OAEb,CAELxW,EAAoB,UAATjZ,EAAqB,IAAIhC,MAAMgyB,KAAS,IAAIhyB,MAAMiyB,MAE7D,IAAU3sB,EAAI,EAAGA,EAAImsB,EAAQlsB,OAAQD,IAEnC2V,EAAO1Z,IAAKkwB,EAASnsB,IAezB,MATqB,KAAhB2V,EAAOhG,OAEVgG,EAAOhG,KAAkB,UAATjT,EAAqBrB,EAAKye,IAAMze,EAAKsU,MAIvDgG,EAAOkG,OAAOhgB,KAAMggB,GACpBlG,EAAOkG,OAAOiB,UAAWnH,EAAO/a,SAAU+a,EAAOlF,WAAYkF,EAAO2G,OAE7D3G,EAIT,IAAIiX,GAAmB,IAAIlyB,MAAMqnB,kBAAmB,CAAEjM,MAAO,WAE7D,SAAS+W,GAAwBzsB,EAAM0sB,GAIrC,IAFA,IAAI5I,EAAY,GAENlkB,EAAI,EAAGsQ,EAAIlQ,EAAKH,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAE9C,IAAIyB,EAAKqrB,EAAmB1sB,EAAMJ,SAEtBsW,IAAP7U,GAEH2C,QAAQqT,KAAM,gFAAiFrX,EAAMJ,IACrGkkB,EAAUnP,KAAM6X,KAIhB1I,EAAUnP,KAAMkP,EAAaxiB,IAMjC,OAAOyiB,EAIT,SAASoI,GAAc9N,EAAYsO,GAEjC,IAAIX,EAAU,GAEd,IAAM,IAAIzvB,KAAQ8hB,EAAa,CAE7B,IAAIlK,EAAWkK,EAAY9hB,GAEvBwnB,EAAY2I,GAAwBvY,EAASgT,aAAcwF,GAIrC,IAArB5I,EAAUjkB,SAEC,UAATvD,GAA6B,eAATA,EAEvBwnB,EAAUnP,KAAM,IAAIra,MAAMqyB,mBAI1B7I,EAAUnP,KAAM,IAAIra,MAAMmnB,oBAQ9B,IAAImL,OAAoD1W,IAAvChC,EAASjZ,KAAK4xB,WAAW7N,UAE1C,GAAK4N,EAEH,IAAM,IAAIhtB,EAAI,EAAGsQ,EAAI4T,EAAUjkB,OAAQD,EAAIsQ,EAAGtQ,IAE5CkkB,EAAWlkB,GAAIgtB,UAAW,EAQ9B,IAIIrX,EAJAE,EAAkC,IAArBqO,EAAUjkB,OAAiBikB,EAAW,GAAMA,EAM7D,OAASxnB,GAEP,IAAK,QACHiZ,EAAS,IAAIjb,MAAMwyB,aAAc5Y,EAASjZ,KAAMwa,GAChD,MAEF,IAAK,aACHF,EAAS,IAAIjb,MAAMyyB,KAAM7Y,EAASjZ,KAAMwa,GACxC,MAEF,IAAK,YACL,IAAK,WAGDF,EAFGqX,EAEM,IAAItyB,MAAM0yB,YAAa9Y,EAASjZ,KAAMwa,GAItC,IAAInb,MAAM2yB,KAAM/Y,EAASjZ,KAAMwa,GAO9CsW,EAAQpX,KAAMY,GAIhB,OAAOwW,EAIT,SAASrB,GAASrpB,GAEhB,YAA+B6U,IAAxB4C,GAAQuC,MAAOha,GAIxB,SAAS0O,GAAS1O,GAEhB,OAAO8X,EAAUL,GAAQuC,MAAOha,GAAMyqB,IA2BxC,SAASoB,GAAkBjyB,GAEzB,IAAIkyB,EAAQ,IAAI7yB,MAAMiyB,MACtBY,EAAM5d,KAAOtU,EAAKsU,KAIlB,IAFA,IAAI8b,EAAWpwB,EAAKowB,SAEVzrB,EAAI,EAAGA,EAAIyrB,EAASxrB,OAAQD,IAAO,CAE3C,IAAI+X,EAAQ0T,EAAUzrB,GAEtButB,EAAMtxB,IAAKkU,GAAS4H,EAAMtW,KAI5B,OAAO8rB,EAUT,SAASC,GAAgB/rB,GAEvB,OAAO8X,EAAUL,GAAQsS,aAAc/pB,GAAM6rB,IAqD/C,GAAqB,IAAhBlW,EAAKnX,OAER,MAAO,CAAEwV,MAAO,IAAI/a,MAAM+yB,OAI5B,IAEIxD,GAAUtS,GAFJ,IAAI+V,WAAYC,gBAAiBvW,EAAM,mBAER,WAAa,GAIlDwW,GAAU3D,GAAQnuB,aAAc,WACpCsI,QAAQC,IAAK,oCAAqCupB,IAElD,IAIItL,GAJAuL,GAvlHJ,SAAqBjW,GAEnB,MAAO,CACLkW,KAAMlV,EAAgBjB,EAAsBC,EAAK,QAAU,IAC3DmW,OAAQlV,EAAkBlB,EAAsBC,EAAK,WAAa,KAmlH1DoW,CAAYrW,EAAsBsS,GAAS,SAAW,IAC9D1H,GAAgB,IAAI7nB,MAAMuzB,cAAe5zB,KAAKgc,SAClDkM,GAAcpL,QAAS9c,KAAKkd,cAAgBR,GAAOW,eAAgBrd,KAAKoc,aAInE/b,MAAMwzB,YAET5L,GAAY,IAAI5nB,MAAMwzB,UAAW7zB,KAAKgc,UAC5Bc,QAAS9c,KAAKkd,cAAgBR,GAM1C,IAAI1C,GAAa,GACb8Z,GAAa,GACb7H,GAAQ,EAIRpN,GAAU,CACZ7E,WAAY,GACZD,MAAO,GACPrX,YAAa,GACbqjB,OAAQ,GACRuB,QAAS,GACTuC,UAAW,GACXgB,QAAS,GACTe,OAAQ,GACRzH,WAAY,GACZ/C,MAAO,GACP+P,aAAc,GACd4C,iBAAkB,GAClBC,cAAe,GACfC,iBAAkB,IAGpBvV,EAAckR,GAAS,qBAAsB,aAnjH7C,SAAyBrS,GAQvB,IANA,IAAIvc,EAAO,CACTmf,QAAS,GACTD,SAAU,GACVD,SAAU,IAGFta,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAIIyB,EAJAsW,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAIX,OAAS3B,EAAMC,UAEb,IAAK,SACHvW,EAAKsW,EAAMjc,aAAc,MACzBT,EAAKmf,QAAS/Y,GAAOwc,GAAalG,GAClC,MAEF,IAAK,UACHtW,EAAKsW,EAAMjc,aAAc,MACzBT,EAAKkf,SAAU9Y,GAAO+X,EAAuBzB,GAC7C,MAEF,IAAK,UACHtW,EAAKsW,EAAMjc,aAAc,UACzBT,EAAKif,SAAU7Y,GAAOmY,EAAuB7B,GAC7C,MAEF,QACE3T,QAAQC,IAAK0T,IAMnBmB,GAAQ7E,WAAYuD,EAAI9b,aAAc,OAAWT,KA4gHnD0d,EAAckR,GAAS,0BAA2B,kBAznGlD,SAA6BrS,GAS3B,IAPA,IAAIvc,EAAO,CACTsU,KAAMiI,EAAI9b,aAAc,OAAU,UAClC8T,MAAO0I,WAAYV,EAAI9b,aAAc,UAAa,GAClD+T,IAAKyI,WAAYV,EAAI9b,aAAc,QAAW,GAC9CuY,WAAY,IAGJrU,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,qBACH3c,EAAKgZ,WAAWU,KAAM0D,EAASV,EAAMjc,aAAc,UAOzDod,GAAQ9E,MAAOwD,EAAI9b,aAAc,OAAWT,KAimG9C0d,EAAckR,GAAS,sBAAuB,cA7jG9C,SAA0BrS,GAIxB,IAFA,IAAIvc,EAAO,GAED2E,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,OAEH3c,EAAKoG,GAAKgX,EAASV,EAAMjc,aAAc,WACvCT,EAAKojB,KAAOV,EAAWhG,GACvB,MAEF,IAAK,QACH1c,EAAKoG,GAAKgX,EAASV,EAAMjc,aAAc,WACvCsI,QAAQqT,KAAM,mEAOpByB,GAAQnc,YAAa6a,EAAI9b,aAAc,OAAWT,KAmiGpD0d,EAAckR,GAAS,iBAAkB,SAtyFzC,SAAqBrS,GAEnB,IAAIvc,EAAO,CACT6kB,UAAWvI,EAAsBC,EAAK,aAAe,GAAIkB,aAG3DI,GAAQkH,OAAQxI,EAAI9b,aAAc,OAAWT,KAiyF/C0d,EAAckR,GAAS,kBAAmB,UAnwF1C,SAAsBrS,GAIpB,IAFA,IAAIvc,EAAO,GAED2E,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,iBACH3c,EAAKumB,QAAUvB,EAA0BtI,IAO/CmB,GAAQyI,QAAS/J,EAAI9b,aAAc,OAAWT,KAgvFhD0d,EAAckR,GAAS,oBAAqB,YAv4E5C,SAAwBrS,GAMtB,IAJA,IAAIvc,EAAO,CACTsU,KAAMiI,EAAI9b,aAAc,SAGhBkE,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,kBACH3c,EAAKqb,IAAM+B,EAASV,EAAMjc,aAAc,SAO9Cod,GAAQgL,UAAWtM,EAAI9b,aAAc,OAAWT,KAk3ElD0d,EAAckR,GAAS,kBAAmB,UAjoE1C,SAAsBrS,GAMpB,IAJA,IAAIvc,EAAO,CACTsU,KAAMiI,EAAI9b,aAAc,SAGhBkE,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,SACH3c,EAAKkpB,OAASJ,EAAmBpM,IAOvCmB,GAAQgM,QAAStN,EAAI9b,aAAc,OAAWT,KA4mEhD0d,EAAckR,GAAS,iBAAkB,SAh+DzC,SAAqBrS,GAInB,IAFA,IAAIvc,EAAO,GAED2E,EAAI,EAAGsQ,EAAIsH,EAAIE,WAAW7X,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAExD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,mBACH3c,EAAO8pB,GAAqBpN,IAOlCmB,GAAQ+M,OAAQrO,EAAI9b,aAAc,OAAWT,KA68D/C0d,EAAckR,GAAS,qBAAsB,YA11D7C,SAAwBrS,GAEtB,IAAIvc,EAAO,CACTsU,KAAMiI,EAAI9b,aAAc,QACxB0e,QAAS,GACTqM,SAAU,GACVH,WAAY,IAGV6H,EAAO5W,EAAsBC,EAAK,QAAU,GAGhD,QAActB,IAATiY,EAAL,CAEA,IAAM,IAAIvuB,EAAI,EAAGA,EAAIuuB,EAAKzW,WAAW7X,OAAQD,IAAO,CAElD,IAAI+X,EAAQwW,EAAKzW,WAAY9X,GAE7B,GAAwB,IAAnB+X,EAAM2B,SAAX,CAEA,IAAIjY,EAAKsW,EAAMjc,aAAc,MAE7B,OAASic,EAAMC,UAEb,IAAK,SACH3c,EAAKmf,QAAS/Y,GAAOwc,GAAalG,GAClC,MAEF,IAAK,WAEH1c,EAAKwrB,SAAWV,GAAuBpO,GACvC,MAEF,IAAK,WACH3T,QAAQqT,KAAM,oDAAqDM,EAAMC,UACzE,MAEF,IAAK,QACL,IAAK,aACL,IAAK,WACL,IAAK,YACH3c,EAAKqrB,WAAW3R,KAAMqR,GAAwBrO,IAC9C,MAEF,QACE3T,QAAQC,IAAK0T,KAMnBmB,GAAQsF,WAAY5G,EAAI9b,aAAc,OAAWT,MAwyDnD0d,EAAckR,GAAS,gBAAiB,OAAQG,IAChDrR,EAAckR,GAAS,wBAAyB,gBApKhD,SAA2BrS,GAEzB,IAAIvc,EAAO,CACTsU,KAAMiI,EAAI9b,aAAc,QACxB2vB,SAAU,KAnkBd,SAAuB7T,GAMrB,IAJA,IAAIuB,EAAWvB,EAAID,qBAAsB,QAI/B3X,EAAI,EAAGA,EAAImZ,EAASlZ,OAAQD,IAAO,CAE3C,IAAIwuB,EAAUrV,EAAUnZ,IAEc,IAAjCwuB,EAAQne,aAAc,OAEzBme,EAAQlzB,aAAc,KA57FnB,iBAAqBgrB,OAs/G5BmI,CAAc7W,GAId,IAFA,IAAIuB,EAAWxB,EAAsBC,EAAK,QAEhC5X,EAAI,EAAGA,EAAImZ,EAASlZ,OAAQD,IAEpC3E,EAAKowB,SAAS1W,KAAMqV,GAAWjR,EAAUnZ,KAI3CkZ,GAAQsS,aAAc5T,EAAI9b,aAAc,OAAWT,KAoJrD0d,EAAckR,GAAS,4BAA6B,oBAt1CpD,SAA+BrS,GAQ7B,IANA,IAAIvc,EAAO,CACTsU,KAAMiI,EAAI9b,aAAc,SAAY,GACpCoiB,OAAQ,GACRsK,MAAO,IAGCxoB,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,mBACHsQ,GAAgCvQ,EAAO1c,IAO7C6d,GAAQkV,iBAAkBxW,EAAI9b,aAAc,OAAWT,KA+zCzD0d,EAAckR,GAAS,yBAA0B,iBA7lCjD,SAA4BrS,GAO1B,IALA,IAAIvc,EAAO,CACTsU,KAAMiI,EAAI9b,aAAc,SAAY,GACpC4yB,YAAa,IAGL1uB,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,aACH3c,EAAKqzB,YAAa3W,EAAMjc,aAAc,SAAa,GACnDwtB,GAAuBvR,EAAO1c,EAAKqzB,YAAa3W,EAAMjc,aAAc,WAO1Eod,GAAQmV,cAAezW,EAAI9b,aAAc,OAAWT,KAskCtD0d,EAAckR,GAAS,QAAS,6BAphChC,SAA+BrS,GAM7B,IAJA,IAAIvc,EAAO,CACTszB,cAAe,IAGP3uB,EAAI,EAAGA,EAAI4X,EAAIE,WAAW7X,OAAQD,IAAO,CAEjD,IAAI+X,EAAQH,EAAIE,WAAY9X,GAE5B,GAAwB,IAAnB+X,EAAM2B,SAEX,OAAS3B,EAAMC,UAEb,IAAK,kBACH3c,EAAKszB,cAAc5Z,KAAM2U,GAA8B3R,KAO7DmB,GAAQoV,iBAAkB7V,EAASb,EAAI9b,aAAc,SAAcT,KAggCrE+d,EAAcF,GAAQ7E,WAAY+F,GAClChB,EAAcF,GAAQ9E,MAAOuJ,GAC7BvE,EAAcF,GAAQnc,YAAawhB,GACnCnF,EAAcF,GAAQkH,OAAQH,GAC9B7G,EAAcF,GAAQyI,QAASH,GAC/BpI,EAAcF,GAAQgL,UAAWzC,GACjCrI,EAAcF,GAAQgM,QAASZ,GAC/BlL,EAAcF,GAAQ+M,OAAQP,IAC9BtM,EAAcF,GAAQsF,WAAYoI,IAClCxN,EAAcF,GAAQsS,aAAc8B,IArHpC,WAEE,IAAIlZ,EAAQ8E,GAAQ9E,MAEpB,IAA0B,IAArBuE,EAASvE,IAEZ,IAAuC,IAAlCuE,EAASO,GAAQ7E,YAAyB,CAI7C,IAAIgG,EAAS,GAEb,IAAM,IAAI5Y,KAAMyX,GAAQ7E,WAItB,IAFA,IAAIuJ,EAAkB5C,EAAcvZ,GAE1BzB,EAAI,EAAGsQ,EAAIsN,EAAgB3d,OAAQD,EAAIsQ,EAAGtQ,IAElDqa,EAAOtF,KAAM6I,EAAiB5d,IAMlCqU,GAAWU,KAAM,IAAIra,MAAMmjB,cAAe,WAAa,EAAGxD,UAM5D,IAAM,IAAI5Y,KAAM2S,EAEdC,GAAWU,KAAM+I,EAAkBrc,IAuFzCmtB,GA59BA,WAEE,IAAIC,EAAoB1uB,OAAOC,KAAM8Y,GAAQkV,kBAAoB,GAC7DU,EAAoB3uB,OAAOC,KAAM8Y,GAAQoV,kBAAoB,GAC7DS,EAAgB5uB,OAAOC,KAAM8Y,GAAQsS,cAAgB,GAEzD,QAA2BlV,IAAtBuY,QAAyDvY,IAAtBwY,EAAxC,CASA,IAPA,IA7W2BrtB,EA6WvButB,GA7WuBvtB,EA6WeotB,EA3WnCtV,EAAUL,GAAQkV,iBAAkB3sB,GAAM4mB,KA4W7C4G,EAfN,SAA6BxtB,GAE3B,OAAO8X,EAAUL,GAAQoV,iBAAkB7sB,GAAMsoB,IAa3BmF,CAAoBJ,GACtCK,EAAc3B,GAAgBuB,GAE9BJ,EAAgBM,EAAgBN,cAChCS,EAAW,GAELpvB,EAAI,EAAGsQ,EAAIqe,EAAc1uB,OAAQD,EAAIsQ,EAAGtQ,IAAO,CAEvD,IAAI6R,EAAO8c,EAAe3uB,GAItBqvB,EAAgBpF,GAAQC,cAAe,SAAWrY,EAAK7Q,OAAS,MAEpE,GAAKquB,EAAgB,CAInB,IAAIC,EAAsBD,EAAcE,cAIxCC,EAAS3d,EAAKgY,WAAYyF,IA4B9B,IAAIG,EAAK,IAAI/0B,MAAMilB,QAEnBwO,GAAa,CAEXjQ,OAAQ8Q,GAAmBA,EAAgB9Q,OAE3CwR,cAAe,SAAW7F,GAExB,IAAI8F,EAAYP,EAAUvF,GAE1B,GAAK8F,EAEH,OAAOA,EAAU/0B,SAIjBwJ,QAAQqT,KAAM,8BAAgCoS,EAAa,oBAM/D+F,cAAe,SAAW/F,EAAYtnB,GAEpC,IAAIotB,EAAYP,EAAUvF,GAE1B,GAAK8F,EAAY,CAEf,IAAIzG,EAAQyG,EAAUzG,MAEtB,GAAK3mB,EAAQ2mB,EAAMP,OAAOhpB,KAAO4C,EAAQ2mB,EAAMP,OAAO9oB,IAEpDuE,QAAQqT,KAAM,8BAAgCoS,EAAa,UAAYtnB,EAAQ,4BAA8B2mB,EAAMP,OAAO9oB,IAAM,UAAYqpB,EAAMP,OAAOhpB,IAAM,WAE1J,GAAKupB,EAAMN,OAEhBxkB,QAAQqT,KAAM,8BAAgCoS,EAAa,mBAEtD,CAEL,IAAIlU,EAASga,EAAUha,OACnB9D,EAAOqX,EAAMrX,KACb8J,EAAagU,EAAUhU,WAE3BE,GAAO+D,WAIP,IAAM,IAAI5f,EAAI,EAAGA,EAAI2b,EAAW1b,OAAQD,IAAO,CAE7C,IAAI0b,EAAYC,EAAY3b,GAI5B,GAAK0b,EAAU5B,MAAiD,IAA1C4B,EAAU5B,IAAItU,QAASqkB,GAE3C,OAASX,EAAMxsB,MAEb,IAAK,WACHmf,GAAO8O,SAAU8E,EAAG5E,iBAAkBhZ,EAAMnX,MAAM+C,KAAKC,SAAU6E,KACjE,MAEF,IAAK,YACHsZ,GAAO8O,SAAU8E,EAAG7E,gBAAiB/Y,EAAKrU,EAAI+E,EAAOsP,EAAKjU,EAAI2E,EAAOsP,EAAK1S,EAAIoD,IAC9E,MAEF,QACE6B,QAAQqT,KAAM,4CAA8CyR,EAAMxsB,WAOtE,OAASgf,EAAUhf,MAEjB,IAAK,SACHmf,GAAO8O,SAAUjP,EAAU0N,KAC3B,MAEF,IAAK,YACHvN,GAAO8O,SAAU8E,EAAG7E,gBAAiBlP,EAAU0N,IAAI5rB,EAAGke,EAAU0N,IAAIxrB,EAAG8d,EAAU0N,IAAIjqB,IACrF,MAEF,IAAK,QACH0c,GAAOS,MAAOZ,EAAU0N,KACxB,MAEF,IAAK,SACHvN,GAAO8O,SAAU8E,EAAG5E,iBAAkBnP,EAAU0N,IAAK1N,EAAU2N,SASvE1T,EAAOkG,OAAOhgB,KAAMggB,IACpBlG,EAAOkG,OAAOiB,UAAWnH,EAAO/a,SAAU+a,EAAOlF,WAAYkF,EAAO2G,OAEpE8S,EAAUvF,GAAajvB,SAAW2H,QAMpC6B,QAAQC,IAAK,wBAA0BwlB,EAAa,sBAjI1D,SAAS2F,EAAS3F,EAAYgG,GAE5B,IAAIC,EAAoBD,EAAc/zB,aAAc,QAChDotB,EAAQ8F,EAAgB9Q,OAAQ2L,GAEpCsF,EAAYzZ,UAAU,SAAWC,GAE1BA,EAAOhG,OAASmgB,IAEnBV,EAAUvF,GAAe,CACvBlU,OAAQA,EACRgG,WAAYqO,GAAoB6F,GAChC3G,MAAOA,EACPtuB,SAAUsuB,EAAML,mBA26B1BkH,GAEA,IAAIta,GAjIJ,SAAqBmC,GAGnB,OAAO4V,GAAgB/U,EADRd,EAAsBC,EAAK,yBAA2B,GAC5B9b,aAAc,SA8H7Ck0B,CAAYrY,EAAsBsS,GAAS,SAAW,IAUlE,MARsB,SAAjB4D,GAAME,QAETtY,GAAMhF,WAAWwf,aAAc,IAAIv1B,MAAMw1B,OAASzyB,KAAKmC,GAAK,EAAG,EAAG,IAIpE6V,GAAM6G,MAAM5c,eAAgBmuB,GAAMC,MAE3B,CACLzZ,WAAYA,GACZ8Z,WAAYA,GACZjV,QAASA,GACTzD,MAAOA,O,gBCx0Hb/a,MAAMy1B,UAAY,EAAQ,IAO1Bz2B,EAAOC,QAAUC,OAAOC,kBAAkB,YAAa,CACrDC,OAAQ,CACNub,IAAa,CAAE3Y,KAAM,SACrB0zB,YAAa,CAAEp2B,QAAS,KAG1BI,KAAM,WACJC,KAAK6Y,MAAQ,MAGfhV,OAAQ,WACN,MAAM7C,EAAOhB,KAAKgB,KAClB,IAAKA,EAAKga,IAAK,OAEfhb,KAAKmE,SACL,MAAM2W,EAAS,IAAIza,MAAMy1B,UACrB90B,EAAK+0B,aAAajb,EAAOuC,eAAerc,EAAK+0B,aACjDjb,EAAO7B,KAAKjY,EAAKga,IAAKhb,KAAKiZ,KAAKzQ,KAAKxI,QAGvCiZ,KAAM,SAAUJ,GACd7Y,KAAK6Y,MAAQA,EACb7Y,KAAKY,GAAGib,YAAY,OAAQhD,GAC5B7Y,KAAKY,GAAGC,KAAK,eAAgB,CAACib,OAAQ,MAAOjD,MAAOA,KAGtD1U,OAAQ,WACFnE,KAAK6Y,OAAO7Y,KAAKY,GAAGmb,eAAe,Y,cCb3C1c,EAAOC,QAAUe,MAAMy1B,UAAY,WAElC,IAAIE,EACAC,EACAC,EAEJ,SAASJ,EAAW9Z,GAEnBhc,KAAKgc,aAAwBC,IAAZD,EAA0BA,EAAU3b,MAAM6b,sBAmF5D,SAASia,EAAejO,GAEvBloB,KAAKkoB,cAAgBA,EA+xCtB,SAASkO,KA8zBT,SAASC,KA6kBT,SAASC,KAkVT,SAASC,KAwUT,SAASC,EAAcC,EAAQC,GAE9B12B,KAAK22B,GAAK,IAAIC,SAAUH,GACxBz2B,KAAKI,OAAS,EACdJ,KAAK02B,kBAAkCza,IAAjBya,GAA+BA,EAmPtD,SAASG,KAsDT,SAASC,EAAe/Z,GAEvB,IACIxC,EAAQwC,EAAKxC,MADG,qBAEpB,GAAKA,EAGJ,OADc4D,SAAU5D,EAAO,IAIhC,MAAM,IAAI1T,MAAO,uEAKlB,SAASkwB,EAAyBjW,GAEjC,OAAOA,EAAO,WAntHfgV,EAAU7iB,UAAY,CAErBkJ,YAAa2Z,EAEb1Z,YAAa,YAEbnD,KAAM,SAAWoD,EAAKC,EAAQC,EAAYC,GACzC,IAAIzB,EAAO/a,KAEPg3B,EAAoB32B,MAAMsc,YAAYC,eAAgBP,GAEtDvB,EAAS,IAAIza,MAAMwc,WAAY7c,KAAKgc,SACxClB,EAAOmc,gBAAiB,eACxBnc,EAAO7B,KAAMoD,GAAK,SAAWoa,GAE5B,IAEC,IAAIrb,EAAQL,EAAKiC,MAAOyZ,EAAQO,GAChC1a,EAAQlB,GAEP,MAAQiW,GAET6F,YAAY,WAEN1a,GAAUA,EAAS6U,GAExBtW,EAAKiB,QAAQmb,UAAW9a,KAEtB,MAIFE,EAAYC,IAGhBa,eAAgB,SAAWnV,GAG1B,OADAlI,KAAKoc,YAAclU,EACZlI,MAIRgd,MAAO,SAAWoa,EAAWJ,GAE5B,GAknHGK,EAAU,0BAFaZ,EAhnHFW,GAonHXE,YAAcD,EAAQzxB,QAAUyxB,IAAYE,EAA4Bd,EAAQ,EAAGY,EAAQzxB,QAlnHvGowB,GAAU,IAAIO,GAAevZ,MAAOoa,OAE9B,CAEN,IAAII,EAAUD,EAA4BH,GAE1C,IAgnHH,SAA2Bra,GAE1B,IAAIsa,EAAU,CAAE,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,IAAK,IAAK,IAAK,KAAM,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,MAE9GI,EAAS,EAWb,IAAM,IAAI9xB,EAAI,EAAGA,EAAI0xB,EAAQzxB,SAAWD,EAAI,CAG3C,IAVI+xB,WAAS3a,GAFC3c,EAWE,GATY,GAC5B2c,EAAOA,EAAKgL,MAAO0P,EAASr3B,GAC5Bq3B,IACOC,KAOML,EAAS1xB,GAErB,OAAO,EAdT,IAAevF,EAEVs3B,EAkBL,OAAO,EA1oHEC,CAAkBH,GAExB,MAAM,IAAI3wB,MAAO,oCAIlB,GAAKiwB,EAAeU,GAAY,IAE/B,MAAM,IAAI3wB,MAAO,4DAA8DiwB,EAAeU,IAI/FxB,GAAU,IAAIM,GAAatZ,MAAOwa,GA4lHrC,IAA4Bf,EAEvBY,EAtlHH,OAAO,IAAIlB,EAFS,IAAI91B,MAAMuzB,cAAe5zB,KAAKgc,SAAUc,QAASka,GAAoB3Z,eAAgBrd,KAAKoc,cAEpEY,MAAOgZ,KAanDG,EAAcljB,UAAY,CAEzBkJ,YAAaga,EAEbnZ,MAAO,WAENiZ,EAAcj2B,KAAK43B,mBAEnB,IAAI7R,EAAS/lB,KAAK63B,cACdC,EAAW93B,KAAK+3B,cAAehS,GAC/B8D,EAAY7pB,KAAKg4B,eAAgBF,GACjCG,EAAYj4B,KAAKk4B,iBACjBC,GAAc,IAAI/B,GAAiBpZ,MAAOib,GAI9C,OAFAj4B,KAAK21B,WAAYsC,EAAWE,EAAatO,GAElCqM,GAMR0B,iBAAkB,WAEjB,IAAIQ,EAAgB,IAAIC,IAEnB,gBAAiBrC,GAEAA,EAAQsC,YAAYrC,YAE1BnqB,SAAS,SAAWysB,GAElC,IAAIC,EAASD,EAAe,GACxBE,EAAOF,EAAe,GACtBG,EAAeH,EAAe,GAE3BH,EAAcO,IAAKH,IAEzBJ,EAAc92B,IAAKk3B,EAAQ,CAC1BI,QAAS,GACTxH,SAAU,KAKZ,IAAIyH,EAAqB,CAAEC,GAAIL,EAAMC,aAAcA,GACnDN,EAAcllB,IAAKslB,GAASI,QAAQle,KAAMme,GAEnCT,EAAcO,IAAKF,IAEzBL,EAAc92B,IAAKm3B,EAAM,CACxBG,QAAS,GACTxH,SAAU,KAKZ,IAAI2H,EAAoB,CAAED,GAAIN,EAAQE,aAAcA,GACpDN,EAAcllB,IAAKulB,GAAOrH,SAAS1W,KAAMqe,MAM3C,OAAOX,GAORP,YAAa,WAEZ,IAAI9R,EAAS,GACTiT,EAAQ,GAEZ,GAAK,UAAWhD,EAAQiD,QAAU,CAEjC,IAAIC,EAAalD,EAAQiD,QAAQE,MAEjC,IAAM,IAAIC,KAAUF,EAAa,CAEhC,IAAIG,EAAYH,EAAYE,GAO5B,GAHArT,EAFI3e,EAAK+W,SAAUib,IAEJC,EAAUC,kBAAoBD,EAAUE,SAGlD,YAAaF,EAAY,CAE7B,IAAIG,EAAuBH,EAAUI,mBAAmBC,aAAmBL,EAAUI,QAAQnC,WAAa,EACtGqC,EAA+C,iBAAtBN,EAAUI,SAAkD,KAAtBJ,EAAUI,QAE7E,GAAKD,GAAsBG,EAAgB,CAE1C,IAAI9R,EAAQ7nB,KAAK45B,WAAYV,EAAYE,IAEzCJ,EAAOK,EAAUC,kBAAoBD,EAAUE,UAAa1R,KAUhE,IAAM,IAAIzgB,KAAM2e,EAAS,CAExB,IAAI8T,EAAW9T,EAAQ3e,QAEI6U,IAAtB+c,EAAOa,GAA2B9T,EAAQ3e,GAAO4xB,EAAOa,GACxD9T,EAAQ3e,GAAO2e,EAAQ3e,GAAKgT,MAAO,MAAO0U,MAIhD,OAAO/I,GAKR6T,WAAY,SAAWP,GAEtB,IAIIh3B,EAJAy3B,EAAUT,EAAUI,QACpBM,EAAWV,EAAUC,kBAAoBD,EAAUE,SACnDzR,EAAYiS,EAAShS,MAAOgS,EAAS/R,YAAa,KAAQ,GAAIxU,cAIlE,OAASsU,GAER,IAAK,MAEJzlB,EAAO,YACP,MAED,IAAK,MACL,IAAK,OAEJA,EAAO,aACP,MAED,IAAK,MAEJA,EAAO,YACP,MAED,IAAK,MAEJA,EAAO,aACP,MAED,IAAK,MAEJ,GAAgC,mBAApBhC,MAAMwzB,UAGjB,YADA9pB,QAAQqT,KAAM,+DAK+B,OAAxC/c,MAAM25B,OAAOC,SAAS/mB,IAAK,SAE/B7S,MAAM25B,OAAOC,SAASr4B,IAAK,UAAW,IAAIvB,MAAMwzB,WAIjDxxB,EAAO,YACP,MAIF,QAGC,YADA0H,QAAQqT,KAAM,0BAA4B0K,EAAY,uBAKxD,GAAwB,iBAAZgS,EAEX,MAAO,QAAUz3B,EAAO,WAAay3B,EAIrC,IAAItc,EAAQ,IAAI0c,WAAYJ,GAC5B,OAAOl3B,OAAOu3B,IAAIC,gBAAiB,IAAIC,KAAM,CAAE7c,GAAS,CAAEnb,KAAMA,MASlE01B,cAAe,SAAWhS,GAEzB,IAAIuU,EAAa,IAAIjC,IAErB,GAAK,YAAarC,EAAQiD,QAAU,CAEnC,IAAIsB,EAAevE,EAAQiD,QAAQuB,QACnC,IAAM,IAAIpB,KAAUmB,EAAe,CAElC,IAAInS,EAAUpoB,KAAKy6B,aAAcF,EAAcnB,GAAUrT,GACzDuU,EAAWh5B,IAAK6c,SAAUib,GAAUhR,IAMtC,OAAOkS,GAKRG,aAAc,SAAWC,EAAa3U,GAErC,IAAIqC,EAAUpoB,KAAK26B,YAAaD,EAAa3U,GAE7CqC,EAAQ0Q,GAAK4B,EAAYtzB,GAEzBghB,EAAQ9S,KAAOolB,EAAYE,SAE3B,IAAIC,EAAYH,EAAYI,UACxBC,EAAYL,EAAYM,UAExBC,OAAuBhf,IAAd4e,EAA0BA,EAAU3yB,MAAQ,EACrDgzB,OAAuBjf,IAAd8e,EAA0BA,EAAU7yB,MAAQ,EAQzD,GAHAkgB,EAAQC,MAAmB,IAAX4S,EAAe56B,MAAMkoB,eAAiBloB,MAAMmoB,oBAC5DJ,EAAQK,MAAmB,IAAXyS,EAAe76B,MAAMkoB,eAAiBloB,MAAMmoB,oBAEvD,YAAakS,EAAc,CAE/B,IAAIS,EAAST,EAAYU,QAAQlzB,MAEjCkgB,EAAQrQ,OAAO5U,EAAIg4B,EAAQ,GAC3B/S,EAAQrQ,OAAOxU,EAAI43B,EAAQ,GAI5B,OAAO/S,GAKRuS,YAAa,SAAWD,EAAa3U,GAEpC,IAAIgU,EAkBA3R,EAhBAiT,EAAcr7B,KAAKkoB,cAAcxL,KAEjC0U,EAAW6E,EAAY/iB,IAAKwnB,EAAYtzB,IAAKgqB,cAE/BnV,IAAbmV,GAA0BA,EAASxrB,OAAS,QAAoCqW,IAA/B8J,EAAQqL,EAAU,GAAI0H,MAItC,KAFrCiB,EAAWhU,EAAQqL,EAAU,GAAI0H,KAEnB3tB,QAAS,UAAmD,IAAhC4uB,EAAS5uB,QAAS,UAE3DnL,KAAKkoB,cAAcpL,aAASb,IAQ9B,IAAI6L,EAAY4S,EAAYY,SAASvT,OAAS,GAAIvU,cAElD,GAAmB,QAAdsU,EAAsB,CAE1B,IAAIhN,EAASza,MAAM25B,OAAOC,SAAS/mB,IAAK,QAExB,OAAX4H,GAEJ/Q,QAAQqT,KAAM,yEAA0E2c,GACxF3R,EAAU,IAAI/nB,MAAMm6B,SAIpBpS,EAAUtN,EAAO7B,KAAM8gB,OAIC,QAAdjS,GAEX/d,QAAQqT,KAAM,oFAAqF2c,GACnG3R,EAAU,IAAI/nB,MAAMm6B,SAIpBpS,EAAUpoB,KAAKkoB,cAAcjP,KAAM8gB,GAMpC,OAFA/5B,KAAKkoB,cAAcpL,QAASue,GAErBjT,GAKR4P,eAAgB,SAAWsC,GAE1B,IAAIiB,EAAc,IAAIlD,IAEtB,GAAK,aAAcrC,EAAQiD,QAAU,CAEpC,IAAIuC,EAAgBxF,EAAQiD,QAAQwC,SAEpC,IAAM,IAAIrC,KAAUoC,EAAgB,CAEnC,IAAIhgB,EAAWxb,KAAK07B,cAAeF,EAAepC,GAAUkB,GAE1C,OAAb9e,GAAoB+f,EAAYj6B,IAAK6c,SAAUib,GAAU5d,IAMhE,OAAO+f,GAORG,cAAe,SAAWC,EAAcrB,GAEvC,IAAIxB,EAAK6C,EAAav0B,GAClBkO,EAAOqmB,EAAaf,SACpBv4B,EAAOs5B,EAAaC,aAUxB,GAPqB,iBAATv5B,IAEXA,EAAOA,EAAK6F,QAKN+tB,EAAY0C,IAAKG,GAAO,OAAO,KAEtC,IAEItd,EAFAkL,EAAa1mB,KAAK67B,gBAAiBF,EAAcrB,EAAYxB,GAIjE,OAASz2B,EAAKmR,eAEb,IAAK,QACJgI,EAAW,IAAInb,MAAMmnB,kBACrB,MACD,IAAK,UACJhM,EAAW,IAAInb,MAAMonB,oBACrB,MACD,QACC1d,QAAQqT,KAAM,gFAAiF/a,GAC/FmZ,EAAW,IAAInb,MAAMmnB,kBAAmB,CAAE/L,MAAO,UAQnD,OAHAD,EAASsgB,UAAWpV,GACpBlL,EAASlG,KAAOA,EAETkG,GAMRqgB,gBAAiB,SAAWF,EAAcrB,EAAYxB,GAErD,IAAIpS,EAAa,GAEZiV,EAAaI,aAEjBrV,EAAWsV,UAAYL,EAAaI,WAAW7zB,OAG3CyzB,EAAaM,QAEjBvV,EAAWjL,OAAQ,IAAIpb,MAAM2qB,OAAQxI,UAAWmZ,EAAaM,QAAQ/zB,OAE1DyzB,EAAaO,cAAmD,UAAnCP,EAAaO,aAAa75B,OAGlEqkB,EAAWjL,OAAQ,IAAIpb,MAAM2qB,OAAQxI,UAAWmZ,EAAaO,aAAah0B,QAGtEyzB,EAAaQ,qBAEjBzV,EAAW0V,kBAAoBT,EAAaQ,mBAAmBj0B,OAG3DyzB,EAAaU,SAEjB3V,EAAW/K,UAAW,IAAItb,MAAM2qB,OAAQxI,UAAWmZ,EAAaU,SAASn0B,OAE9DyzB,EAAaW,eAAqD,UAApCX,EAAaW,cAAcj6B,OAGpEqkB,EAAW/K,UAAW,IAAItb,MAAM2qB,OAAQxI,UAAWmZ,EAAaW,cAAcp0B,QAG1EyzB,EAAaY,iBAEjB7V,EAAW8V,kBAAoBve,WAAY0d,EAAaY,eAAer0B,QAGnEyzB,EAAac,UAEjB/V,EAAW8C,QAAUvL,WAAY0d,EAAac,QAAQv0B,QAGlDwe,EAAW8C,QAAU,IAEzB9C,EAAW4C,aAAc,GAGrBqS,EAAae,mBAEjBhW,EAAWiW,aAAehB,EAAae,iBAAiBx0B,OAGpDyzB,EAAaiB,YAEjBlW,EAAW2C,UAAYsS,EAAaiB,UAAU10B,OAG1CyzB,EAAakB,SAEjBnW,EAAWsC,UAAW,IAAI3oB,MAAM2qB,OAAQxI,UAAWmZ,EAAakB,SAAS30B,OAE9DyzB,EAAamB,eAAqD,UAApCnB,EAAamB,cAAcz6B,OAGpEqkB,EAAWsC,UAAW,IAAI3oB,MAAM2qB,OAAQxI,UAAWmZ,EAAamB,cAAc50B,QAI/E,IAAI6S,EAAO/a,KAsDX,OArDAi2B,EAAY/iB,IAAK4lB,GAAK1H,SAAStlB,SAAS,SAAW4R,GAElD,IAAIrb,EAAOqb,EAAMgb,aAEjB,OAASr2B,GAER,IAAK,OACJqkB,EAAWqW,QAAUhiB,EAAK4M,WAAY2S,EAAY5c,EAAMob,IACxD,MAED,IAAK,eACJpS,EAAWrM,IAAMU,EAAK4M,WAAY2S,EAAY5c,EAAMob,IACpD,MAED,IAAK,oBACJpS,EAAWsW,gBAAkBjiB,EAAK4M,WAAY2S,EAAY5c,EAAMob,IAChE,MAGD,IAAK,gBACJpS,EAAW9K,YAAcb,EAAK4M,WAAY2S,EAAY5c,EAAMob,IAC5D,MAED,IAAK,YACJpS,EAAWwC,UAAYnO,EAAK4M,WAAY2S,EAAY5c,EAAMob,IAC1D,MAED,IAAK,kBACJpS,EAAWuW,OAASliB,EAAK4M,WAAY2S,EAAY5c,EAAMob,IACvDpS,EAAWuW,OAAOr2B,QAAUvG,MAAM68B,iCAClC,MAED,IAAK,gBACJxW,EAAWuC,YAAclO,EAAK4M,WAAY2S,EAAY5c,EAAMob,IAC5D,MAED,IAAK,mBACJpS,EAAWyW,SAAWpiB,EAAK4M,WAAY2S,EAAY5c,EAAMob,IACzDpS,EAAW4C,aAAc,EACzB,MAED,IAAK,eACL,IAAK,oBACL,IAAK,iBACL,IAAK,0BACL,QACCvf,QAAQqT,KAAM,0EAA2E/a,OAOrFqkB,GAKRiB,WAAY,SAAW2S,EAAYlzB,GAUlC,MAPK,mBAAoB4uB,EAAQiD,SAAW7xB,KAAM4uB,EAAQiD,QAAQmE,iBAEjErzB,QAAQqT,KAAM,oGACdhW,EAAK6uB,EAAY/iB,IAAK9L,GAAKgqB,SAAU,GAAI0H,IAInCwB,EAAWpnB,IAAK9L,IAOxB8wB,eAAgB,WAEf,IAAIxH,EAAY,GACZ2M,EAAe,GAEnB,GAAK,aAAcrH,EAAQiD,QAAU,CAEpC,IAAIqE,EAAgBtH,EAAQiD,QAAQsE,SAEpC,IAAM,IAAInE,KAAUkE,EAAgB,CAEnC,IAAIE,EAAeF,EAAelE,GAE9BqE,EAAgBxH,EAAY/iB,IAAKiL,SAAUib,IAE/C,GAA+B,SAA1BoE,EAAaE,SAAsB,CAEvC,IAAIzM,EAAWjxB,KAAK29B,cAAeF,EAAeH,GAClDrM,EAAS6H,GAAKM,EAETqE,EAAc7E,QAAQhzB,OAAS,GAAImE,QAAQqT,KAAM,kFACtD6T,EAAS2M,WAAaH,EAAc7E,QAAS,GAAIE,GAEjDpI,EAAW0I,GAAWnI,OAEhB,GAA+B,eAA1BuM,EAAaE,SAA4B,CAEpD,IAAIG,EAAc,CACjBz2B,GAAIgyB,GAGLyE,EAAYC,WAAa99B,KAAK+9B,kBAAmBN,EAAeH,GAChEO,EAAYz2B,GAAKgyB,EAEZqE,EAAc7E,QAAQhzB,OAAS,GAAImE,QAAQqT,KAAM,sFAEtDigB,EAAcjE,GAAWyE,IAQ5B,MAAO,CAENnN,UAAWA,EACX2M,aAAcA,IAShBM,cAAe,SAAWF,EAAeO,GAExC,IAAIC,EAAW,GA8Bf,OA5BAR,EAAcrM,SAAStlB,SAAS,SAAW4R,GAE1C,IAAIwgB,EAAWF,EAAetgB,EAAMob,IAEpC,GAA2B,YAAtBoF,EAASR,SAAd,CAEA,IAAIS,EAAU,CAEbrF,GAAIpb,EAAMob,GACVjZ,QAAS,GACTwE,QAAS,GACThD,WAAW,IAAIhhB,MAAMilB,SAAU9C,UAAW0b,EAASE,UAAUxc,GAC7Dyc,eAAe,IAAIh+B,MAAMilB,SAAU9C,UAAW0b,EAASI,cAAc1c,GACrE2c,SAAUL,EAASM,MAIf,YAAaN,IAEjBC,EAAQte,QAAUqe,EAASO,QAAQ7c,EACnCuc,EAAQ9Z,QAAU6Z,EAASQ,QAAQ9c,GAIpCqc,EAASvjB,KAAMyjB,OAIT,CAENF,SAAUA,EACVzM,MAAO,KAOTuM,kBAAmB,SAAWN,EAAeO,GAI5C,IAFA,IAAIW,EAAkB,GAEZh5B,EAAI,EAAGA,EAAI83B,EAAcrM,SAASxrB,OAAQD,IAAO,CAE1D,GAAW,IAANA,EAAU,CAEdoE,QAAQqT,KAAM,iFAEd,MAID,IAAIM,EAAQ+f,EAAcrM,SAAUzrB,GAEhCi5B,EAAkBZ,EAAetgB,EAAMob,IAEvC+F,EAAiB,CAEpBvpB,KAAMspB,EAAgBhE,SACtBkE,cAAeF,EAAgBG,cAC/B33B,GAAIw3B,EAAgBx3B,GACpB43B,YAAaJ,EAAgBK,YAAYrd,GAI1C,GAAkC,sBAA7Bgd,EAAgBlB,SAAmC,OAE9BzH,EAAY/iB,IAAKiL,SAAUT,EAAMob,KAEvC1H,SAAStlB,SAAS,SAAW4R,QAEpBzB,IAAvByB,EAAMgb,eAA6BmG,EAAeK,MAAQxhB,EAAMob,OAItE6F,EAAgBjkB,KAAMmkB,GAIvB,OAAOF,GAKRhJ,WAAY,SAAWsC,EAAWE,EAAaoD,GAE9CrF,EAAa,IAAI71B,MAAMiyB,MAEvB,IAAI6M,EAAWn/B,KAAKo/B,YAAanH,EAAUvH,UAAWyH,EAAaoD,GAE/D8D,EAAarJ,EAAQiD,QAAQqG,MAE7BvkB,EAAO/a,KACXm/B,EAASrzB,SAAS,SAAW+M,GAE5B,IAAI0mB,EAAYF,EAAYxmB,EAAMigB,IAClC/d,EAAKykB,oBAAqB3mB,EAAO0mB,GAETtJ,EAAY/iB,IAAK2F,EAAMigB,IAAKF,QAElC9sB,SAAS,SAAW2zB,GAErC,IAAIC,EAASP,EAASjsB,IAAKusB,EAAW3G,SACtB7c,IAAXyjB,GAAuBA,EAAO99B,IAAKiX,MAInB,OAAjBA,EAAM6mB,QAEVxJ,EAAWt0B,IAAKiX,MAOlB7Y,KAAK2/B,aAAc1H,EAAUvH,UAAWyH,EAAagH,GAErDn/B,KAAK4/B,qBAEL5/B,KAAK6/B,sBAEL,IAAI7lB,GAAa,IAAIqc,GAAkBrZ,QAGH,IAA/BkZ,EAAW9E,SAASxrB,QAAgBswB,EAAW9E,SAAU,GAAI0O,UAEjE5J,EAAW9E,SAAU,GAAIpX,WAAaA,EACtCkc,EAAaA,EAAW9E,SAAU,IAInC8E,EAAWlc,WAAaA,GAKzBolB,YAAa,SAAW1O,EAAWyH,EAAaoD,GAE/C,IAAI4D,EAAW,IAAI9G,IACfgH,EAAarJ,EAAQiD,QAAQqG,MAEjC,IAAM,IAAIlG,KAAUiG,EAAa,CAEhC,IAAIj4B,EAAK+W,SAAUib,GACfjY,EAAOke,EAAYjG,GACnBqE,EAAgBxH,EAAY/iB,IAAK9L,GAEjCyR,EAAQ7Y,KAAK8wB,cAAe2M,EAAe/M,EAAWtpB,EAAI+Z,EAAKyZ,UAEnE,IAAO/hB,EAAQ,CAEd,OAASsI,EAAKuc,UAEb,IAAK,SACJ7kB,EAAQ7Y,KAAK+/B,aAActC,GAC3B,MACD,IAAK,QACJ5kB,EAAQ7Y,KAAKggC,YAAavC,GAC1B,MACD,IAAK,OACJ5kB,EAAQ7Y,KAAKigC,WAAYxC,EAAetF,EAAaoD,GACrD,MACD,IAAK,aACJ1iB,EAAQ7Y,KAAKkgC,YAAazC,EAAetF,GACzC,MACD,IAAK,WACL,IAAK,OACL,QACCtf,EAAQ,IAAIxY,MAAMiyB,MAKpBzZ,EAAMvD,KAAOjV,MAAM8/B,gBAAgBC,iBAAkBjf,EAAKyZ,UAC1D/hB,EAAMigB,GAAK1xB,EAIZpH,KAAKqgC,mBAAoBxnB,EAAOsI,GAChCge,EAAS79B,IAAK8F,EAAIyR,GAInB,OAAOsmB,GAIRrO,cAAe,SAAW2M,EAAe/M,EAAWtpB,EAAIkO,GAEvD,IAAIgc,EAAO,KAsCX,OApCAmM,EAAc7E,QAAQ9sB,SAAS,SAAW4zB,GAEzC,IAAM,IAAI5G,KAAMpI,EAAY,CAE3B,IAAIO,EAAWP,EAAWoI,GAE1B7H,EAASgN,SAASnyB,SAAS,SAAWqyB,EAASx4B,GAE9C,GAAKw4B,EAAQrF,KAAO4G,EAAO5G,GAAK,CAE/B,IAAIwH,EAAUhP,GACdA,EAAO,IAAIjxB,MAAMgyB,MACZkO,YAAY/+B,KAAM28B,EAAQE,eAG/B/M,EAAKhc,KAAOjV,MAAM8/B,gBAAgBC,iBAAkB9qB,GACpDgc,EAAKwH,GAAK1xB,EAEV6pB,EAASO,MAAO7rB,GAAM2rB,EAIL,OAAZgP,GAEJhP,EAAK1vB,IAAK0+B,WAYRhP,GAKRyO,aAAc,SAAWtC,GAExB,IAAI5kB,EACA2nB,EAcJ,GAZA/C,EAAcrM,SAAStlB,SAAS,SAAW4R,GAE1C,IAAI+iB,EAAOzK,EAAQiD,QAAQyH,cAAehjB,EAAMob,SAElC7c,IAATwkB,IAEJD,EAAkBC,WAMKxkB,IAApBukB,EAEJ3nB,EAAQ,IAAIxY,MAAM6C,aAEZ,CAEN,IAAIb,EAAO,OACmC4Z,IAAzCukB,EAAgBG,sBAAqF,IAA/CH,EAAgBG,qBAAqBz4B,QAE/F7F,EAAO,GAIR,IAAIu+B,EAAoB,OACW3kB,IAA9BukB,EAAgBK,YAEpBD,EAAoBJ,EAAgBK,UAAU34B,MAAQ,KAIvD,IAAI44B,EAAmB,SACW7kB,IAA7BukB,EAAgBO,WAEpBD,EAAmBN,EAAgBO,SAAS74B,MAAQ,KAKrD,IAAI84B,EAAQp+B,OAAOq+B,WACfC,EAASt+B,OAAOu+B,iBAEiBllB,IAAhCukB,EAAgBY,kBAA8DnlB,IAAjCukB,EAAgBa,eAEjEL,EAAQR,EAAgBY,YAAYl5B,MACpCg5B,EAASV,EAAgBa,aAAan5B,OAIvC,IAAIo5B,EAASN,EAAQE,EAEjBK,EAAM,QAC2BtlB,IAAhCukB,EAAgBgB,cAEpBD,EAAMf,EAAgBgB,YAAYt5B,OAInC,IAAIu5B,EAAcjB,EAAgBkB,YAAclB,EAAgBkB,YAAYx5B,MAAQ,KAEpF,OAAS7F,GAER,KAAK,EACJwW,EAAQ,IAAIxY,MAAM8pB,kBAAmBoX,EAAKD,EAAQV,EAAmBE,GAChD,OAAhBW,GAAuB5oB,EAAM8oB,eAAgBF,GAClD,MAED,KAAK,EACJ5oB,EAAQ,IAAIxY,MAAMsqB,oBAAsBqW,EAAQ,EAAGA,EAAQ,EAAGE,EAAS,GAAKA,EAAS,EAAGN,EAAmBE,GAC3G,MAED,QACC/2B,QAAQqT,KAAM,wCAA0C/a,EAAO,KAC/DwW,EAAQ,IAAIxY,MAAM6C,UAOrB,OAAO2V,GAKRmnB,YAAa,SAAWvC,GAEvB,IAAI5kB,EACA+oB,EAcJ,GAZAnE,EAAcrM,SAAStlB,SAAS,SAAW4R,GAE1C,IAAI+iB,EAAOzK,EAAQiD,QAAQyH,cAAehjB,EAAMob,SAElC7c,IAATwkB,IAEJmB,EAAiBnB,WAMKxkB,IAAnB2lB,EAEJ/oB,EAAQ,IAAIxY,MAAM6C,aAEZ,CAEN,IAAIb,EAKHA,OAFiC4Z,IAA7B2lB,EAAeC,UAEZ,EAIAD,EAAeC,UAAU35B,MAIjC,IAAIuT,EAAQ,cAEkBQ,IAAzB2lB,EAAe5W,QAEnBvP,GAAQ,IAAIpb,MAAM2qB,OAAQxI,UAAWof,EAAe5W,MAAM9iB,QAI3D,IAAI45B,OAA2C7lB,IAA7B2lB,EAAeG,UAA4B,EAAIH,EAAeG,UAAU75B,MAAQ,SAGxD+T,IAArC2lB,EAAeI,mBAA8E,IAA3CJ,EAAeI,kBAAkB95B,QAEvF45B,EAAY,GAIb,IAAI3W,EAAW,OAC2BlP,IAArC2lB,EAAeK,oBAIlB9W,OAF4ClP,IAAxC2lB,EAAeM,sBAAoF,IAA9CN,EAAeM,qBAAqBh6B,MAElF,EAIA05B,EAAeK,kBAAkB/5B,OAS9C,OAAS7F,GAER,KAAK,EACJwW,EAAQ,IAAIxY,MAAMmrB,WAAY/P,EAAOqmB,EAAW3W,EALtC,GAMV,MAED,KAAK,EACJtS,EAAQ,IAAIxY,MAAMkrB,iBAAkB9P,EAAOqmB,GAC3C,MAED,KAAK,EACJ,IAAI9S,EAAQ5rB,KAAKmC,GAAK,OAEa0W,IAA9B2lB,EAAeO,aAEnBnT,EAAQ3uB,MAAM+C,KAAKC,SAAUu+B,EAAeO,WAAWj6B,QAIxD,IAAIk6B,EAAW,OACoBnmB,IAA9B2lB,EAAeS,aAKnBD,EAAW/hC,MAAM+C,KAAKC,SAAUu+B,EAAeS,WAAWn6B,OAC1Dk6B,EAAWh/B,KAAKkC,IAAK88B,EAAU,IAIhCvpB,EAAQ,IAAIxY,MAAMorB,UAAWhQ,EAAOqmB,EAAW3W,EAAU6D,EAAOoT,EAhCtD,GAiCV,MAED,QACCr4B,QAAQqT,KAAM,uCAAyCwkB,EAAeC,UAAU35B,MAAQ,uCACxF2Q,EAAQ,IAAIxY,MAAMmrB,WAAY/P,EAAOqmB,QAKH7lB,IAA/B2lB,EAAeU,aAAkE,IAArCV,EAAeU,YAAYp6B,QAE3E2Q,EAAM0pB,YAAa,GAMrB,OAAO1pB,GAIRonB,WAAY,SAAWxC,EAAetF,EAAaoD,GAElD,IAAI1iB,EACAoB,EAAW,KACXuB,EAAW,KACXqO,EAAY,GA4DhB,OAzDA4T,EAAcrM,SAAStlB,SAAS,SAAW4R,GAErCya,EAAYQ,IAAKjb,EAAMob,MAE3B7e,EAAWke,EAAYjlB,IAAKwK,EAAMob,KAI9ByC,EAAY5C,IAAKjb,EAAMob,KAE3BjP,EAAUnP,KAAM6gB,EAAYroB,IAAKwK,EAAMob,QAMpCjP,EAAUjkB,OAAS,EAEvB4V,EAAWqO,EAEAA,EAAUjkB,OAAS,EAE9B4V,EAAWqO,EAAW,IAItBrO,EAAW,IAAInb,MAAMmnB,kBAAmB,CAAE/L,MAAO,WACjDoO,EAAUnP,KAAMc,IAIZ,UAAWvB,EAAS2Y,YAExB/I,EAAU/d,SAAS,SAAW0P,GAE7BA,EAASgnB,aAAeniC,MAAMoiC,gBAM3BxoB,EAASyoB,cAEb7Y,EAAU/d,SAAS,SAAW0P,GAE7BA,EAASmX,UAAW,KAIrB9Z,EAAQ,IAAIxY,MAAM0yB,YAAa9Y,EAAUuB,IAIzC3C,EAAQ,IAAIxY,MAAM2yB,KAAM/Y,EAAUuB,GAI5B3C,GAIRqnB,YAAa,SAAWzC,EAAetF,GAEtC,IAAIle,EAAWwjB,EAAcrM,SAASuR,QAAQ,SAAWC,EAAKllB,GAI7D,OAFKya,EAAYQ,IAAKjb,EAAMob,MAAO8J,EAAMzK,EAAYjlB,IAAKwK,EAAMob,KAEzD8J,IAEL,MAGCpnB,EAAW,IAAInb,MAAMqyB,kBAAmB,CAAEjX,MAAO,QAAUonB,UAAW,IAC1E,OAAO,IAAIxiC,MAAMyyB,KAAM7Y,EAAUuB,IAKlC6kB,mBAAoB,SAAWxnB,EAAO0mB,GAErC,IAAIuD,EAAgB,GAEf,kBAAmBvD,IAAYuD,EAAcC,WAAa5kB,SAAUohB,EAAUyD,cAAc96B,QAC5F,oBAAqBq3B,IAAYuD,EAAcG,YAAc1D,EAAU2D,gBAAgBh7B,OACvF,mBAAoBq3B,IAAYuD,EAAcK,eAAiB5D,EAAU6D,eAAel7B,OACxF,iBAAkBq3B,IAAYuD,EAAc9/B,SAAWu8B,EAAU8D,aAAan7B,OAC9E,gBAAiBq3B,IAAYuD,EAAcQ,YAAc/D,EAAUgE,YAAYr7B,OAC/E,iBAAkBq3B,IAAYuD,EAAcU,aAAejE,EAAUkE,aAAav7B,OAClF,gBAAiBq3B,IAAYuD,EAAc7gB,MAAQsd,EAAUmE,YAAYx7B,OAE9E,IAAImZ,EAAYsiB,EAAmBb,GAEnCjqB,EAAM+qB,YAAaviB,IAIpBme,oBAAqB,SAAW3mB,EAAO0mB,GAEjC,mBAAoBA,GAETtJ,EAAY/iB,IAAK2F,EAAMigB,IAAK1H,SAElCtlB,SAAS,SAAW4R,GAE5B,GAA4B,mBAAvBA,EAAMgb,aAAoC,CAE9C,IAAImL,EAAe7N,EAAQiD,QAAQqG,MAAO5hB,EAAMob,IAEhD,GAAK,oBAAqB+K,EAAe,CAExC,IAAIC,EAAMD,EAAaX,gBAAgBh7B,WAGjB+T,IAAjBpD,EAAMlS,QAEVkS,EAAMlS,OAAOpG,SAASiiB,UAAWshB,GACjC5N,EAAWt0B,IAAKiX,EAAMlS,SAItBkS,EAAMkrB,QAAQ,IAAI1jC,MAAMC,SAAUkiB,UAAWshB,UAcnDnE,aAAc,SAAWjP,EAAWyH,EAAagH,GAEhD,IAAI6E,EAAehkC,KAAKikC,iBAExB,IAAM,IAAInL,KAAMpI,EAAY,CAE3B,IAAIO,EAAWP,EAAWoI,GAEZ7C,EAAY/iB,IAAKiL,SAAU8S,EAAS6H,KAAOF,QAEjD9sB,SAAS,SAAW4zB,GAE3B,GAAKvH,EAAYQ,IAAK+G,EAAO5G,IAAO,CAEnC,IAAIoG,EAAQQ,EAAO5G,GACI7C,EAAY/iB,IAAKgsB,GAEvBtG,QAAQ9sB,SAAS,SAAWo4B,GAEvC/E,EAASxG,IAAKuL,EAAcpL,KAEpBqG,EAASjsB,IAAKgxB,EAAcpL,IAElCtwB,KAAM,IAAInI,MAAMqxB,SAAUT,EAASO,OAASwS,EAAcE,EAAcpL,cAcpFmL,eAAgB,WAEf,IAAID,EAAe,GAEnB,GAAK,SAAUhO,EAAQiD,QAAU,CAEhC,IAAIkL,EAAenO,EAAQiD,QAAQmL,KAEnC,IAAM,IAAIhL,KAAU+K,EAEnB,GAAyC,aAApCA,EAAc/K,GAASsE,SAA0B,CAErD,IAAI2G,EAAYF,EAAc/K,GAASkL,SAElCvmB,MAAMwmB,QAASF,GAEnBA,EAAUv4B,SAAS,SAAW04B,GAE7BR,EAAcQ,EAASC,OAAS,IAAIpkC,MAAMilB,SAAU9C,UAAWgiB,EAASE,OAAO9iB,MAMhFoiB,EAAcK,EAAUI,OAAS,IAAIpkC,MAAMilB,SAAU9C,UAAW6hB,EAAUK,OAAO9iB,IAUrF,OAAOoiB,GAKRpE,mBAAoB,WAEnB,GAAK,mBAAoB5J,GAAW,iBAAkBA,EAAQ2O,eAAiB,CAE9E,IAAIC,EAAe5O,EAAQ2O,eAAeE,aAAa38B,MACnD6I,EAAI6zB,EAAc,GAClB1X,EAAI0X,EAAc,GAClB/iB,EAAI+iB,EAAc,GAEtB,GAAW,IAAN7zB,GAAiB,IAANmc,GAAiB,IAANrL,EAAU,CAEpC,IAAIpG,EAAQ,IAAIpb,MAAM2qB,MAAOja,EAAGmc,EAAGrL,GACnCqU,EAAWt0B,IAAK,IAAIvB,MAAMqrB,aAAcjQ,EAAO,OAQlDokB,oBAAqB,WAEpB3J,EAAW7a,UAAU,SAAWqC,GAE/B,GAAKA,EAAMnC,SAELmC,EAAMzD,SAAS6qB,gBAAgBvkC,UAAYmd,EAAMzD,SAAS6qB,gBAAgBjY,QAAS,CAEvF,IAAI7K,EAAOtE,EAAMsE,KACb+iB,EAAUrnB,EAAMlC,SAASwG,KAGzBgjB,GAAY,EAEhB9O,EAAW7a,UAAU,SAAWqC,GAE1BA,EAAMnC,QAELmC,EAAMlC,SAASwG,OAAS+iB,GAAWrnB,EAAMsE,OAASA,IAAOgjB,GAAY,OAMzD,IAAdA,IAAqBtnB,EAAMlC,SAAWkC,EAAMlC,SAASjS,SAE1DmU,EAAMlC,SAAS6hB,cAAe,QAenCjH,EAAenjB,UAAY,CAE1BkJ,YAAaia,EAGbpZ,MAAO,SAAWib,GAEjB,IAAIE,EAAc,IAAIE,IAEtB,GAAK,aAAcrC,EAAQiD,QAAU,CAEpC,IAAIgM,EAAWjP,EAAQiD,QAAQiM,SAE/B,IAAM,IAAI9L,KAAU6L,EAAW,CAE9B,IAAIxH,EAAgBxH,EAAY/iB,IAAKiL,SAAUib,IAC3CwJ,EAAM5iC,KAAKmlC,cAAe1H,EAAewH,EAAU7L,GAAUnB,GAEjEE,EAAY72B,IAAK6c,SAAUib,GAAUwJ,IAMvC,OAAOzK,GAKRgN,cAAe,SAAW1H,EAAe2H,EAASnN,GAEjD,OAASmN,EAAQ1H,UAEhB,IAAK,OACJ,OAAO19B,KAAKqlC,kBAAmB5H,EAAe2H,EAASnN,GAGxD,IAAK,aACJ,OAAOj4B,KAAKslC,mBAAoBF,KAQnCC,kBAAmB,SAAW5H,EAAe2H,EAASnN,GAErD,IAAIvH,EAAYuH,EAAUvH,UACtB2M,EAAepF,EAAUoF,aAEzBgC,EAAa5B,EAAc7E,QAAQve,KAAK,SAAWqlB,GAEtD,OAAO1J,EAAQiD,QAAQqG,MAAOI,EAAO5G,OAKtC,GAA2B,IAAtBuG,EAAWz5B,OAAhB,CAEA,IAAIqrB,EAAWwM,EAAcrM,SAASuR,QAAQ,SAAW1R,EAAUvT,GAIlE,YAF+BzB,IAA1ByU,EAAWhT,EAAMob,MAAqB7H,EAAWP,EAAWhT,EAAMob,KAEhE7H,IAEL,MAEC4M,EAAcJ,EAAcrM,SAASuR,QAAQ,SAAW9E,EAAangB,GAIxE,YAFkCzB,IAA7BohB,EAAc3f,EAAMob,MAAqB+E,EAAcR,EAAc3f,EAAMob,KAEzE+E,IAEL,MAOC0B,EAAYF,EAAY,GAExByD,EAAgB,GAEf,kBAAmBvD,IAAYuD,EAAcC,WAAaxD,EAAUyD,cAAc96B,OAClF,yBAA0Bq3B,IAAYuD,EAAcG,YAAc1D,EAAUgG,qBAAqBr9B,OACjG,sBAAuBq3B,IAAYuD,EAAc9/B,SAAWu8B,EAAUiG,kBAAkBt9B,OACxF,qBAAsBq3B,IAAYuD,EAAc7gB,MAAQsd,EAAUkG,iBAAiBv9B,OAExF,IAAImZ,EAAYsiB,EAAmBb,GAEnC,OAAO9iC,KAAK0lC,YAAaN,EAASnU,EAAU4M,EAAaxc,KAK1DqkB,YAAa,SAAWN,EAASnU,EAAU4M,EAAa8H,GAEvD,IAAI/C,EAAM,IAAIviC,MAAM2sB,eACfoY,EAAQxK,WAAWgI,EAAIttB,KAAO8vB,EAAQxK,UAE3C,IAAIgL,EAAU5lC,KAAK6lC,aAAcT,EAASnU,GACtC6U,EAAU9lC,KAAK+lC,WAAYH,GAE3BI,EAAoB,IAAI3lC,MAAMotB,uBAAwBqY,EAAQG,OAAQ,GAuB1E,GArBAN,EAAaO,uBAAwBF,GAErCpD,EAAIpV,aAAc,WAAYwY,GAEzBF,EAAQK,OAAOvgC,OAAS,GAE5Bg9B,EAAIpV,aAAc,QAAS,IAAIntB,MAAMotB,uBAAwBqY,EAAQK,OAAQ,IAIzElV,IAEJ2R,EAAIpV,aAAc,YAAa,IAAIntB,MAAM+lC,sBAAuBN,EAAQO,eAAgB,IAExFzD,EAAIpV,aAAc,aAAc,IAAIntB,MAAMotB,uBAAwBqY,EAAQ/hB,cAAe,IAGzF6e,EAAIF,aAAezR,GAIf6U,EAAQjZ,OAAOjnB,OAAS,EAAI,CAEhC,IAAI0gC,EAAkB,IAAIjmC,MAAMotB,uBAAwBqY,EAAQjZ,OAAQ,IAErD,IAAIxsB,MAAMkmC,SAAUC,gBAAiBb,GAC3CO,uBAAwBI,GAErC1D,EAAIpV,aAAc,SAAU8Y,GAoB7B,GAhBAR,EAAQW,IAAI36B,SAAS,SAAW46B,EAAU/gC,GAGzC,IAAI2P,EAAO,MAAS3P,EAAI,GAAIghC,WAGjB,IAANhhC,IAEJ2P,EAAO,MAIRstB,EAAIpV,aAAclY,EAAM,IAAIjV,MAAMotB,uBAAwBqY,EAAQW,IAAK9gC,GAAK,OAIxEigC,EAAQpqB,UAA6C,YAAjCoqB,EAAQpqB,SAASorB,YAA4B,CAGrE,IAAIC,EAAoBf,EAAQgB,cAAe,GAC3CC,EAAa,EAgBjB,GAdAjB,EAAQgB,cAAch7B,SAAS,SAAWk7B,EAAcrhC,GAElDqhC,IAAiBH,IAErBjE,EAAIxV,SAAU2Z,EAAYphC,EAAIohC,EAAYF,GAE1CA,EAAoBG,EACpBD,EAAaphC,MAOVi9B,EAAIqE,OAAOrhC,OAAS,EAAI,CAE5B,IAAIshC,EAAYtE,EAAIqE,OAAQrE,EAAIqE,OAAOrhC,OAAS,GAC5CuhC,EAAYD,EAAU3xB,MAAQ2xB,EAAUjb,MAEvCkb,IAAcrB,EAAQgB,cAAclhC,QAExCg9B,EAAIxV,SAAU+Z,EAAWrB,EAAQgB,cAAclhC,OAASuhC,EAAWN,GAQ1C,IAAtBjE,EAAIqE,OAAOrhC,QAEfg9B,EAAIxV,SAAU,EAAG0Y,EAAQgB,cAAclhC,OAAQkgC,EAAQgB,cAAe,IAQxE,OAFA9mC,KAAKonC,gBAAiBxE,EAAKwC,EAASvH,EAAa8H,GAE1C/C,GAIRiD,aAAc,SAAWT,EAASnU,GAEjC,IAAI2U,EAAU,GAuBd,GArBAA,EAAQyB,qBAAyCprB,IAArBmpB,EAAQkC,SAA2BlC,EAAQkC,SAAS1lB,EAAI,GACpFgkB,EAAQ2B,mBAAiDtrB,IAA/BmpB,EAAQoC,mBAAqCpC,EAAQoC,mBAAmB5lB,EAAI,GAEjGwjB,EAAQqC,oBAEZ7B,EAAQnqB,MAAQzb,KAAK0nC,kBAAmBtC,EAAQqC,kBAAmB,KAI/DrC,EAAQuC,uBAEZ/B,EAAQpqB,SAAWxb,KAAK4nC,qBAAsBxC,EAAQuC,qBAAsB,KAIxEvC,EAAQyC,qBAEZjC,EAAQ/Y,OAAS7sB,KAAK8nC,aAAc1C,EAAQyC,mBAAoB,KAI5DzC,EAAQ2C,eAAiB,CAE7BnC,EAAQ9Y,GAAK,GAGb,IADA,IAAInnB,EAAI,EACAy/B,EAAQ2C,eAAgBpiC,IAE/BigC,EAAQ9Y,GAAGpS,KAAM1a,KAAKgoC,SAAU5C,EAAQ2C,eAAgBpiC,KACxDA,IAgCF,OA1BAigC,EAAQqC,YAAc,GAEJ,OAAbhX,IAEJ2U,EAAQ3U,SAAWA,EAEnBA,EAASgN,SAASnyB,SAAS,SAAWqyB,EAASx4B,GAG9Cw4B,EAAQte,QAAQ/T,SAAS,SAAW7F,EAAOgb,QAEJhF,IAAjC2pB,EAAQqC,YAAahiC,KAAwB2/B,EAAQqC,YAAahiC,GAAU,IAEjF2/B,EAAQqC,YAAahiC,GAAQyU,KAAM,CAElCtT,GAAIzB,EACJuf,OAAQiZ,EAAQ9Z,QAASpD,YAUtB2kB,GAIRG,WAAY,SAAWH,GAEtB,IAAIE,EAAU,CACbG,OAAQ,GACRpZ,OAAQ,GACRsZ,OAAQ,GACRM,IAAK,GACLK,cAAe,GACf/iB,cAAe,GACfsiB,eAAgB,IAGb6B,EAAe,EACfC,EAAa,EACbC,GAA0B,EAG1BC,EAAsB,GACtBC,EAAc,GACdC,EAAa,GACbC,EAAU,GACVC,EAAc,GACdC,EAAoB,GAEpB3tB,EAAO/a,KA4JX,OA3JA4lC,EAAQ2B,cAAcz7B,SAAS,SAAW68B,EAAaC,GAEtD,IAAIC,GAAY,EASXF,EAAc,IAElBA,IAA8B,EAC9BE,GAAY,GAIb,IAAIC,EAAgB,GAChBzkB,EAAU,GAId,GAFAgkB,EAAoB3tB,KAAoB,EAAdiuB,EAA+B,EAAdA,EAAkB,EAAiB,EAAdA,EAAkB,GAE7E/C,EAAQnqB,MAAQ,CAEpB,IAAIza,EAAO+nC,EAASH,EAAoBV,EAAcS,EAAa/C,EAAQnqB,OAE3E8sB,EAAW7tB,KAAM1Z,EAAM,GAAKA,EAAM,GAAKA,EAAM,IAI9C,GAAK4kC,EAAQ3U,SAAW,CAcvB,QAZ4ChV,IAAvC2pB,EAAQqC,YAAaU,IAEzB/C,EAAQqC,YAAaU,GAAc78B,SAAS,SAAWk9B,GAEtD3kB,EAAQ3J,KAAMsuB,EAAG9jB,QACjB4jB,EAAcpuB,KAAMsuB,EAAG5hC,OAOpBid,EAAQze,OAAS,EAAI,CAElBwiC,IAENr+B,QAAQqT,KAAM,6GACdgrB,GAA0B,GAI3B,IAAIa,EAAS,CAAE,EAAG,EAAG,EAAG,GACpBC,EAAS,CAAE,EAAG,EAAG,EAAG,GAExB7kB,EAAQvY,SAAS,SAAWoZ,EAAQikB,GAEnC,IAAIC,EAAgBlkB,EAChB8hB,EAAe8B,EAAeK,GAElCD,EAAOp9B,SAAS,SAAWu9B,EAAgBC,EAAqBC,GAE/D,GAAKH,EAAgBC,EAAiB,CAErCE,EAAqBD,GAAwBF,EAC7CA,EAAgBC,EAEhB,IAAIG,EAAMP,EAAQK,GAClBL,EAAQK,GAAwBtC,EAChCA,EAAewC,SAQlBV,EAAgBG,EAChB5kB,EAAU6kB,EAKX,KAAQ7kB,EAAQze,OAAS,GAExBye,EAAQ3J,KAAM,GACdouB,EAAcpuB,KAAM,GAIrB,IAAM,IAAI/U,EAAI,EAAGA,EAAI,IAAMA,EAE1B8iC,EAAY/tB,KAAM2J,EAAS1e,IAC3B+iC,EAAkBhuB,KAAMouB,EAAenjC,IAMzC,GAAKigC,EAAQ/Y,OAAS,CAEjB7rB,EAAO+nC,EAASH,EAAoBV,EAAcS,EAAa/C,EAAQ/Y,QAE3Eyb,EAAY5tB,KAAM1Z,EAAM,GAAKA,EAAM,GAAKA,EAAM,IAI/C,GAAK4kC,EAAQpqB,UAA6C,YAAjCoqB,EAAQpqB,SAASorB,YAEzC,IAAIE,EAAgBiC,EAASH,EAAoBV,EAAcS,EAAa/C,EAAQpqB,UAAY,GAI5FoqB,EAAQ9Y,IAEZ8Y,EAAQ9Y,GAAGhhB,SAAS,SAAWghB,EAAInnB,GAElC,IAAI3E,EAAO+nC,EAASH,EAAoBV,EAAcS,EAAa7b,QAE7C7Q,IAAjBusB,EAAS7iC,KAEb6iC,EAAS7iC,GAAM,IAIhB6iC,EAAS7iC,GAAI+U,KAAM1Z,EAAM,IACzBwnC,EAAS7iC,GAAI+U,KAAM1Z,EAAM,OAM3BmnC,IAEKU,IAEJ9tB,EAAK0uB,QAAS3D,EAASF,EAASyC,EAAqBvB,EAAewB,EAAaC,EAAYC,EAASC,EAAaC,EAAmBP,GAEtID,IACAC,EAAa,EAGbE,EAAsB,GACtBC,EAAc,GACdC,EAAa,GACbC,EAAU,GACVC,EAAc,GACdC,EAAoB,OAMf5C,GAKR2D,QAAS,SAAW3D,EAASF,EAASyC,EAAqBvB,EAAewB,EAAaC,EAAYC,EAASC,EAAaC,EAAmBP,GAE3I,IAAM,IAAIxiC,EAAI,EAAGA,EAAIwiC,EAAYxiC,IAEhCmgC,EAAQG,OAAOvrB,KAAMkrB,EAAQyB,gBAAiBgB,EAAqB,KACnEvC,EAAQG,OAAOvrB,KAAMkrB,EAAQyB,gBAAiBgB,EAAqB,KACnEvC,EAAQG,OAAOvrB,KAAMkrB,EAAQyB,gBAAiBgB,EAAqB,KAEnEvC,EAAQG,OAAOvrB,KAAMkrB,EAAQyB,gBAAiBgB,EAAiC,GAAV1iC,EAAI,MACzEmgC,EAAQG,OAAOvrB,KAAMkrB,EAAQyB,gBAAiBgB,EAAiC,GAAV1iC,EAAI,GAAU,KACnFmgC,EAAQG,OAAOvrB,KAAMkrB,EAAQyB,gBAAiBgB,EAAiC,GAAV1iC,EAAI,GAAU,KAEnFmgC,EAAQG,OAAOvrB,KAAMkrB,EAAQyB,gBAAiBgB,EAAyB,EAAJ1iC,KACnEmgC,EAAQG,OAAOvrB,KAAMkrB,EAAQyB,gBAAiBgB,EAAyB,EAAJ1iC,EAAQ,KAC3EmgC,EAAQG,OAAOvrB,KAAMkrB,EAAQyB,gBAAiBgB,EAAyB,EAAJ1iC,EAAQ,KAEtEigC,EAAQ3U,WAEZ6U,EAAQ/hB,cAAcrJ,KAAM+tB,EAAa,IACzC3C,EAAQ/hB,cAAcrJ,KAAM+tB,EAAa,IACzC3C,EAAQ/hB,cAAcrJ,KAAM+tB,EAAa,IACzC3C,EAAQ/hB,cAAcrJ,KAAM+tB,EAAa,IAEzC3C,EAAQ/hB,cAAcrJ,KAAM+tB,EAAyB,GAAV9iC,EAAI,KAC/CmgC,EAAQ/hB,cAAcrJ,KAAM+tB,EAAyB,GAAV9iC,EAAI,GAAU,IACzDmgC,EAAQ/hB,cAAcrJ,KAAM+tB,EAAyB,GAAV9iC,EAAI,GAAU,IACzDmgC,EAAQ/hB,cAAcrJ,KAAM+tB,EAAyB,GAAV9iC,EAAI,GAAU,IAEzDmgC,EAAQ/hB,cAAcrJ,KAAM+tB,EAAiB,EAAJ9iC,IACzCmgC,EAAQ/hB,cAAcrJ,KAAM+tB,EAAiB,EAAJ9iC,EAAQ,IACjDmgC,EAAQ/hB,cAAcrJ,KAAM+tB,EAAiB,EAAJ9iC,EAAQ,IACjDmgC,EAAQ/hB,cAAcrJ,KAAM+tB,EAAiB,EAAJ9iC,EAAQ,IAEjDmgC,EAAQO,eAAe3rB,KAAMguB,EAAmB,IAChD5C,EAAQO,eAAe3rB,KAAMguB,EAAmB,IAChD5C,EAAQO,eAAe3rB,KAAMguB,EAAmB,IAChD5C,EAAQO,eAAe3rB,KAAMguB,EAAmB,IAEhD5C,EAAQO,eAAe3rB,KAAMguB,EAA+B,GAAV/iC,EAAI,KACtDmgC,EAAQO,eAAe3rB,KAAMguB,EAA+B,GAAV/iC,EAAI,GAAU,IAChEmgC,EAAQO,eAAe3rB,KAAMguB,EAA+B,GAAV/iC,EAAI,GAAU,IAChEmgC,EAAQO,eAAe3rB,KAAMguB,EAA+B,GAAV/iC,EAAI,GAAU,IAEhEmgC,EAAQO,eAAe3rB,KAAMguB,EAAuB,EAAJ/iC,IAChDmgC,EAAQO,eAAe3rB,KAAMguB,EAAuB,EAAJ/iC,EAAQ,IACxDmgC,EAAQO,eAAe3rB,KAAMguB,EAAuB,EAAJ/iC,EAAQ,IACxDmgC,EAAQO,eAAe3rB,KAAMguB,EAAuB,EAAJ/iC,EAAQ,KAIpDigC,EAAQnqB,QAEZqqB,EAAQK,OAAOzrB,KAAM6tB,EAAY,IACjCzC,EAAQK,OAAOzrB,KAAM6tB,EAAY,IACjCzC,EAAQK,OAAOzrB,KAAM6tB,EAAY,IAEjCzC,EAAQK,OAAOzrB,KAAM6tB,EAAwB,GAAV5iC,EAAI,KACvCmgC,EAAQK,OAAOzrB,KAAM6tB,EAAwB,GAAV5iC,EAAI,GAAU,IACjDmgC,EAAQK,OAAOzrB,KAAM6tB,EAAwB,GAAV5iC,EAAI,GAAU,IAEjDmgC,EAAQK,OAAOzrB,KAAM6tB,EAAgB,EAAJ5iC,IACjCmgC,EAAQK,OAAOzrB,KAAM6tB,EAAgB,EAAJ5iC,EAAQ,IACzCmgC,EAAQK,OAAOzrB,KAAM6tB,EAAgB,EAAJ5iC,EAAQ,KAIrCigC,EAAQpqB,UAA6C,YAAjCoqB,EAAQpqB,SAASorB,cAEzCd,EAAQgB,cAAcpsB,KAAMosB,GAC5BhB,EAAQgB,cAAcpsB,KAAMosB,GAC5BhB,EAAQgB,cAAcpsB,KAAMosB,IAIxBlB,EAAQ/Y,SAEZiZ,EAAQjZ,OAAOnS,KAAM4tB,EAAa,IAClCxC,EAAQjZ,OAAOnS,KAAM4tB,EAAa,IAClCxC,EAAQjZ,OAAOnS,KAAM4tB,EAAa,IAElCxC,EAAQjZ,OAAOnS,KAAM4tB,EAAyB,GAAV3iC,EAAI,KACxCmgC,EAAQjZ,OAAOnS,KAAM4tB,EAAyB,GAAV3iC,EAAI,GAAU,IAClDmgC,EAAQjZ,OAAOnS,KAAM4tB,EAAyB,GAAV3iC,EAAI,GAAU,IAElDmgC,EAAQjZ,OAAOnS,KAAM4tB,EAAiB,EAAJ3iC,IAClCmgC,EAAQjZ,OAAOnS,KAAM4tB,EAAiB,EAAJ3iC,EAAQ,IAC1CmgC,EAAQjZ,OAAOnS,KAAM4tB,EAAiB,EAAJ3iC,EAAQ,KAItCigC,EAAQ9Y,IAEZ8Y,EAAQ9Y,GAAGhhB,SAAS,SAAWghB,EAAI7L,QAERhF,IAArB6pB,EAAQW,IAAKxlB,KAAoB6kB,EAAQW,IAAKxlB,GAAM,IAEzD6kB,EAAQW,IAAKxlB,GAAIvG,KAAM8tB,EAASvnB,GAAK,IACrC6kB,EAAQW,IAAKxlB,GAAIvG,KAAM8tB,EAASvnB,GAAK,IAErC6kB,EAAQW,IAAKxlB,GAAIvG,KAAM8tB,EAASvnB,GAAiB,GAAVtb,EAAI,KAC3CmgC,EAAQW,IAAKxlB,GAAIvG,KAAM8tB,EAASvnB,GAAiB,GAAVtb,EAAI,GAAU,IAErDmgC,EAAQW,IAAKxlB,GAAIvG,KAAM8tB,EAASvnB,GAAS,EAAJtb,IACrCmgC,EAAQW,IAAKxlB,GAAIvG,KAAM8tB,EAASvnB,GAAS,EAAJtb,EAAQ,QAUjDyhC,gBAAiB,SAAWsC,EAAWC,EAAe9L,EAAa8H,GAElE,GAAqB,OAAhB9H,EAAL,CAEA6L,EAAU5E,gBAAgBvkC,SAAW,GACrCmpC,EAAU5E,gBAAgBjY,OAAS,GAEnC,IAAI9R,EAAO/a,KACX69B,EAAYC,WAAWhyB,SAAS,SAAW89B,GAE1C,IAAIC,EAAe7T,EAAQiD,QAAQiM,SAAU0E,EAAU1K,YAEjCjjB,IAAjB4tB,GAEJ9uB,EAAK+uB,iBAAkBJ,EAAWC,EAAeE,EAAclE,QAYlEmE,iBAAkB,SAAWJ,EAAWC,EAAeE,EAAclE,GAEpE,IAAIoE,EAAW,IAAI1pC,MAAM2sB,eACpB6c,EAAajP,WAAWmP,EAASz0B,KAAOu0B,EAAajP,UAU1D,IARA,IAAI2M,OAAuDtrB,IAArC0tB,EAAcnC,mBAAqCmC,EAAcnC,mBAAmB5lB,EAAI,GAG1GylB,OAA+CprB,IAA3B0tB,EAAcrC,SAA2BqC,EAAcrC,SAAS1lB,EAAEmG,QAAU,GAEhGiiB,OAA6C/tB,IAA1B4tB,EAAavC,SAA2BuC,EAAavC,SAAS1lB,EAAI,GACrF/B,OAAqC5D,IAAzB4tB,EAAapL,QAA0BoL,EAAapL,QAAQ7c,EAAI,GAEtEjc,EAAI,EAAGA,EAAIka,EAAQja,OAAQD,IAAO,CAE3C,IAAIskC,EAA4B,EAAfpqB,EAASla,GAI1B0hC,EAAiB4C,IAAgBD,EAAoB,EAAJrkC,GACjD0hC,EAAiB4C,EAAa,IAAOD,EAAoB,EAAJrkC,EAAQ,GAC7D0hC,EAAiB4C,EAAa,IAAOD,EAAoB,EAAJrkC,EAAQ,GAK9D,IAAIukC,EAAe,CAClB3C,cAAeA,EACfF,gBAAiBA,GAGd8C,EAAenqC,KAAK+lC,WAAYmE,GAEhClE,EAAoB,IAAI3lC,MAAMotB,uBAAwB0c,EAAalE,OAAQ,GAC/ED,EAAkB1wB,KAAOu0B,EAAajP,SAEtC+K,EAAaO,uBAAwBF,GAErC0D,EAAU5E,gBAAgBvkC,SAASma,KAAMsrB,IAK1C8B,aAAc,SAAWsC,GAExB,IAAIxD,EAAcwD,EAAWC,uBACzBC,EAAgBF,EAAWG,yBAC3B9T,EAAS2T,EAAWI,QAAQ5oB,EAC5B6oB,EAAc,GAelB,MAduB,kBAAlBH,IAEC,gBAAiBF,EAErBK,EAAcL,EAAWM,YAAY9oB,EAE1B,iBAAkBwoB,IAE7BK,EAAcL,EAAWO,aAAa/oB,IAMjC,CACNgpB,SAAU,EACVnU,OAAQA,EACR5W,QAAS4qB,EACT7D,YAAaA,EACb0D,cAAeA,IAMjBtC,SAAU,SAAW6C,GAEpB,IAAIjE,EAAciE,EAAOR,uBACrBC,EAAgBO,EAAON,yBACvB9T,EAASoU,EAAOC,GAAGlpB,EACnB6oB,EAAc,GAOlB,MANuB,kBAAlBH,IAEJG,EAAcI,EAAOE,QAAQnpB,GAIvB,CACNgpB,SAAU,EACVnU,OAAQA,EACR5W,QAAS4qB,EACT7D,YAAaA,EACb0D,cAAeA,IAMjB5C,kBAAmB,SAAWsD,GAE7B,IAAIpE,EAAcoE,EAAUX,uBACxBC,EAAgBU,EAAUT,yBAC1B9T,EAASuU,EAAUC,OAAOrpB,EAC1B6oB,EAAc,GAOlB,MANuB,kBAAlBH,IAEJG,EAAcO,EAAUE,WAAWtpB,GAI7B,CACNgpB,SAAU,EACVnU,OAAQA,EACR5W,QAAS4qB,EACT7D,YAAaA,EACb0D,cAAeA,IAMjB1C,qBAAsB,SAAWuD,GAEhC,IAAIvE,EAAcuE,EAAad,uBAC3BC,EAAgBa,EAAaZ,yBAEjC,GAAqB,yBAAhB3D,EAEJ,MAAO,CACNgE,SAAU,EACVnU,OAAQ,CAAE,GACV5W,QAAS,CAAE,GACX+mB,YAAa,UACb0D,cAAeA,GAYjB,IAPA,IAAIc,EAAsBD,EAAaE,UAAUzpB,EAK7C0pB,EAAkB,GAEZ3lC,EAAI,EAAGA,EAAIylC,EAAoBxlC,SAAWD,EAEnD2lC,EAAgB5wB,KAAM/U,GAIvB,MAAO,CACNilC,SAAU,EACVnU,OAAQ2U,EACRvrB,QAASyrB,EACT1E,YAAaA,EACb0D,cAAeA,IAMjBhF,mBAAoB,SAAWF,GAE9B,QAA0BnpB,IAArB5b,MAAMkrC,WAGV,OADAxhC,QAAQsnB,MAAO,oIACR,IAAIhxB,MAAM2sB,eAIlB,IAAIwe,EAAQrtB,SAAUinB,EAAQqG,OAE9B,GAAK9wB,MAAO6wB,GAGX,OADAzhC,QAAQsnB,MAAO,8DAA+D+T,EAAQqG,MAAOrG,EAAQh+B,IAC9F,IAAI/G,MAAM2sB,eAUlB,IANA,IAYI0e,EAAWC,EAZXC,EAASJ,EAAQ,EAEjBK,EAAQzG,EAAQ0G,WAAWlqB,EAC3BmqB,EAAgB,GAChBC,EAAe5G,EAAQ6G,OAAOrqB,EAExBjc,EAAI,EAAGsQ,EAAI+1B,EAAapmC,OAAQD,EAAIsQ,EAAGtQ,GAAK,EAErDomC,EAAcrxB,MAAM,IAAIra,MAAM6rC,SAAU1pB,UAAWwpB,EAAcrmC,IAMlE,GAAsB,WAAjBy/B,EAAQ+G,KAEZJ,EAAcrxB,KAAMqxB,EAAe,SAE7B,GAAsB,aAAjB3G,EAAQ+G,KAAsB,CAEzCT,EAAYE,EACZD,EAAUE,EAAMjmC,OAAS,EAAI8lC,EAE7B,IAAU/lC,EAAI,EAAGA,EAAIimC,IAAWjmC,EAE/BomC,EAAcrxB,KAAMqxB,EAAepmC,IAMrC,IACI6mB,EADQ,IAAInsB,MAAMkrC,WAAYK,EAAQC,EAAOE,EAAeL,EAAWC,GACtDS,UAAkC,EAAvBL,EAAcnmC,QAE1CymC,EAAY,IAAIC,aAAgC,EAAlB9f,EAAS5mB,QAE3C4mB,EAAS1gB,SAAS,SAAWm6B,EAAQtgC,GAEpCsgC,EAAOsG,QAASF,EAAe,EAAJ1mC,MAI5B,IAAIsU,EAAW,IAAI5Z,MAAM2sB,eAGzB,OAFA/S,EAASuT,aAAc,WAAY,IAAIntB,MAAMmsC,gBAAiBH,EAAW,IAElEpyB,IASToc,EAAgBpjB,UAAY,CAE3BkJ,YAAaka,EAGbrZ,MAAO,WAEN,IAAIyvB,EAAiB,GAGjBC,EAAW1sC,KAAK2sC,aAEpB,QAAkB1wB,IAAbywB,EAAyB,OAAOD,EAErC,IAAM,IAAIlgC,KAAOmgC,EAAW,CAE3B,IAAIE,EAAUF,EAAUngC,GAEpB8L,EAAOrY,KAAK6sC,QAASD,GAEzBH,EAAe/xB,KAAMrC,GAItB,OAAOo0B,GAIRE,WAAY,WAIX,QAAwC1wB,IAAnC+Z,EAAQiD,QAAQ6T,eAArB,CAEA,IAAIC,EAAgB/sC,KAAKgtC,2BAEzBhtC,KAAKitC,qBAAsBF,GAE3B,IAAIG,EAAYltC,KAAKmtC,qBAAsBJ,GAG3C,OAFe/sC,KAAKotC,gBAAiBF,KAStCF,yBAA0B,WAEzB,IAAIK,EAAgBrX,EAAQiD,QAAQqU,mBAEhCP,EAAgB,IAAI1U,IAExB,IAAM,IAAIe,KAAUiU,EAAgB,CAEnC,IAAIE,EAAeF,EAAejU,GAElC,GAA8D,OAAzDmU,EAAa3S,SAASrgB,MAAO,uBAAmC,CAEpE,IAAIizB,EAAY,CAEfpmC,GAAImmC,EAAanmC,GACjBq5B,KAAM8M,EAAa3S,SACnB6S,OAAQ,IAITV,EAAczrC,IAAKksC,EAAUpmC,GAAIomC,IAMnC,OAAOT,GAORE,qBAAsB,SAAWF,GAEhC,IAAIW,EAAY1X,EAAQiD,QAAQ6T,eAShC,IAAM,IAAI1T,KAAUsU,EAAY,CAE/B,IAAIC,EAAiB,CAEpBvmC,GAAIsmC,EAAWtU,GAAShyB,GACxB+a,MAAOurB,EAAWtU,GAASwU,QAAQhsB,EAAEvH,IAAK0c,GAC1CoE,OAAQuS,EAAWtU,GAASyU,cAAcjsB,GAIvC6b,EAAgBxH,EAAY/iB,IAAKy6B,EAAevmC,IAEpD,QAAuB6U,IAAlBwhB,EAA8B,CAElC,IAAIqQ,EAAmBrQ,EAAc7E,QAAS,GAAIE,GAC9CiV,EAA6BtQ,EAAc7E,QAAS,GAAIF,aAEvDqV,EAA2BxzB,MAAO,KAEtCwyB,EAAc75B,IAAK46B,GAAmBL,OAAY,EAAIE,EAE3CI,EAA2BxzB,MAAO,KAE7CwyB,EAAc75B,IAAK46B,GAAmBL,OAAY,EAAIE,EAE3CI,EAA2BxzB,MAAO,KAE7CwyB,EAAc75B,IAAK46B,GAAmBL,OAAY,EAAIE,EAE3CI,EAA2BxzB,MAAO,oBAAuBwyB,EAAcpU,IAAKmV,KAEvFf,EAAc75B,IAAK46B,GAAmBL,OAAgB,MAAIE,MAa9DR,qBAAsB,SAAWJ,GAEhC,IAAIiB,EAAYhY,EAAQiD,QAAQgV,eAE5Bf,EAAY,IAAI7U,IAEpB,IAAM,IAAIe,KAAU4U,EAAY,CAE/B,IAAIE,EAAkB,GAElBzO,EAAaxJ,EAAY/iB,IAAKiL,SAAUib,IAE5C,QAAoBnd,IAAfwjB,EAA2B,CAG/B,IAAIrO,EAAWqO,EAAWrO,SAEtBrW,EAAO/a,KACXoxB,EAAStlB,SAAS,SAAW4R,EAAO/X,GAEnC,GAAKonC,EAAcpU,IAAKjb,EAAMob,IAAO,CAEpC,IAAI0U,EAAYT,EAAc75B,IAAKwK,EAAMob,IAGzC,QAA4B7c,IAAvBuxB,EAAUC,OAAOtqC,QAA0C8Y,IAAvBuxB,EAAUC,OAAOlqC,QAA0C0Y,IAAvBuxB,EAAUC,OAAO3oC,EAAkB,CAE/G,QAA8BmX,IAAzBiyB,EAAiBvoC,GAAoB,CAIzCswB,EAAY/iB,IAAKwK,EAAMob,IAAKF,QAAQ9sB,SAAS,SAAW4zB,QAE1BzjB,IAAxByjB,EAAOhH,eAA6ByV,EAAUzO,EAAO5G,OAI3D,IAAIsV,EAAWpY,EAAQiD,QAAQqG,MAAO6O,EAAQxH,YAE1CxlB,EAAO,CAEVktB,UAAWhuC,MAAM8/B,gBAAgBC,iBAAkBgO,EAASxT,UAC5D0T,gBAAiB,CAAE,EAAG,EAAG,GACzBC,gBAAiB,CAAE,EAAG,EAAG,GACzBC,aAAc,CAAE,EAAG,EAAG,GACtBntB,UAAWtG,EAAK0zB,sBAAuBL,IAMnC,gBAAiBA,IAAWjtB,EAAKutB,aAAeN,EAAS7K,YAAYr7B,OACrE,iBAAkBkmC,IAAWjtB,EAAKwtB,cAAgBP,EAAS3K,aAAav7B,OAE7EgmC,EAAiBvoC,GAAMwb,EAIxB+sB,EAAiBvoC,GAAK6nC,EAAU/M,MAAS+M,OAEnC,QAAgCvxB,IAA3BuxB,EAAUC,OAAOmB,MAAsB,CAElD,QAA8B3yB,IAAzBiyB,EAAiBvoC,GAAoB,CAEzC,IAAIkpC,EAEJ5Y,EAAY/iB,IAAKwK,EAAMob,IAAKF,QAAQ9sB,SAAS,SAAW4zB,QAE1BzjB,IAAxByjB,EAAOhH,eAA6BmW,EAAanP,EAAO5G,OAI9D,IAAIgW,EAAY7Y,EAAY/iB,IAAK27B,GAAajW,QAAS,GAAIE,GACvDoG,EAAQjJ,EAAY/iB,IAAK47B,GAAYlW,QAAS,GAAIE,GAGlDqV,EAAUlY,EAAY/iB,IAAKgsB,GAAQtG,QAAS,GAAIE,GAEhDsV,EAAWpY,EAAQiD,QAAQqG,MAAO6O,GAElChtB,EAAO,CAEVktB,UAAWhuC,MAAM8/B,gBAAgBC,iBAAkBgO,EAASxT,UAC5DmU,UAAW/Y,EAAQiD,QAAQsE,SAAUsR,GAAajU,UAInDsT,EAAiBvoC,GAAMwb,EAIxB+sB,EAAiBvoC,GAAK6nC,EAAU/M,MAAS+M,OAQ5CN,EAAU5rC,IAAK6c,SAAUib,GAAU8U,IAMrC,OAAOhB,GAIRuB,sBAAuB,SAAWlP,GAEjC,IAAIuD,EAAgB,GAcpB,MAZK,kBAAmBvD,IAAYuD,EAAcC,WAAa5kB,SAAUohB,EAAUyD,cAAc96B,QAE5F,oBAAqBq3B,IAAYuD,EAAcG,YAAc1D,EAAU2D,gBAAgBh7B,OACvF,mBAAoBq3B,IAAYuD,EAAcK,eAAiB5D,EAAU6D,eAAel7B,OAExF,iBAAkBq3B,IAAYuD,EAAc9/B,SAAWu8B,EAAU8D,aAAan7B,OAC9E,gBAAiBq3B,IAAYuD,EAAcQ,YAAc/D,EAAUgE,YAAYr7B,OAE/E,iBAAkBq3B,IAAYuD,EAAcU,aAAejE,EAAUkE,aAAav7B,OAElF,gBAAiBq3B,IAAYuD,EAAc7gB,MAAQsd,EAAUmE,YAAYx7B,OAEvEy7B,EAAmBb,IAM3BsK,gBAAiB,SAAWF,GAE3B,IAAI8B,EAAYhZ,EAAQiD,QAAQgW,eAG5BvC,EAAW,GAEf,IAAM,IAAItT,KAAU4V,EAAY,CAE/B,IAAI5d,EAAW6E,EAAY/iB,IAAKiL,SAAUib,IAAWhI,SAEhDA,EAASxrB,OAAS,GAItBmE,QAAQqT,KAAM,sIAIf,IAAI8xB,EAAQhC,EAAUh6B,IAAKke,EAAU,GAAI0H,IAEzC4T,EAAUtT,GAAW,CAEpB9jB,KAAM05B,EAAW5V,GAASwB,SAC1BsU,MAAOA,GAMT,OAAOxC,GAIRG,QAAS,SAAWD,GAEnB,IAAI5sB,EAAS,GAETjF,EAAO/a,KAOX,OANA4sC,EAAQsC,MAAMpjC,SAAS,SAAWqjC,GAEjCnvB,EAASA,EAAOovB,OAAQr0B,EAAKs0B,eAAgBF,OAIvC,IAAI9uC,MAAMmjB,cAAeopB,EAAQt3B,MAAQ,EAAG0K,IAIpDqvB,eAAgB,SAAWF,GAE1B,IAAInvB,EAAS,GAETsuB,EAAkB,IAAIjuC,MAAMC,QAC5BiuC,EAAkB,IAAIluC,MAAMwU,WAC5B25B,EAAe,IAAInuC,MAAMC,QAQ7B,GANK6uC,EAAU9tB,WAAY8tB,EAAU9tB,UAAUoB,UAAW6rB,EAAiBC,EAAiBC,GAE5FF,EAAkBA,EAAgB/B,UAClCgC,GAAkB,IAAIluC,MAAMw1B,OAAQyZ,kBAAmBf,GAAkBhC,UACzEiC,EAAeA,EAAajC,eAEPtwB,IAAhBkzB,EAAUI,GAAmBzpC,OAAOC,KAAMopC,EAAUI,EAAE9B,QAAS7nC,OAAS,EAAI,CAEhF,IAAI4pC,EAAgBxvC,KAAKyvC,oBAAqBN,EAAUd,UAAWc,EAAUI,EAAE9B,OAAQa,EAAiB,iBACjFryB,IAAlBuzB,GAA8BxvB,EAAOtF,KAAM80B,GAIjD,QAAqBvzB,IAAhBkzB,EAAUO,GAAmB5pC,OAAOC,KAAMopC,EAAUO,EAAEjC,QAAS7nC,OAAS,EAAI,CAEhF,IAAI+pC,EAAgB3vC,KAAK4vC,sBAAuBT,EAAUd,UAAWc,EAAUO,EAAEjC,OAAQc,EAAiBY,EAAUT,aAAcS,EAAUR,oBACrH1yB,IAAlB0zB,GAA8B3vB,EAAOtF,KAAMi1B,GAIjD,QAAqB1zB,IAAhBkzB,EAAUU,GAAmB/pC,OAAOC,KAAMopC,EAAUU,EAAEpC,QAAS7nC,OAAS,EAAI,CAEhF,IAAIkqC,EAAa9vC,KAAKyvC,oBAAqBN,EAAUd,UAAWc,EAAUU,EAAEpC,OAAQe,EAAc,cAC9EvyB,IAAf6zB,GAA2B9vB,EAAOtF,KAAMo1B,GAI9C,QAAiC7zB,IAA5BkzB,EAAUpQ,cAA8B,CAE5C,IAAIgR,EAAa/vC,KAAKgwC,mBAAoBb,QACtBlzB,IAAf8zB,GAA2B/vB,EAAOtF,KAAMq1B,GAI9C,OAAO/vB,GAIRyvB,oBAAqB,SAAWpB,EAAWZ,EAAQwC,EAAc5tC,GAEhE,IAAI8f,EAAQniB,KAAKkwC,mBAAoBzC,GACjCtS,EAASn7B,KAAKmwC,uBAAwBhuB,EAAOsrB,EAAQwC,GAEzD,OAAO,IAAI5vC,MAAMsiB,oBAAqB0rB,EAAY,IAAMhsC,EAAM8f,EAAOgZ,IAItEyU,sBAAuB,SAAWvB,EAAWZ,EAAQwC,EAAcvB,EAAcC,QAE9D1yB,IAAbwxB,EAAOtqC,IAEXnD,KAAKowC,qBAAsB3C,EAAOtqC,GAClCsqC,EAAOtqC,EAAEg4B,OAASsS,EAAOtqC,EAAEg4B,OAAO9gB,IAAKha,MAAM+C,KAAKC,gBAGjC4Y,IAAbwxB,EAAOlqC,IAEXvD,KAAKowC,qBAAsB3C,EAAOlqC,GAClCkqC,EAAOlqC,EAAE43B,OAASsS,EAAOlqC,EAAE43B,OAAO9gB,IAAKha,MAAM+C,KAAKC,gBAGjC4Y,IAAbwxB,EAAO3oC,IAEX9E,KAAKowC,qBAAsB3C,EAAO3oC,GAClC2oC,EAAO3oC,EAAEq2B,OAASsS,EAAO3oC,EAAEq2B,OAAO9gB,IAAKha,MAAM+C,KAAKC,WAInD,IAAI8e,EAAQniB,KAAKkwC,mBAAoBzC,GACjCtS,EAASn7B,KAAKmwC,uBAAwBhuB,EAAOsrB,EAAQwC,QAEnCh0B,IAAjByyB,KAEJA,EAAeA,EAAar0B,IAAKha,MAAM+C,KAAKC,WAC/BqX,KAAM,OAEnBg0B,GAAe,IAAIruC,MAAMw1B,OAAQrT,UAAWksB,GAC5CA,GAAe,IAAIruC,MAAMwU,YAAa+gB,aAAc8Y,SAI9BzyB,IAAlB0yB,KAEJA,EAAgBA,EAAct0B,IAAKha,MAAM+C,KAAKC,WAChCqX,KAAM,OAEpBi0B,GAAgB,IAAItuC,MAAMw1B,OAAQrT,UAAWmsB,GAC7CA,GAAgB,IAAItuC,MAAMwU,YAAa+gB,aAAc+Y,GAAgB0B,WAStE,IALA,IAAIj6B,EAAa,IAAI/V,MAAMwU,WACvBy7B,EAAQ,IAAIjwC,MAAMw1B,MAElB0a,EAAmB,GAEb5qC,EAAI,EAAGA,EAAIw1B,EAAOv1B,OAAQD,GAAK,EAExC2qC,EAAMhvC,IAAK65B,EAAQx1B,GAAKw1B,EAAQx1B,EAAI,GAAKw1B,EAAQx1B,EAAI,GAAK,OAE1DyQ,EAAWwf,aAAc0a,QAEHr0B,IAAjByyB,GAA6Bt4B,EAAWG,YAAam4B,QACnCzyB,IAAlB0yB,GAA8Bv4B,EAAWka,SAAUqe,GAExDv4B,EAAWm2B,QAASgE,EAAoB5qC,EAAI,EAAM,GAInD,OAAO,IAAItF,MAAMuiB,wBAAyByrB,EAAY,cAAelsB,EAAOouB,IAI7EP,mBAAoB,SAAWb,GAE9B,IAAI1B,EAAS0B,EAAUpQ,cAAc0O,OAAOmB,MACxCzT,EAASsS,EAAOtS,OAAO9gB,KAAK,SAAWm2B,GAE1C,OAAOA,EAAM,OAIVC,EAAWva,EAAWwa,gBAAiBvB,EAAUd,WAAYsC,sBAAuBxB,EAAUJ,WAElG,OAAO,IAAI1uC,MAAMuwC,oBAAqBzB,EAAUd,UAAY,0BAA4BoC,EAAW,IAAKhD,EAAOtrB,MAAOgZ,IAMvH+U,mBAAoB,SAAWzC,GAE9B,IAAItrB,EAAQ,GAkBZ,YAfkBlG,IAAbwxB,EAAOtqC,IAAkBgf,EAAQA,EAAMitB,OAAQ3B,EAAOtqC,EAAEgf,aAC3ClG,IAAbwxB,EAAOlqC,IAAkB4e,EAAQA,EAAMitB,OAAQ3B,EAAOlqC,EAAE4e,aAC3ClG,IAAbwxB,EAAO3oC,IAAkBqd,EAAQA,EAAMitB,OAAQ3B,EAAO3oC,EAAEqd,QAG7DA,EAAQA,EAAMR,MAAM,SAAWC,EAAGC,GAEjC,OAAOD,EAAIC,KAERgvB,QAAQ,SAAWC,EAAM7qC,EAAOuX,GAEnC,OAAOA,EAAMrS,QAAS2lC,IAAU7qC,MAQlCkqC,uBAAwB,SAAWhuB,EAAOsrB,EAAQwC,GAEjD,IAAIc,EAAYd,EAEZ9U,EAAS,GAET6V,GAAW,EACXC,GAAW,EACXC,GAAW,EAgDf,OA9CA/uB,EAAMrW,SAAS,SAAWgV,GAOzB,GALK2sB,EAAOtqC,IAAI6tC,EAASvD,EAAOtqC,EAAEgf,MAAMhX,QAAS2V,IAC5C2sB,EAAOlqC,IAAI0tC,EAASxD,EAAOlqC,EAAE4e,MAAMhX,QAAS2V,IAC5C2sB,EAAO3oC,IAAIosC,EAASzD,EAAO3oC,EAAEqd,MAAMhX,QAAS2V,KAG/B,IAAbkwB,EAAiB,CAErB,IAAIG,EAAS1D,EAAOtqC,EAAEg4B,OAAQ6V,GAC9B7V,EAAOzgB,KAAMy2B,GACbJ,EAAW,GAAMI,OAKjBhW,EAAOzgB,KAAMq2B,EAAW,IAIzB,IAAkB,IAAbE,EAAiB,CAErB,IAAIG,EAAS3D,EAAOlqC,EAAE43B,OAAQ8V,GAC9B9V,EAAOzgB,KAAM02B,GACbL,EAAW,GAAMK,OAIjBjW,EAAOzgB,KAAMq2B,EAAW,IAIzB,IAAkB,IAAbG,EAAiB,CAErB,IAAIG,EAAS5D,EAAO3oC,EAAEq2B,OAAQ+V,GAC9B/V,EAAOzgB,KAAM22B,GACbN,EAAW,GAAMM,OAIjBlW,EAAOzgB,KAAMq2B,EAAW,OAMnB5V,GAORiV,qBAAsB,SAAWkB,GAEhC,IAAM,IAAI3rC,EAAI,EAAGA,EAAI2rC,EAAMnW,OAAOv1B,OAAQD,IAAO,CAEhD,IAAIsqC,EAAeqB,EAAMnW,OAAQx1B,EAAI,GACjC4rC,EAAaD,EAAMnW,OAAQx1B,GAAMsqC,EAEjCuB,EAAepuC,KAAKuB,IAAK4sC,GAE7B,GAAKC,GAAgB,IAAM,CAe1B,IAbA,IAAIC,EAAkBD,EAAe,IAEjCE,EAAOH,EAAaE,EACpBE,EAAY1B,EAAeyB,EAE3BE,EAAcN,EAAMnvB,MAAOxc,EAAI,GAE/BksC,GADWP,EAAMnvB,MAAOxc,GAAMisC,GACRH,EACtBK,EAAWF,EAAcC,EAEzBE,EAAoB,GACpBC,EAAqB,GAEjBF,EAAWR,EAAMnvB,MAAOxc,IAE/BosC,EAAkBr3B,KAAMo3B,GACxBA,GAAYD,EAEZG,EAAmBt3B,KAAMi3B,GACzBA,GAAaD,EAIdJ,EAAMnvB,MAAQ8vB,EAAQX,EAAMnvB,MAAOxc,EAAGosC,GACtCT,EAAMnW,OAAS8W,EAAQX,EAAMnW,OAAQx1B,EAAGqsC,OAa5C1b,EAAWrjB,UAAY,CAEtBkJ,YAAama,EAEb4b,YAAa,WAEZ,OAAOlyC,KAAKmyC,UAAWnyC,KAAKoyC,cAAgB,IAI7CC,eAAgB,WAEf,OAAOryC,KAAKmyC,UAAWnyC,KAAKoyC,cAAgB,IAI7CE,eAAgB,WAEf,OAAOtyC,KAAKuyC,aAIbC,UAAW,SAAWrxB,GAErBnhB,KAAKmyC,UAAUz3B,KAAMyG,GACrBnhB,KAAKoyC,eAAiB,GAIvBK,SAAU,WAETzyC,KAAKmyC,UAAUrjB,MACf9uB,KAAKoyC,eAAiB,GAIvBM,eAAgB,SAAWlC,EAAKl7B,GAE/BtV,KAAKuyC,YAAc/B,EACnBxwC,KAAK2yC,gBAAkBr9B,GAIxB0H,MAAO,SAAWD,GAEjB/c,KAAKoyC,cAAgB,EACrBroC,QAAQC,IAAI,YAAa6sB,GACzB72B,KAAK4yC,SAAW,IAAI/b,EACpB72B,KAAKmyC,UAAY,GACjBnyC,KAAKuyC,YAAc,GACnBvyC,KAAK2yC,gBAAkB,GAEvB,IAAI53B,EAAO/a,KAEPoa,EAAQ2C,EAAK3C,MAAO,WAmCxB,OAjCAA,EAAMtO,SAAS,SAAW+mC,EAAMltC,GAE/B,IAAImtC,EAAeD,EAAKt4B,MAAO,aAC3Bw4B,EAAaF,EAAKt4B,MAAO,aAE7B,IAAKu4B,IAAgBC,EAArB,CAEA,IAAIC,EAAiBH,EAAKt4B,MAAO,QAAUQ,EAAKq3B,cAAgB,gBAAiB,IAC7Ea,EAAgBJ,EAAKt4B,MAAO,QAAYQ,EAAmB,cAAI,8BAC/Dm4B,EAAWL,EAAKt4B,MAAO,SAAYQ,EAAKq3B,cAAgB,GAAM,MAE7DY,EAEJj4B,EAAKo4B,eAAgBN,EAAMG,GAEhBC,EAEXl4B,EAAKq4B,kBAAmBP,EAAMI,EAAe74B,IAAUzU,IAE5CutC,EAEXn4B,EAAK03B,WAEMI,EAAKt4B,MAAO,cAIvBQ,EAAKs4B,2BAA4BR,OAM5B7yC,KAAK4yC,UAIbO,eAAgB,SAAWN,EAAMhwB,GAEhC,IAAIlF,EAAWkF,EAAU,GAAI/E,OAAO1F,QAAS,KAAM,IAAKA,QAAS,KAAM,IAEnEk7B,EAAYzwB,EAAU,GAAIzI,MAAO,KAAMC,KAAK,SAAWomB,GAE1D,OAAOA,EAAK3iB,OAAO1F,QAAS,KAAM,IAAKA,QAAS,KAAM,OAInD+I,EAAO,CAAE7L,KAAMqI,GACf41B,EAAQvzC,KAAKwzC,cAAeF,GAE5BG,EAAczzC,KAAKqyC,iBAGK,IAAvBryC,KAAKoyC,cAETpyC,KAAK4yC,SAAShxC,IAAK+b,EAAUwD,GAKxBxD,KAAY81B,GAGE,aAAb91B,EAEJ81B,EAAYnP,SAAS5pB,KAAMyG,QAEelF,IAA/Bw3B,EAAa91B,GAAWvW,KAEnCqsC,EAAa91B,GAAa,GAC1B81B,EAAa91B,GAAY81B,EAAa91B,GAAWvW,IAAOqsC,EAAa91B,IAIpD,KAAb41B,EAAMnsC,KAAYqsC,EAAa91B,GAAY41B,EAAMnsC,IAAO+Z,IAE9B,iBAAboyB,EAAMnsC,IAExBqsC,EAAa91B,GAAa,GAC1B81B,EAAa91B,GAAY41B,EAAMnsC,IAAO+Z,GAEd,iBAAbxD,IAEoB81B,EAAa91B,GAA1B,aAAbA,EAAoD,CAAEwD,GAC5BA,GAMR,iBAAboyB,EAAMnsC,KAAkB+Z,EAAK/Z,GAAKmsC,EAAMnsC,IAChC,KAAfmsC,EAAMj+B,OAAc6L,EAAKyZ,SAAW2Y,EAAMj+B,MAC3B,KAAfi+B,EAAMlxC,OAAc8e,EAAKuc,SAAW6V,EAAMlxC,MAE/CrC,KAAKwyC,UAAWrxB,IAIjBqyB,cAAe,SAAWD,GAEzB,IAAInsC,EAAKmsC,EAAO,GAEI,KAAfA,EAAO,KAEXnsC,EAAK+W,SAAUo1B,EAAO,IAEjB54B,MAAOvT,KAEXA,EAAKmsC,EAAO,KAMd,IAAIj+B,EAAO,GAAIjT,EAAO,GAStB,OAPKkxC,EAAM3tC,OAAS,IAEnB0P,EAAOi+B,EAAO,GAAIn7B,QAAS,WAAY,IACvC/V,EAAOkxC,EAAO,IAIR,CAAEnsC,GAAIA,EAAIkO,KAAMA,EAAMjT,KAAMA,IAIpC+wC,kBAAmB,SAAWP,EAAMhwB,EAAU6wB,GAE7C,IAAIC,EAAW9wB,EAAU,GAAIzK,QAAS,KAAM,IAAKA,QAAS,KAAM,IAAK0F,OACjE81B,EAAY/wB,EAAU,GAAIzK,QAAS,KAAM,IAAKA,QAAS,KAAM,IAAK0F,OAKpD,YAAb61B,GAAwC,MAAdC,IAE9BA,EAAYF,EAAYt7B,QAAS,KAAM,IAAKA,QAAS,KAAM,IAAK0F,QAIjE,IAAI21B,EAAczzC,KAAKqyC,iBAGvB,GAAoB,iBAFHoB,EAAYn+B,KAE7B,CAQA,GAAkB,MAAbq+B,EAAmB,CAEvB,IAAIE,EAAYD,EAAUx5B,MAAO,KAAM2N,MAAO,GAC1C+rB,EAAO31B,SAAU01B,EAAW,IAC5BE,EAAK51B,SAAU01B,EAAW,IAE1BG,EAAOJ,EAAUx5B,MAAO,KAAM2N,MAAO,GAQzC4rB,EAAW,cAm5Bd,SAAiB/xB,EAAGC,GAEnB,IAAM,IAAIlc,EAAI,EAAGsb,EAAIW,EAAEhc,OAAQqQ,EAAI4L,EAAEjc,OAAQD,EAAIsQ,EAAGtQ,IAAMsb,IAEzDW,EAAGX,GAAMY,EAAGlc,GAr5BXsuC,CADAL,EAAY,CAAEE,EAAMC,GAPpBC,EAAOA,EAAK35B,KAAK,SAAWy2B,GAE3B,OAAOA,EAAKhzB,OAAO1F,QAAS,KAAM,aAQF6D,IAA5Bw3B,EAAaE,KAEjBF,EAAaE,GAAa,IAOV,SAAbA,IAAsBF,EAAYrsC,GAAKwsC,GAGvCD,KAAYF,GAAe11B,MAAMwmB,QAASkP,EAAaE,IAE3DF,EAAaE,GAAWj5B,KAAMk5B,GAIZ,MAAbD,EAAmBF,EAAaE,GAAaC,EAC7CH,EAAY7xB,EAAIgyB,EAItB5zC,KAAK0yC,eAAgBe,EAAaE,GAGhB,MAAbA,GAA+C,MAA3BC,EAAU7rB,OAAS,KAE3C0rB,EAAY7xB,EAAIsyB,EAAkBN,SApDlC5zC,KAAKm0C,yBAA0BtB,EAAMc,EAAUC,IA0DjDP,2BAA4B,SAAWR,GAEtC,IAAIY,EAAczzC,KAAKqyC,iBAEvBoB,EAAY7xB,GAAKixB,EAIU,MAAtBA,EAAK9qB,OAAS,KAElB0rB,EAAY7xB,EAAIsyB,EAAkBT,EAAY7xB,KAOhDuyB,yBAA0B,SAAWtB,EAAMc,EAAUC,GAMpD,IAAIQ,EAAQR,EAAUx5B,MAAO,MAAOC,KAAK,SAAWg6B,GAEnD,OAAOA,EAAKv2B,OAAO1F,QAAS,MAAO,IAAKA,QAAS,KAAM,QAIpDk8B,EAAgBF,EAAO,GACvBG,EAAiBH,EAAO,GACxBI,EAAiBJ,EAAO,GACxBK,EAAgBL,EAAO,GACvBM,EAAiBN,EAAO,GAG5B,OAASG,GAER,IAAK,MACL,IAAK,OACL,IAAK,OACL,IAAK,YACL,IAAK,SACL,IAAK,SACL,IAAK,cACJG,EAAiBz2B,WAAYy2B,GAC7B,MAED,IAAK,QACL,IAAK,WACL,IAAK,WACL,IAAK,kBACL,IAAK,eACL,IAAK,cACJA,EAAiBR,EAAkBQ,GAMrC10C,KAAKkyC,cAAeoC,GAAkB,CAErC,KAAQC,EACR,MAASC,EACT,KAAQC,EACR,MAASC,GAIV10C,KAAK0yC,eAAgB1yC,KAAKkyC,cAAeoC,KAS3C/d,EAAatjB,UAAY,CAExBkJ,YAAaoa,EAEbvZ,MAAO,SAAWyZ,GAEjB,IAAIke,EAAS,IAAIne,EAAcC,GAC/Bke,EAAOC,KAAM,IAEb,IAAIrhB,EAAUohB,EAAOE,YAErB9qC,QAAQC,IAAK,wCAA0CupB,GAIvD,IAFA,IAAIqf,EAAW,IAAI/b,GAET72B,KAAK80C,aAAcH,IAAW,CAEvC,IAAIxzB,EAAOnhB,KAAK+vB,UAAW4kB,EAAQphB,GACrB,OAATpS,GAAgByxB,EAAShxC,IAAKuf,EAAK7L,KAAM6L,GAI/C,OAAOyxB,GAKRkC,aAAc,SAAWH,GAUxB,OAAKA,EAAOI,OAAS,IAAO,GAEhBJ,EAAO9yC,YAAc,IAAM,IAAO,KAAW8yC,EAAOI,OAIxDJ,EAAO9yC,YAAc,IAAM,IAAM8yC,EAAOI,QAOjDhlB,UAAW,SAAW4kB,EAAQphB,GAE7B,IAAIpS,EAAO,GAGP6zB,EAAczhB,GAAW,KAASohB,EAAOM,YAAcN,EAAOE,YAC9DK,EAAkB3hB,GAAW,KAASohB,EAAOM,YAAcN,EAAOE,YAKlEM,GAFoB5hB,GAAW,KAASohB,EAAOM,YAAcN,EAAOE,YAE1DF,EAAOS,YACjB9/B,EAAOq/B,EAAOU,UAAWF,GAG7B,GAAmB,IAAdH,EAAkB,OAAO,KAI9B,IAFA,IAAIM,EAAe,GAET3vC,EAAI,EAAGA,EAAIuvC,EAAevvC,IAEnC2vC,EAAa56B,KAAM1a,KAAKu1C,cAAeZ,IAKxC,IAAIvtC,EAAKkuC,EAAa1vC,OAAS,EAAI0vC,EAAc,GAAM,GACnD1a,EAAW0a,EAAa1vC,OAAS,EAAI0vC,EAAc,GAAM,GACzD5X,EAAW4X,EAAa1vC,OAAS,EAAI0vC,EAAc,GAAM,GAM7D,IAFAn0B,EAAKq0B,eAAqC,IAAlBN,GAAuBP,EAAO9yC,cAAgBmzC,EAE9DA,EAAYL,EAAO9yC,aAAc,CAExC,IAAI4zC,EAAUz1C,KAAK+vB,UAAW4kB,EAAQphB,GAErB,OAAZkiB,GAAmBz1C,KAAK01C,aAAcpgC,EAAM6L,EAAMs0B,GAWxD,OAPAt0B,EAAKm0B,aAAeA,EAED,iBAAPluC,IAAkB+Z,EAAK/Z,GAAKA,GACtB,KAAbwzB,IAAkBzZ,EAAKyZ,SAAWA,GACrB,KAAb8C,IAAkBvc,EAAKuc,SAAWA,GACzB,KAATpoB,IAAc6L,EAAK7L,KAAOA,GAExB6L,GAIRu0B,aAAc,SAAWpgC,EAAM6L,EAAMs0B,GAGpC,IAAgC,IAA3BA,EAAQD,eAA0B,CAEtC,IAAIttC,EAAQutC,EAAQH,aAAc,GAE7Bv3B,MAAMwmB,QAASr8B,IAEnBiZ,EAAMs0B,EAAQngC,MAASmgC,EAEvBA,EAAQ7zB,EAAI1Z,GAIZiZ,EAAMs0B,EAAQngC,MAASpN,OAIlB,GAAc,gBAAToN,GAA2C,MAAjBmgC,EAAQngC,KAAe,CAE5D,IAAIkI,EAAQ,GAEZi4B,EAAQH,aAAaxpC,SAAS,SAAW+W,EAAUld,GAGvC,IAANA,GAAU6X,EAAM9C,KAAMmI,WAIF5G,IAArBkF,EAAK8U,cAET9U,EAAK8U,YAAc,IAIpB9U,EAAK8U,YAAYvb,KAAM8C,QAEjB,GAAsB,iBAAjBi4B,EAAQngC,KAA0B,CAElCxP,OAAOC,KAAM0vC,GAEnB3pC,SAAS,SAAWS,GAExB4U,EAAM5U,GAAQkpC,EAASlpC,WAIlB,GAAc,iBAAT+I,GAA4C,MAAjBmgC,EAAQngC,KAAe,CAE7D,IAIIo/B,EAJAJ,EAAgBmB,EAAQH,aAAc,GACtCf,EAAiBkB,EAAQH,aAAc,GACvCd,EAAiBiB,EAAQH,aAAc,GACvCb,EAAgBgB,EAAQH,aAAc,GAGD,IAApChB,EAAcnpC,QAAS,UAAiBmpC,EAAgBA,EAAcl8B,QAAS,OAAQ,SAClD,IAArCm8B,EAAeppC,QAAS,UAAiBopC,EAAiBA,EAAen8B,QAAS,OAAQ,SAI9Fs8B,EAFuB,UAAnBH,GAAiD,aAAnBA,GAAoD,WAAnBA,GAAkD,aAAnBA,GAAsE,IAArCA,EAAeppC,QAAS,QAE1I,CAChBsqC,EAAQH,aAAc,GACtBG,EAAQH,aAAc,GACtBG,EAAQH,aAAc,IAKNG,EAAQH,aAAc,GAKxCn0B,EAAMmzB,GAAkB,CAEvB,KAAQC,EACR,MAASC,EACT,KAAQC,EACR,MAASC,aAI0Bz4B,IAAzBkF,EAAMs0B,EAAQngC,MAEE,iBAAfmgC,EAAQruC,IAEnB+Z,EAAMs0B,EAAQngC,MAAS,GACvB6L,EAAMs0B,EAAQngC,MAAQmgC,EAAQruC,IAAOquC,GAIrCt0B,EAAMs0B,EAAQngC,MAASmgC,EAMF,aAAjBA,EAAQngC,MAELyI,MAAMwmB,QAASpjB,EAAMs0B,EAAQngC,SAEnC6L,EAAMs0B,EAAQngC,MAAS,CAAE6L,EAAMs0B,EAAQngC,QAIxC6L,EAAMs0B,EAAQngC,MAAOoF,KAAM+6B,SAEuBx5B,IAAvCkF,EAAMs0B,EAAQngC,MAAQmgC,EAAQruC,MAEzC+Z,EAAMs0B,EAAQngC,MAAQmgC,EAAQruC,IAAOquC,IAQxCF,cAAe,SAAWZ,GAEzB,IAAItyC,EAAOsyC,EAAOU,UAAW,GAE7B,OAAShzC,GAER,IAAK,IACJ,OAAOsyC,EAAOgB,aAEf,IAAK,IACJ,OAAOhB,EAAOiB,aAEf,IAAK,IACJ,OAAOjB,EAAOkB,aAEf,IAAK,IACJ,OAAOlB,EAAOmB,WAEf,IAAK,IACJ,OAAOnB,EAAOoB,WAEf,IAAK,IACJ,IAAInwC,EAAS+uC,EAAOE,YACpB,OAAOF,EAAOqB,eAAgBpwC,GAE/B,IAAK,IACAA,EAAS+uC,EAAOE,YACpB,OAAOF,EAAOU,UAAWzvC,GAE1B,IAAK,IACJ,OAAO+uC,EAAOsB,WAEf,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IAEJ,IAAIC,EAAcvB,EAAOE,YACrBsB,EAAWxB,EAAOE,YAClBuB,EAAmBzB,EAAOE,YAE9B,GAAkB,IAAbsB,EAEJ,OAAS9zC,GAER,IAAK,IACL,IAAK,IACJ,OAAOsyC,EAAO0B,gBAAiBH,GAEhC,IAAK,IACJ,OAAOvB,EAAO2B,gBAAiBJ,GAEhC,IAAK,IACJ,OAAOvB,EAAO4B,gBAAiBL,GAEhC,IAAK,IACJ,OAAOvB,EAAO6B,cAAeN,GAE9B,IAAK,IACJ,OAAOvB,EAAO8B,cAAeP,GAMX,oBAATQ,MAEX3sC,QAAQsnB,MAAO,qHAIhB,IACIslB,EAAU,IAAIngB,EADJ,IAAIkgB,KAAKE,QAAS,IAAI1c,WAAYya,EAAOqB,eAAgBI,KAC/BS,aAAapgB,QAErD,OAASp0B,GAER,IAAK,IACL,IAAK,IACJ,OAAOs0C,EAAQN,gBAAiBH,GAEjC,IAAK,IACJ,OAAOS,EAAQL,gBAAiBJ,GAEjC,IAAK,IACJ,OAAOS,EAAQJ,gBAAiBL,GAEjC,IAAK,IACJ,OAAOS,EAAQH,cAAeN,GAE/B,IAAK,IACJ,OAAOS,EAAQF,cAAeP,GAIjC,QACC,MAAM,IAAIrvC,MAAO,0CAA4CxE,MAgBjEm0B,EAAavjB,UAAY,CAExBkJ,YAAaqa,EAEb30B,UAAW,WAEV,OAAO7B,KAAKI,QAIb20C,KAAM,WAEL,OAAO/0C,KAAK22B,GAAGF,OAAOa,YAIvBsd,KAAM,SAAWhvC,GAEhB5F,KAAKI,QAAUwF,GAOhB+vC,WAAY,WAEX,OAAmC,IAAR,EAAlB31C,KAAKo1C,aAIfiB,gBAAiB,SAAWtB,GAI3B,IAFA,IAAInzB,EAAI,GAEEjc,EAAI,EAAGA,EAAIovC,EAAMpvC,IAE1Bic,EAAElH,KAAM1a,KAAK21C,cAId,OAAO/zB,GAIRwzB,SAAU,WAET,IAAIltC,EAAQlI,KAAK22B,GAAGye,SAAUp1C,KAAKI,QAEnC,OADAJ,KAAKI,QAAU,EACR8H,GAIR+tC,SAAU,WAET,IAAI/tC,EAAQlI,KAAK22B,GAAGsf,SAAUj2C,KAAKI,OAAQJ,KAAK02B,cAEhD,OADA12B,KAAKI,QAAU,EACR8H,GAIR4tC,SAAU,WAET,IAAI5tC,EAAQlI,KAAK22B,GAAGmf,SAAU91C,KAAKI,OAAQJ,KAAK02B,cAEhD,OADA12B,KAAKI,QAAU,EACR8H,GAIRsuC,cAAe,SAAWzB,GAIzB,IAFA,IAAInzB,EAAI,GAEEjc,EAAI,EAAGA,EAAIovC,EAAMpvC,IAE1Bic,EAAElH,KAAM1a,KAAK81C,YAId,OAAOl0B,GAIRizB,UAAW,WAEV,IAAI3sC,EAAQlI,KAAK22B,GAAGke,UAAW70C,KAAKI,OAAQJ,KAAK02B,cAEjD,OADA12B,KAAKI,QAAU,EACR8H,GASR6tC,SAAU,WAET,IAAIe,EAAKC,EAeT,OAbK/2C,KAAK02B,cAETogB,EAAM92C,KAAK60C,YACXkC,EAAO/2C,KAAK60C,cAIZkC,EAAO/2C,KAAK60C,YACZiC,EAAM92C,KAAK60C,aAKA,WAAPkC,GAEJA,EAAgB,YAAPA,EAGI,cAFbD,EAAc,YAANA,KAEkBC,EAASA,EAAO,EAAM,cAI9B,WAAPA,GAFXD,EAAQA,EAAM,EAAM,cAMP,WAAPC,EAAqBD,GAI7BL,cAAe,SAAW1B,GAIzB,IAFA,IAAInzB,EAAI,GAEEjc,EAAI,EAAGA,EAAIovC,EAAMpvC,IAE1Bic,EAAElH,KAAM1a,KAAK+1C,YAId,OAAOn0B,GAKRqzB,UAAW,WAEV,IAAI6B,EAAKC,EAcT,OAZK/2C,KAAK02B,cAETogB,EAAM92C,KAAK60C,YACXkC,EAAO/2C,KAAK60C,cAIZkC,EAAO/2C,KAAK60C,YACZiC,EAAM92C,KAAK60C,aAIE,WAAPkC,EAAqBD,GAI7BjB,WAAY,WAEX,IAAI3tC,EAAQlI,KAAK22B,GAAGkf,WAAY71C,KAAKI,OAAQJ,KAAK02B,cAElD,OADA12B,KAAKI,QAAU,EACR8H,GAIRquC,gBAAiB,SAAWxB,GAI3B,IAFA,IAAInzB,EAAI,GAEEjc,EAAI,EAAGA,EAAIovC,EAAMpvC,IAE1Bic,EAAElH,KAAM1a,KAAK61C,cAId,OAAOj0B,GAIRg0B,WAAY,WAEX,IAAI1tC,EAAQlI,KAAK22B,GAAGif,WAAY51C,KAAKI,OAAQJ,KAAK02B,cAElD,OADA12B,KAAKI,QAAU,EACR8H,GAIRouC,gBAAiB,SAAWvB,GAI3B,IAFA,IAAInzB,EAAI,GAEEjc,EAAI,EAAGA,EAAIovC,EAAMpvC,IAE1Bic,EAAElH,KAAM1a,KAAK41C,cAId,OAAOh0B,GAIRo0B,eAAgB,SAAWjB,GAE1B,IAAI7sC,EAAQlI,KAAK22B,GAAGF,OAAO1O,MAAO/nB,KAAKI,OAAQJ,KAAKI,OAAS20C,GAE7D,OADA/0C,KAAKI,QAAU20C,EACR7sC,GAIRmtC,UAAW,SAAWN,GAKrB,IAFA,IAAInzB,EAAI,GAEEjc,EAAI,EAAGA,EAAIovC,EAAMpvC,IAE1Bic,EAAGjc,GAAM3F,KAAKo1C,WAIf,IAAI4B,EAAWp1B,EAAEzW,QAAS,GAG1B,OAFK6rC,GAAY,IAAIp1B,EAAIA,EAAEmG,MAAO,EAAGivB,IAE9B32C,MAAMsc,YAAYs6B,WAAY,IAAI/c,WAAYtY,MAUvDiV,EAAQ5jB,UAAY,CAEnBkJ,YAAa0a,EAEbj1B,IAAK,SAAW2K,EAAKikC,GAEpBxwC,KAAMuM,GAAQikC,IAmEhB,IAAI0G,EAAY,GAGhB,SAASnO,EAASH,EAAoBV,EAAcS,EAAawO,GAEhE,IAAIlxC,EAEJ,OAASkxC,EAAWvQ,aAEnB,IAAK,kBACJ3gC,EAAQ2iC,EACR,MACD,IAAK,YACJ3iC,EAAQiiC,EACR,MACD,IAAK,YACJjiC,EAAQ0iC,EACR,MACD,IAAK,UACJ1iC,EAAQkxC,EAAWt3B,QAAS,GAC5B,MACD,QACC9V,QAAQqT,KAAM,mDAAqD+5B,EAAWvQ,aAI9C,kBAA7BuQ,EAAW7M,gBAAoCrkC,EAAQkxC,EAAWt3B,QAAS5Z,IAEhF,IAAI6tC,EAAO7tC,EAAQkxC,EAAWvM,SAC1BmJ,EAAKD,EAAOqD,EAAWvM,SAE3B,OAkID,SAAgBhpB,EAAGC,EAAGiyB,EAAMC,GAE3B,IAAM,IAAIpuC,EAAImuC,EAAM7yB,EAAI,EAAGtb,EAAIouC,EAAIpuC,IAAMsb,IAExCW,EAAGX,GAAMY,EAAGlc,GAIb,OAAOic,EA1IAmG,CAAOmvB,EAAWC,EAAW1gB,OAAQqd,EAAMC,GAInD,IAAIqD,EAAU,IAAI/2C,MAAMilB,QACpB+xB,EAAY,IAAIh3C,MAAMw1B,MACtByhB,EAAU,IAAIj3C,MAAMC,QACpB2iC,EAAc,IAAI5iC,MAAMC,QACxB0C,EAAW,IAAI3C,MAAMilB,QAczB,SAASqe,EAAmBb,GAE3B,IAAIzhB,EAAY,IAAIhhB,MAAMilB,QAC1B2d,EAAY3hC,IAAK,EAAG,EAAG,GACvB0B,EAASuiB,WAET,IAyBK/H,EAzBDguB,EAAU1I,EAAyB,WAAIyU,EAAezU,EAAcC,YAAewU,EAAe,IAEjGzU,EAAcG,aAAcA,EAAYzgB,UAAWsgB,EAAcG,aACjEH,EAAcK,gBAAiBF,EAAYrhC,IAAK01C,EAAQ90B,UAAWsgB,EAAcK,iBAEjFL,EAAc9/B,aAEdwa,EAAQslB,EAAc9/B,SAASqX,IAAKha,MAAM+C,KAAKC,WAC7CqX,KAAM8wB,GACZxoC,EAASw0C,sBAAuBH,EAAU70B,UAAWhF,KAIjDslB,EAAcQ,eAEd9lB,EAAQslB,EAAcQ,YAAYjpB,IAAKha,MAAM+C,KAAKC,WAChDqX,KAAM8wB,GACZ4L,EAAQI,sBAAuBH,EAAU70B,UAAWhF,IAEpDxa,EAASuT,YAAa6gC,IAIlBtU,EAAcU,gBAEdhmB,EAAQslB,EAAcU,aAAanpB,IAAKha,MAAM+C,KAAKC,WACjDqX,KAAM8wB,GACZ4L,EAAQI,sBAAuBH,EAAU70B,UAAWhF,IAEpD45B,EAAQK,WAAYL,GAEpBp0C,EAASstB,SAAU8mB,IASpB,OALKtU,EAAc7gB,OAAQZ,EAAUY,MAAOq1B,EAAQ90B,UAAWsgB,EAAc7gB,QAE7EZ,EAAUq2B,YAAazU,GACvB5hB,EAAUiP,SAAUttB,GAEbqe,EAMR,SAASk2B,EAAe/L,GAEvB,IAAImM,EAAQ,CACX,MACA,MACA,MACA,MACA,MACA,OAID,OAAe,IAAVnM,GAEJzhC,QAAQqT,KAAM,uGACPu6B,EAAO,IAIRA,EAAOnM,GAMf,SAAS0I,EAAkBhsC,GAQ1B,OANYA,EAAMkS,MAAO,KAAMC,KAAK,SAAWm2B,GAE9C,OAAOvyB,WAAYuyB,MAQrB,SAASjZ,EAA4Bd,EAAQqd,EAAMC,GAKlD,YAHc93B,IAAT63B,IAAqBA,EAAO,QACrB73B,IAAP83B,IAAmBA,EAAKtd,EAAOa,YAE7Bj3B,MAAMsc,YAAYs6B,WAAY,IAAI/c,WAAYzD,EAAQqd,EAAMC,IA2BpE,SAAS9B,EAAQ2F,EAAI3xC,EAAO4xC,GAE3B,OAAOD,EAAG7vB,MAAO,EAAG9hB,GAAQmpC,OAAQyI,GAAKzI,OAAQwI,EAAG7vB,MAAO9hB,IAI5D,OAAO6vB,EAv5H2B,I,gBCrBnC,MAAMgiB,EAAc,EAAQ,GAAR,GAIdC,EAAc,WAClB,IAAIC,EACJ,OAAO,WAEL,OADAA,EAAUA,GAAWF,EALN,qFAMRE,GAJQ,GAYnB34C,EAAOC,QAAUC,OAAOC,kBAAkB,oBAAqB,CAC7DC,OAAQ,CAAC4C,KAAM,SAEftC,KAAM,WACJC,KAAK6Y,MAAQ,KACb7Y,KAAK8a,OAAS,KACd9a,KAAKi4C,cAAgBF,IAAaG,KAAK,KACrCl4C,KAAK8a,OAAS,IAAIza,MAAM83C,WACxBn4C,KAAK8a,OAAOuC,eAAe,gBAI/BxZ,OAAQ,WACN,MAAMkX,EAAO/a,KACPY,EAAKZ,KAAKY,GACVoa,EAAMhb,KAAKgB,KAEZga,IAELhb,KAAKmE,SAELnE,KAAKi4C,cAAcC,KAAK,KACtBl4C,KAAK8a,OAAO7B,KAAK+B,GAAK,SAAqBo9B,GACzCr9B,EAAKlC,MAAQu/B,EAAUh9B,MACvBL,EAAKlC,MAAMmB,WAAao+B,EAAUp+B,WAClCpZ,EAAGib,YAAY,OAAQd,EAAKlC,OAC5BjY,EAAGC,KAAK,eAAgB,CAACib,OAAQ,OAAQjD,MAAOkC,EAAKlC,eAK3D1U,OAAQ,WACDnE,KAAK6Y,OACV7Y,KAAKY,GAAGmb,eAAe,Y,cC/B3B,SAASs8B,EAAajxC,GACpB,MAAMkxC,EAASC,SAASC,eAAepxC,GACjCs4B,EAAS4Y,EAAOG,WAEtB,IACE/Y,GAAUA,EAAOgZ,YAAYJ,GAC7B,MAAOpkC,KAUX,SAASykC,EAAoBt8B,EAAKc,EAASy7B,GACzC,OAAO,IAAIA,GAAQ,SAASC,EAASC,GACnC,MAAMC,EAAU57B,EAAQ47B,SAAW,IAC7BC,EAhCD,UAAYC,KAAKn2C,MAAQ,IAAMM,KAAK81C,KAAqB,IAAhB91C,KAAK+1C,UAiC7Cb,EA9BV,SAAsBj8B,EAAKjV,GACzB,IAAIkxC,EAASC,SAASa,cAAc,UAMpC,OALAd,EAAOj2C,KAAO,kBACdi2C,EAAOe,OAAQ,EACff,EAAOlxC,GAAKA,EACZkxC,EAAOt9B,IAAMqB,EAENi8B,EAuBUgB,CAAaj9B,EAAK28B,GAE3BO,EAAYriB,YAAW,WAC3B4hB,EAAO,IAAIjyC,MAAM,qBAAuBwV,EAAM,eAE9Cg8B,EAAaW,KACZD,GAEGS,EAAiB,SAASD,GAAaE,aAAaF,IAE1DjB,EAAO7uC,iBAAiB,QAAQ,SAASyK,GACvC2kC,EAAQ,CAACa,IAAI,IAEbF,EAAeD,GACflB,EAAaW,MAGfV,EAAO7uC,iBAAiB,SAAS,SAASyK,GACxC4kC,EAAO,IAAIjyC,MAAM,qBAAuBwV,EAAM,WAAanI,IAE3DslC,EAAeD,GACflB,EAAaW,MA9BnB,SAAsBV,GACpB,MAAMqB,EAAcpB,SAASj7B,qBAAqB,UAAU,GAC5Dq8B,EAAYlB,WAAWmB,aAAatB,EAAQqB,GA+B1CE,CAAavB,MAYjBj5C,EAAOC,QARP,SAAqBw6C,GAEnB,OADAA,EAAWA,GAAY,GAChB,SAAUz9B,EAAKc,GAEpB,OAAOw7B,EAAoBt8B,EAD3Bc,EAAUA,GAAW,GACoB28B,EAASlB,SAAWA,Y,cC1DjEv5C,EAAOC,QAAUC,OAAOC,kBAAkB,eAAgB,CACxDC,OAAQ,CACNub,IAAa,CAAE3Y,KAAM,SACrB0zB,YAAa,CAAEp2B,QAAS,KAG1BI,KAAM,WACJC,KAAK6Y,MAAQ,MAGfhV,OAAQ,WACN,IAAIiX,EACJ,MAAM9Z,EAAOhB,KAAKgB,KACbA,EAAKga,MAEVhb,KAAKmE,SACL2W,EAAS,IAAIza,MAAM05C,aACf/4C,EAAK+0B,aAAajb,EAAOuC,eAAerc,EAAK+0B,aACjDjb,EAAO7B,KAAKjY,EAAKga,IAAMM,IAGrBA,EAAOD,SAAUvK,IACXA,aAAazQ,MAAM0yB,aAAejiB,EAAE0K,WACtC1K,EAAE0K,SAASmX,YAAe7hB,EAAEmJ,UAAYnJ,EAAEmJ,SAASuX,OAAU,IAAI5rB,UAIrE5F,KAAKiZ,KAAKqC,OAIdrC,KAAM,SAAUJ,GACd7Y,KAAK6Y,MAAQA,EACb7Y,KAAKY,GAAGib,YAAY,OAAQhD,GAC5B7Y,KAAKY,GAAGC,KAAK,eAAgB,CAACib,OAAQ,OAAQjD,MAAOA,KAGvD1U,OAAQ,WACFnE,KAAK6Y,OAAO7Y,KAAKY,GAAGmb,eAAe,Y,gBClD3C,EAAQ,IACR,EAAQ,IACR,EAAQ,IACR,EAAQ,IACR,EAAQ,IACR,EAAQ,IACR,EAAQ,IACR,EAAQ,K,cCPR1c,EAAOC,QAAUC,OAAOC,kBAAkB,aAAc,CACtDC,OAAQ,CACNW,OAAQ,CAACT,QAAS,CAACwD,EAAG,EAAGI,EAAG,EAAGuB,EAAG,GAAIzC,KAAM,SAG9CtC,KAAM,WACJC,KAAKC,QAAS,EACdD,KAAKg6C,SAAW,KAChBh6C,KAAKi6C,KAAOj6C,KAAKi6C,KAAKzxC,KAAKxI,MAC3BA,KAAKI,OAAS,IAAIC,MAAMC,SAG1BuD,OAAQ,WACN7D,KAAKI,OAAOoB,KAAKxB,KAAKgB,KAAKZ,SAG7BK,KAAM,WAAcT,KAAKY,GAAG6I,iBAAiB,QAASzJ,KAAKi6C,OAC3Dv5C,MAAO,WAAcV,KAAKY,GAAG8I,oBAAoB,QAAS1J,KAAKi6C,OAC/D91C,OAAQ,WAAcnE,KAAKU,SAE3Bu5C,KAAM,WACJ,MAAMD,EAAWh6C,KAAKY,GAAG2B,QAAQstB,cAAc,yBAC/C,IAAKmqB,EACH,MAAM,IAAInzC,MAAM,6CAElBmzC,EAAS94C,WAAW,uBAAuBP,cAAcX,KAAKY,KAGhEiB,UAAW,WACT,OAAO7B,KAAKI,OAAOoB,KAAKxB,KAAKgB,KAAKZ,Y,cCPtC,SAAS85C,EAAahmB,EAAMimB,EAAeld,EAAQN,GAC5CzI,IAELimB,EAAgBA,GAAiB,GAEjCjmB,EAAK7Y,SAAU8F,IAEb,IAAKA,EAAK5F,OAAQ,OAzBtB,IAA8BC,MA2BgB2F,EAAK3F,UAxBtCuC,MAAMwmB,QAAQ/oB,GAChBA,EACEA,EAASqO,UACXrO,EAASqO,UAET,CAACrO,GAND,IA2BO1P,QAAS0P,MAEjBA,GAAc,WAAYA,KAC1B2+B,EAAcv0C,SAAoD,IAA1Cu0C,EAAchvC,QAAQqQ,EAASlG,QAE3DkG,EAASyhB,OAASA,EAClBzhB,EAASmhB,aAAeA,EACxBnhB,EAAS4+B,aAAc,SAW7B/6C,EAAOC,QAAUC,OAAOC,kBAAkB,eAAgB,CACxD66C,UAAU,EAEV56C,OAAQ,CACNid,KAAM,CAAC/c,QAAS,IAChBmoB,UAAW,CAACnoB,QAAS,MAAOE,MAAO,CAAC,MAAO,QAC3Cic,OAAQ,CAACnc,QAAS,YAAaE,MAAO,CAAC,YAAa,eACpDy6C,iBAAkB,CAAC36C,SAAS,GAC5Bg9B,aAAc,CAACh9B,QAAS,EAAG6F,IAAK,EAAGF,IAAK,GACxCukB,UAAW,CAAClqB,QAAS,KAGvBI,KAAM,WACJ,MAAMiB,EAAOhB,KAAKgB,KAElBhB,KAAKooB,SAAU,IAAI/nB,MAAMk6C,mBAAoBthC,KAAK,CAChDjY,EAAK0b,KAAO,QAAU1b,EAAK8mB,UAAW9mB,EAAK0b,KAAO,QAAU1b,EAAK8mB,UACjE9mB,EAAK0b,KAAO,QAAU1b,EAAK8mB,UAAW9mB,EAAK0b,KAAO,QAAU1b,EAAK8mB,UACjE9mB,EAAK0b,KAAO,QAAU1b,EAAK8mB,UAAW9mB,EAAK0b,KAAO,QAAU1b,EAAK8mB,YAEnE9nB,KAAKooB,QAAQtM,OAASzb,MAAMW,EAAK8a,QAEjC9b,KAAKw6C,mBAAqB,KACxB,MAAMtmB,EAAOl0B,KAAKY,GAAGoY,YAAY,QAC3BhY,EAAOhB,KAAKgB,KAClBk5C,EAAYhmB,EAAMlzB,EAAK6oB,UAAW7pB,KAAKooB,QAASpnB,EAAK27B,eAEvD38B,KAAKY,GAAG6I,iBAAiB,cAAezJ,KAAKw6C,qBAG/C32C,OAAQ,SAAU42C,GAChB,MAAMz5C,EAAOhB,KAAKgB,KACZkzB,EAAOl0B,KAAKY,GAAGoY,YAAY,QAEjC,IAAI0hC,EAAqB,GACrBC,EAAuB,GAiB3B,GAfI35C,EAAK6oB,UAAUjkB,SACb60C,EAAQ5wB,WACV6wB,EAAqB15C,EAAK6oB,UAAUgnB,OAAQv7B,IAAUmlC,EAAQ5wB,UAAU+wB,SAAStlC,IACjFqlC,EAAuBF,EAAQ5wB,UAAUgnB,OAAQv7B,IAAUtU,EAAK6oB,UAAU+wB,SAAStlC,KAEnFolC,EAAqB15C,EAAK6oB,WAG1B6wB,EAAmB90C,QACrBs0C,EAAYhmB,EAAMwmB,EAAoB16C,KAAKooB,QAASpnB,EAAK27B,cAEvDge,EAAqB/0C,QACvBs0C,EAAYhmB,EAAMymB,EAAsB,KAAM,GAG5CF,EAAQ5wB,WAAa7oB,EAAK27B,eAAiB8d,EAAQ9d,aAAc,CACnE,MAAMke,EAA0B75C,EAAK6oB,UAClCgnB,OAAQv7B,GAASmlC,EAAQ5wB,UAAU+wB,SAAStlC,IAC3CulC,EAAwBj1C,QAC1Bs0C,EAAYhmB,EAAM2mB,EAAyB76C,KAAKooB,QAASpnB,EAAK27B,cAI9D38B,KAAKgB,KAAKs5C,mBAAqBG,EAAQH,iBACzCt6C,KAAK86C,cAAc96C,KAAKooB,UACdpoB,KAAKgB,KAAKs5C,kBAAoBG,EAAQH,kBAChDt6C,KAAK86C,cAAc,OAIvB32C,OAAQ,WACNnE,KAAKY,GAAG8I,oBAAoB,cAAe1J,KAAKw6C,oBAChD,MAAMtmB,EAAOl0B,KAAKY,GAAGoY,YAAY,QAC3BhY,EAAOhB,KAAKgB,KAElBk5C,EAAYhmB,EAAMlzB,EAAK6oB,UAAW,KAAM,GACpC7oB,EAAKs5C,kBAAkBt6C,KAAK86C,cAAc,OAGhDA,cAAe,SAAU1yB,GACvBpoB,KAAKY,GAAG2B,QAAQb,SAASq5C,WAAa3yB,M,cCvH1C/oB,EAAOC,QAAUC,OAAOC,kBAAkB,OAAQ,CAChDO,KAAM,WACJC,KAAKwC,OAASxC,KAAKY,GAAG2B,QAAQE,QAAQu4C,QAEtCh7C,KAAKi7C,cAAgB,UAErBj7C,KAAKk7C,UAAW,EAChBl7C,KAAKm7C,MAA8C,KACnDn7C,KAAKg7C,QAA8Ch7C,KAAKY,GAAG2B,QAAQE,QAAQu4C,QAC3Eh7C,KAAKo7C,WAA8C,KAGnDp7C,KAAKq7C,MAAQr7C,KAAKq7C,MAAM7yC,KAAKxI,MAC7BA,KAAKs7C,WAAat7C,KAAKs7C,WAAW9yC,KAAKxI,MACvCA,KAAKu7C,YAAcv7C,KAAKu7C,YAAY/yC,KAAKxI,OAG3CS,KAAM,WACJ,MAAMG,EAAKZ,KAAKY,GAChBA,EAAG6I,iBAAiB,MAAOzJ,KAAKq7C,OAChCz6C,EAAG6I,iBAAiB,WAAYzJ,KAAKu7C,aACrC36C,EAAG6I,iBAAiB,SAAUzJ,KAAKs7C,YACnC16C,EAAG6I,iBAAiB,eAAgBzJ,KAAKu7C,aACzC36C,EAAG6I,iBAAiB,aAAczJ,KAAKs7C,YACvC16C,EAAG6I,iBAAiB,cAAezJ,KAAKu7C,aACxC36C,EAAG6I,iBAAiB,YAAazJ,KAAKs7C,aAGxC56C,MAAO,WACL,MAAME,EAAKZ,KAAKY,GAChBA,EAAG8I,oBAAoB,MAAO1J,KAAKq7C,OACnCz6C,EAAG8I,oBAAoB,WAAY1J,KAAKu7C,aACxC36C,EAAG8I,oBAAoB,SAAU1J,KAAKs7C,YACtC16C,EAAG8I,oBAAoB,eAAgB1J,KAAKu7C,aAC5C36C,EAAG8I,oBAAoB,aAAc1J,KAAKs7C,YAC1C16C,EAAG8I,oBAAoB,cAAe1J,KAAKu7C,aAC3C36C,EAAG8I,oBAAoB,YAAa1J,KAAKs7C,aAG3CC,YAAa,WACXv7C,KAAKk7C,UAAW,GAGlBI,WAAY,WACV,MAAMH,EAAQn7C,KAAKm7C,MACnBn7C,KAAKk7C,UAAW,EACXC,IACLA,EAAMK,YAAYx7C,KAAKi7C,eACvBj7C,KAAKm7C,WAAQl/B,EACbjc,KAAKwC,OAAOi5C,iBAAiBz7C,KAAKo7C,YAClCp7C,KAAKo7C,WAAa,OAGpBC,MAAO,SAAUK,GACf,MAAMP,EAAQO,EAAInkC,OAAO3W,GAIpBu6C,IAASA,EAAMQ,GAAG37C,KAAKi7C,gBAAmBj7C,KAAKk7C,WAAYl7C,KAAKm7C,QACrEA,EAAMS,SAAS57C,KAAKi7C,eACpBj7C,KAAKm7C,MAAQA,EACbn7C,KAAKo7C,WAAa,IAAIS,OAAOC,eAAe97C,KAAKY,GAAGm7C,KAAMZ,EAAMY,MAChE/7C,KAAKwC,OAAOw5C,cAAch8C,KAAKo7C,iB,cCjEnC/7C,EAAOC,QAAUC,OAAOC,kBAAkB,eAAgB,CACxD6U,aAAc,CAAC,YAKf5U,OAAQ,CACNw8C,GAAI,CAAEt8C,QAAS,qCACfu8C,aAAc,CAAEv8C,QAAS,OACzBw8C,SAAU,CAAEx8C,QAAS,GACrBwrB,SAAU,CAAExrB,QAAS,GACrBwC,MAAO,CAAExC,SAAS,IAGpBI,KAAM,WACJC,KAAK2U,SAAW,EAChB3U,KAAKo8C,SAAW,EAEhB,MAAMC,EAAYr8C,KAAKq8C,UAAU7zC,KAAKxI,MAClCs8C,EAASt8C,KAAKgB,KAAKi7C,GAAG7hC,MAAM,KAChCpa,KAAKu8C,SAAW,GAChB,IAAK,IAAI52C,EAAI,EAAGA,EAAK22C,EAAO12C,OAAQD,IAClC3F,KAAKu8C,SAASD,EAAO32C,IAAM02C,EAC3Br8C,KAAKY,GAAG6I,iBAAiB6yC,EAAO32C,GAAI02C,GAEtCr8C,KAAKu8C,SAASC,QAAUx8C,KAAKy8C,UAAUj0C,KAAKxI,MAC5CA,KAAKY,GAAG6I,iBAAiB,UAAWzJ,KAAKu8C,SAASC,UAGpDr4C,OAAQ,WACN,IAAK,IAAI6B,KAAShG,KAAKu8C,SACjBv8C,KAAKu8C,SAASzyC,eAAe9D,KAC/BhG,KAAKY,GAAG8I,oBAAoB1D,EAAOhG,KAAKu8C,SAASv2C,WAC1ChG,KAAKu8C,SAASv2C,IAGzBhG,KAAKY,GAAG8I,oBAAoB,UAAW1J,KAAKu8C,SAASC,gBAC9Cx8C,KAAKu8C,SAASC,SAGvBH,UAAW,WACT,GAAIr8C,KAAKo8C,SAAWp8C,KAAKgB,KAAKm7C,SAAU,CACtC,MAAMn7C,EAAOhB,KAAKgB,KACd07C,EAAkBt5C,KAAKgoB,MAAM,EAAIpqB,EAAKmqB,UAAW,MACjDpY,EAAI/S,KAAKY,GAAGa,aAAa,YAC7BzB,KAAKY,GAAGK,aAAa,WAAY,CAACkC,EAAG4P,EAAE5P,EAAGI,EAAGm5C,EAAiB53C,EAAGiO,EAAEjO,IACnE9E,KAAKo8C,WACLp8C,KAAKY,GAAGC,KAAK,eAIjB47C,UAAW,WACLz8C,KAAKo8C,SAAW,GAAGp8C,KAAKY,GAAGC,KAAK,WACpCb,KAAKo8C,SAAW,M,cCvCpB/8C,EAAOC,QAAUC,OAAOC,kBAAkB,iBAAkB,CAC1D6U,aAAc,CAAC,YAMf5U,OAAQ,CACN2vB,KAAgB,CAAEzvB,QAAS,GAC3Bg9C,OAAgB,CAAEh9C,QAAS,KAC3Bi9C,cAAgB,CAAEj9C,QAAS,KAC3Bk9C,aAAgB,CAAEl9C,SAAS,GAC3Bm9C,YAAgB,CAAEn9C,SAAS,IAO7BI,KAAM,WACJC,KAAKwC,OAASxC,KAAKY,GAAG2B,QAAQE,QAAQu4C,QACtCh7C,KAAKwC,OAAOu6C,aAAa/8C,MAEzB,MAAMY,EAAKZ,KAAKY,GACZI,EAAOhB,KAAKgB,KACZT,GAAW,IAAKs7C,OAAOmB,MAAQx7C,KAAKZ,EAAGc,SAASC,iBAAiB,IAAItB,MAAMC,UAE/EN,KAAK+7C,KAAO,IAAIF,OAAOoB,KAAK,CAC1BzhC,SAAUxb,KAAKwC,OAAOonB,YAAY,kBAClCrpB,SAAUA,EACV6uB,KAAMpuB,EAAKouB,KACXwtB,cAAe57C,EAAK47C,cACpBM,eAAe,IAEjBl9C,KAAK+7C,KAAKoB,SACR,IAAItB,OAAOuB,OAAOp8C,EAAK27C,QACvB,IAAId,OAAOmB,KAAK,EAAGh8C,EAAK27C,OAAQ,IAGlC38C,KAAK+7C,KAAKn7C,GAAKZ,KAAKY,GACpBZ,KAAKY,GAAGm7C,KAAO/7C,KAAK+7C,KACpB/7C,KAAKwC,OAAO66C,QAAQr9C,KAAK+7C,MAErBn7C,EAAGoV,aAAa,kBAClBjM,QAAQqT,KAAK,+EAIjBjZ,OAAQ,WACNnE,KAAKwC,OAAO86C,WAAWt9C,KAAK+7C,MAC5B/7C,KAAKwC,OAAO+6C,gBAAgBv9C,aACrBA,KAAKY,GAAGm7C,MAiBjByB,WAAY,SAAUz5C,EAAGC,GACvB,IAAKA,EAAI,OAET,MAAMpD,EAAKZ,KAAKY,GACVI,EAAOhB,KAAKgB,KACZ+6C,EAAO/7C,KAAK+7C,KAEb/6C,EAAK87C,aAAaf,EAAKpnC,SAASrT,IAAI,EAAG,EAAG,GAC/Cy6C,EAAKx7C,SAASiB,KAAKZ,EAAGa,aAAa,cAGrCiwC,KAAO,WACL,MAAM/8B,EAAW,IAAItU,MAAMC,QACvBm9C,EAAqB,IAAIp9C,MAAMC,QAC/Bo9C,EAAuB,IAAIr9C,MAAMC,QACjCq9C,EAAe,IAAIt9C,MAAMC,QAE7B,OAAO,SAAUyD,EAAGC,GAClB,IAAKA,EAAI,OAET,IAGIk9B,EACA0c,EAJA7B,EAAO/7C,KAAK+7C,KACZ/6C,EAAOhB,KAAKgB,KACZ68C,GAAa,EACLC,GAAgBnlC,IAExBolC,EAAW/9C,KAAKwC,OAAOw7C,cAE3Bh6C,EAAKZ,KAAKoC,IAAIxB,EAAmC,IAA/BhE,KAAKwC,OAAOxB,KAAKi9C,aAEnCN,EAAar8C,IAAI,EAAG,EAAG,GACvBqT,EAASnT,KAAKxB,KAAKY,GAAGa,aAAa,aACnCs6C,EAAKpnC,SAASnT,KAAKmT,GAEnB,IAAK,IAAWupC,EAAPv4C,EAAI,EAAYu4C,EAAUH,EAASp4C,GAAIA,IAI9C,GAAKu4C,EAAQx+C,QAAb,CACA,GAAIq8C,EAAK30C,KAAO82C,EAAQC,GAAG/2C,GACzB82C,EAAQE,GAAGC,OAAOX,OACb,IAAI3B,EAAK30C,KAAO82C,EAAQI,GAAGl3C,GAGhC,SAFAs2C,EAAqBl8C,KAAK08C,EAAQE,IAKpCP,EAAa9B,EAAKpnC,SAAS4pC,IAAIb,IApH3B,KAqHAG,GAAcH,EAAqBn6C,GAAK,GAI1CoR,EAAS6pC,eAAed,GACfA,EAAqBn6C,EAAI,KAIlC29B,EAAS6a,EAAK30C,KAAO82C,EAAQC,GAAG/2C,GAC5BhE,KAAKuB,IAAIu5C,EAAQO,GAAGl7C,EAAI26C,EAAQI,GAAG/9C,SAASgD,GAC5CH,KAAKuB,IAAIu5C,EAAQQ,GAAGn7C,EAAI26C,EAAQC,GAAG59C,SAASgD,GAC5C29B,EAAS4c,IACXA,EAAe5c,EACfyc,EAAan8C,KAAKk8C,GAClBE,EAAa7B,EAAK30C,KAAO82C,EAAQC,GAAG/2C,GAAK82C,EAAQI,GAAKJ,EAAQC,KAKpEV,EAAmBj8C,KAAKmT,GAAUgqC,YAC9Bf,KAAgB58C,EAAK87C,aAAeW,EAAmBl6C,EAAI,KACxDvC,EAAK67C,aAECc,EAAap6C,EAAI,EA7IxB,MA8IFo6C,EAAan8C,KAAKxB,KAAK4+C,gBAAgBhB,EAAYD,IAFnDA,EAAar8C,IAAI,EAAG,EAAG,GAOzBqT,EAAS6pC,eAAeb,IAEf39C,KAAKwC,OAAOq8C,OAAOC,OAI5BnqC,EAAS/S,IAAI5B,KAAKwC,OAAOq8C,OAAOC,MAAMC,QAAQ98B,MAAW,EAALje,EAAW,MAGjE+3C,EAAKpnC,SAASnT,KAAKmT,GACnB3U,KAAKY,GAAGK,aAAa,WAAY86C,EAAKpnC,UACtC3U,KAAKY,GAAGK,aAAa,WAAY86C,EAAKx7C,WA7EpC,GA0FNq+C,gBAAiB,SAAUhB,EAAYD,GACrC,IAAIqB,EACAC,EACAC,EAAQl/C,KAAK+7C,KAAKx7C,SAClB4+C,EAAMn/C,KAAK+7C,KAAKx7C,SAASgJ,QAM7B,OAJAy1C,EAAM,IAAInD,OAAOuD,IAAIF,EAAOC,GAC5BH,EAAIK,mBACJL,EAAIM,cAAc1B,GAEboB,EAAIO,QAGTN,EAAYD,EAAItnB,OAAO8nB,eAChBp8C,KAAKuB,IAAIs6C,EAAU17C,GAAKH,KAAKuB,IAAIg5C,EAAap6C,GAAK07C,EAAYtB,GAJ9CA,M,cCnM5Bt+C,EAAOC,QAAUC,OAAOC,kBAAkB,cAAe,CACvDO,KAAM,WACJC,KAAKY,GAAG6I,iBAAiB,eAAiByK,IACxCA,EAAEqD,OAAOsB,MAAMwC,SAAU8F,IACnBA,EAAK5F,QAAQ4F,EAAKlH,SAASwlC,+B,cCHvCpgD,EAAOC,QAAUC,OAAOC,kBAAkB,kBAAmB,CAC3DO,KAAM,WACJC,KAAKwb,SAAW,IAAInb,MAAMq/C,mBAAmB,CAACC,aAAa,IAC3D3/C,KAAK4/C,cAAgB5/C,KAAK4/C,cAAcp3C,KAAKxI,MAC7CA,KAAKY,GAAG6I,iBAAiB,cAAezJ,KAAK4/C,gBAG/Cz7C,OAAQ,WACNnE,KAAKY,GAAG8I,oBAAoB,cAAe1J,KAAK4/C,gBAGlDA,cAAe,WACb5/C,KAAKY,GAAGc,SAAS2Z,SAAU8F,IACrBA,EAAK5F,SAAQ4F,EAAK3F,SAAWxb,KAAKwb,gB,cCR5Cnc,EAAOC,QAAUC,OAAOC,kBAAkB,kBAAmB,CAC3DC,OAAQ,CACNqyB,QAAS,CAACnyB,QAAS,IACnBkgD,MAAO,CAAClgD,QAAS,YACjBg9C,OAAQ,CAACh9C,QAAS,KAClBmgD,MAAO,CAACngD,SAAS,IAGnBI,KAAM,WAEJC,KAAK+/C,SAAW,KAEhB//C,KAAKggD,IAAM,GAEXhgD,KAAKigD,WAAa,GAElBjgD,KAAKkgD,UAAYlgD,KAAKkgD,UAAU13C,KAAKxI,MACrCA,KAAKmgD,aAAengD,KAAKmgD,aAAa33C,KAAKxI,OAG7CmE,OAAQ,WACNnE,KAAKU,SAGPD,KAAM,WACJ,MAAM8B,EAAUvC,KAAKY,GAAG2B,QAEpBvC,KAAKgB,KAAK8+C,QACZ9/C,KAAK+/C,SAAW,IAAIK,iBAAiBpgD,KAAK6D,OAAO2E,KAAKxI,KAAM,OAC5DA,KAAK+/C,SAASM,QAAQ99C,EAAS,CAAC+9C,WAAW,EAAMC,SAAS,MAI9D7/C,MAAO,WACDV,KAAK+/C,WACP//C,KAAK+/C,SAASS,aACdxgD,KAAK+/C,SAAW,OAOpBl8C,OAAQ,WACN,MAAM7C,EAAOhB,KAAKgB,KAClB,IAAIy/C,EAIFA,EADEz/C,EAAK8wB,QACK9xB,KAAKY,GAAG2B,QAAQm+C,iBAAiB1/C,EAAK8wB,SAGtC9xB,KAAKY,GAAG2B,QAAQ6uB,SAG9BpxB,KAAKggD,IAAMjiC,MAAM9K,UAAU8U,MAAM1U,KAAKotC,IAGxC38C,KAAM,WACJ,MAAMvD,EAAW,IAAIF,MAAMC,QACvBqgD,EAAe,IAAItgD,MAAMC,QACzBsgD,EAAgB,IAAIvgD,MAAMC,QAC1By0C,EAAO,IAAI10C,MAAMC,QACjBugD,EAAM,IAAIxgD,MAAMygD,KAChBC,EAAc,IAAI1oB,IACtB,OAAO,WACL,MAAMz3B,EAAKZ,KAAKY,GACZI,EAAOhB,KAAKgB,KACZkzB,EAAOtzB,EAAGoY,YAAY,QACtBinC,EAAa,GACjB,IAAIe,EAmDJ,IAAsBC,EAjDjB/sB,IAEL6sB,EAAYG,QACZtgD,EAAGc,SAASC,iBAAiBpB,GAC7BK,EAAGc,SAASy/C,cAAcP,GAC1BI,EAAiBhgD,EAAK27C,QA4CAsE,EA5CqBL,EA6ClCx9C,KAAKkC,IAAI87C,MAAM,KAAMH,EAAS1U,YA3CvCvsC,KAAKggD,IAAIl0C,SAmBT,SAAoBlL,GAClB,IAAI+7C,EAAQzoB,EAAM/I,EAAUk2B,EAE5B,IAAKzgD,EAAG0gD,SAAY,OAIpB,GAFAptB,EAAOtzB,EAAGoY,YAAY,SAEjBkb,EAAQ,OAOb,GALA2sB,EAAIU,cAAcrtB,GAAMstB,QAAQzM,GAChCsM,EAASj+C,KAAKkC,IAAIyvC,EAAK5xC,EAAG4xC,EAAKxxC,EAAGwxC,EAAKjwC,GAAK,EAC5C63C,EAASv5C,KAAKgoB,KAAK,EAAIi2B,EAASA,GAChCR,EAAIY,UAAUd,IAEThE,EAAU,OAEfxxB,EAAW5qB,EAASQ,WAAW4/C,GAC3Bx1B,EAAWwxB,EAASqE,IACtBf,EAAWvlC,KAAK9Z,GAChBmgD,EAAYz/C,IAAIV,EAAIuqB,OAnCxB80B,EACGt+B,KAAK,CAACC,EAAGC,IAAMk/B,EAAY7tC,IAAI0O,GAAKm/B,EAAY7tC,IAAI2O,GAAK,GAAK,GAC9D/V,QAAQ9L,KAAKkgD,WAGU,IAAtBD,EAAWr6C,QAAgBhF,EAAGC,KAAK,MAAO,CAACD,GAAI,OAGnDZ,KAAKigD,WACFpP,OAAQjwC,IAAQmgD,EAAYpoB,IAAI/3B,IAChCkL,QAAQ9L,KAAKmgD,cAGhBngD,KAAKigD,WAAaA,IArChB,GAqENC,UAAW,SAAUlG,GACnBA,EAASn5C,KAAK,OACdm5C,EAAS4B,SAAS57C,KAAKgB,KAAK6+C,OAC5B7/C,KAAKY,GAAGC,KAAK,MAAO,CAACD,GAAIo5C,KAE3BmG,aAAc,SAAUnG,GACtBA,EAASn5C,KAAK,UACdm5C,EAASwB,YAAYx7C,KAAKgB,KAAK6+C,OAC/B7/C,KAAKY,GAAGC,KAAK,SAAU,CAACD,GAAIo5C,Q,gBCjJhC,EAAQ,IACR,EAAQ,IACR,EAAQ,K,cCIR36C,EAAOC,QAAUC,OAAOC,kBAAkB,WAAY,CACpDO,KAAM,WACJC,KAAKwC,OAASxC,KAAKY,GAAG2B,QAAQE,QAAQ0S,IACtCnV,KAAK0hD,kBAAmB,EACxB1hD,KAAKY,GAAG6I,iBAAiB,cAAezJ,KAAK2hD,YAAYn5C,KAAKxI,QAGhES,KAAM,WACCT,KAAK0hD,kBAAkB1hD,KAAK2hD,eAGnCA,YAAa,WACX,MAAMrmC,EAAStb,KAAKY,GAAGoY,YAAY,QAC7BoC,EAAQpb,KAAKY,GAAG2B,QAAQb,SAE9B,IAAK4Z,EAAQ,OAEb,IAAIsmC,EAKJ,GAJAtmC,EAAOD,SAAU8F,IACXA,EAAK5F,SAAQqmC,EAAUzgC,MAGxBygC,EAAS,OAEd,MAAMC,EAAkBD,EAAQ3nC,SAAS6nC,kBACrC,IAAIzhD,MAAM6kC,UAAW6c,mBAAmBH,EAAQ3nC,UAChD2nC,EAAQ3nC,SAAS1Q,QAErB6R,EAAM4mC,oBACNH,EAAgBje,YAAYge,EAAQrhB,aACpCvgC,KAAKwC,OAAOy/C,mBAAmBJ,GAE/B7hD,KAAK0hD,kBAAmB,M,cCtC5BriD,EAAOC,QAAUC,OAAOC,kBAAkB,YAAa,CACrDC,OAAQ,CACNyiD,YAAa,CAAC7/C,KAAM,QACpBpC,OAAQ,CAACN,SAAS,GAClB4U,MAAO,CAAC5U,QAAS,IAEnBI,KAAM,WACJC,KAAKwC,OAASxC,KAAKY,GAAG2B,QAAQE,QAAQ0S,IACtCnV,KAAKwC,OAAO4S,SAASpV,MACrBA,KAAKkzB,MAAQ,KACblzB,KAAK0c,KAAO,GACZ1c,KAAKmiD,UAAY,IAAI9hD,MAAM+hD,WAE7Bj+C,OAAQ,WACNnE,KAAKwC,OAAO6S,YAAYrV,OAE1B6D,OAAQ,WACN7D,KAAK0c,KAAK9W,OAAS,GAErBzE,kBAAmB,WACjBnB,KAAKkzB,MAAQ,KACblzB,KAAK0c,KAAO,IAEd5Y,KAAO,WACL,MAAMu+C,EAAQ,IAAIhiD,MAAMC,QAClBgiD,EAAS,IAAIjiD,MAAMC,QACnBiiD,EAAQ,IAAIliD,MAAMC,QAExB,OAAO,SAAUyD,EAAGC,GAClB,MAAMpD,EAAKZ,KAAKY,GACVI,EAAOhB,KAAKgB,KACZmhD,EAAYniD,KAAKmiD,UACjB5tC,EAAQvT,EAAKuT,MAAQvQ,EAAK,IAEhC,IAAKhD,EAAKf,OAAQ,OAGlB,IAAKD,KAAK0c,KAAK9W,OAAQ,CACrB,MAAMrF,EAAWP,KAAKY,GAAGc,SAASnB,SAClCP,KAAKkzB,MAAQlzB,KAAKkzB,OAASlzB,KAAKwC,OAAOqT,SAAStV,GAChDP,KAAK0c,KAAO1c,KAAKwC,OAAOggD,QAAQjiD,EAAU8hD,EAAM7gD,KAAKR,EAAKkhD,aAAcliD,KAAKkzB,QAAU,GACvFtyB,EAAGC,KAAK,oBAIV,IAAKb,KAAK0c,KAAK9W,OAIb,OAHAmE,QAAQqT,KAAK,mCAAoCpc,EAAKkhD,aACtDliD,KAAKY,GAAGK,aAAa,YAAa,CAAChB,QAAQ,SAC3CW,EAAGC,KAAK,kBAKV,MAAM4hD,EAAW7hD,EAAGc,SAASnB,SACvBmiD,EAAY1iD,KAAK0c,KAAK,GAI5B,IAAIimC,EAEJ,GALAL,EAAOM,WAAWF,EAAWD,GAEZH,EAAO18C,SAGT2O,EAAO,CAKpB,GAHAvU,KAAK0c,KAAK8C,SAGLxf,KAAK0c,KAAK9W,OAGb,OAFA5F,KAAKY,GAAGK,aAAa,YAAa,CAAChB,QAAQ,SAC3CW,EAAGC,KAAK,kBAIV0hD,EAAM/gD,KAAKihD,GACXE,EAAa3iD,KAAK0c,KAAK,QAIvB6lC,EAAM/gD,KAAK8gD,EAAO/gD,UAAUgT,IAAQ3S,IAAI6gD,GACxCE,EAAaD,EAIfC,EAAWp/C,EAAIk/C,EAASl/C,EACxB3C,EAAGc,SAASqiC,OAAO4e,GAInBR,EAAUnD,IAAI6D,OAAOrhD,KAAK+gD,GAC1BJ,EAAUnD,IAAI6D,OAAOt/C,GAAK,IAC1B4+C,EAAUnD,IAAIprC,UAAUrQ,GAAK,EAC7B,MAAMu/C,EAAgBX,EAAUY,gBAAgB/iD,KAAKwC,OAAOwgD,cAEvDF,EAAcl9C,QAKjB08C,EAAOM,WAAWE,EAAc,GAAGG,MAAOR,GAC1CA,EAAS7gD,IAAI0gD,EAAO/gD,UAAUgT,KAJ9BkuC,EAASjhD,KAAK+gD,IAtEd,M,gBCvBR,MAAM,YAAEW,GAAgB,EAAQ,IAE1BC,EAAa,IAAID,EACjBE,EAAO,QAOb/jD,EAAOC,QAAUC,OAAO8jD,eAAe,MAAO,CAC5CtjD,KAAM,WACJC,KAAK4hD,QAAU,KACf5hD,KAAKsjD,OAAS,IAAIC,KAMpBtB,mBAAoB,SAAUhoC,GAC5Bja,KAAK4hD,QAAU,IAAIvhD,MAAM2yB,KAAK/Y,GAC9BkpC,EAAWK,YAAYJ,EAAMF,EAAYO,WAAWxpC,IACpD8D,MAAM+1B,KAAK9zC,KAAKsjD,QAAQx3C,QAAS43C,GAAUA,EAAMviD,sBAMnD6hD,WAAY,WACV,OAAOhjD,KAAK4hD,SAMdxsC,SAAU,SAAUuuC,GAClB3jD,KAAKsjD,OAAO1hD,IAAI+hD,IAMlBtuC,YAAa,SAAUsuC,GACrB3jD,KAAKsjD,OAAOM,OAAOD,IASrBnB,QAAS,SAAUjtC,EAAOC,EAAKquC,GAC7B,OAAO7jD,KAAK4hD,QACRuB,EAAWW,SAASvuC,EAAOC,EAAK4tC,EAAMS,GACtC,MAONhuC,SAAU,SAAUtV,GAClB,OAAOP,KAAK4hD,QACRuB,EAAWttC,SAASutC,EAAM7iD,GAC1B,MAQNuV,QAAS,SAAUvV,EAAUsjD,GAC3B,OAAO7jD,KAAK4hD,QACRuB,EAAWY,eAAexjD,EAAU6iD,EAAMS,GAAS,GACnD,MAWN9tC,UAAW,SAAUR,EAAOC,EAAKquC,EAAS1iC,EAAM6iC,GAC9C,OAAKhkD,KAAK4hD,QAGEzgC,EAILgiC,EAAWptC,UAAUR,EAAOC,EAAK2L,EAAMiiC,EAAMS,EAASG,IAH3DA,EAAUxiD,KAAKgU,GACRxV,KAAK8V,QAAQN,EAAKquC,KAJzBG,EAAUxiD,KAAKgU,GACR,U,6BC1Fb,uDAAItB,EAAE,aAAaA,EAAE+vC,iBAAiB,SAAS/vC,GAAG,IAAInQ,EAAEmgD,EAAEnzC,EAAE,IAAIhN,EAAE,EAAEmgD,EAAEhwC,EAAEiwC,MAAMv+C,OAAO7B,EAAEmgD,EAAEngD,KAAKgN,EAAEmD,EAAEiwC,MAAMpgD,IAAIqgD,SAAS,IAAI/jD,MAAMC,QAAQ,EAAE,EAAE,GAAGyQ,EAAEqzC,SAASxiD,IAAIsS,EAAEsY,SAASzb,EAAE6Q,IAAI7Q,EAAEqzC,SAASxiD,IAAIsS,EAAEsY,SAASzb,EAAE8Q,IAAI9Q,EAAEqzC,SAASxiD,IAAIsS,EAAEsY,SAASzb,EAAE8c,IAAI9c,EAAEqzC,SAASC,aAAa,IAAInwC,EAAEowC,YAAY,SAASpwC,EAAEnQ,GAAG,OAAOwgD,OAAOrwC,EAAEswC,QAAQzgD,KAAKmQ,EAAEuwC,OAAO,SAASvwC,GAAG,OAAOA,EAAE9Q,KAAKshD,MAAMthD,KAAK+1C,SAASjlC,EAAEtO,UAAUsO,EAAEywC,eAAe,SAASzwC,EAAEnQ,GAAG,IAAImgD,EAAE,GAAG,GAAGhwC,EAAEpI,SAAQ,SAASoI,GAAGnQ,EAAEoH,QAAQ+I,IAAI,GAAGgwC,EAAExpC,KAAKxG,MAAKgwC,EAAEt+C,OAAO,EAAE,MAAM,GAAGs+C,EAAEtJ,SAAS1mC,EAAE,KAAKgwC,EAAEtJ,SAAS1mC,EAAEA,EAAEtO,OAAO,KAAKsO,EAAEwG,KAAKxG,EAAEsL,SAAS0kC,EAAEtJ,SAAS72C,EAAE,KAAKmgD,EAAEtJ,SAAS72C,EAAEA,EAAE6B,OAAO,KAAK7B,EAAE2W,KAAK3W,EAAEyb,SAAS0kC,EAAE,GAAGhwC,EAAEpI,SAAQ,SAASoI,GAAGnQ,EAAE62C,SAAS1mC,IAAIgwC,EAAExpC,KAAKxG,MAAK,IAAI,IAAInD,EAAEmzC,EAAE,GAAGpzC,EAAEozC,EAAE,GAAGv+C,EAAEuO,EAAE6T,QAAQpiB,EAAE,KAAKoL,GAAGpL,EAAE+U,KAAK/U,EAAE6Z,SAAS,IAAI,IAAIxU,EAAE,EAAE45C,EAAE7gD,EAAEgkB,QAAQ68B,EAAE,KAAK9zC,GAAG,GAAG8zC,EAAElqC,KAAKkqC,EAAEplC,SAASxU,IAAI,GAAG,MAAM,IAAInE,MAAM,oBAAoB,OAAO+9C,EAAEplC,QAAQolC,EAAE91B,MAAQnpB,EAAEypC,OAAOwV,IAAI1wC,EAAE2wC,mBAAmB,SAAS3wC,EAAEnQ,GAAG,IAAImgD,EAAE,IAAI7jD,MAAMC,QAAQyQ,EAAEhN,EAAEyoB,SAAStY,EAAE4wC,UAAUh5C,SAAQ,SAASoI,GAAGgwC,EAAEtiD,IAAImP,EAAEmD,OAAMgwC,EAAEG,aAAanwC,EAAE4wC,UAAUl/C,QAAQsO,EAAEkwC,SAAS5iD,KAAK0iD,IAAIhwC,EAAE6wC,aAAa,SAAS7wC,EAAEnQ,GAAG,IAAI,IAAImgD,EAAE,GAAGnzC,EAAEhN,EAAEyoB,SAAS1b,EAAE,EAAEA,EAAEoD,EAAE4wC,UAAUl/C,OAAOkL,IAAI,CAAC,IAAInL,EAAEqF,EAAE45C,EAAE/2B,EAAE9c,EAAEmD,EAAE4wC,UAAUh0C,IAAI,IAAIA,GAAGnL,EAAEuO,EAAE4wC,UAAU,GAAG95C,EAAEkJ,EAAE4wC,UAAU5wC,EAAE4wC,UAAUl/C,OAAO,IAAIkL,IAAIoD,EAAE4wC,UAAUl/C,OAAO,GAAGD,EAAEuO,EAAE4wC,UAAU,GAAG95C,EAAEkJ,EAAE4wC,UAAU5wC,EAAE4wC,UAAUl/C,OAAO,KAAKD,EAAEuO,EAAE4wC,UAAUh0C,EAAE,GAAG9F,EAAEkJ,EAAE4wC,UAAUh0C,EAAE,IAAI8zC,EAAE7zC,EAAE/F,GAAG,IAAIg6C,EAAEj0C,EAAEpL,GAAG4D,QAAQzH,IAAI+rB,GAAGjM,EAAEgjC,EAAEr7C,QAAQzH,IAAI+rB,GAAGzI,EAAE4/B,EAAEC,QAAQrjC,GAAG,GAAGwD,EAAEhiB,KAAKmC,GAAG,KAAK6f,EAAEhiB,KAAKmC,GAAG,IAAI,CAAC,IAAI2lB,EAAE,GAAGhX,EAAEgxC,WAAWp5C,SAAQ,SAAS/H,GAAGA,EAAE+gD,UAAUlK,SAAS1mC,EAAE4wC,UAAUh0C,KAAKoa,EAAExQ,KAAK3W,MAAKmQ,EAAEgxC,WAAWh6B,OAAOg5B,EAAExpC,KAAKxG,EAAE4wC,UAAUh0C,IAAIoD,EAAE4wC,UAAUZ,EAAElkD,KAAK6kD,mBAAmB3wC,EAAEnQ,IAAImQ,EAAEixC,SAAS,SAASjxC,EAAEnQ,GAAG,IAAImgD,EAAEngD,EAAEyoB,SAAS,GAAGtY,EAAE4wC,UAAUl/C,OAAO,EAAE,OAAM,EAAG,IAAI,IAAImL,GAAE,EAAGD,EAAE,GAAGnL,EAAE,EAAEA,EAAEuO,EAAE4wC,UAAUl/C,OAAOD,IAAI,CAAC,IAAIqF,EAAE45C,EAAE/2B,EAAEq2B,EAAEhwC,EAAE4wC,UAAUn/C,IAAI,IAAIA,GAAGqF,EAAEk5C,EAAEhwC,EAAE4wC,UAAU,IAAIF,EAAEV,EAAEhwC,EAAE4wC,UAAU5wC,EAAE4wC,UAAUl/C,OAAO,KAAKD,IAAIuO,EAAE4wC,UAAUl/C,OAAO,GAAGoF,EAAEk5C,EAAEhwC,EAAE4wC,UAAU,IAAIF,EAAEV,EAAEhwC,EAAE4wC,UAAU5wC,EAAE4wC,UAAUl/C,OAAO,MAAMoF,EAAEk5C,EAAEhwC,EAAE4wC,UAAUn/C,EAAE,IAAIi/C,EAAEV,EAAEhwC,EAAE4wC,UAAUn/C,EAAE,KAAK,IAAIq/C,EAAEh6C,EAAEzB,QAAQzH,IAAI+rB,GAAGjM,EAAEgjC,EAAEr7C,QAAQzH,IAAI+rB,GAAGzI,EAAE4/B,EAAEC,QAAQrjC,GAAG,GAAGwD,IAAIhiB,KAAKmC,IAAI,IAAI6f,EAAE,OAAM,EAAG,IAAI8F,EAAE85B,EAAEI,MAAMxjC,GAAGre,EAAEuN,EAAE4J,KAAKwQ,GAAG,OAAOpa,EAAEhF,SAAQ,SAASoI,GAAG,IAAIA,IAAInD,GAAE,MAAMD,EAAEhF,QAAQgF,EAAE,GAAG,EAAE,SAASoD,GAAGA,EAAE,IAAInD,GAAE,IAAK,SAASmD,GAAGA,EAAE,IAAInD,GAAE,KAAMA,GAAGmD,EAAEmxC,kBAAkB,SAASnxC,EAAEnQ,GAAG,IAAImgD,EAAEhwC,EAAE/Q,EAAEY,EAAEZ,EAAE4N,EAAEmD,EAAE3Q,EAAEQ,EAAER,EAAEuN,EAAEoD,EAAEpP,EAAEf,EAAEe,EAAE,OAAOo/C,EAAEA,EAAEnzC,EAAEA,EAAED,EAAEA,GAAGoD,EAAEoxC,cAAc,SAASpxC,EAAEnQ,GAAG,IAAI,IAAImgD,GAAE,EAAGnzC,GAAG,EAAED,EAAEoD,EAAEtO,OAAOD,EAAEmL,EAAE,IAAIC,EAAED,EAAEnL,EAAEoL,GAAGmD,EAAEnD,GAAGjM,GAAGf,EAAEe,GAAGf,EAAEe,EAAEoP,EAAEvO,GAAGb,GAAGoP,EAAEvO,GAAGb,GAAGf,EAAEe,GAAGf,EAAEe,EAAEoP,EAAEnD,GAAGjM,IAAIf,EAAEZ,GAAG+Q,EAAEvO,GAAGxC,EAAE+Q,EAAEnD,GAAG5N,IAAIY,EAAEe,EAAEoP,EAAEnD,GAAGjM,IAAIoP,EAAEvO,GAAGb,EAAEoP,EAAEnD,GAAGjM,GAAGoP,EAAEnD,GAAG5N,IAAI+gD,GAAGA,GAAG,OAAOA,GAAGhwC,EAAEqxC,kBAAkB,SAASrxC,EAAEnQ,EAAEmgD,GAAG,IAAInzC,EAAE,IAAID,GAAG,IAAInL,EAAE,GAAG,OAAO5B,EAAE+gD,UAAUh5C,SAAQ,SAASoI,GAAGnD,EAAE3N,KAAKoC,IAAI0+C,EAAEhwC,GAAG3Q,EAAEwN,GAAGD,EAAE1N,KAAKkC,IAAI4+C,EAAEhwC,GAAG3Q,EAAEuN,GAAGnL,EAAE+U,KAAKwpC,EAAEhwC,UAASA,EAAE3Q,EAAEuN,EAAE,IAAIoD,EAAE3Q,EAAEwN,EAAE,IAAI/Q,KAAKslD,cAAc3/C,EAAEuO,KAAKA,EAAEsxC,SAAS,SAAStxC,EAAEnQ,EAAEmgD,GAAG,OAAOA,EAAE/gD,EAAE+Q,EAAE/Q,IAAIY,EAAEe,EAAEoP,EAAEpP,IAAIf,EAAEZ,EAAE+Q,EAAE/Q,IAAI+gD,EAAEp/C,EAAEoP,EAAEpP,IAAIoP,EAAEuxC,OAAO,SAASvxC,EAAEnQ,GAAG,OAAO/D,KAAKqlD,kBAAkBnxC,EAAEnQ,GAAG,MAAM,IAAIA,EAAE,SAASmQ,GAAGlU,KAAK85B,QAAQ,GAAG95B,KAAK0lD,cAAcxxC,GAAGnQ,EAAEkP,UAAUyH,KAAK,SAASxG,GAAGlU,KAAK85B,QAAQpf,KAAKxG,GAAGlU,KAAK2lD,SAAS3lD,KAAK85B,QAAQl0B,OAAO,IAAI7B,EAAEkP,UAAU6b,IAAI,WAAW,IAAI5a,EAAElU,KAAK85B,QAAQ,GAAG/1B,EAAE/D,KAAK85B,QAAQhL,MAAM,OAAO9uB,KAAK85B,QAAQl0B,OAAO,IAAI5F,KAAK85B,QAAQ,GAAG/1B,EAAE/D,KAAK4lD,SAAS,IAAI1xC,GAAGnQ,EAAEkP,UAAU9O,OAAO,SAAS+P,GAAG,IAAInQ,EAAE/D,KAAK85B,QAAQ3uB,QAAQ+I,GAAGgwC,EAAElkD,KAAK85B,QAAQhL,MAAM/qB,IAAI/D,KAAK85B,QAAQl0B,OAAO,IAAI5F,KAAK85B,QAAQ/1B,GAAGmgD,EAAElkD,KAAK0lD,cAAcxB,GAAGlkD,KAAK0lD,cAAcxxC,GAAGlU,KAAK2lD,SAAS5hD,GAAG/D,KAAK4lD,SAAS7hD,KAAKA,EAAEkP,UAAU8hC,KAAK,WAAW,OAAO/0C,KAAK85B,QAAQl0B,QAAQ7B,EAAEkP,UAAU4yC,eAAe,SAAS3xC,GAAGlU,KAAK2lD,SAAS3lD,KAAK85B,QAAQ3uB,QAAQ+I,KAAKnQ,EAAEkP,UAAU0yC,SAAS,SAASzxC,GAAG,IAAI,IAAInQ,EAAE/D,KAAK85B,QAAQ5lB,GAAGA,EAAE,GAAG,CAAC,IAAIgwC,GAAGhwC,EAAE,GAAG,GAAG,EAAEnD,EAAE/Q,KAAK85B,QAAQoqB,GAAG,KAAKlkD,KAAK0lD,cAAc3hD,GAAG/D,KAAK0lD,cAAc30C,IAAI,MAAM/Q,KAAK85B,QAAQoqB,GAAGngD,EAAE/D,KAAK85B,QAAQ5lB,GAAGnD,EAAEmD,EAAEgwC,IAAIngD,EAAEkP,UAAU2yC,SAAS,SAAS1xC,GAAG,IAAI,IAAInQ,EAAE/D,KAAK85B,QAAQl0B,OAAOs+C,EAAElkD,KAAK85B,QAAQ5lB,GAAGnD,EAAE/Q,KAAK0lD,cAAcxB,KAAK,CAAC,IAAIpzC,EAAEoD,EAAE,GAAG,EAAEvO,EAAEmL,EAAE,EAAE9F,EAAE,KAAK45C,OAAE,EAAgI,GAAtHj/C,EAAE5B,IAAG6gD,EAAE5kD,KAAK0lD,cAAc1lD,KAAK85B,QAAQn0B,KAAKoL,IAAI/F,EAAErF,GAAMmL,EAAE/M,GAAE/D,KAAK0lD,cAAc1lD,KAAK85B,QAAQhpB,KAAK,OAAO9F,EAAE+F,EAAE6zC,KAAK55C,EAAE8F,GAAM,OAAO9F,EAAE,MAAMhL,KAAK85B,QAAQ5lB,GAAGlU,KAAK85B,QAAQ9uB,GAAGhL,KAAK85B,QAAQ9uB,GAAGk5C,EAAEhwC,EAAElJ,IAAI,IAAIk5C,EAAE,aAAaA,EAAEnkD,KAAK,SAASmU,GAAG,IAAI,IAAInQ,EAAE,EAAEA,EAAEmQ,EAAEtO,OAAO7B,IAAI,CAAC,IAAImgD,EAAEhwC,EAAEnQ,GAAGmgD,EAAEh5B,EAAE,EAAEg5B,EAAEh3B,EAAE,EAAEg3B,EAAEc,EAAE,EAAEd,EAAE4B,KAAK,EAAE5B,EAAE6B,SAAQ,EAAG7B,EAAE8B,QAAO,EAAG9B,EAAExkB,OAAO,OAAOwkB,EAAE+B,QAAQ,SAAS/xC,GAAG,IAAI,IAAInQ,EAAE,EAAEA,EAAEmQ,EAAEtO,OAAO7B,IAAI,CAAC,IAAImgD,EAAEhwC,EAAEnQ,UAAUmgD,EAAEh5B,SAASg5B,EAAEh3B,SAASg3B,EAAEc,SAASd,EAAE4B,YAAY5B,EAAE6B,eAAe7B,EAAE8B,cAAc9B,EAAExkB,SAASwkB,EAAEgC,KAAK,WAAW,OAAO,IAAIniD,GAAE,SAASmQ,GAAG,OAAOA,EAAEgX,MAAKg5B,EAAEiC,OAAO,SAASjyC,EAAEnQ,EAAEmgD,GAAGlkD,KAAKD,KAAKmU,GAAG,IAAInD,EAAE/Q,KAAKkmD,OAAO,IAAIn1C,EAAE2J,KAAK3W,GAAGgN,EAAEgkC,OAAO,GAAG,CAAC,IAAIjkC,EAAEC,EAAE+d,MAAM,GAAGhe,IAAIozC,EAAE,CAAC,IAAI,IAAIv+C,EAAEmL,EAAE9F,EAAE,GAAGrF,EAAE+5B,QAAQ10B,EAAE0P,KAAK/U,GAAGA,EAAEA,EAAE+5B,OAAO,OAAO1/B,KAAKimD,QAAQj7C,GAAGA,EAAEo7C,UAAUt1C,EAAEk1C,QAAO,EAAG,IAAI,IAAIpB,EAAE5kD,KAAKklD,WAAWhxC,EAAEpD,GAAG+c,EAAE,EAAEm3B,EAAEJ,EAAEh/C,OAAOioB,EAAEm3B,EAAEn3B,IAAI,CAAC,IAAIjM,EAAEgjC,EAAE/2B,GAAG,IAAIjM,EAAEokC,OAAO,CAAC,IAAI5gC,EAAEtU,EAAEoc,EAAEtL,EAAEkkC,KAAK56B,EAAEtJ,EAAEmkC,QAAQ,IAAI76B,GAAG9F,EAAExD,EAAEsL,EAAE,CAAC,GAAGtL,EAAEmkC,SAAQ,EAAGnkC,EAAE8d,OAAO5uB,GAAG8Q,EAAEwiC,WAAWF,EAAEE,SAAS,MAAM,IAAIv9C,MAAM,oBAAoB+a,EAAEojC,EAAEpjC,EAAEojC,GAAGhlD,KAAKqmD,UAAUzkC,EAAEwiC,SAASF,EAAEE,UAAUxiC,EAAEsL,EAAE9H,EAAExD,EAAEsJ,EAAEtJ,EAAEsL,EAAEtL,EAAEojC,EAAE95B,EAAEna,EAAE80C,eAAejkC,GAAG7Q,EAAE2J,KAAKkH,MAAM,MAAM,IAAIsiC,EAAEmC,UAAU,SAAStiD,EAAEmgD,GAAG,OAAOhwC,EAAEmxC,kBAAkBthD,EAAEmgD,IAAIA,EAAEgB,WAAW,SAAShxC,EAAEnQ,GAAG,IAAI,IAAImgD,EAAE,GAAGnzC,EAAE,EAAEA,EAAEhN,EAAEmhD,WAAWt/C,OAAOmL,IAAImzC,EAAExpC,KAAKxG,EAAEnQ,EAAEmhD,WAAWn0C,KAAK,OAAOmzC,GAAG,IAAInzC,EAAE,EAAED,EAAE,aAAaA,EAAEw1C,UAAU,SAASviD,GAAG,IAAImgD,EAAElkD,KAAK+Q,EAAE/Q,KAAKumD,qBAAqBxiD,GAAG+M,EAAE,GAAGC,EAAEyb,SAAS1gB,SAAQ,SAAS/H,GAAGA,EAAEZ,EAAE+Q,EAAEowC,YAAYvgD,EAAEZ,EAAE,GAAGY,EAAER,EAAE2Q,EAAEowC,YAAYvgD,EAAER,EAAE,GAAGQ,EAAEe,EAAEoP,EAAEowC,YAAYvgD,EAAEe,EAAE,MAAKgM,EAAE0b,SAASzb,EAAEyb,SAAS,IAAI7mB,EAAE3F,KAAKwmD,oBAAoBz1C,GAAGD,EAAEm2B,OAAO,GAAG,IAAIj8B,EAAE,SAASkJ,EAAEnQ,GAAG,IAAI,IAAImgD,EAAE,EAAEA,EAAEhwC,EAAEtO,OAAOs+C,IAAI,GAAGngD,IAAImQ,EAAEgwC,GAAG,OAAOA,GAAG,OAAOv+C,EAAEmG,SAAQ,SAAS/H,GAAG,IAAIgN,EAAE,GAAGhN,EAAE+H,SAAQ,SAASgF,GAAG,IAAInL,EAAEmL,EAAEo0C,WAAW7qC,KAAI,SAASnG,GAAG,OAAOlJ,EAAEjH,EAAEmQ,MAAK0wC,EAAE9zC,EAAEo0C,WAAW7qC,KAAI,SAASnG,GAAG,OAAOgwC,EAAEuC,0BAA0B31C,EAAEoD,MAAKpD,EAAEszC,SAASjhD,EAAE+Q,EAAEowC,YAAYxzC,EAAEszC,SAASjhD,EAAE,GAAG2N,EAAEszC,SAAS7gD,EAAE2Q,EAAEowC,YAAYxzC,EAAEszC,SAAS7gD,EAAE,GAAGuN,EAAEszC,SAASt/C,EAAEoP,EAAEowC,YAAYxzC,EAAEszC,SAASt/C,EAAE,GAAGiM,EAAE2J,KAAK,CAACtT,GAAG4D,EAAEjH,EAAE+M,GAAGo0C,WAAWv/C,EAAEm/C,UAAUh0C,EAAEg0C,UAAUV,SAAStzC,EAAEszC,SAASsC,QAAQ9B,OAAM9zC,EAAEm2B,OAAOvsB,KAAK3J,MAAKD,GAAGA,EAAEy1C,qBAAqB,SAASxiD,GAAG,OAAOmQ,EAAE+vC,iBAAiBlgD,GAAGA,EAAE4iD,gBAAgB3mD,KAAK4mD,2BAA2B7iD,IAAI+M,EAAE01C,oBAAoB,SAAStyC,GAAG,IAAInQ,EAAE,GAAGmgD,EAAE,EAAEnzC,EAAE,SAASmD,GAAGA,EAAEgxC,WAAWp5C,SAAQ,SAAS/H,QAAG,IAASA,EAAEmvB,QAAQnvB,EAAEmvB,MAAMhf,EAAEgf,MAAMniB,EAAEhN,QAAO,OAAOmQ,EAAE2yC,SAAS/6C,SAAQ,SAASoI,QAAG,IAASA,EAAEgf,QAAQhf,EAAEgf,MAAMgxB,IAAInzC,EAAEmD,IAAInQ,EAAEmQ,EAAEgf,SAASnvB,EAAEmQ,EAAEgf,OAAO,IAAInvB,EAAEmQ,EAAEgf,OAAOxY,KAAKxG,MAAKnQ,GAAG+M,EAAEg2C,wBAAwB,SAAS5yC,EAAEnQ,EAAEmgD,GAAG,IAAInzC,EAAE,IAAIwyC,IAAIzyC,EAAEozC,EAAEhxC,IAAIgB,EAAE4wC,UAAU,IAAIn/C,EAAEu+C,EAAEhxC,IAAIgB,EAAE4wC,UAAU,IAAI95C,EAAEk5C,EAAEhxC,IAAIgB,EAAE4wC,UAAU,IAAIh0C,EAAEhF,SAAQ,SAASoI,IAAIvO,EAAEgzB,IAAIzkB,IAAIlJ,EAAE2tB,IAAIzkB,KAAKnD,EAAEnP,IAAImC,EAAE8iD,SAAS3yC,OAAMvO,EAAEmG,SAAQ,SAASoI,GAAGlJ,EAAE2tB,IAAIzkB,IAAInD,EAAEnP,IAAImC,EAAE8iD,SAAS3yC,OAAMA,EAAEgxC,WAAWnnC,MAAM+1B,KAAK/iC,IAAID,EAAE81C,2BAA2B,SAAS1yC,GAAG,IAAI,IAAInQ,EAAE/D,KAAKkkD,EAAE,GAAGpzC,EAAEoD,EAAEsY,SAAS7mB,EAAEuO,EAAE6yC,cAAc/7C,EAAE,IAAIqtB,IAAIusB,EAAE,EAAEA,EAAE9zC,EAAElL,OAAOg/C,IAAI55C,EAAE1J,IAAIsjD,EAAE,IAAIrB,KAAKrvC,EAAEiwC,MAAMr4C,SAAQ,SAASoI,GAAGgwC,EAAExpC,KAAK,CAACtT,GAAG2J,IAAI+zC,UAAU,CAAC5wC,EAAE0N,EAAE1N,EAAE2N,EAAE3N,EAAE2Z,GAAGu2B,SAASlwC,EAAEkwC,SAASv3B,OAAO3Y,EAAE2Y,OAAOq4B,WAAW,KAAKl6C,EAAEkI,IAAIgB,EAAE0N,GAAGhgB,IAAIsiD,EAAEt+C,OAAO,GAAGoF,EAAEkI,IAAIgB,EAAE2N,GAAGjgB,IAAIsiD,EAAEt+C,OAAO,GAAGoF,EAAEkI,IAAIgB,EAAE2Z,GAAGjsB,IAAIsiD,EAAEt+C,OAAO,MAAK,IAAIioB,EAAE,CAACg5B,SAAS3C,EAAE13B,SAAS1b,EAAEi2C,cAAcphD,GAAG,OAAOu+C,EAAEp4C,SAAQ,SAASoI,GAAGnQ,EAAE+iD,wBAAwB5yC,EAAE2Z,EAAE7iB,MAAK6iB,GAAG/c,EAAE21C,0BAA0B,SAASvyC,EAAEnQ,GAAG,IAAImgD,EAAEhwC,EAAE4wC,UAAU/zC,EAAEhN,EAAE+gD,UAAUh0C,EAAE,IAAIyyC,IAAI,GAAGW,EAAEp4C,SAAQ,SAASoI,GAAGnD,EAAE6pC,SAAS1mC,IAAIpD,EAAElP,IAAIsS,MAAKpD,EAAEikC,KAAK,EAAE,MAAM,GAAGjkC,EAAE6nB,IAAIurB,EAAE,KAAKpzC,EAAE6nB,IAAIurB,EAAEA,EAAEt+C,OAAO,KAAKs+C,EAAExpC,KAAKwpC,EAAE1kC,SAAS1O,EAAE6nB,IAAI5nB,EAAE,KAAKD,EAAE6nB,IAAI5nB,EAAEA,EAAEnL,OAAO,KAAKmL,EAAE2J,KAAK3J,EAAEyO,SAAS,IAAI7Z,EAAE,GAAG,OAAOu+C,EAAEp4C,SAAQ,SAASoI,GAAGnD,EAAE6pC,SAAS1mC,IAAIvO,EAAE+U,KAAKxG,MAAKvO,GAAG,IAAIA,EAAE,WAAW3F,KAAK0mD,QAAQ,IAAI/gD,EAAEsN,UAAUyH,KAAK,SAASxG,EAAEnQ,QAAG,IAASA,IAAIA,EAAEmQ,GAAGlU,KAAK0mD,QAAQhsC,KAAK,CAACssC,KAAK9yC,EAAE+yC,MAAMljD,KAAK4B,EAAEsN,UAAUi0C,WAAW,WAAW,IAAInjD,EAAEmgD,EAAEnzC,EAAED,EAAE9Q,KAAK0mD,QAAQ/gD,EAAE,GAAGqF,EAAE,EAAE45C,EAAE,EAAE/2B,EAAE,EAAEq2B,EAAEpzC,EAAE,GAAGk2C,KAAKj2C,EAAED,EAAE,GAAGm2C,MAAMthD,EAAE+U,KAAK3W,EAAE+M,EAAE,GAAGk2C,MAAM,IAAI,IAAIhC,EAAE,EAAEA,EAAEl0C,EAAElL,OAAOo/C,IAAI,CAAC,IAAIpjC,EAAE9Q,EAAEk0C,GAAGgC,KAAK5hC,EAAEtU,EAAEk0C,GAAGiC,MAAM,GAAG/yC,EAAEsxC,SAASzhD,EAAEgN,EAAEqU,IAAI,EAAE,CAAC,KAAKlR,EAAEuxC,OAAO1hD,EAAEgN,IAAImD,EAAEsxC,SAASzhD,EAAEmgD,EAAE9+B,GAAG,GAAG,CAACzf,EAAE+U,KAAKwpC,GAAGA,EAAEngD,EAAEmgD,EAAEnzC,EAAEhN,EAAE6gD,EAAE55C,EAAE45C,EAAE/2B,EAAE7iB,EAAEg6C,EAAEh6C,EAAE,SAAS+F,EAAEqU,EAAEyI,EAAEm3B,EAAE,GAAG9wC,EAAEsxC,SAASzhD,EAAEmgD,EAAEtiC,IAAI,EAAE,CAAC,KAAK1N,EAAEuxC,OAAO1hD,EAAEmgD,IAAIhwC,EAAEsxC,SAASzhD,EAAEgN,EAAE6Q,GAAG,GAAG,CAACjc,EAAE+U,KAAK3J,GAAGmzC,EAAEngD,EAAEgN,EAAEA,EAAEhN,EAAE6gD,EAAE55C,EAAE6iB,EAAEA,EAAE7iB,EAAEg6C,EAAEh6C,EAAE,SAASk5C,EAAEtiC,EAAEgjC,EAAEI,GAAG,OAAO,IAAIr/C,EAAEC,QAAQsO,EAAEuxC,OAAO9/C,EAAEA,EAAEC,OAAO,GAAGkL,EAAEA,EAAElL,OAAO,GAAGohD,OAAOrhD,EAAE+U,KAAK5J,EAAEA,EAAElL,OAAO,GAAGohD,MAAMhnD,KAAK0c,KAAK/W,EAAEA,GAAG,IAAIqF,EAAE45C,EAAE/2B,EAAEm3B,EAAEpjC,EAAEwD,EAAE8F,EAAE,WAAWlrB,KAAKmnD,MAAM,IAAIj8B,EAAEu4B,WAAW,SAASvvC,GAAG,OAAOpD,EAAEw1C,UAAUpyC,IAAIgX,EAAEjY,UAAUuwC,YAAY,SAAStvC,EAAEnQ,GAAG/D,KAAKmnD,MAAMjzC,GAAGnQ,GAAGmnB,EAAEjY,UAAU4C,SAAS,SAAS9R,EAAEmgD,GAAG,IAAIlkD,KAAKmnD,MAAMpjD,GAAG,OAAO,KAAK,IAAIgN,EAAE,KAAKD,EAAE1N,KAAKgkD,IAAI,GAAG,GAAG,OAAOpnD,KAAKmnD,MAAMpjD,GAAGkjC,OAAOn7B,SAAQ,SAAS/H,EAAE4B,GAAG5B,EAAE+H,SAAQ,SAAS/H,GAAG,IAAIiH,EAAEkJ,EAAEmxC,kBAAkBthD,EAAEqgD,SAASF,GAAGl5C,EAAE8F,IAAIC,EAAEpL,EAAEmL,EAAE9F,SAAO+F,GAAGma,EAAEjY,UAAUo0C,cAAc,SAAStjD,EAAEmgD,EAAEnzC,EAAED,GAAG,IAAI9Q,KAAKmnD,MAAMpjD,GAAG,OAAO,IAAI1D,MAAMC,QAAQyQ,EAAEA,GAAG,KAAKD,EAAEA,GAAG,EAAE,IAAInL,EAAE,GAAG,OAAO3F,KAAKmnD,MAAMpjD,GAAGkjC,OAAOid,GAAGp4C,SAAQ,SAAS/H,GAAGgN,GAAGD,EAAEoD,EAAEmxC,kBAAkBt0C,EAAEhN,EAAEqgD,UAAUtzC,EAAEA,GAAGnL,EAAE+U,KAAK3W,EAAEqgD,UAAUz+C,EAAE+U,KAAK3W,EAAEqgD,aAAYlwC,EAAEuwC,OAAO9+C,IAAI,IAAItF,MAAMC,SAAS4qB,EAAEjY,UAAU8wC,eAAe,SAAShgD,EAAEmgD,EAAEnzC,EAAED,QAAG,IAASA,IAAIA,GAAE,GAAI,IAAInL,EAAE3F,KAAKmnD,MAAMjD,GAAG13B,SAASxhB,EAAE,KAAK45C,EAAEjsC,IAAS,OAAO3Y,KAAKmnD,MAAMjD,GAAGjd,OAAOl2B,GAAGjF,SAAQ,SAASo4C,GAAG,IAAInzC,EAAEmD,EAAEmxC,kBAAkBnB,EAAEE,SAASrgD,GAAGgN,EAAE6zC,KAAK9zC,GAAGoD,EAAEqxC,kBAAkBxhD,EAAEmgD,EAAEv+C,MAAMqF,EAAEk5C,EAAEU,EAAE7zC,MAAK/F,GAAGkgB,EAAEjY,UAAU6wC,SAAS,SAAS5vC,EAAEnQ,EAAEgN,EAAED,GAAG,IAAI9F,EAAEhL,KAAKmnD,MAAMp2C,GAAGk2B,OAAOn2B,GAAG8zC,EAAE5kD,KAAKmnD,MAAMp2C,GAAGyb,SAASqB,EAAE7tB,KAAK+jD,eAAe7vC,EAAEnD,EAAED,GAAGk0C,EAAEhlD,KAAK+jD,eAAehgD,EAAEgN,EAAED,GAAE,GAAI,IAAI+c,IAAIm3B,EAAE,OAAO,KAAK,IAAIpjC,EAAEsiC,EAAEiC,OAAOn7C,EAAE6iB,EAAEm3B,GAAG5/B,EAAE,SAASlR,EAAEnQ,GAAG,IAAI,IAAImgD,EAAE,EAAEA,EAAEhwC,EAAEgxC,WAAWt/C,OAAOs+C,IAAI,GAAGhwC,EAAEgxC,WAAWhB,KAAKngD,EAAEqD,GAAG,OAAO8M,EAAEwyC,QAAQxC,IAAIh5B,EAAE,IAAIvlB,EAAEulB,EAAExQ,KAAKxG,GAAG,IAAI,IAAI+B,EAAE,EAAEA,EAAE2L,EAAEhc,OAAOqQ,IAAI,CAAC,IAAIlD,EAAE6O,EAAE3L,EAAE,GAAG,GAAGlD,EAAE,CAAC,IAAID,EAAEsS,EAAExD,EAAE3L,GAAGlD,GAAGmY,EAAExQ,KAAKkqC,EAAE9xC,EAAE,IAAI8xC,EAAE9xC,EAAE,MAAMoY,EAAExQ,KAAK3W,GAAGmnB,EAAEg8B,aAAa,IAAIh6B,EAAEhC,EAAExO,KAAKrC,KAAI,SAASnG,GAAG,OAAO,IAAI7T,MAAMC,QAAQ4T,EAAE/Q,EAAE+Q,EAAE3Q,EAAE2Q,EAAEpP,MAAK,OAAOooB,EAAE1N,QAAQ0N,GAAGhC,EAAEjY,UAAU8C,WAAW8X,EAAE,IAAIxtB,MAAMC,QAAQ0kD,EAAE,IAAI3kD,MAAMinD,MAAM1lC,EAAE,IAAIvhB,MAAMknD,SAASniC,EAAE,IAAI/kB,MAAMC,QAAQ,SAAS4T,EAAEnQ,EAAEmgD,EAAEnzC,EAAED,EAAEnL,GAAG,IAAIulB,EAAElrB,KAAKmnD,MAAMp2C,GAAGyb,SAASvW,EAAEjW,KAAKmnD,MAAMp2C,GAAGk2B,OAAOn2B,GAAGiC,EAAE,CAACmxC,GAAGpxC,EAAE,GAAGA,EAAEoxC,EAAE98C,IAAI,EAAE4D,OAAE,EAAOoa,EAAE9jB,IAAI,EAAE,EAAE,GAAGsjD,EAAEjsC,IAASqsC,EAAEwC,sBAAsBt8B,EAAEg5B,EAAEY,UAAU,IAAI55B,EAAEg5B,EAAEY,UAAU,IAAI55B,EAAEg5B,EAAEY,UAAU,KAAKE,EAAEyC,aAAa1jD,EAAE8pB,GAAG9pB,EAAEvC,KAAKqsB,GAAG,IAAI,IAAIX,EAAEna,EAAE+b,MAAM5B,EAAEA,EAAEna,EAAE+b,MAAM,CAAClN,EAAEtgB,IAAI4pB,EAAEgC,EAAE43B,UAAU,IAAI55B,EAAEgC,EAAE43B,UAAU,IAAI55B,EAAEgC,EAAE43B,UAAU,KAAKljC,EAAE8lC,oBAAoB3jD,EAAE8pB,GAAGA,EAAEw3B,kBAAkBthD,GAAG6gD,IAAI55C,EAAEkiB,EAAE9H,EAAE5jB,KAAKqsB,GAAG+2B,EAAE/2B,EAAEw3B,kBAAkBthD,IAAI,IAAIZ,EAAE2P,EAAEoa,GAAG,KAAK/pB,EAAE,GAAG,IAAI,IAAIwkD,EAAE,EAAEA,EAAEz6B,EAAEg4B,WAAWt/C,OAAO+hD,IAAI,CAAC,IAAI9lC,EAAE5L,EAAEiX,EAAEg4B,WAAWyC,IAAI9lC,EAAEza,MAAM0L,IAAIC,EAAE2H,KAAKmH,GAAG/O,EAAE+O,EAAEza,IAAIjE,EAAE,IAAI,OAAOwC,EAAEnE,KAAK4jB,GAAGpa,K,gBCA9wT,EAAQ,IACR,EAAQ,IACR,EAAQ,IACR,EAAQ,K,cCER3L,EAAOC,QAAUC,OAAOqoD,kBAAkB,SAAU,CAClDC,kBAAmB,CACjB5tC,SAAU,CACR+R,UAAW,QACXgV,MAAO,GACPE,OAAQ,IAEVl+B,SAAU,CAACG,GAAI,GAAII,EAAG,EAAGuB,EAAG,GAC5B0W,SAAU,CACRR,IAAK,oFACLjD,OAAQ,UAGZ+vC,SAAU,CACR9mB,MAAO,iBACPE,OAAQ,kBACRlmB,IAAK,mB,gBCrBT,MAAM+sC,EAAK,EAAQ,IACbC,EAAiB,EAAQ,IAK/B3oD,EAAOC,QAAQ2oD,UAAY1oD,OAAOqoD,kBAAkB,YAAa,CAC/DC,kBAAmB,CACjB,QAAW,IAEbC,SAAU,CACR9sC,IAAK,iBAIT3b,EAAOC,QAAQub,UAAYtb,OAAOC,kBAAkB,UAAW,CAC7D6U,aAAc,CAAC,YACf5U,OAAQ,CACNub,IAAK,CAAC3Y,KAAM,UAEdtC,KAAM,WACJ,MAAMiB,EAAOhB,KAAKgB,KACdA,EAAKga,IACPktC,MAAMlnD,EAAKga,KACRk9B,KAAMiQ,GAAaA,EAASC,QAC5BlQ,KAAMkQ,GAASpoD,KAAKqoD,QAAQD,IAE/BpoD,KAAKqoD,QAAQL,IAGjBK,QAAS,SAAUD,GACjB,MAAME,EAAO,IAAIP,EAAGQ,QACpBD,EAAKE,SAASJ,GACd,MAAMK,EAAQ,IAAIV,EAAGW,MAAMJ,GAC3BG,EAAME,kBACN3oD,KAAKY,GAAGib,YAAY,OAAQ4sC,EAAMv1B,OAClClzB,KAAK4oD,eAEPA,YAAa,WACX,MACMptC,GADoBxb,KAAKY,GAAGM,WAAWsa,UACN,IAAIA,SACtCA,GACLxb,KAAKY,GAAGc,SAAS2Z,SAAU8F,IACrBA,EAAK5F,SACP4F,EAAK3F,SAAWA,MAItBrX,OAAQ,WACNnE,KAAKY,GAAGmb,eAAe,Y,cCjD3B,IAAu4e7H,EAAuEnQ,EAA18egkD,EAAG1oD,EAAOC,QAAQ,CAACupD,QAAQ,QAAQtjD,GAAGnC,KAAKmC,GAAGujD,IAAI,EAAE1lD,KAAKmC,GAAGwjD,WAAW,YAAYC,WAAW,WAAWC,MAAM7lD,KAAKgoB,KAAK,GAAG89B,KAAK,OAAOC,IAAI,SAASC,IAAI,YAAYC,IAAI,MAAMC,IAAI,SAASC,IAAI,YAAYxB,EAAGW,MAAM,SAASx0C,EAAEnQ,GAAG,IAAImQ,EAAE,MAAM,IAAIrN,MAAM,wDAAwD7G,KAAKwpD,MAAM,GAAGxpD,KAAKypD,UAAU,KAAKzpD,KAAKkzB,MAAM,IAAI7yB,MAAM6C,SAASlD,KAAKsoD,KAAK,KAAKtoD,KAAK0pD,QAAQ,KAAK1pD,KAAK2pD,OAAO,IAAI5B,EAAG6B,YAAY7lD,GAAGgkD,EAAG/tB,OAAOj6B,OAAOC,KAAK6pD,QAAQ31C,IAAI6zC,EAAGW,MAAMz1C,UAAU,CAAC62C,gBAAgB,SAAS51C,EAAEnQ,GAAG,IAAI4B,EAAE3F,KAAKsoD,KAAKyB,YAAYhmD,EAAEimD,MAAM91C,EAAE3T,SAASiB,KAAKmE,GAAGuO,EAAE3T,SAASgD,GAAG2Q,EAAE+1C,cAAc,EAAE/1C,EAAEg2C,OAAOh2C,EAAEg2C,KAAKC,OAAO,MAAMj2C,EAAEg2C,KAAKnmD,EAAEA,EAAEomD,OAAOj2C,GAAGk2C,QAAQ,SAASl2C,IAAgC,IAAvBlU,KAAKwpD,MAAMr+C,QAAQ+I,KAAYlU,KAAKwpD,MAAM9uC,KAAKxG,GAAGlU,KAAKqqD,eAAen2C,GAAGA,EAAE3T,SAASgD,EAAE,EAAEvD,KAAKypD,UAAU7nD,IAAIsS,EAAEggB,MAAMl0B,KAAKsoD,KAAK1mD,IAAIsS,EAAE81C,MAAM91C,EAAE81C,KAAKE,KAAKh2C,IAAIo2C,WAAW,SAASp2C,GAAG,GAAGA,EAAE,CAAC,IAAInQ,EAAE/D,KAAKwpD,MAAMr+C,QAAQ+I,GAAGlU,KAAKsoD,KAAKnkD,OAAO+P,EAAE81C,OAAO,IAAIjmD,GAAG/D,KAAKwpD,MAAMe,OAAOxmD,EAAE,GAAGmQ,EAAEs2C,YAAYC,eAAe,WAAW,GAAGzqD,KAAKypD,UAAU,IAAI,IAAIv1C,EAAElU,KAAKypD,UAAUr4B,SAASrtB,EAAE,EAAEA,EAAEmQ,EAAEtO,OAAO7B,IAAI/D,KAAKypD,UAAUtlD,OAAO+P,EAAEnQ,KAAK2mD,cAAc,SAASx2C,GAAG,IAAInQ,EAAE/D,KAAKsoD,KAAKqC,WAAWz2C,GAAG,OAAOA,EAAEg2C,YAAO,IAAoBlqD,KAAKsoD,KAAKsC,MAAM7mD,GAAG/D,KAAKsoD,KAAKsC,MAAM7mD,GAAGmmD,KAAK,OAAOW,WAAW,SAAS32C,GAAG,IAAInQ,EAAE/D,KAAKsoD,KAAKwC,YAAY52C,GAAGA,EAAE1S,KAAKxB,KAAKsoD,KAAKyB,YAAYhmD,KAAKsmD,eAAe,SAASn2C,GAAG,GAAGA,EAAE81C,KAAK91C,EAAE3T,SAASiB,KAAKxB,KAAKsoD,KAAKyB,YAAY71C,EAAE81C,WAAW,CAAC,IAAIjmD,EAAE/D,KAAKsoD,KAAKwC,YAAY52C,EAAE3T,UAAU2T,EAAE3T,SAASiB,KAAKxB,KAAKsoD,KAAKyB,YAAYhmD,IAAI,OAAOmQ,GAAG62C,cAAc,WAAW,IAAI72C,EAAE6zC,EAAGiD,MAAMC,UAAU,EAAEjrD,KAAKwpD,MAAM5jD,OAAO,GAAG,OAAO5F,KAAKwpD,MAAMt1C,IAAI4vC,SAAS,SAAS5vC,EAAEnQ,EAAE4B,GAAG,OAAO3F,KAAK2pD,OAAO7F,SAAS5vC,EAAE81C,KAAKjmD,EAAEimD,KAAKrkD,EAAE3F,KAAKsoD,OAAOuB,QAAQ,SAAS31C,GAAGlU,KAAKkzB,MAAM/uB,OAAOnE,KAAKypD,WAAWzpD,KAAKsoD,MAAMp0C,IAAIlU,KAAKsoD,OAAOtoD,KAAKyqD,iBAAiBzqD,KAAKwpD,MAAM19C,SAAQ,SAASoI,GAAGlU,KAAKsoD,KAAKnkD,OAAO+P,EAAE81C,MAAM91C,EAAEs2C,aAAYxqD,KAAKsoD,KAAKkC,WAAWxqD,KAAKsoD,KAAKp0C,EAAElU,KAAKwpD,MAAM,GAAGxpD,KAAKypD,UAAU,IAAIppD,MAAM6C,SAASlD,KAAKkzB,MAAMtxB,IAAI5B,KAAKypD,YAAYyB,gBAAgB,SAASh3C,GAAG,IAAInQ,EAAE,IAAI1D,MAAMqyB,kBAAkB,CAACjX,MAAM,EAAE+N,QAAQ,KAAKxpB,KAAK0pD,SAAS1pD,KAAKkzB,MAAM/uB,OAAOnE,KAAK0pD,SAAS1pD,KAAK0pD,QAAQ,IAAIrpD,MAAM6C,SAASlD,KAAKsoD,KAAK4C,gBAAgBh3C,EAAElU,KAAK0pD,QAAQ3lD,GAAG/D,KAAKkzB,MAAMtxB,IAAI5B,KAAK0pD,UAAUf,gBAAgB,SAASz0C,GAAGlU,KAAKmrD,QAAQ,IAAIpnD,EAAE/D,KAAKsoD,KAAK8C,cAAcl3C,GAAGlU,KAAKwpD,MAAMzlD,EAAE/D,KAAKypD,UAAU,IAAIppD,MAAM6C,SAAS,IAAI,IAAIyC,EAAE,EAAEA,EAAE5B,EAAE6B,OAAOD,IAAI3F,KAAKypD,UAAU7nD,IAAImC,EAAE4B,GAAGuuB,MAAMl0B,KAAKkzB,MAAMtxB,IAAI5B,KAAKypD,YAAY0B,MAAM,WAAWnrD,KAAKyqD,iBAAiBzqD,KAAKypD,WAAWzpD,KAAKkzB,MAAM/uB,OAAOnE,KAAKypD,aAAa1B,EAAGW,MAAMz1C,UAAUkJ,YAAY4rC,EAAGW,MAAMX,EAAGsD,KAAK,SAASn3C,EAAEnQ,EAAE4B,EAAEqF,GAAGhL,KAAKsrD,EAAEp3C,GAAG,EAAElU,KAAK+Q,EAAEhN,GAAG,EAAE/D,KAAKgL,EAAErF,GAAG,EAAE3F,KAAKglD,EAAEh6C,GAAG,EAAEhL,KAAKkqD,KAAK,KAAKlqD,KAAKurD,SAAS,GAAGvrD,KAAKwrD,UAAS,EAAGxrD,KAAKyrD,UAAU,EAAEzrD,KAAK0rD,UAAU,EAAE1rD,KAAK2rD,UAAS,EAAG3rD,KAAK4rD,QAAQ,KAAK5rD,KAAK6rD,SAAS9D,EAAG+D,WAAWC,cAAchE,EAAGsD,KAAKp4C,UAAU,CAAC3R,IAAI,SAAS4S,EAAEnQ,EAAE4B,GAAG,OAAO3F,KAAKsrD,EAAEp3C,EAAElU,KAAK+Q,EAAEhN,EAAE/D,KAAKgL,EAAErF,EAAE3F,MAAMwB,KAAK,SAAS0S,GAAG,OAAOlU,KAAKsrD,EAAEp3C,EAAEo3C,EAAEtrD,KAAK+Q,EAAEmD,EAAEnD,EAAE/Q,KAAKgL,EAAEkJ,EAAElJ,EAAEhL,KAAKglD,EAAE9wC,EAAE8wC,EAAEhlD,KAAKkqD,KAAKh2C,EAAEg2C,MAAM,KAAKlqD,KAAKurD,SAASr3C,EAAEq3C,UAAU,GAAGvrD,KAAKwrD,SAASt3C,EAAEs3C,SAASxrD,MAAM4B,IAAI,SAASsS,GAAG,OAAOlU,KAAKsrD,GAAGp3C,EAAEo3C,EAAEtrD,KAAK+Q,GAAGmD,EAAEnD,EAAE/Q,KAAKgL,GAAGkJ,EAAElJ,EAAEhL,MAAMgsD,OAAO,SAAS93C,GAAG,OAAOlU,KAAKsrD,IAAIp3C,EAAEo3C,GAAGtrD,KAAK+Q,IAAImD,EAAEnD,GAAG/Q,KAAKgL,IAAIkJ,EAAElJ,IAAI+8C,EAAGsD,KAAKp4C,UAAUkJ,YAAY4rC,EAAGsD,KAAKtD,EAAGQ,QAAQ,SAASr0C,GAAGA,EAAEA,GAAG,GAAGlU,KAAKqC,KAAK0lD,EAAGsB,IAAIrpD,KAAK+0C,KAAK,EAAE/0C,KAAKisD,cAAS,IAAoB/3C,EAAE+3C,SAAS,GAAG/3C,EAAE+3C,SAASjsD,KAAK4qD,MAAM,GAAG5qD,KAAKksD,SAAS,EAAElsD,KAAKmsD,gBAAgB,KAAKnsD,KAAKosD,eAAc,EAAG,IAAIroD,EAAE4B,EAAE,GAAG,IAAI5B,EAAE,EAAE,EAAEA,EAAEA,IAAI4B,EAAE+U,KAAK1a,KAAKqsD,cAActoD,IAAI,IAAI/D,KAAKssD,UAAU,IAAIjsD,MAAMksD,MAAMvsD,KAAKssD,UAAUE,OAAO7mD,EAAE,GAAGxC,EAAEwC,EAAE,GAAGpC,GAAGQ,EAAE,EAAE,EAAEA,EAAEA,IAAI/D,KAAKssD,UAAUG,OAAO9mD,EAAE5B,GAAGZ,EAAEwC,EAAE5B,GAAGR,GAAGvD,KAAKssD,UAAUG,OAAO9mD,EAAE,GAAGxC,EAAEwC,EAAE,GAAGpC,GAAGvD,KAAKssD,UAAUI,WAAU,EAAG1sD,KAAK2sD,QAAQ,IAAItsD,MAAM6kC,SAASllC,KAAK2sD,QAAQngC,SAAS7mB,EAAE3F,KAAK2sD,QAAQC,oBAAmB,EAAG5sD,KAAK6sD,aAAa,IAAIxsD,MAAMysD,cAAc9sD,KAAKssD,WAAWtsD,KAAK+sD,WAAW,EAAE/sD,KAAKisD,SAASjsD,KAAKgtD,YAAY,GAAGjF,EAAGkB,MAAMjpD,KAAK+sD,WAAW/sD,KAAKitD,eAAe,IAAIjtD,KAAKktD,YAAY,CAAC,IAAInF,EAAGsD,KAAK,GAAG,EAAE,GAAG,IAAItD,EAAGsD,KAAK,EAAE,GAAG,GAAG,IAAItD,EAAGsD,KAAK,EAAE,GAAG,GAAG,IAAItD,EAAGsD,MAAM,EAAE,EAAE,GAAG,IAAItD,EAAGsD,MAAM,EAAE,EAAE,GAAG,IAAItD,EAAGsD,KAAK,GAAG,EAAE,IAAIrrD,KAAKmtD,WAAW,CAAC,IAAIpF,EAAGsD,KAAK,GAAG,GAAG,GAAG,IAAItD,EAAGsD,KAAK,EAAE,GAAG,GAAG,IAAItD,EAAGsD,MAAM,EAAE,GAAG,GAAG,IAAItD,EAAGsD,MAAM,EAAE,EAAE,GAAG,IAAItD,EAAGsD,MAAM,GAAG,EAAE,GAAG,IAAItD,EAAGsD,KAAK,GAAG,EAAE,IAAIrrD,KAAKotD,MAAM,GAAGptD,KAAKqtD,MAAM,IAAIhtD,MAAMC,QAAQN,KAAKstD,KAAK,IAAIvF,EAAGsD,KAAKrrD,KAAKutD,eAAe,IAAIltD,MAAMC,QAAQN,KAAKwtD,UAAU,GAAGxtD,KAAKytD,UAAU,IAAI1F,EAAGQ,QAAQmF,WAAW,EAAE,EAAE3F,EAAGQ,QAAQt1C,UAAU,CAAC82C,YAAY,SAAS71C,GAAG,OAAOlU,KAAKqtD,MAAMlqD,EAAE+Q,EAAEo3C,EAAEtrD,KAAK+sD,WAAW,IAAI/sD,KAAKqtD,MAAM9pD,EAAE2Q,EAAE8wC,EAAEhlD,KAAKqtD,MAAMvoD,IAAKoP,EAAElJ,EAAEkJ,EAAEnD,GAAG/Q,KAAKgtD,YAAY,GAAIhtD,KAAKqtD,OAAOvC,YAAY,SAAS52C,GAAG,IAAInQ,EAAEmQ,EAAE/Q,GAAG4kD,EAAGQ,QAAQmF,WAAW1tD,KAAKisD,UAAUtmD,IAAIuO,EAAE/Q,EAAE,EAAE4kD,EAAGkB,MAAM,EAAE/0C,EAAEpP,GAAG9E,KAAKisD,SAAS,OAAOjsD,KAAKstD,KAAKhsD,IAAIyC,EAAE4B,GAAG5B,EAAE4B,GAAG3F,KAAK2tD,WAAW3tD,KAAKstD,OAAOM,UAAU,SAAS15C,GAAG,IAAInQ,EAAEmQ,EAAE/Q,GAAG4kD,EAAGQ,QAAQmF,WAAW1tD,KAAKisD,UAAUtmD,IAAIuO,EAAE/Q,EAAE,EAAE4kD,EAAGkB,MAAM,EAAE/0C,EAAEpP,GAAG9E,KAAKisD,SAAS,OAAOjsD,KAAKstD,KAAKhsD,IAAIyC,EAAE4B,GAAG5B,EAAE4B,GAAG3F,KAAK2tD,WAAW3tD,KAAKstD,MAAMttD,KAAK4qD,MAAM5qD,KAAK2qD,WAAW3qD,KAAKstD,QAAQO,aAAa,SAAS35C,EAAEnQ,EAAE4B,GAAG,IAAIqF,EAAEk5C,EAAEjuC,EAAEjW,KAAKktD,YAAYtnD,OAAO,IAAI5F,KAAKotD,MAAMxnD,OAAO,EAAEoF,EAAE,EAAEiL,EAAEjL,EAAEA,IAAIhL,KAAKstD,KAAK9rD,KAAK0S,GAAGlU,KAAKstD,KAAK1rD,IAAI5B,KAAKktD,YAAYliD,MAAIk5C,EAAElkD,KAAK4qD,MAAM5qD,KAAK2qD,WAAW3qD,KAAKstD,SAAW3nD,IAAIA,EAAEuO,EAAEgwC,IAAIlkD,KAAKotD,MAAM1yC,KAAKwpC,GAAG,GAAGngD,EAAE,IAAIiH,EAAE,EAAEiL,EAAEjL,EAAEA,IAAIhL,KAAKstD,KAAK9rD,KAAK0S,GAAGlU,KAAKstD,KAAK1rD,IAAI5B,KAAKmtD,WAAWniD,MAAIk5C,EAAElkD,KAAK4qD,MAAM5qD,KAAK2qD,WAAW3qD,KAAKstD,SAAW3nD,IAAIA,EAAEuO,EAAEgwC,IAAIlkD,KAAKotD,MAAM1yC,KAAKwpC,GAAG,OAAOlkD,KAAKotD,OAAOU,cAAc,WAAW,IAAI55C,EAAEnQ,EAAE,EAAE4B,EAAEoiD,EAAGiD,MAAMC,UAAU,EAAEjrD,KAAKksD,UAAU,IAAIh4C,KAAKlU,KAAK4qD,MAAM,CAAC,GAAG7mD,IAAI4B,EAAE,OAAO3F,KAAK4qD,MAAM12C,GAAGnQ,IAAI,OAAO/D,KAAK4qD,MAAM12C,IAAIy2C,WAAW,SAASz2C,GAAG,OAAOA,EAAEo3C,EAAEtrD,KAAKitD,eAAe/4C,EAAEnD,EAAE/Q,KAAKitD,eAAe/4C,EAAElJ,GAAGmgB,SAAS,SAASjX,EAAEnQ,GAAyE,OAAhEX,KAAKkC,IAAIlC,KAAKuB,IAAIuP,EAAEo3C,EAAEvnD,EAAEunD,GAAGloD,KAAKuB,IAAIuP,EAAEnD,EAAEhN,EAAEgN,GAAG3N,KAAKuB,IAAIuP,EAAElJ,EAAEjH,EAAEiH,KAAcjH,EAAEihD,EAAE9wC,EAAE8wC,IAAG+I,UAAU,WAAW,IAAI75C,EAAEnQ,EAAE,IAAImQ,KAAKlU,KAAK4qD,OAAM7mD,EAAE/D,KAAK4qD,MAAM12C,IAAKu3C,UAAU,EAAE1nD,EAAE2nD,UAAU,EAAE3nD,EAAE6nD,QAAQ,KAAK7nD,EAAE4nD,UAAS,GAAItwC,SAAS,SAASnH,GAAG,IAAInQ,EAAE,IAAIA,KAAK/D,KAAK4qD,MAAM12C,EAAElU,KAAK4qD,MAAM7mD,KAAKiqD,aAAa,SAAS95C,EAAEnQ,EAAE4B,GAAG,IAAIqF,EAAE5H,KAAKuB,IAAIuP,EAAE8wC,GAAG,EAAEh6C,IAAIA,EAAE,GAAG,IAAIk5C,EAAElkD,KAAKwtD,UAAUxiD,GAAGk5C,IAAIlkD,KAAKmsD,gBAAgB8B,OAAOjjD,EAAEk5C,EAAE,IAAI7jD,MAAM6tD,gBAAgBluD,KAAKssD,UAAUtsD,KAAKmsD,iBAAiBnsD,KAAKwtD,UAAUxiD,GAAGk5C,GAAG,IAAIjuC,EAAE,IAAI8xC,EAAGoG,KAAK,CAACpZ,KAAK/0C,KAAKisD,SAAShqC,MAAMle,EAAEimD,KAAK91C,EAAE+F,SAASiqC,EAAE1oC,SAAS7V,IAAI,OAAOuO,EAAEg2C,KAAKj0C,EAAEA,GAAGm1C,cAAc,SAASl3C,GAAGA,EAAEA,GAAG,GAAG,IAA+VlJ,EAAEk5C,EAAEjuC,EAA/VlS,EAAE,GAAG4B,EAAE,CAACyoD,UAAU,IAAInC,SAASjsD,KAAKisD,SAASzwC,SAAS,KAAK2wC,gBAAgB,CAAC8B,OAAO,EAAEI,cAAa,EAAGC,cAAc,EAAEC,MAAM,EAAEC,UAAU,GAAGC,eAAe,KAAwM,IAAIzjD,KAAvMrF,EAAEoiD,EAAGiD,MAAM0D,MAAM/oD,EAAEuO,GAAGlU,KAAKisD,SAAStmD,EAAEsmD,SAASjsD,KAAK+sD,WAAW,EAAE/sD,KAAKisD,SAASjsD,KAAKgtD,YAAY,GAAGjF,EAAGkB,MAAMjpD,KAAK+sD,WAAW/sD,KAAKosD,eAAc,EAAGpsD,KAAKmsD,gBAAgBxmD,EAAEwmD,gBAAmCnsD,KAAK4qD,MAAM30C,EAAEjW,KAAK4qD,MAAM5/C,IAAGk5C,EAAElkD,KAAKguD,aAAa/3C,EAAEtQ,EAAEyoD,UAAUzoD,EAAE6V,WAAYjb,SAASiB,KAAKxB,KAAK+pD,YAAY9zC,IAAIiuC,EAAE3jD,SAASgD,EAAE,EAAEQ,EAAE2W,KAAKwpC,GAAG,OAAOngD,GAAG4qD,iBAAiB,SAASz6C,GAAGA,IAAIA,EAAE,IAAI7T,MAAMqnB,kBAAkB,CAACjM,MAAM,WAAW,IAAI1X,EAAE,IAAI1D,MAAM2yB,KAAKhzB,KAAK6sD,aAAa34C,GAAG,OAAOlU,KAAKqtD,MAAM/rD,IAAI,EAAE,EAAE,GAAGyC,EAAE6qD,aAAa5uD,KAAKqtD,MAAMtF,EAAGxiD,GAAG,GAAGxB,GAAG8qD,SAAS,SAAS36C,GAAiE,IAAInQ,EAAE4B,EAAEqF,EAAEk5C,EAAE,IAA1EhwC,EAAEA,GAAG,GAAGlU,KAAK+0C,UAAK,IAAoB7gC,EAAE6gC,KAAK/0C,KAAK+0C,KAAK7gC,EAAE6gC,KAAqBhxC,GAAG/D,KAAK+0C,KAAKhxC,EAAE/D,KAAK+0C,KAAK,EAAEhxC,IAAI,IAAI4B,GAAG3F,KAAK+0C,KAAKpvC,EAAE3F,KAAK+0C,KAAK,EAAEpvC,IAAIqF,GAAGjH,EAAE4B,EAAEvC,KAAKuB,IAAIZ,IAAI/D,KAAK+0C,MAAM3xC,KAAKuB,IAAIgB,IAAI3F,KAAK+0C,MAAM3xC,KAAKuB,IAAIqG,IAAIhL,KAAK+0C,OAAOmP,EAAE,IAAI6D,EAAGsD,KAAKtnD,EAAE4B,EAAEqF,GAAGhL,KAAK4B,IAAIsiD,KAAKgH,gBAAgB,SAASh3C,EAAEnQ,EAAE4B,GAAG,IAAIqF,EAAEk5C,EAAEjuC,EAAElF,EAAE/Q,KAAKssD,UAAUwC,uBAAuB,IAAI9jD,GAAGkJ,EAAEA,EAAE,EAAElJ,EAAEA,IAAI,IAAIk5C,GAAGhwC,EAAEA,EAAE,EAAEgwC,EAAEA,IAAI,GAAGjuC,GAAGjL,EAAEk5C,EAAE9gD,KAAKuB,IAAIqG,IAAIkJ,GAAG9Q,KAAKuB,IAAIu/C,IAAIhwC,GAAG9Q,KAAKuB,IAAIsR,IAAI/B,EAAE,CAAClU,KAAKstD,KAAKhsD,IAAI0J,EAAEk5C,EAAEjuC,GAAG,IAAI+uC,EAAE,IAAI3kD,MAAMyyB,KAAK/hB,EAAEpL,GAAGq/C,EAAEzkD,SAASiB,KAAKxB,KAAK+pD,YAAY/pD,KAAKstD,OAAOtI,EAAEhiD,SAASG,EAAE,GAAG4kD,EAAGgB,WAAWhlD,EAAEnC,IAAIojD,KAAKpjD,IAAI,SAASsS,GAAG,IAAInQ,EAAE/D,KAAK2qD,WAAWz2C,GAAG,IAAIlU,KAAK4qD,MAAM7mD,GAAG,OAAO/D,KAAK4qD,MAAM7mD,GAAGmQ,EAAElU,KAAKksD,WAAWh4C,GAAG/P,OAAO,SAAS+P,GAAG,IAAInQ,EAAE/D,KAAK2qD,WAAWz2C,GAAGlU,KAAK4qD,MAAM7mD,YAAY/D,KAAK4qD,MAAM7mD,GAAG/D,KAAKksD,aAAa1B,QAAQ,WAAWxqD,KAAK4qD,MAAM,KAAK5qD,KAAKksD,SAAS,EAAElsD,KAAKssD,UAAU,KAAKtsD,KAAK2sD,QAAQnC,UAAUxqD,KAAK2sD,QAAQ,KAAK3sD,KAAK6sD,aAAarC,UAAUxqD,KAAK6sD,aAAa,KAAK7sD,KAAKotD,MAAM,KAAKptD,KAAKqtD,MAAM,KAAKrtD,KAAKutD,eAAe,KAAKvtD,KAAKwtD,UAAU,KAAKxtD,KAAKytD,UAAU,MAAMx0C,KAAK,SAAS/E,EAAEnQ,EAAE4B,GAAG,IAAIqF,EAAEhL,KAAK+nD,EAAGiD,MAAM+D,QAAQ,CAAC1yC,IAAInI,EAAE86C,SAAS,SAAS96C,GAAGlJ,EAAEw9C,SAASt0C,GAAGnQ,EAAEsP,KAAK1N,GAAG,KAAKuO,IAAI+6C,OAAM,EAAGxyC,MAAMzR,KAAKw9C,SAAS,SAASt0C,GAAG,IAAInQ,EAAE4B,EAAEqF,EAAEkJ,EAAE02C,MAAM,IAAI5qD,KAAK4qD,MAAM,GAAG5qD,KAAKksD,SAAS,EAAElsD,KAAK+0C,KAAK7gC,EAAE6gC,KAAK/0C,KAAKisD,SAAS/3C,EAAE+3C,SAASjsD,KAAK+sD,WAAW,EAAE/sD,KAAKisD,SAASjsD,KAAKgtD,YAAY,GAAGjF,EAAGkB,MAAMjpD,KAAK+sD,WAAW/sD,KAAKmsD,gBAAgBj4C,EAAEi4C,gBAAgBnsD,KAAKosD,cAAcl4C,EAAEk4C,cAAcroD,EAAE,EAAEA,EAAEiH,EAAEpF,OAAO7B,KAAI4B,EAAE,IAAIoiD,EAAGsD,MAAO7pD,KAAKwJ,EAAEjH,IAAI/D,KAAK4B,IAAI+D,IAAIupD,OAAO,WAAW,IAAIh7C,EAAEnQ,EAAE4B,EAAE,CAACovC,KAAK/0C,KAAK+0C,KAAKkX,SAASjsD,KAAKisD,SAASE,gBAAgBnsD,KAAKmsD,gBAAgBC,cAAcpsD,KAAKosD,eAAephD,EAAE,GAAG,IAAIjH,KAAK/D,KAAK4qD,MAAM12C,EAAElU,KAAK4qD,MAAM7mD,GAAGiH,EAAE0P,KAAK,CAAC4wC,EAAEp3C,EAAEo3C,EAAEv6C,EAAEmD,EAAEnD,EAAE/F,EAAEkJ,EAAElJ,EAAEg6C,EAAE9wC,EAAE8wC,EAAEwG,SAASt3C,EAAEs3C,SAASD,SAASr3C,EAAEq3C,WAAW,OAAO5lD,EAAEilD,MAAM5/C,EAAErF,GAAG0mD,cAAc,SAASn4C,GAAG,IAAInQ,EAAEgkD,EAAGe,IAAI,EAAE50C,EAAE,OAAO,IAAI7T,MAAMC,QAAQN,KAAKisD,SAAS7oD,KAAK+rD,IAAIprD,GAAG/D,KAAKisD,SAAS7oD,KAAKgsD,IAAIrrD,GAAG,IAAI4pD,WAAW,SAASz5C,GAAG,IAAInQ,EAAEX,KAAKisD,MAAMn7C,EAAEo3C,GAAG3lD,EAAEvC,KAAKisD,MAAMn7C,EAAEnD,GAAG/F,EAAE5H,KAAKisD,MAAMn7C,EAAElJ,GAAGk5C,EAAE9gD,KAAKuB,IAAIZ,EAAEmQ,EAAEo3C,GAAGr1C,EAAE7S,KAAKuB,IAAIgB,EAAEuO,EAAEnD,GAAGA,EAAE3N,KAAKuB,IAAIqG,EAAEkJ,EAAElJ,GAAG,OAAOk5C,EAAEjuC,GAAGiuC,EAAEnzC,EAAEhN,GAAG4B,EAAEqF,EAAEiL,EAAElF,EAAEpL,GAAG5B,EAAEiH,EAAEA,GAAGjH,EAAE4B,EAAE3F,KAAKstD,KAAKhsD,IAAIyC,EAAE4B,EAAEqF,KAAK+8C,EAAGQ,QAAQt1C,UAAUkJ,YAAY4rC,EAAGQ,QAAQR,EAAGuH,QAAQ,SAASp7C,GAAGA,EAAEA,GAAG,GAAGlU,KAAKqC,KAAK0lD,EAAGuB,IAAItpD,KAAK+0C,KAAK,EAAE/0C,KAAKisD,cAAS,IAAoB/3C,EAAE+3C,SAAS,GAAG/3C,EAAE+3C,SAASjsD,KAAK4qD,MAAM,GAAG5qD,KAAKksD,SAAS,EAAElsD,KAAKmsD,gBAAgB,KAAKnsD,KAAKosD,eAAc,EAAG,IAAIroD,EAAE,GAAGA,EAAE2W,KAAK,IAAIra,MAAMC,SAASyD,EAAE2W,KAAK,IAAIra,MAAMC,SAASN,KAAKisD,SAASjsD,KAAKisD,WAAWloD,EAAE2W,KAAK,IAAIra,MAAMC,QAAQN,KAAKisD,SAASjsD,KAAKisD,WAAWloD,EAAE2W,KAAK,IAAIra,MAAMC,QAAQN,KAAKisD,UAAUjsD,KAAKisD,WAAWjsD,KAAKssD,UAAU,IAAIjsD,MAAMksD,MAAMvsD,KAAKssD,UAAUE,QAAQxsD,KAAKisD,UAAUjsD,KAAKisD,UAAUjsD,KAAKssD,UAAUG,QAAQzsD,KAAKisD,SAASjsD,KAAKisD,UAAUjsD,KAAKssD,UAAUG,OAAOzsD,KAAKisD,SAASjsD,KAAKisD,UAAUjsD,KAAKssD,UAAUG,OAAOzsD,KAAKisD,UAAUjsD,KAAKisD,UAAUjsD,KAAKssD,UAAUG,QAAQzsD,KAAKisD,UAAUjsD,KAAKisD,UAAUjsD,KAAK2sD,QAAQ,IAAItsD,MAAM6kC,SAASllC,KAAK2sD,QAAQngC,SAASzoB,EAAE/D,KAAK2sD,QAAQC,oBAAmB,EAAG5sD,KAAK6sD,aAAa,IAAIxsD,MAAMysD,cAAc9sD,KAAKssD,WAAWtsD,KAAKuvD,cAAc,EAAEvvD,KAAKisD,SAASjsD,KAAKitD,eAAe,IAAIjtD,KAAKktD,YAAY,CAAC,IAAInF,EAAGsD,KAAK,EAAE,EAAE,GAAG,IAAItD,EAAGsD,KAAK,GAAG,EAAE,GAAG,IAAItD,EAAGsD,MAAM,EAAE,EAAE,GAAG,IAAItD,EAAGsD,KAAK,EAAE,EAAE,IAAIrrD,KAAKmtD,WAAW,CAAC,IAAIpF,EAAGsD,MAAM,GAAG,EAAE,GAAG,IAAItD,EAAGsD,MAAM,EAAE,EAAE,GAAG,IAAItD,EAAGsD,KAAK,EAAE,EAAE,GAAG,IAAItD,EAAGsD,KAAK,GAAG,EAAE,IAAIrrD,KAAKotD,MAAM,GAAGptD,KAAKqtD,MAAM,IAAIhtD,MAAMC,QAAQN,KAAKstD,KAAK,IAAIvF,EAAGsD,KAAKrrD,KAAKutD,eAAe,IAAIltD,MAAMC,QAAQN,KAAKwtD,UAAU,GAAGxtD,KAAKytD,UAAU,IAAI1F,EAAGuH,QAAQr8C,UAAU,CAAC82C,YAAY,SAAS71C,GAAG,OAAOlU,KAAKqtD,MAAMlqD,EAAE+Q,EAAEo3C,EAAEtrD,KAAKuvD,cAAcvvD,KAAKqtD,MAAM9pD,EAAE2Q,EAAE8wC,EAAEhlD,KAAKqtD,MAAMvoD,EAAEoP,EAAEnD,EAAE/Q,KAAKuvD,cAAcvvD,KAAKqtD,OAAOvC,YAAY,SAAS52C,GAAG,IAAInQ,EAAEX,KAAKisD,MAAMn7C,EAAE/Q,EAAEnD,KAAKuvD,eAAe5pD,EAAEvC,KAAKisD,MAAMn7C,EAAEpP,EAAE9E,KAAKuvD,eAAe,OAAOvvD,KAAKstD,KAAKhsD,IAAIyC,EAAE4B,EAAE,IAAIioD,UAAU,SAAS15C,GAAG,IAAInQ,EAAEX,KAAKisD,MAAMn7C,EAAE/Q,EAAEnD,KAAKuvD,eAAe5pD,EAAEvC,KAAKisD,MAAMn7C,EAAEpP,EAAE9E,KAAKuvD,eAAe,OAAOvvD,KAAKstD,KAAKhsD,IAAIyC,EAAE4B,GAAG3F,KAAK4qD,MAAM5qD,KAAK2qD,WAAW3qD,KAAKstD,QAAQO,aAAa,SAAS35C,EAAEnQ,EAAE4B,GAAG,IAAIqF,EAAEk5C,EAAEjuC,EAAEjW,KAAKktD,YAAYtnD,OAAO,IAAI5F,KAAKotD,MAAMxnD,OAAO,EAAEoF,EAAE,EAAEiL,EAAEjL,EAAEA,IAAIhL,KAAKstD,KAAK9rD,KAAK0S,GAAGlU,KAAKstD,KAAK1rD,IAAI5B,KAAKktD,YAAYliD,MAAIk5C,EAAElkD,KAAK4qD,MAAM5qD,KAAK2qD,WAAW3qD,KAAKstD,SAAW3nD,IAAIA,EAAEuO,EAAEgwC,IAAIlkD,KAAKotD,MAAM1yC,KAAKwpC,GAAG,GAAGngD,EAAE,IAAIiH,EAAE,EAAEiL,EAAEjL,EAAEA,IAAIhL,KAAKstD,KAAK9rD,KAAK0S,GAAGlU,KAAKstD,KAAK1rD,IAAI5B,KAAKmtD,WAAWniD,MAAIk5C,EAAElkD,KAAK4qD,MAAM5qD,KAAK2qD,WAAW3qD,KAAKstD,SAAW3nD,IAAIA,EAAEuO,EAAEgwC,IAAIlkD,KAAKotD,MAAM1yC,KAAKwpC,GAAG,OAAOlkD,KAAKotD,OAAOU,cAAc,WAAW,IAAI55C,EAAEnQ,EAAE,EAAE4B,EAAEoiD,EAAGiD,MAAMC,UAAU,EAAEjrD,KAAKksD,UAAU,IAAIh4C,KAAKlU,KAAK4qD,MAAM,CAAC,GAAG7mD,IAAI4B,EAAE,OAAO3F,KAAK4qD,MAAM12C,GAAGnQ,IAAI,OAAO/D,KAAK4qD,MAAM12C,IAAIy2C,WAAW,SAASz2C,GAAG,OAAOA,EAAEo3C,EAAEtrD,KAAKitD,eAAe/4C,EAAEnD,GAAGoa,SAAS,SAASjX,EAAEnQ,GAAuD,OAA9CX,KAAKkC,IAAIlC,KAAKuB,IAAIuP,EAAEo3C,EAAEvnD,EAAEunD,GAAGloD,KAAKuB,IAAIuP,EAAEnD,EAAEhN,EAAEgN,KAAchN,EAAEihD,EAAE9wC,EAAE8wC,IAAG+I,UAAU,WAAW,IAAI75C,EAAEnQ,EAAE,IAAImQ,KAAKlU,KAAK4qD,OAAM7mD,EAAE/D,KAAK4qD,MAAM12C,IAAKu3C,UAAU,EAAE1nD,EAAE2nD,UAAU,EAAE3nD,EAAE6nD,QAAQ,KAAK7nD,EAAE4nD,UAAS,GAAItwC,SAAS,SAASnH,GAAG,IAAInQ,EAAE,IAAIA,KAAK/D,KAAK4qD,MAAM12C,EAAElU,KAAK4qD,MAAM7mD,KAAKiqD,aAAa,SAAS95C,EAAEnQ,EAAE4B,GAAG,IAAIqF,EAAE5H,KAAKuB,IAAIuP,EAAE8wC,GAAG,EAAEh6C,IAAIA,EAAE,GAAG,IAAIk5C,EAAElkD,KAAKwtD,UAAUxiD,GAAGk5C,IAAIlkD,KAAKmsD,gBAAgB8B,OAAOjjD,EAAEk5C,EAAE,IAAI7jD,MAAM6tD,gBAAgBluD,KAAKssD,UAAUtsD,KAAKmsD,iBAAiBnsD,KAAKwtD,UAAUxiD,GAAGk5C,GAAG,IAAIjuC,EAAE,IAAI8xC,EAAGoG,KAAK,CAACpZ,KAAK/0C,KAAKisD,SAAShqC,MAAMle,EAAEimD,KAAK91C,EAAE+F,SAASiqC,EAAE1oC,SAAS7V,IAAI,OAAOuO,EAAEg2C,KAAKj0C,EAAEA,GAAGm1C,cAAc,SAASl3C,GAAGA,EAAEA,GAAG,GAAG,IAAqTlJ,EAAEk5C,EAAEjuC,EAArTlS,EAAE,GAAG4B,EAAE,CAACyoD,UAAU,IAAInC,SAASjsD,KAAKisD,SAASzwC,SAAS,KAAK2wC,gBAAgB,CAAC8B,OAAO,EAAEI,cAAa,EAAGC,cAAc,EAAEC,MAAM,EAAEC,UAAU,GAAGC,eAAe,KAA8J,IAAIzjD,KAA7JrF,EAAEoiD,EAAGiD,MAAM0D,MAAM/oD,EAAEuO,GAAGlU,KAAKisD,SAAStmD,EAAEsmD,SAASjsD,KAAKuvD,cAAc,EAAEvvD,KAAKisD,SAASjsD,KAAKosD,eAAc,EAAGpsD,KAAKmsD,gBAAgBxmD,EAAEwmD,gBAAmCnsD,KAAK4qD,MAAM30C,EAAEjW,KAAK4qD,MAAM5/C,IAAGk5C,EAAElkD,KAAKguD,aAAa/3C,EAAEtQ,EAAEyoD,UAAUzoD,EAAE6V,WAAYjb,SAASiB,KAAKxB,KAAK+pD,YAAY9zC,IAAIiuC,EAAE3jD,SAASgD,EAAE,EAAEQ,EAAE2W,KAAKwpC,GAAG,OAAOngD,GAAG4qD,iBAAiB,SAASz6C,GAAGA,IAAIA,EAAE,IAAI7T,MAAMqnB,kBAAkB,CAACjM,MAAM,WAAW,IAAI1X,EAAE,IAAI1D,MAAM2yB,KAAKhzB,KAAK6sD,aAAa34C,GAAG,OAAOlU,KAAKqtD,MAAM/rD,IAAI,EAAE,EAAE,GAAGyC,EAAE6qD,aAAa5uD,KAAKqtD,MAAMtF,EAAGxiD,GAAG,GAAGxB,GAAG8qD,SAAS,SAAS36C,GAAGA,EAAEA,GAAG,GAAGlU,KAAK+0C,UAAK,IAAoB7gC,EAAE6gC,KAAK/0C,KAAK+0C,KAAK7gC,EAAE6gC,KAAK,IAAIhxC,EAAE4B,EAAEqF,EAAEk5C,EAAE9gD,KAAK81C,KAAKl5C,KAAK+0C,KAAK,GAAG,IAAIhxC,GAAGmgD,EAAEA,EAAEngD,EAAEA,IAAI,IAAI4B,GAAGu+C,EAAEA,EAAEv+C,EAAEA,IAAIqF,EAAE,IAAI+8C,EAAGsD,KAAKtnD,EAAE4B,EAAE,GAAG3F,KAAK4B,IAAIoJ,IAAIkgD,gBAAgB,SAASh3C,EAAEnQ,EAAE4B,GAAG,IAAIqF,EAAEk5C,EAAEjuC,EAAE7S,KAAK81C,KAAKhlC,EAAE,GAAG,IAAIlJ,GAAGiL,EAAEA,EAAEjL,EAAEA,IAAI,IAAIk5C,GAAGjuC,EAAEA,EAAEiuC,EAAEA,IAAI,CAAClkD,KAAKstD,KAAKhsD,IAAI0J,EAAEk5C,GAAG,IAAInzC,EAAE,IAAI1Q,MAAMyyB,KAAK9yB,KAAK2sD,QAAQhnD,GAAGoL,EAAExQ,SAASiB,KAAKxB,KAAK+pD,YAAY/pD,KAAKstD,OAAOv8C,EAAE/N,SAASG,EAAE,GAAG4kD,EAAGgB,WAAWhlD,EAAEnC,IAAImP,KAAKnP,IAAI,SAASsS,GAAG,IAAInQ,EAAE/D,KAAK2qD,WAAWz2C,GAAG,IAAIlU,KAAK4qD,MAAM7mD,GAAG,OAAO/D,KAAK4qD,MAAM7mD,GAAGmQ,EAAElU,KAAKksD,WAAWh4C,GAAG/P,OAAO,SAAS+P,GAAG,IAAInQ,EAAE/D,KAAK2qD,WAAWz2C,GAAGlU,KAAK4qD,MAAM7mD,YAAY/D,KAAK4qD,MAAM7mD,GAAG/D,KAAKksD,aAAa1B,QAAQ,WAAWxqD,KAAK4qD,MAAM,KAAK5qD,KAAKksD,SAAS,EAAElsD,KAAKssD,UAAU,KAAKtsD,KAAK2sD,QAAQnC,UAAUxqD,KAAK2sD,QAAQ,KAAK3sD,KAAK6sD,aAAarC,UAAUxqD,KAAK6sD,aAAa,KAAK7sD,KAAKotD,MAAM,KAAKptD,KAAKqtD,MAAM,KAAKrtD,KAAKutD,eAAe,KAAKvtD,KAAKwtD,UAAU,KAAKxtD,KAAKytD,UAAU,MAAMx0C,KAAK,SAAS/E,EAAEnQ,EAAE4B,GAAGoiD,EAAGiD,MAAM+D,QAAQ,CAAC1yC,IAAInI,EAAE86C,SAAS,SAAS96C,GAAGlU,KAAKwoD,SAASt0C,GAAGnQ,EAAEsP,KAAK1N,GAAG,KAAKuO,IAAI+6C,OAAM,EAAGxyC,MAAMzc,QAAQwoD,SAAS,SAASt0C,GAAG,IAAInQ,EAAE4B,EAAEqF,EAAEkJ,EAAE02C,MAAM,IAAI5qD,KAAK4qD,MAAM,GAAG5qD,KAAKksD,SAAS,EAAElsD,KAAK+0C,KAAK7gC,EAAE6gC,KAAK/0C,KAAKisD,SAAS/3C,EAAE+3C,SAASjsD,KAAKuvD,cAAc,EAAEvvD,KAAKisD,SAASjsD,KAAKmsD,gBAAgBj4C,EAAEi4C,gBAAgBnsD,KAAKosD,cAAcl4C,EAAEk4C,cAAcroD,EAAE,EAAEA,EAAEiH,EAAEpF,OAAO7B,KAAI4B,EAAE,IAAIoiD,EAAGsD,MAAO7pD,KAAKwJ,EAAEjH,IAAI/D,KAAK4B,IAAI+D,IAAIupD,OAAO,WAAW,IAAIh7C,EAAEnQ,EAAE4B,EAAE,CAACovC,KAAK/0C,KAAK+0C,KAAKkX,SAASjsD,KAAKisD,SAASE,gBAAgBnsD,KAAKmsD,gBAAgBC,cAAcpsD,KAAKosD,eAAephD,EAAE,GAAG,IAAIjH,KAAK/D,KAAK4qD,MAAM12C,EAAElU,KAAK4qD,MAAM7mD,GAAGiH,EAAE0P,KAAK,CAAC4wC,EAAEp3C,EAAEo3C,EAAEv6C,EAAEmD,EAAEnD,EAAE/F,EAAEkJ,EAAElJ,EAAEg6C,EAAE9wC,EAAE8wC,EAAEwG,SAASt3C,EAAEs3C,SAASD,SAASr3C,EAAEq3C,WAAW,OAAO5lD,EAAEilD,MAAM5/C,EAAErF,IAAIoiD,EAAGuH,QAAQr8C,UAAUkJ,YAAY4rC,EAAGuH,QAAQvH,EAAGoG,KAAK,SAASj6C,GAAGA,EAAEA,GAAG,GAAG,IAAInQ,EAAE,CAACimD,KAAK,KAAK/vC,SAAS,KAAKuB,SAAS,MAAM,KAAGzX,EAAEgkD,EAAGiD,MAAM0D,MAAM3qD,EAAEmQ,IAAM81C,OAAOjmD,EAAEkW,SAAS,MAAM,IAAIpT,MAAM,iCAAiC7G,KAAKgqD,KAAKjmD,EAAEimD,KAAKhqD,KAAKgqD,KAAKE,MAAMlqD,KAAKgqD,KAAKE,OAAOlqD,MAAMA,KAAKgqD,KAAKE,KAAKM,UAAUxqD,KAAKgqD,KAAKE,KAAKlqD,KAAKA,KAAK6rD,SAAS9D,EAAGiD,MAAMe,aAAa/rD,KAAKia,SAASlW,EAAEkW,SAASja,KAAKwb,SAASzX,EAAEyX,SAASxb,KAAKwb,WAAWxb,KAAKwb,SAAS,IAAInb,MAAMmnB,kBAAkB,CAAC/L,MAAMssC,EAAGiD,MAAMwE,aAAa,aAAa,OAAOxvD,KAAKyvD,WAAW1H,EAAGmB,KAAKlpD,KAAKmqD,OAAO,KAAKnqD,KAAKurD,SAAS,GAAGvrD,KAAK0vD,UAAS,EAAG1vD,KAAK2vD,UAAU,WAAW3vD,KAAKk0B,KAAK,IAAI7zB,MAAM2yB,KAAKhzB,KAAKia,SAASja,KAAKwb,UAAUxb,KAAKk0B,KAAKq3B,SAASqE,UAAU5vD,KAAKA,KAAKO,SAASP,KAAKk0B,KAAK3zB,SAASP,KAAKgD,SAAShD,KAAKk0B,KAAKlxB,SAAShD,KAAKgD,SAASG,GAAG,GAAG4kD,EAAGgB,WAAW/oD,KAAKk0B,KAAKjS,MAAM3gB,IAAIyC,EAAEke,MAAMle,EAAEke,MAAM,GAAGjiB,KAAKwb,SAASG,SAAS3b,KAAK6vD,UAAU7vD,KAAKwb,SAASG,SAASm0C,SAAS9vD,KAAK6vD,UAAU,MAAM9H,EAAGoG,KAAKl7C,UAAU,CAACrH,OAAO,WAAW,OAAO5L,KAAKwb,SAASG,UAAU3b,KAAKwb,SAASG,SAASo0C,OAAO/vD,KAAK2vD,WAAW3vD,KAAK0vD,UAAS,EAAG1vD,MAAMgwD,SAAS,WAAW,OAAO,OAAOhwD,KAAK6vD,WAAW7vD,KAAKwb,SAASG,UAAU3b,KAAKwb,SAASG,SAASo0C,OAAO/vD,KAAK6vD,WAAW7vD,KAAK0vD,UAAS,EAAG1vD,MAAMiwD,OAAO,WAAW,OAAOjwD,KAAK0vD,SAAS1vD,KAAKgwD,WAAWhwD,KAAK4L,SAAS5L,MAAMwqD,QAAQ,WAAWxqD,KAAKgqD,MAAMhqD,KAAKgqD,KAAKE,OAAOlqD,KAAKgqD,KAAKE,KAAK,MAAMlqD,KAAKgqD,KAAK,KAAKhqD,KAAKO,SAAS,KAAKP,KAAKgD,SAAS,KAAKhD,KAAKk0B,KAAKwL,QAAQ1/B,KAAKk0B,KAAKwL,OAAOv7B,OAAOnE,KAAKk0B,MAAMl0B,KAAKk0B,KAAKq3B,SAASqE,UAAU,KAAK5vD,KAAKk0B,KAAK,KAAKl0B,KAAKwb,SAAS,KAAKxb,KAAKurD,SAAS,KAAKvrD,KAAKmqD,OAAO,KAAKnqD,KAAKia,SAAS,KAAKja,KAAK6vD,UAAU,OAAO9H,EAAGoG,KAAKl7C,UAAUkJ,YAAY4rC,EAAGoG,KAAoBj6C,EAAE,WAAWlU,KAAK+uB,IAAI,KAAK/uB,KAAKijB,KAAK,KAAKjjB,KAAKgjB,KAAK,KAAKhjB,KAAKkwD,MAAK,IAAInsD,EAAE,WAAW/D,KAAKmwD,MAAM,KAAKnwD,KAAKowD,KAAK,KAAKpwD,KAAK4F,OAAO,EAAE5F,KAAKqwD,aAAa,GAAGrwD,KAAK6rD,SAAS5S,KAAKn2C,MAAM,GAAGM,KAAKshD,MAAM,IAAIthD,KAAK+1C,UAAUn5C,KAAKswD,UAAU,KAAMvE,WAAW,WAAW,OAAO3oD,KAAK+1C,SAASxS,SAAS,IAAI5e,MAAM,GAAGkxB,KAAKn2C,QAAOiB,EAAEkP,UAAU,CAAC6C,QAAQ,SAAS5B,GAAG,OAAOlU,KAAKqwD,aAAan8C,EAAE23C,WAAW0E,QAAQ,SAAS5qD,GAAG,IAAIqF,EAAE,IAAIkJ,EAAE,IAAIvO,EAAEkmD,SAAS,IAAIlmD,EAAEkmD,SAAS9nD,EAAEgoD,aAAa,MAAM7H,GAAG,OAAOn6C,QAAQsnB,MAAM,oFAAoF,KAAK,OAAOrmB,EAAE+jB,IAAIppB,EAAEqF,EAAEklD,MAAK,EAAGlwD,KAAKqwD,aAAa1qD,EAAEkmD,UAAU7gD,EAAEA,GAAGwlD,YAAY,SAASt8C,EAAEnQ,GAAG/D,KAAKqwD,aAAan8C,EAAE6a,IAAI88B,UAAU,KAAK7rD,KAAKqwD,aAAatsD,EAAE8nD,UAAU33C,EAAEA,EAAE6a,IAAIhrB,GAAGnC,IAAI,SAASsS,GAAG,IAAInQ,EAAE/D,KAAKqwD,aAAan8C,EAAE23C,UAAU,GAAG9nD,EAAE,CAAC,IAAY,IAATA,EAAEmsD,KAAU,OAAOnsD,EAAEgrB,IAAI7a,EAAEnQ,EAAEmsD,MAAK,EAAGnsD,EAAEkf,KAAK,KAAKlf,EAAEif,KAAK,UAAUjf,EAAE/D,KAAKuwD,QAAQr8C,GAAG,GAAGlU,KAAKmwD,MAAM,CAAC,IAAInwD,KAAKowD,KAAK,MAAM,IAAIvpD,MAAM,sEAAsE7G,KAAKowD,KAAKntC,KAAKlf,EAAEA,EAAEif,KAAKhjB,KAAKowD,KAAKpwD,KAAKowD,KAAKrsD,EAAEA,EAAEkf,KAAK,UAAUjjB,KAAKmwD,MAAMpsD,EAAE/D,KAAKowD,KAAKrsD,EAAEA,EAAEkf,KAAK,KAAKlf,EAAEif,KAAK,KAAKhjB,KAAK4F,SAAS5F,KAAKywD,WAAWzwD,KAAK0wD,KAAK,cAAc/3B,IAAI,SAASzkB,GAAG,QAAQlU,KAAKqwD,aAAan8C,EAAE23C,WAAW8E,OAAO,SAASz8C,GAAGlU,KAAK0wD,KAAK,kBAAkB,IAAI3sD,EAAE/D,KAAK8V,QAAQ5B,GAAG,IAAInQ,EAAE,KAAK,wDAAwD,GAAGA,EAAEif,KAAK,CAAC,IAAIrd,EAAE5B,EAAEif,KAAKhY,EAAErF,EAAEqd,KAAKjf,GAAG/D,KAAKowD,OAAOpwD,KAAKowD,KAAKzqD,GAAG,IAAIu+C,EAAEngD,EAAEkf,KAAKjY,IAAIA,EAAEiY,KAAKlf,GAAGA,EAAEkf,KAAKtd,EAAE5B,EAAEif,KAAKrd,EAAEqd,KAAKrd,EAAEsd,KAAKihC,EAAEv+C,EAAEqd,KAAKjf,EAAE/D,KAAKmwD,OAAOxqD,IAAI3F,KAAKmwD,MAAMpsD,KAAK6sD,SAAS,SAAS18C,GAAG,IAAInQ,EAAE/D,KAAK8V,QAAQ5B,GAAG,IAAInQ,EAAE,KAAK,wDAAwD,GAAGA,EAAEkf,KAAK,CAAC,IAAItd,EAAE5B,EAAEkf,KAAKjjB,KAAK2wD,OAAOhrD,EAAEopB,KAAK/uB,KAAKowD,MAAMzqD,IAAI3F,KAAKowD,KAAKrsD,KAAK4d,KAAK,SAASzN,GAAG,IAAInQ,EAAE4B,EAAEqF,EAAEhL,KAAKswD,UAAUpM,EAAElkD,KAAKmwD,MAAM,IAAInlD,EAAEpF,OAAO,EAAEs+C,GAAGl5C,EAAE0P,KAAKwpC,EAAEn1B,KAAKm1B,EAAEA,EAAEjhC,KAAK,IAAIjjB,KAAKkhD,QAAQl2C,EAAE2W,KAAKzN,GAAGvO,EAAEqF,EAAEpF,OAAO7B,EAAE,EAAE4B,EAAE5B,EAAEA,IAAI/D,KAAK4B,IAAIoJ,EAAEjH,KAAKI,OAAO,SAAS+P,GAAG,IAAInQ,EAAE/D,KAAK8V,QAAQ5B,GAAG,SAAOnQ,GAAGA,EAAEmsD,OAASnsD,EAAEif,OAAOjf,EAAEif,KAAKC,KAAKlf,EAAEkf,MAAMlf,EAAEkf,OAAOlf,EAAEkf,KAAKD,KAAKjf,EAAEif,MAAMjf,EAAEif,OAAOhjB,KAAKmwD,MAAMpsD,EAAEkf,MAAMlf,EAAEkf,OAAOjjB,KAAKowD,KAAKrsD,EAAEif,MAAMjf,EAAEmsD,MAAK,EAAGnsD,EAAEif,KAAK,KAAKjf,EAAEkf,KAAK,KAAKjjB,KAAK4F,SAAS,KAAK4Z,MAAM,WAAW,IAAItL,EAAElU,KAAKmwD,MAAM,OAAO,IAAInwD,KAAK4F,OAAO,MAAMsO,EAAE8O,OAAO9O,EAAE8O,KAAKC,KAAK/O,EAAE+O,MAAM/O,EAAE+O,OAAO/O,EAAE+O,KAAKD,KAAK9O,EAAE8O,MAAMhjB,KAAKmwD,MAAMj8C,EAAE+O,KAAK/O,EAAE+O,OAAOjjB,KAAKowD,KAAK,MAAMl8C,EAAEg8C,MAAK,EAAGh8C,EAAE8O,KAAK,KAAK9O,EAAE+O,KAAK,KAAKjjB,KAAK4F,SAASsO,EAAE6a,MAAMD,IAAI,WAAW,IAAI5a,EAAElU,KAAKowD,KAAK,OAAO,IAAIpwD,KAAK4F,OAAO,MAAMsO,EAAE8O,OAAO9O,EAAE8O,KAAKC,KAAK/O,EAAE+O,MAAM/O,EAAE+O,OAAO/O,EAAE+O,KAAKD,KAAK9O,EAAE8O,MAAMhjB,KAAKowD,KAAKl8C,EAAE8O,KAAK9O,EAAE8O,OAAOhjB,KAAKmwD,MAAM,MAAMj8C,EAAEg8C,MAAK,EAAGh8C,EAAE8O,KAAK,KAAK9O,EAAE+O,KAAK,KAAKjjB,KAAK4F,SAASsO,EAAE6a,MAAMqgB,OAAO,SAASl7B,GAAG,IAAI,IAAInQ,EAAEmQ,EAAEi8C,MAAMpsD,GAAG/D,KAAK4B,IAAImC,EAAEgrB,KAAKhrB,EAAEA,EAAEkf,MAAMi+B,MAAM,WAAW,IAAI,IAAIhtC,EAAElU,KAAKmwD,MAAMj8C,GAAGA,EAAEg8C,MAAK,EAAGh8C,EAAEA,EAAE+O,KAAKjjB,KAAKmwD,MAAM,KAAKnwD,KAAK4F,OAAO,GAAG4kD,QAAQ,WAAW,IAAI,IAAIt2C,EAAElU,KAAKmwD,MAAMj8C,GAAGA,EAAE6a,IAAI,KAAK7a,EAAEA,EAAE+O,KAAKjjB,KAAKmwD,MAAM,KAAKnwD,KAAKqwD,aAAa,MAAMK,KAAK,SAASx8C,GAAGnK,QAAQC,IAAI,uBAAuBkK,EAAE,yBAAyB,IAAI,IAAInQ,EAAE/D,KAAKmwD,MAAMpsD,GAAGgG,QAAQC,IAAI,IAAIjG,EAAEgrB,IAAI4X,WAAW,eAAe5iC,EAAEif,KAAKjf,EAAEif,KAAK+L,IAAI,SAAShrB,EAAEA,EAAEkf,OAAOlZ,QAAQC,IAAI,uCAAuCD,QAAQC,IAAI,WAAWhK,KAAKowD,KAAKpwD,KAAKowD,KAAKrhC,IAAI,QAAQ,cAAc/uB,KAAKmwD,MAAMnwD,KAAKmwD,MAAMphC,IAAI,QAAQ,QAAmB5S,YAAYpY,EAAEgkD,EAAG+D,WAAW/nD,EAAK,WAAW,IAAImQ,EAAE,SAASA,EAAEnQ,EAAE4B,EAAEqF,EAAEk5C,GAAGlkD,KAAK6wD,UAAU9sD,EAAE/D,KAAK8wD,OAAOnrD,EAAE3F,KAAK+wD,QAAQ/lD,EAAEhL,KAAKgxD,OAAO98C,EAAElU,KAAK0rD,UAAUxH,GAAG,IAAGhwC,EAAEjB,UAAU,CAAChT,QAAO,EAAGgxD,OAAO,KAAKC,QAAQ,SAASh9C,GAAG,IAAInQ,EAAE4B,EAAE,OAAO3F,KAAKC,QAAQD,KAAK6wD,YAAYlrD,EAAE3F,KAAKixD,OAAOjxD,KAAKixD,OAAO7hB,OAAOl7B,GAAGA,EAAEnQ,EAAE/D,KAAK6wD,UAAUzP,MAAMphD,KAAK+wD,QAAQprD,GAAG3F,KAAK8wD,QAAQ9wD,KAAKmxD,UAAUptD,GAAGotD,OAAO,WAAW,OAAOnxD,KAAKoxD,UAAUpxD,KAAKgxD,OAAO7sD,OAAOnE,KAAK6wD,UAAU7wD,KAAK+wD,SAAS,MAAMK,QAAQ,WAAW,QAAQpxD,KAAKgxD,UAAUhxD,KAAK6wD,WAAWQ,SAAS,kBAAkBrxD,KAAKgxD,cAAchxD,KAAK6wD,iBAAiB7wD,KAAK+wD,SAASpqB,SAAS,WAAW,MAAM,yBAAyB3mC,KAAK8wD,OAAO,aAAa9wD,KAAKoxD,UAAU,YAAYpxD,KAAKC,OAAO,OAAkBkc,YAAYjI,EAAE,IAAInQ,EAAE,WAAW/D,KAAKsxD,UAAU,GAAGtxD,KAAKuxD,YAAY,KAAK,IAAIr9C,EAAElU,KAAKA,KAAKwxD,SAAS,WAAWztD,EAAEkP,UAAUu+C,SAASpQ,MAAMltC,EAAEu9C,aAAa1tD,EAAEkP,UAAU,CAACy+C,UAAS,EAAGC,kBAAiB,EAAG1xD,QAAO,EAAG2xD,iBAAiB,SAAS19C,EAAEnQ,GAAG,GAAG,mBAAmBmQ,EAAE,MAAM,IAAIrN,MAAM,2EAA2EuR,QAAQ,OAAOrU,KAAK8tD,kBAAkB,SAAS9tD,EAAE4B,EAAEqF,EAAEk5C,GAAG,IAAIjuC,EAAElF,EAAE/Q,KAAK8xD,iBAAiB/tD,EAAEiH,GAAG,IAAI,IAAI+F,GAAG,IAAGkF,EAAEjW,KAAKsxD,UAAUvgD,IAAK+/C,SAASnrD,EAAE,MAAM,IAAIkB,MAAM,kBAAkBlB,EAAE,GAAG,QAAQ,eAAeA,EAAE,OAAO,IAAI,sEAAsEsQ,EAAE,IAAI/B,EAAElU,KAAK+D,EAAE4B,EAAEqF,EAAEk5C,GAAGlkD,KAAK+xD,YAAY97C,GAAG,OAAOjW,KAAK0xD,UAAU1xD,KAAKuxD,aAAat7C,EAAEi7C,QAAQlxD,KAAKuxD,aAAat7C,GAAG87C,YAAY,SAAS79C,GAAG,IAAInQ,EAAE/D,KAAKsxD,UAAU1rD,OAAO,GAAG7B,UAAU/D,KAAKsxD,UAAUvtD,IAAImQ,EAAEw3C,WAAW1rD,KAAKsxD,UAAUvtD,GAAG2nD,WAAW1rD,KAAKsxD,UAAU/G,OAAOxmD,EAAE,EAAE,EAAEmQ,IAAI49C,iBAAiB,SAAS59C,EAAEnQ,GAAG,IAAI,IAAI4B,EAAEqF,EAAEhL,KAAKsxD,UAAU1rD,OAAOoF,KAAK,IAAGrF,EAAE3F,KAAKsxD,UAAUtmD,IAAK6lD,YAAY38C,GAAGvO,EAAEorD,UAAUhtD,EAAE,OAAOiH,EAAE,OAAO,GAAG2tB,IAAI,SAASzkB,EAAEnQ,GAAG,OAAO,IAAI/D,KAAK8xD,iBAAiB59C,EAAEnQ,IAAInC,IAAI,SAASsS,EAAEnQ,EAAE4B,GAAG,OAAO3F,KAAK4xD,iBAAiB19C,EAAE,OAAOlU,KAAK6xD,kBAAkB39C,GAAE,EAAGnQ,EAAE4B,IAAIqsD,QAAQ,SAAS99C,EAAEnQ,EAAE4B,GAAG,OAAO3F,KAAK4xD,iBAAiB19C,EAAE,WAAWlU,KAAK6xD,kBAAkB39C,GAAE,EAAGnQ,EAAE4B,IAAIxB,OAAO,SAAS+P,EAAEnQ,GAAG/D,KAAK4xD,iBAAiB19C,EAAE,UAAU,IAAIvO,EAAE3F,KAAK8xD,iBAAiB59C,EAAEnQ,GAAG,OAAO,IAAI4B,IAAI3F,KAAKsxD,UAAU3rD,GAAG0rD,WAAWrxD,KAAKsxD,UAAU/G,OAAO5kD,EAAE,IAAIuO,GAAG+9C,UAAU,SAAS/9C,QAAG,IAAoBA,IAAIA,EAAE,MAAM,IAAI,IAAInQ,EAAE/D,KAAKsxD,UAAU1rD,OAAO7B,KAAKmQ,EAAElU,KAAKsxD,UAAUvtD,GAAGgtD,UAAU78C,IAAIlU,KAAKsxD,UAAUvtD,GAAGstD,WAAWrxD,KAAKsxD,UAAU/G,OAAOxmD,EAAE,IAAI/D,KAAKsxD,UAAUvtD,GAAGstD,WAAWn9C,IAAIlU,KAAKsxD,UAAU1rD,OAAO,IAAIssD,gBAAgB,WAAW,OAAOlyD,KAAKsxD,UAAU1rD,QAAQusD,KAAK,WAAWnyD,KAAK2xD,kBAAiB,GAAIH,SAAS,WAAW,GAAGxxD,KAAKC,OAAO,CAAC,IAAIiU,EAAEnQ,EAAEga,MAAM9K,UAAU8U,MAAM1U,KAAKo+C,WAAW9rD,EAAE3F,KAAKsxD,UAAU1rD,OAAO,GAAG5F,KAAK0xD,WAAW1xD,KAAKuxD,YAAYxtD,GAAG4B,EAAE,CAACuO,EAAElU,KAAKsxD,UAAUvpC,QAAQ/nB,KAAK2xD,kBAAiB,EAAG,GAAGhsD,UAAUuO,EAAEvO,IAAI3F,KAAK2xD,mBAAoC,IAAlBz9C,EAAEvO,GAAGurD,QAAQntD,OAAYquD,OAAO,WAAWpyD,KAAKuxD,YAAY,MAAM/G,QAAQ,WAAWxqD,KAAKiyD,mBAAmBjyD,KAAKsxD,iBAAiBtxD,KAAKuxD,aAAa5qB,SAAS,WAAW,MAAM,kBAAkB3mC,KAAKC,OAAO,iBAAiBD,KAAKkyD,kBAAkB,MAAMnuD,EAAEkP,UAAUkJ,YAAYpY,EAAEgkD,EAAGsK,OAAOtuD,EAA38F,GAAg9FgkD,EAAG6B,YAAY,SAAS11C,GAAGA,EAAEA,GAAG,GAAG,IAAInQ,EAAE,CAACuuD,eAAc,EAAGC,gBAAgB,MAAMxuD,EAAEgkD,EAAGiD,MAAM0D,MAAM3qD,EAAEmQ,GAAGlU,KAAKsyD,cAAcvuD,EAAEuuD,cAActyD,KAAKuyD,gBAAgBxuD,EAAEwuD,gBAAgBvyD,KAAKwyD,KAAK,IAAIzK,EAAG+D,YAAY/D,EAAG6B,YAAY32C,UAAU,CAAC6wC,SAAS,SAAS5vC,EAAEnQ,EAAE4B,EAAEqF,GAAG,IAAIk5C,EAAEjuC,EAAElF,EAAEi0C,EAAEl0C,EAAE8Q,EAAE,IAAIjc,EAAEA,GAAG3F,KAAKuyD,gBAAgBvnD,EAAE+iD,YAAY/tD,KAAKwyD,KAAKtR,QAAQlhD,KAAKwyD,KAAK5wD,IAAIsS,GAAGlU,KAAKwyD,KAAK5sD,OAAO,GAAG,CAAC,GAAG5F,KAAKwyD,KAAK7wC,KAAK3hB,KAAKyyD,UAASvO,EAAElkD,KAAKwyD,KAAKhzC,SAAUmsC,UAAS,EAAGzH,IAAIngD,EAAE,OAAOgkD,EAAG2K,SAASC,UAAU5uD,GAAG,IAA6C+M,EAAE,EAAE8Q,GAA7C7Q,EAAE/F,EAAE6iD,aAAa3J,EAAElkD,KAAKsyD,cAAc3sD,IAAWC,OAAOgc,EAAE9Q,EAAEA,IAAI,IAAGk0C,EAAEj0C,EAAED,IAAK06C,WAAWv1C,EAAEiuC,EAAEuH,UAAUzgD,EAAEmgB,SAAS+4B,EAAEc,IAAIA,EAAE2G,UAAU11C,EAAE+uC,EAAEyG,WAAW,CAAC,GAAGzG,EAAE2G,UAAS,EAAG3G,EAAE4G,QAAQ1H,EAAEc,EAAEyG,UAAUx1C,EAAE+uC,EAAE0G,UAAUz1C,EAAEjL,EAAEmgB,SAASpnB,EAAEihD,GAAGA,IAAIjhD,EAAE,OAAOgkD,EAAG2K,SAASC,UAAU5uD,GAAG/D,KAAKwyD,KAAK5wD,IAAIojD,IAAI,OAAO,MAAMyN,QAAQ,SAASv+C,EAAEnQ,GAAG,OAAOmQ,EAAEw3C,UAAU3nD,EAAE2nD,YAAY3D,EAAG6B,YAAY32C,UAAUkJ,YAAY4rC,EAAG6B,YAAY7B,EAAG2K,SAAS,CAACC,UAAU,SAASz+C,GAAG,IAAI,IAAInQ,EAAE,CAACmQ,GAAGA,EAAE03C,SAAS13C,EAAEA,EAAE03C,QAAQ7nD,EAAE2W,KAAKxG,GAAG,OAAOnQ,EAAEqiD,WAAWwM,YAAY,SAAS1+C,EAAEnQ,GAAG,IAAI4B,EAAE3F,KAAK2yD,UAAUz+C,GAAGlJ,EAAEhL,KAAK2yD,UAAU5uD,GAAG,OAAO4B,EAAEypC,OAAOpkC,EAAEo7C,YAAYyM,WAAW,SAAS3+C,GAAG,IAAInQ,EAAE4B,EAAEqF,EAAEk5C,EAAEjuC,EAAElF,EAAE,EAAE,IAAIhN,EAAE,EAAEA,EAAEmQ,EAAEtO,SAAS7B,EAAE4B,EAAEuO,EAAEnQ,EAAE,GAAGiH,EAAEkJ,EAAEnQ,GAAGmgD,EAAEv+C,EAAE,GAAGqF,EAAE,GAAGiL,EAAEtQ,EAAE,GAAGqF,EAAE,GAAG+F,GAAG3N,KAAKgoB,KAAK84B,EAAEA,EAAEjuC,EAAEA,GAAG,OAAOlF,GAAGqS,YAAY,SAASlP,EAAEnQ,EAAE4B,EAAEqF,GAAG,IAAIk5C,EAAEjuC,EAAElF,EAAEi0C,EAAEl0C,EAAE8Q,EAAEiM,EAAEzqB,KAAKuB,IAAIigD,EAAE,GAAG,IAAsBV,EAAEv+C,EAAEuO,EAAE,GAAG,EAAE+B,EAAEjL,EAAEjH,EAAE,GAAG,EAAE+M,GAAxCC,EAAE8c,EAAEloB,EAAEuO,KAAG8wC,EAAEn3B,EAAE7iB,EAAEjH,IAA+BmQ,IAAIvO,GAAG5B,IAAIiH,GAAG45C,EAAElqC,KAAK,CAACxG,EAAEnQ,KAAI6d,EAAE,EAAE9Q,IAAKk0C,IAAIl0C,GAAGk0C,EAAE9wC,GAAGgwC,GAAGnzC,EAAE6Q,IAAI9Q,GAAGC,EAAEhN,GAAGkS,GAAG,OAAO2uC,GAAGkO,WAAW,SAAS5+C,GAAG,IAAInQ,EAAE4B,EAAEqF,EAAEk5C,EAAEjuC,EAAElF,EAAEi0C,EAAE,GAAGl0C,EAAEoD,EAAEtO,OAAO,GAAG,EAAEkL,EAAE,OAAOk0C,EAAE,IAAI/uC,EAAE,EAAEnF,EAAE,EAAEmF,IAAIA,EAAE,IAAIlS,EAAEmQ,EAAE+B,GAAGtQ,EAAEuO,EAAE+B,EAAE,GAA2CiuC,GAAxCl5C,EAAEhL,KAAKojB,YAAYrf,EAAE,GAAGA,EAAE,GAAG4B,EAAE,GAAGA,EAAE,KAAQC,OAAOmL,EAAE,EAAEmzC,EAAE,EAAEnzC,IAAIA,EAAEi0C,EAAEtqC,KAAK1P,EAAE+F,IAAI,OAAOi0C,EAAEtqC,KAAKxG,EAAEpD,EAAE,IAAIk0C,GAAG+N,aAAa,SAAS7+C,EAAEnQ,GAAG,IAAI4B,EAAEqF,EAAEk5C,EAAEjuC,EAAElF,EAAEi0C,EAAEl0C,EAAE8Q,EAAEiM,EAAE+2B,EAAEx/B,EAAE8H,EAAEpa,EAAE/O,EAAE6B,OAAOmN,EAAEhP,EAAE,GAAG,GAAGmnB,EAAEnnB,EAAE,GAAG,GAAGivD,EAAEjvD,EAAE+O,EAAE,GAAG,GAAGR,EAAEvO,EAAE+O,EAAE,GAAG,GAAG,IAAY/B,EAAE,CAAC,CAAXpL,EAAEoN,EAAE/H,EAAEkgB,IAAYpa,EAAE,EAAEgC,EAAEhC,IAAIA,EAAE,CAAC,IAAWozC,GAAPr2B,EAAE9pB,EAAE+M,IAAO,GAAGmF,EAAE4X,EAAE,GAAG+2B,EAAE5kD,KAAKojB,YAAYzd,EAAEqF,EAAEk5C,EAAEjuC,GAAGiX,GAAE,EAAGtL,EAAE,EAAEA,EAAEgjC,EAAEh/C,SAASgc,EAAE,GAAGwD,EAAEw/B,EAAEhjC,IAAI1N,EAAE++C,aAAa7tC,EAAE,GAAGA,EAAE,IAAI,CAAC8H,GAAE,EAAG,MAAMA,IAAI83B,EAAEjhD,EAAE+M,EAAE,GAAGC,EAAE2J,KAAKsqC,GAAGr/C,EAAEq/C,EAAE,GAAGh6C,EAAEg6C,EAAE,IAAI,OAAOj0C,EAAE2J,KAAK,CAACs4C,EAAE1gD,IAAIvB,GAAGmiD,aAAa,SAASh/C,GAAG,GAAGA,EAAEtO,OAAO,EAAE,OAAOsO,EAAE,IAAInQ,EAAE4B,EAAEqF,EAAEk5C,EAAEjuC,EAAElF,EAAEi0C,EAAE,GAAGl0C,EAAEoD,EAAE,GAAG,GAAG0N,EAAE1N,EAAE,GAAG,GAAG2Z,EAAE3Z,EAAE,GAAG,GAAG0wC,EAAE1wC,EAAE,GAAG,GAAGkR,EAAEyI,EAAE/c,EAAEoc,EAAE03B,EAAEhjC,EAAE,IAAyBwD,GAArBnP,EAAE7S,KAAKgoB,KAAKhG,EAAEA,EAAE8H,EAAEA,GAAQA,GAAGjX,EAAE+uC,EAAEtqC,KAAK,CAAC5J,EAAE8Q,IAAI7Q,EAAE,EAAEA,EAAEmD,EAAEtO,OAAOmL,IAAIhN,EAAE8pB,EAAEloB,EAAEi/C,EAAE55C,EAAEoa,EAAE8+B,EAAEh3B,EAAsB9H,GAApByI,EAAE3Z,EAAEnD,GAAG,IAAiBhN,EAAEmpB,GAAhB03B,EAAE1wC,EAAEnD,GAAG,IAAapL,EAA4BunB,GAA1BjX,EAAE7S,KAAKgoB,KAAKhG,EAAEA,EAAE8H,EAAEA,KAAG9H,GAAGnP,KAAYjL,GAAGkiB,IAAIg3B,IAAIc,EAAEtqC,KAAK,CAAC3W,EAAE4B,IAAI,OAAOq/C,EAAEtqC,KAAK,CAACmT,EAAE+2B,IAAII,IAAI+C,EAAG/tB,OAAO,CAAChe,QAAQ,KAAKm3C,YAAY,KAAK/2C,aAAY,EAAGrc,KAAK,SAASmU,GAAGlU,KAAKoc,YAAYlI,IAAG,EAAGlU,KAAKgc,QAAQ,IAAI3b,MAAM+yD,gBAAe,eAAa,eAAa,WAAWrpD,QAAQqT,KAAK,2BAA0Bpd,KAAKmzD,YAAY,IAAI9yD,MAAMgzD,YAAYrzD,KAAKgc,SAAShc,KAAKmzD,YAAY/2C,YAAYlI,GAAGymB,YAAY,SAASzmB,EAAEnQ,EAAE4B,EAAEqF,GAAG,IAAIk5C,EAAE,IAAI7jD,MAAMm6B,QAAQ,KAAKz2B,GAAG,OAAO/D,KAAKmzD,YAAYl6C,KAAK/E,GAAE,SAASA,GAAGgwC,EAAEr8B,MAAM3T,EAAEgwC,EAAE9J,aAAY,EAAGz0C,GAAGA,EAAEu+C,KAAI,MAAK,SAAShwC,GAAGlJ,GAAGA,EAAEkJ,MAAKgwC,EAAEoP,WAAWp/C,EAAEgwC,IAAI6D,EAAGwL,YAAY,SAASr/C,EAAEnQ,EAAE4B,GAAG3F,KAAKwzD,MAAK,EAAGxzD,KAAKyzD,WAAU,EAAGzzD,KAAK0zD,aAAa,KAAK1zD,KAAK2zD,eAAe,KAAK3zD,KAAK4zD,QAAQ,KAAK5zD,KAAKC,QAAO,EAAGD,KAAKwf,OAAM,EAAGxf,KAAK2jD,MAAK,EAAG3jD,KAAK6zD,MAAM,EAAE7zD,KAAKO,SAAS,IAAIF,MAAMC,QAAQN,KAAK8zD,eAAe,IAAIzzD,MAAMoD,QAAQzD,KAAKgxD,OAAO,IAAIjJ,EAAGsK,OAAOryD,KAAKkzB,MAAMhf,EAAElU,KAAK+zD,QAAQhwD,EAAE/D,KAAKg0D,WAAW,IAAI3zD,MAAM+hD,UAAUpiD,KAAKi0D,iBAAgB,GAAGtuD,EAAEA,GAAG4yC,UAAW9uC,iBAAiB,YAAYzJ,KAAKk0D,qBAAqB1rD,KAAKxI,OAAM,GAAI2F,EAAE8D,iBAAiB,YAAYzJ,KAAKm0D,qBAAqB3rD,KAAKxI,OAAM,GAAI2F,EAAE8D,iBAAiB,UAAUzJ,KAAKo0D,mBAAmB5rD,KAAKxI,OAAM,GAAI2F,EAAE8D,iBAAiB,aAAazJ,KAAKq0D,cAAc7rD,KAAKxI,OAAM,GAAI2F,EAAE8D,iBAAiB,iBAAiBzJ,KAAKq0D,cAAc7rD,KAAKxI,OAAM,IAAK+nD,EAAGwL,YAAYe,KAAK,OAAOvM,EAAGwL,YAAYgB,IAAI,MAAMxM,EAAGwL,YAAYiB,KAAK,OAAOzM,EAAGwL,YAAYkB,GAAG,KAAK1M,EAAGwL,YAAYmB,MAAM,QAAQ3M,EAAGwL,YAAYoB,MAAM,QAAQ5M,EAAGwL,YAAYtgD,UAAU,CAACpP,OAAO,WAAW,GAAG7D,KAAKC,OAAO,CAACD,KAAKg0D,WAAWY,cAAc50D,KAAK8zD,eAAe9zD,KAAK+zD,SAAS,IAAI7/C,EAAEnQ,EAAE4B,EAAE3F,KAAKg0D,WAAWjR,gBAAgB/iD,KAAKkzB,OAAM,GAAIvtB,EAAEC,OAAO,GAAU7B,GAAPmQ,EAAEvO,EAAE,IAAO2V,OAAOiwC,SAASqE,UAAU5vD,KAAK0zD,cAAc3vD,IAAI/D,KAAK0zD,cAAc1zD,KAAKgxD,OAAOQ,SAASzJ,EAAGwL,YAAYgB,IAAIv0D,KAAK0zD,cAAc1zD,KAAK0zD,aAAa3vD,EAAE/D,KAAK2zD,eAAe,KAAK3zD,KAAKgxD,OAAOQ,SAASzJ,EAAGwL,YAAYe,KAAKt0D,KAAK0zD,eAAe1zD,KAAKO,SAASiB,KAAK0S,EAAE+uC,OAAOjjD,KAAK8zD,eAAehvD,EAAEoP,EAAEiX,WAAWnrB,KAAK0zD,cAAc1zD,KAAKgxD,OAAOQ,SAASzJ,EAAGwL,YAAYgB,IAAIv0D,KAAK0zD,cAAc1zD,KAAK0zD,aAAa,KAAK1zD,KAAK2zD,eAAe,MAAM3zD,KAAK4zD,QAAQjuD,IAAIyO,eAAe,WAAWpU,KAAKi0D,iBAAgB,GAAIE,qBAAqB,SAASjgD,GAAG,OAAOA,EAAEA,GAAGtR,OAAOoD,OAAQoO,iBAAiBpU,KAAKi0D,iBAAiBj0D,KAAKi0D,iBAAgB,GAAG,IAAKj0D,KAAK0zD,eAAe1zD,KAAK2zD,eAAe3zD,KAAK0zD,cAAc1zD,KAAKwf,MAAMtL,EAAEhH,SAASlN,KAAK2jD,KAAKzvC,EAAE2gD,QAAQ70D,KAAKwzD,KAAK,IAAIt/C,EAAE1B,MAAMxS,KAAKyzD,UAAU,IAAIv/C,EAAE1B,WAAWxS,KAAKgxD,OAAOQ,SAASzJ,EAAGwL,YAAYiB,KAAKx0D,KAAK0zD,gBAAgBU,mBAAmB,SAASlgD,GAAG,OAAOA,EAAEE,iBAAiBpU,KAAKi0D,iBAAiBj0D,KAAKi0D,iBAAgB,GAAG,IAAKj0D,KAAKwf,MAAMtL,EAAEhH,SAASlN,KAAK2jD,KAAKzvC,EAAE2gD,QAAQ70D,KAAKgxD,OAAOQ,SAASzJ,EAAGwL,YAAYkB,GAAGz0D,KAAK0zD,cAAc1zD,KAAK2zD,gBAAgB3zD,KAAK0zD,cAAc1zD,KAAK2zD,eAAe9H,WAAW7rD,KAAK0zD,aAAa7H,UAAU7rD,KAAKgxD,OAAOQ,SAASzJ,EAAGwL,YAAYmB,MAAM10D,KAAK0zD,cAAc1zD,KAAKwzD,KAAK,IAAIt/C,EAAE1B,OAASxS,KAAKwzD,UAAUxzD,KAAKyzD,UAAU,IAAIv/C,EAAE1B,OAASxS,KAAKyzD,aAAaS,qBAAqB,SAAShgD,GAAGA,EAAEE,iBAAiBpU,KAAK8zD,eAAe3wD,EAAE+Q,EAAE4gD,QAAQlyD,OAAOq+B,WAAW,EAAE,EAAEjhC,KAAK8zD,eAAevwD,GAAM2Q,EAAE6gD,QAAQnyD,OAAOu+B,YAArB,EAAkC,GAAGkzB,cAAc,SAASngD,GAAG,GAAGlU,KAAKC,OAAO,CAACiU,EAAEE,iBAAiBF,EAAE8gD,kBAAkB,IAAIjxD,EAAE,OAAE,IAASmQ,EAAE+gD,WAAWlxD,EAAEmQ,EAAE+gD,gBAAW,IAAS/gD,EAAEqD,SAASxT,GAAGmQ,EAAEqD,QAAQxT,EAAE,EAAE/D,KAAK6zD,QAAQ7zD,KAAK6zD,QAAQ7zD,KAAKgxD,OAAOQ,SAASzJ,EAAGwL,YAAYoB,MAAM30D,KAAK6zD,UAAU9L,EAAGwL,YAAYtgD,UAAUkJ,YAAY4rC,EAAGwL,YAAYxL,EAAG30B,MAAM,SAASlf,EAAEnQ,GAAG,IAAI4B,EAAE,CAACwuB,QAAQokB,SAASwD,KAAKmZ,OAAM,EAAGC,WAAU,EAAGC,WAAW,OAAOC,aAAY,EAAGC,IAAI,KAAKhqC,MAAM,IAAIjrB,MAAMkrB,iBAAiB,UAAUgqC,cAAc,KAAKC,WAAW,oBAAoBC,eAAe,KAAKC,UAAU,GAAG1qD,EAAE,CAAC2qD,YAAY,IAAIC,YAAY,IAAIC,UAAU,EAAEC,QAAO,GAAI,GAAGnwD,EAAEoiD,EAAGiD,MAAM0D,MAAM/oD,EAAEuO,GAAG,kBAAkBnQ,IAAIiH,EAAE+8C,EAAGiD,MAAM0D,MAAM1jD,EAAEjH,IAAI/D,KAAKkb,SAAS,IAAI7a,MAAM01D,cAAc,CAACb,MAAMvvD,EAAEuvD,MAAMC,UAAUxvD,EAAEwvD,YAAYn1D,KAAKkb,SAAS86C,cAAcrwD,EAAEyvD,WAAW,GAAGp1D,KAAKkb,SAASm6C,YAAY1vD,EAAE0vD,YAAYr1D,KAAKghC,MAAMp+B,OAAOq+B,WAAWjhC,KAAKkhC,OAAOt+B,OAAOu+B,YAAYnhC,KAAK01D,UAAU/vD,EAAE+vD,UAAU11D,KAAKi2D,UAAU,IAAI51D,MAAM+yB,MAAMpzB,KAAKi2D,UAAUX,IAAI3vD,EAAE2vD,IAAIt1D,KAAKi2D,UAAUr0D,IAAI,IAAIvB,MAAMqrB,aAAa,WAAW/lB,EAAE4vD,eAAe5vD,EAAE2lB,MAAM/qB,SAASe,KAAK,EAAE,GAAG,GAAGq9C,YAAY3+C,KAAKi2D,UAAUr0D,IAAI+D,EAAE2lB,OAAO,uBAAuB3lB,EAAE6vD,WAAW,CAAC,IAAItR,EAAEthD,OAAOq+B,WAAWjhC,KAAK01D,UAAUz/C,EAAErT,OAAOu+B,YAAYnhC,KAAK01D,UAAU11D,KAAKoC,OAAO,IAAI/B,MAAMsqB,mBAAmBu5B,GAAG,EAAEA,EAAE,EAAEjuC,EAAE,EAAEA,GAAG,EAAE,EAAE,UAAUjW,KAAKoC,OAAO,IAAI/B,MAAM8pB,kBAAkB,GAAGnqB,KAAKghC,MAAMhhC,KAAKkhC,OAAO,EAAE,KAAKlhC,KAAKk2D,YAAYnyD,EAAE/D,KAAKk2D,YAAYl2D,KAAKsU,SAAS,IAAIjU,MAAM81D,cAAcn2D,KAAKoC,OAAOpC,KAAKkb,SAASk7C,YAAYp2D,KAAKsU,SAASqhD,YAAY3qD,EAAE2qD,YAAY31D,KAAKsU,SAASshD,YAAY5qD,EAAE4qD,YAAY51D,KAAKsU,SAASuhD,UAAU7qD,EAAE6qD,UAAU71D,KAAKsU,SAASwhD,OAAO9qD,EAAE8qD,QAAQnwD,EAAE8vD,gBAAgBz1D,KAAKoC,OAAO7B,SAASiB,KAAKmE,EAAE8vD,gBAAgB7yD,OAAO6G,iBAAiB,SAAS,WAAW,GAAGzJ,KAAKghC,MAAMp+B,OAAOq+B,WAAWjhC,KAAKkhC,OAAOt+B,OAAOu+B,YAAY,uBAAuBnhC,KAAKoC,OAAOC,KAAK,CAAC,IAAI6R,EAAElU,KAAKghC,MAAMhhC,KAAK01D,UAAU3xD,EAAE/D,KAAKkhC,OAAOlhC,KAAK01D,UAAU11D,KAAKoC,OAAO4kD,KAAK9yC,GAAG,EAAElU,KAAKoC,OAAO6kD,MAAM/yC,EAAE,EAAElU,KAAKoC,OAAOi0D,IAAItyD,EAAE,EAAE/D,KAAKoC,OAAOk0D,OAAOvyD,GAAG,OAAO/D,KAAKoC,OAAOk/B,OAAOthC,KAAKghC,MAAMhhC,KAAKkhC,OAAOlhC,KAAKoC,OAAOm0D,yBAAyBv2D,KAAKkb,SAASs7C,QAAQx2D,KAAKghC,MAAMhhC,KAAKkhC,SAAS14B,KAAKxI,OAAM,GAAIA,KAAKy2D,SAAS9wD,EAAEwuB,UAAU4zB,EAAG30B,MAAMngB,UAAU,CAACwjD,SAAS,SAASviD,GAAGA,EAAEwiD,MAAM11B,MAAMhhC,KAAKghC,MAAM,KAAK9sB,EAAEwiD,MAAMx1B,OAAOlhC,KAAKkhC,OAAO,KAAKlhC,KAAKkb,SAASy7C,cAAc/zD,OAAOg0D,kBAAkB52D,KAAKkb,SAASs7C,QAAQx2D,KAAKghC,MAAMhhC,KAAKkhC,QAAQhtB,EAAE2iD,YAAY72D,KAAKkb,SAASk7C,aAAax0D,IAAI,SAASsS,GAAGlU,KAAKi2D,UAAUr0D,IAAIsS,IAAI/P,OAAO,SAAS+P,GAAGlU,KAAKi2D,UAAU9xD,OAAO+P,IAAI4iD,OAAO,WAAW92D,KAAKk2D,WAAWl2D,KAAKsU,SAASzQ,SAAS7D,KAAKkb,SAAS47C,OAAO92D,KAAKi2D,UAAUj2D,KAAKoC,SAAS20D,gBAAgB,WAAW,GAAG/2D,KAAK01D,WAAW,EAAc11D,KAAK01D,UAAU,MAAhD,CAAmD,IAAIxhD,EAAElU,KAAKghC,MAAMhhC,KAAK01D,UAAU3xD,EAAE/D,KAAKkhC,OAAOlhC,KAAK01D,UAAU11D,KAAKoC,OAAO4kD,KAAK9yC,GAAG,EAAElU,KAAKoC,OAAO6kD,MAAM/yC,EAAE,EAAElU,KAAKoC,OAAOi0D,IAAItyD,EAAE,EAAE/D,KAAKoC,OAAOk0D,OAAOvyD,GAAG,EAAE/D,KAAKoC,OAAOm0D,2BAA0BS,QAAQ,SAAS9iD,GAAGlU,KAAKoC,OAAO2hC,OAAO7vB,EAAE3T,YAAYwnD,EAAG30B,MAAMngB,UAAUkJ,YAAY4rC,EAAG30B,MAAM20B,EAAGkP,iBAAiB,SAAS/iD,GAAGlU,KAAKk3D,MAAMhjD,EAAElU,KAAKm3D,SAAS,IAAIpP,EAAGsK,OAAOryD,KAAKo3D,WAAW,IAAIrP,EAAGsK,OAAOryD,KAAK0vD,SAAS,KAAK1vD,KAAKq3D,iBAAgB,EAAGr3D,KAAKk3D,MAAMlG,OAAOpvD,IAAI5B,KAAKs3D,QAAQt3D,OAAO+nD,EAAGkP,iBAAiBhkD,UAAU,CAACrH,OAAO,SAASsI,EAAEnQ,GAAGmQ,IAAInQ,EAAEA,IAAG,EAAG/D,KAAK0vD,WAAWx7C,GAAGlU,KAAKu3D,eAAexzD,GAAGmQ,EAAEw7C,SAAS1vD,KAAKq3D,kBAAkBtzD,GAAG/D,KAAKo3D,WAAW5F,SAASt9C,GAAGA,EAAE87C,YAAY97C,EAAEtI,SAAS5L,KAAK0vD,SAASx7C,EAAEnQ,GAAG/D,KAAKm3D,SAAS3F,SAASt9C,KAAKqjD,eAAe,SAASrjD,GAAGA,EAAEA,IAAG,EAAGlU,KAAK0vD,WAAWx7C,GAAGlU,KAAKo3D,WAAW5F,SAASxxD,KAAK0vD,UAAU1vD,KAAK0vD,SAASM,YAAYhwD,KAAK0vD,SAAS,MAAM4H,QAAQ,SAASpjD,EAAEnQ,GAAG,OAAOmQ,GAAG,KAAK6zC,EAAGwL,YAAYiB,KAAKzwD,GAAG/D,KAAKu3D,iBAAiB,MAAM,KAAKxP,EAAGwL,YAAYmB,MAAM10D,KAAK4L,OAAO7H,MAAMgkD,EAAGkP,iBAAiBhkD,UAAUkJ,YAAY4rC,EAAGkP,iBAAiBlP,EAAGiD,MAAM,CAACwM,MAAM,SAAStjD,EAAEnQ,EAAE4B,GAAG,OAAOvC,KAAKkC,IAAIvB,EAAEX,KAAKoC,IAAIG,EAAEuO,KAAKujD,KAAK,SAASvjD,GAAG,OAAOA,GAAGA,EAAE9Q,KAAKuB,IAAIuP,IAAIilC,OAAO,SAASjlC,EAAEnQ,GAAG,OAAO,IAAI0tD,UAAU7rD,OAAOxC,KAAK+1C,SAASjlC,EAAE,GAAGA,EAAE9Q,KAAK+1C,UAAUp1C,EAAEmQ,GAAGA,GAAG+2C,UAAU,SAAS/2C,EAAEnQ,GAAG,OAAO,IAAI0tD,UAAU7rD,OAAOxC,KAAK+1C,SAASjlC,EAAE,GAAGA,EAAE,EAAE9Q,KAAK+1C,UAAUp1C,EAAEmQ,EAAE,GAAGA,EAAE,GAAGyqC,UAAU,SAASzqC,EAAEnQ,EAAE4B,GAAG,OAAOuO,EAAEnQ,IAAI4B,EAAE5B,IAAI2zD,iBAAiB,SAASxjD,GAAG,OAAOA,GAAGlU,KAAK8oD,KAAM9oD,KAAKuF,GAAG2O,GAAGlU,KAAK8oD,IAAI50C,GAAGlU,KAAKuF,KAAK2O,GAAGlU,KAAK8oD,KAAK50C,GAAG63C,WAAW,WAAW,OAAO3oD,KAAK+1C,SAASxS,SAAS,IAAI5e,MAAM,GAAGkxB,KAAKn2C,OAAO60D,cAAc,SAASzjD,GAAG,GAAG,iBAAiBA,GAAGA,EAAEmL,UAAUnL,IAAIA,EAAEtR,OAAO,OAAM,EAAG,IAAI,GAAGsR,EAAEiI,cAAcrW,OAAOmN,UAAUnJ,eAAeuJ,KAAKa,EAAEiI,YAAYlJ,UAAU,iBAAiB,OAAM,EAAG,MAAMlP,GAAG,OAAM,EAAG,OAAM,GAAI2qD,MAAM,SAASx6C,EAAEnQ,GAAG,IAAI4B,EAAE3F,KAAKgL,EAAE+S,MAAMwmB,QAAQxgC,GAAGmgD,EAAEl5C,GAAG,IAAI,GAAG,OAAOA,GAAGkJ,EAAEA,GAAG,GAAGgwC,EAAEA,EAAE9U,OAAOl7B,GAAGnQ,EAAE+H,SAAQ,SAAS/H,EAAEiH,QAAG,IAAoBk5C,EAAEl5C,GAAGk5C,EAAEl5C,GAAGjH,EAAE4B,EAAEgyD,cAAc5zD,GAAGmgD,EAAEl5C,GAAGrF,EAAE+oD,MAAMx6C,EAAElJ,GAAGjH,IAAI,IAAImQ,EAAE/I,QAAQpH,IAAImgD,EAAExpC,KAAK3W,MAAKmgD,IAAIhwC,GAAGvO,EAAEgyD,cAAczjD,IAAIpO,OAAOC,KAAKmO,GAAGpI,SAAQ,SAAS/H,GAAGmgD,EAAEngD,GAAGmQ,EAAEnQ,MAC5w+B+B,OAAOC,KAAKhC,GAAG+H,SAAQ,SAASd,GAAGjH,EAAEiH,IAAIrF,EAAEgyD,cAAc5zD,EAAEiH,KAAKkJ,EAAElJ,GAAGk5C,EAAEl5C,GAAGrF,EAAE+oD,MAAMx6C,EAAElJ,GAAGjH,EAAEiH,IAAIk5C,EAAEl5C,GAAGjH,EAAEiH,MAAKk5C,IAAIphD,IAAI,WAAW,OAAOF,OAAOg1D,IAAIh1D,OAAOg1D,IAAIp1D,OAAOq1D,YAAYC,YAAYl1D,OAAOC,YAAYC,OAAOigB,MAAM,SAAS7O,GAAG,KAAKA,EAAE6jD,WAAW7jD,EAAEwkC,YAAYxkC,EAAE6jD,YAAYC,UAAU,SAAS9jD,EAAEnQ,EAAE4B,EAAEqF,GAAG,GAAwBA,EAAEA,GAAG,MAA1BjH,EAAEA,GAAG,KAAE4B,EAAEA,GAAGuO,EAAEtO,QAAsB,GAAG,EAAEoF,GAAG,CAAC,IAAI,IAAIk5C,EAAEngD,EAAEkS,EAAEtQ,EAAEoL,EAAE,GAAG/F,EAAEiL,EAAEiuC,GAAG,GAAGhwC,EAAEgwC,GAAGnzC,EAAE,GAAGkF,EAAE,IAAI+uC,EAAE9wC,EAAEgwC,GAAGhwC,EAAEgwC,GAAGhwC,EAAE+B,GAAG/B,EAAE+B,GAAG+uC,QAAQd,EAAElkD,KAAKg4D,UAAU9jD,EAAEnQ,EAAEkS,EAAEjL,EAAE,GAAGhL,KAAKg4D,UAAU9jD,EAAE+B,EAAEtQ,EAAEqF,EAAE,KAAKwkD,aAAa,SAASt7C,EAAEnQ,GAAG,IAAI4B,EAAEqF,EAAEk5C,EAAEhwC,EAAEkG,MAAM,KAAKnE,EAAE,OAAO,IAAIlS,EAAE/D,KAAKirD,UAAUlnD,GAAG4B,EAAE,EAAE,EAAEA,EAAEA,IAAuB,GAAnBqF,EAAEmT,SAAS+lC,EAAEv+C,IAAI5B,GAAMiH,EAAE,EAAEA,EAAE,MAAMA,EAAE,KAAKiL,GAAGjL,EAAE,IAAI,OAAOiL,EAAEA,EAAEoI,UAAU,EAAEpI,EAAErQ,OAAO,IAAM,KAAKmpD,QAAQ,SAAS76C,GAAG,IAAInQ,EAAE,IAAIk0D,eAAwDjtD,OAAvC,IAAoBkJ,EAAE+6C,OAAS/6C,EAAE+6C,MAAU/6C,EAAEmI,IAAInI,EAAEmI,IAAI,MAAMjZ,KAAKshD,MAAM,IAAIthD,KAAK+1C,UAAUF,KAAKn2C,MAAMiB,EAAEm0D,mBAAmB,WAAW,GAAG,MAAMl4D,KAAKm4D,OAAoH,IAAIn4D,KAAKm4D,QAAQpuD,QAAQqT,KAAK,0BAA0Bpd,KAAKm4D,OAAO,KAAKn4D,KAAKo4D,WAAW,QAAQlkD,EAAEmI,SAArO,CAAsB,IAAItY,EAAE,KAAK,IAAIA,EAAEs0D,KAAKr7C,MAAMhd,KAAKs4D,cAAc,MAAM3yD,GAAG,OAAmBuO,EAAE86C,SAAS37C,KAAKa,EAAEuI,OAAO,KAAK1Y,KAA4GA,EAAEw0D,KAAK,MAAMvtD,GAAE,GAAIjH,EAAEy0D,iBAAiB,SAAS,oBAAoBz0D,EAAEy0D,iBAAiB,eAAe,oBAAoBz0D,EAAE00D,KAAK,O,cCDnsCp5D,EAAOC,QAAU,CACf,KAAQ,EACR,SAAY,GACZ,gBAAmB,CACjB,OAAU,EACV,cAAgB,EAChB,cAAiB,EACjB,MAAS,EACT,UAAa,GACb,eAAkB,IAEpB,eAAiB,EACjB,MAAS,CACP,CACE,GAAM,EACN,EAAK,EACL,EAAK,EACL,EAAK,EACL,UAAY,EACZ,SAAY,IAEd,CACE,EAAK,EACL,GAAM,EACN,EAAK,EACL,EAAK,EACL,UAAY,EACZ,SAAY,IAEd,CACE,EAAK,EACL,EAAK,EACL,EAAK,EACL,EAAK,EACL,UAAY,EACZ,SAAY,IAEd,CACE,EAAK,EACL,GAAM,EACN,EAAK,EACL,EAAK,EACL,UAAY,EACZ,SAAY,IAEd,CACE,GAAM,EACN,EAAK,EACL,EAAK,EACL,EAAK,EACL,UAAY,EACZ,SAAY,IAEd,CACE,EAAK,EACL,EAAK,EACL,GAAM,EACN,EAAK,EACL,UAAY,EACZ,SAAY,IAEd,CACE,EAAK,EACL,EAAK,EACL,GAAM,EACN,EAAK,EACL,UAAY,EACZ,SAAY,O,cC7DlBD,EAAOC,QAAQ2oD,UAAY1oD,OAAOqoD,kBAAkB,UAAW,CAC7DC,kBAAmB,CACjB6Q,MAAO,GACP11D,SAAU,CAACG,GAAI,GAAII,EAAG,EAAGuB,EAAG,IAE9BgjD,SAAU,CACR9mB,MAAO,cACP23B,MAAO,cACPC,QAAS,gBACTC,UAAW,kBACXC,kBAAmB,0BACnBvkD,MAAO,cACPwkD,cAAe,sBACft9C,MAAO,cACP+N,QAAS,mBAIbnqB,EAAOC,QAAQub,UAAYtb,OAAOC,kBAAkB,QAAS,CAC3DC,OAAQ,CAENuhC,MAAO,CAACrhC,QAAS,GAAI6F,IAAK,GAC1BmzD,MAAO,CAACh5D,QAAS,GAAI6F,IAAK,GAG1BozD,QAAS,CAACj5D,QAAS,IAGnBk5D,UAAW,CAACl5D,QAAS,IACrBm5D,kBAAmB,CAACn5D,QAAS,IAG7B4U,MAAO,CAAC5U,QAAS,GACjBo5D,cAAe,CAACp5D,QAAS,GAGzB8b,MAAO,CAAC9b,QAAS,UAAW0C,KAAM,SAClCmnB,QAAS,CAAC7pB,QAAS,KAOrBc,KAAM,WACJ,MAAMG,EAAKZ,KAAKY,GACZI,EAAOhB,KAAKgB,KAChB,IAAIwa,EAAW5a,EAAGM,WAAWsa,SAE7B,MAAMvB,EAAW,IAAI5Z,MAAM24D,cAAch4D,EAAKggC,MAAOhgC,EAAK23D,MAAO33D,EAAK43D,QAAS53D,EAAK43D,SACpF3+C,EAAS0sC,gBACT3mD,KAAKi5D,MAAQ,GACb,IAAK,IAAIlmD,EAAGpN,EAAI,EAAGsQ,EAAIgE,EAASuS,SAAS5mB,OAAQD,EAAIsQ,EAAGtQ,IACtDoN,EAAIkH,EAASuS,SAAS7mB,GACtB3F,KAAKi5D,MAAMv+C,KAAK,CACd5V,EAAGiO,EAAEjO,EACLo0D,IAAK91D,KAAK+1C,SAAW/1C,KAAKmC,GAAK,EAC/B4zD,IAAKn4D,EAAK63D,UAAYz1D,KAAK+1C,SAAWn4C,EAAK83D,kBAC3CvkD,OAAQvT,EAAKuT,MAAQnR,KAAK+1C,SAAWn4C,EAAK+3D,eAAiB,MAI1Dv9C,IACHA,EAAW,GACXA,EAASA,SAAW,IAAInb,MAAMmnB,kBAAkB,CAC9C/L,MAAOza,EAAKya,MACZ6N,YAAatoB,EAAKwoB,QAAU,EAC5BA,QAASxoB,EAAKwoB,QACd4vC,QAAS/4D,MAAMg5D,eAInBr5D,KAAKk0B,KAAO,IAAI7zB,MAAM2yB,KAAK/Y,EAAUuB,EAASA,UAC9C5a,EAAGib,YAAY,OAAQ7b,KAAKk0B,OAG9B/vB,OAAQ,WACNnE,KAAKY,GAAGmb,eAAe,SAGzBjY,KAAM,SAAUC,EAAGC,GACjB,IAAKA,EAAI,OAET,MAAMs1D,EAAQt5D,KAAKk0B,KAAKja,SAASuS,SACjC,IAAK,IAAIzZ,EAAGwmD,EAAQ5zD,EAAI,EAAIoN,EAAIumD,EAAM3zD,GAAKA,IACzC4zD,EAASv5D,KAAKi5D,MAAMtzD,GACpBoN,EAAEjO,EAAIy0D,EAAOz0D,EAAI1B,KAAKgsD,IAAImK,EAAOL,KAAOK,EAAOJ,IAC/CI,EAAOL,KAAOK,EAAOhlD,MAAQvQ,EAE/BhE,KAAKk0B,KAAKja,SAAS2yC,oBAAqB,M,cCtF5CvtD,EAAOC,QAAQ2oD,UAAY1oD,OAAOqoD,kBAAkB,SAAU,CAC5DC,kBAAmB,CACjB2R,KAAgB,IAElB1R,SAAU,CACRprC,KAAgB,YAChB+8C,SAAgB,gBAChB9c,OAAgB,cAChB,kBAAmB,sBACnBqJ,OAAgB,iBAIpB3mD,EAAOC,QAAQub,UAAYtb,OAAOC,kBAAkB,OAAQ,CAC1DC,OAAQ,CACNid,KAAgB,CAAC/c,QAAS,IAC1B85D,SAAgB,CAAC95D,QAAS,IAC1Bg9C,OAAgB,CAACh9C,QAAS,GAC1B+5D,eAAgB,CAAC/5D,QAAS,GAC1BqmD,OAAgB,CAACrmD,SAAS,IAG5BI,KAAM,WACJ,MAAMa,EAAKZ,KAAKY,GACZI,EAAOhB,KAAKgB,KAChB,IAAIwa,EAAW5a,EAAGM,WAAWsa,SAE7B,IAAKxa,EAAK0b,KAAK9W,OAEb,YADAmE,QAAQsnB,MAAM,oDAIhB,MAAMigB,EAAQ,IAAIjxC,MAAMs5D,iBAAiB34D,EAAK0b,KAAKrC,KAAI,SAAU4oC,GAE/D,OADAA,EAAQA,EAAM7oC,MAAM,KACb,IAAI/Z,MAAMC,QAAQikD,OAAOtB,EAAM,IAAKsB,OAAOtB,EAAM,IAAKsB,OAAOtB,EAAM,SAEtEhpC,EAAW,IAAI5Z,MAAMu5D,aACzBtoB,EAAOtwC,EAAKy4D,SAAUz4D,EAAK27C,OAAQ37C,EAAK04D,eAAgB14D,EAAKglD,QAG1DxqC,IACHA,EAAW,GACXA,EAASA,SAAW,IAAInb,MAAMmnB,mBAGhCxnB,KAAKk0B,KAAO,IAAI7zB,MAAM2yB,KAAK/Y,EAAUuB,EAASA,UAC9Cxb,KAAKY,GAAGib,YAAY,OAAQ7b,KAAKk0B,OAGnCrwB,OAAQ,SAAUqR,GACXpP,OAAOC,KAAKmP,GAAUtP,SAE3B5F,KAAKmE,SACLnE,KAAKD,SAGPoE,OAAQ,WACFnE,KAAKk0B,MAAMl0B,KAAKY,GAAGmb,eAAe","file":"1.bundle.js","sourcesContent":["require('./src/controls');\nrequire('./src/loaders');\nrequire('./src/misc');\nrequire('./src/pathfinding');\nrequire('./src/primitives');\n","require('./checkpoint-controls');\nrequire('./gamepad-controls');\nrequire('./keyboard-controls');\nrequire('./touch-controls');\nrequire('./movement-controls');\nrequire('./trackpad-controls');\n","const EPS = 0.1;\n\nmodule.exports = AFRAME.registerComponent('checkpoint-controls', {\n  schema: {\n    enabled: {default: true},\n    mode: {default: 'teleport', oneOf: ['teleport', 'animate']},\n    animateSpeed: {default: 3.0}\n  },\n\n  init: function () {\n    this.active = true;\n    this.checkpoint = null;\n\n    this.isNavMeshConstrained = false;\n\n    this.offset = new THREE.Vector3();\n    this.position = new THREE.Vector3();\n    this.targetPosition = new THREE.Vector3();\n  },\n\n  play: function () { this.active = true; },\n  pause: function () { this.active = false; },\n\n  setCheckpoint: function (checkpoint) {\n    const el = this.el;\n\n    if (!this.active) return;\n    if (this.checkpoint === checkpoint) return;\n\n    if (this.checkpoint) {\n      el.emit('navigation-end', {checkpoint: this.checkpoint});\n    }\n\n    this.checkpoint = checkpoint;\n    this.sync();\n\n    // Ignore new checkpoint if we're already there.\n    if (this.position.distanceTo(this.targetPosition) < EPS) {\n      this.checkpoint = null;\n      return;\n    }\n\n    el.emit('navigation-start', {checkpoint: checkpoint});\n\n    if (this.data.mode === 'teleport') {\n      this.el.setAttribute('position', this.targetPosition);\n      this.checkpoint = null;\n      el.emit('navigation-end', {checkpoint: checkpoint});\n      el.components['movement-controls'].updateNavLocation();\n    }\n  },\n\n  isVelocityActive: function () {\n    return !!(this.active && this.checkpoint);\n  },\n\n  getVelocity: function () {\n    if (!this.active) return;\n\n    const data = this.data;\n    const offset = this.offset;\n    const position = this.position;\n    const targetPosition = this.targetPosition;\n    const checkpoint = this.checkpoint;\n\n    this.sync();\n    if (position.distanceTo(targetPosition) < EPS) {\n      this.checkpoint = null;\n      this.el.emit('navigation-end', {checkpoint: checkpoint});\n      return offset.set(0, 0, 0);\n    }\n    offset.setLength(data.animateSpeed);\n    return offset;\n  },\n\n  sync: function () {\n    const offset = this.offset;\n    const position = this.position;\n    const targetPosition = this.targetPosition;\n\n    position.copy(this.el.getAttribute('position'));\n    this.checkpoint.object3D.getWorldPosition(targetPosition);\n    targetPosition.add(this.checkpoint.components.checkpoint.getOffset());\n    offset.copy(targetPosition).sub(position);\n  }\n});\n","/**\n * Gamepad controls for A-Frame.\n *\n * Stripped-down version of: https://github.com/donmccurdy/aframe-gamepad-controls\n *\n * For more information about the Gamepad API, see:\n * https://developer.mozilla.org/en-US/docs/Web/API/Gamepad_API/Using_the_Gamepad_API\n */\n\nconst GamepadButton = require('../../lib/GamepadButton'),\n    GamepadButtonEvent = require('../../lib/GamepadButtonEvent');\n\nconst JOYSTICK_EPS = 0.2;\n\nconst Joystick = {\n  MOVEMENT: 1,\n  ROTATION: 2\n};\n\nmodule.exports = AFRAME.registerComponent('gamepad-controls', {\n\n  /*******************************************************************\n   * Statics\n   */\n\n  GamepadButton: GamepadButton,\n\n  /*******************************************************************\n   * Schema\n   */\n\n  schema: {\n    // Controller 0-3\n    controller:        { default: 0, oneOf: [0, 1, 2, 3] },\n\n    // Enable/disable features\n    enabled:           { default: true },\n\n    // Debugging\n    debug:             { default: false },\n\n    // Heading element for rotation\n    camera:          { default: '[camera]', type: 'selector' },\n\n    // Rotation sensitivity\n    rotationSensitivity:  { default: 2.0 },\n  },\n\n  /*******************************************************************\n   * Core\n   */\n\n  /**\n   * Called once when component is attached. Generally for initial setup.\n   */\n  init: function () {\n    const sceneEl = this.el.sceneEl;\n\n    this.system = sceneEl.systems['tracked-controls-webxr'] || {controllers: []};\n\n    this.prevTime = window.performance.now();\n\n    // Button state\n    this.buttons = {};\n\n    // Rotation\n    const rotation = this.el.object3D.rotation;\n    this.pitch = new THREE.Object3D();\n    this.pitch.rotation.x = THREE.Math.degToRad(rotation.x);\n    this.yaw = new THREE.Object3D();\n    this.yaw.position.y = 10;\n    this.yaw.rotation.y = THREE.Math.degToRad(rotation.y);\n    this.yaw.add(this.pitch);\n\n    this._lookVector = new THREE.Vector2();\n    this._moveVector = new THREE.Vector2();\n    this._dpadVector = new THREE.Vector2();\n\n    sceneEl.addBehavior(this);\n  },\n\n  /**\n   * Called when component is attached and when component data changes.\n   * Generally modifies the entity based on the data.\n   */\n  update: function () { this.tick(); },\n\n  /**\n   * Called on each iteration of main render loop.\n   */\n  tick: function (t, dt) {\n    this.updateButtonState();\n    this.updateRotation(dt);\n  },\n\n  /**\n   * Called when a component is removed (e.g., via removeAttribute).\n   * Generally undoes all modifications to the entity.\n   */\n  remove: function () { },\n\n  /*******************************************************************\n   * Movement\n   */\n\n  isVelocityActive: function () {\n    if (!this.data.enabled || !this.isConnected()) return false;\n\n    const dpad = this._dpadVector;\n    const joystick = this._moveVector;\n\n    this.getDpad(dpad);\n    this.getJoystick(Joystick.MOVEMENT, joystick);\n\n    const inputX = dpad.x || joystick.x;\n    const inputY = dpad.y || joystick.y;\n\n    return Math.abs(inputX) > JOYSTICK_EPS || Math.abs(inputY) > JOYSTICK_EPS;\n  },\n\n  getVelocityDelta: function () {\n    const dpad = this._dpadVector;\n    const joystick = this._moveVector;\n\n    this.getDpad(dpad);\n    this.getJoystick(Joystick.MOVEMENT, joystick);\n\n    const inputX = dpad.x || joystick.x;\n    const inputY = dpad.y || joystick.y;\n    const dVelocity = new THREE.Vector3();\n\n    if (Math.abs(inputX) > JOYSTICK_EPS) {\n      dVelocity.x += inputX;\n    }\n    if (Math.abs(inputY) > JOYSTICK_EPS) {\n      dVelocity.z += inputY;\n    }\n\n    return dVelocity;\n  },\n\n  /*******************************************************************\n   * Rotation\n   */\n\n  isRotationActive: function () {\n    if (!this.data.enabled || !this.isConnected()) return false;\n\n    const joystick = this._lookVector;\n\n    this.getJoystick(Joystick.ROTATION, joystick);\n\n    return Math.abs(joystick.x) > JOYSTICK_EPS || Math.abs(joystick.y) > JOYSTICK_EPS;\n  },\n\n  updateRotation: function (dt) {\n    if (!this.isRotationActive()) return;\n\n    const data = this.data;\n    const yaw = this.yaw;\n    const pitch = this.pitch;\n    const lookControls = data.camera.components['look-controls'];\n    const hasLookControls = lookControls && lookControls.pitchObject && lookControls.yawObject;\n\n    // Sync with look-controls pitch/yaw if available.\n    if (hasLookControls) {\n      pitch.rotation.copy(lookControls.pitchObject.rotation);\n      yaw.rotation.copy(lookControls.yawObject.rotation);\n    }\n\n    const lookVector = this._lookVector;\n\n    this.getJoystick(Joystick.ROTATION, lookVector);\n\n    if (Math.abs(lookVector.x) <= JOYSTICK_EPS) lookVector.x = 0;\n    if (Math.abs(lookVector.y) <= JOYSTICK_EPS) lookVector.y = 0;\n\n    lookVector.multiplyScalar(data.rotationSensitivity * dt / 1000);\n    yaw.rotation.y -= lookVector.x;\n    pitch.rotation.x -= lookVector.y;\n    pitch.rotation.x = Math.max(- Math.PI / 2, Math.min(Math.PI / 2, pitch.rotation.x));\n    data.camera.object3D.rotation.set(pitch.rotation.x, yaw.rotation.y, 0);\n\n    // Sync with look-controls pitch/yaw if available.\n    if (hasLookControls) {\n      lookControls.pitchObject.rotation.copy(pitch.rotation);\n      lookControls.yawObject.rotation.copy(yaw.rotation);\n    }\n  },\n\n  /*******************************************************************\n   * Button events\n   */\n\n  updateButtonState: function () {\n    const gamepad = this.getGamepad();\n    if (this.data.enabled && gamepad) {\n\n      // Fire DOM events for button state changes.\n      for (var i = 0; i < gamepad.buttons.length; i++) {\n        if (gamepad.buttons[i].pressed && !this.buttons[i]) {\n          this.emit(new GamepadButtonEvent('gamepadbuttondown', i, gamepad.buttons[i]));\n        } else if (!gamepad.buttons[i].pressed && this.buttons[i]) {\n          this.emit(new GamepadButtonEvent('gamepadbuttonup', i, gamepad.buttons[i]));\n        }\n        this.buttons[i] = gamepad.buttons[i].pressed;\n      }\n\n    } else if (Object.keys(this.buttons)) {\n      // Reset state if controls are disabled or controller is lost.\n      this.buttons = {};\n    }\n  },\n\n  emit: function (event) {\n    // Emit original event.\n    this.el.emit(event.type, event);\n\n    // Emit convenience event, identifying button index.\n    this.el.emit(\n      event.type + ':' + event.index,\n      new GamepadButtonEvent(event.type, event.index, event)\n    );\n  },\n\n  /*******************************************************************\n   * Gamepad state\n   */\n\n  /**\n   * Returns the Gamepad instance attached to the component. If connected,\n   * a proxy-controls component may provide access to Gamepad input from a\n   * remote device.\n   *\n   * @return {Gamepad}\n   */\n  getGamepad: function () {\n    const stdGamepad = navigator.getGamepads\n          && navigator.getGamepads()[this.data.controller],\n        xrController = this.system.controllers[this.data.controller],\n        xrGamepad = xrController && xrController.gamepad,\n        proxyControls = this.el.sceneEl.components['proxy-controls'],\n        proxyGamepad = proxyControls && proxyControls.isConnected()\n          && proxyControls.getGamepad(this.data.controller);\n    return proxyGamepad || xrGamepad || stdGamepad;\n  },\n\n  /**\n   * Returns the state of the given button.\n   * @param  {number} index The button (0-N) for which to find state.\n   * @return {GamepadButton}\n   */\n  getButton: function (index) {\n    return this.getGamepad().buttons[index];\n  },\n\n  /**\n   * Returns state of the given axis. Axes are labelled 0-N, where 0-1 will\n   * represent X/Y on the first joystick, and 2-3 X/Y on the second.\n   * @param  {number} index The axis (0-N) for which to find state.\n   * @return {number} On the interval [-1,1].\n   */\n  getAxis: function (index) {\n    return this.getGamepad().axes[index];\n  },\n\n  /**\n   * Returns the state of the specified joystick as a THREE.Vector2.\n   * @param  {Joystick} role\n   * @param  {THREE.Vector2} target\n   * @return {THREE.Vector2}\n   */\n  getJoystick: function (index, target) {\n    const gamepad = this.getGamepad();\n    if (gamepad.mapping === 'xr-standard') {\n      // See: https://github.com/donmccurdy/aframe-extras/issues/307\n      switch (index) {\n        case Joystick.MOVEMENT: return target.set(gamepad.axes[2], gamepad.axes[3]);\n        case Joystick.ROTATION: return target.set(gamepad.axes[0], gamepad.axes[1]);\n      }\n    } else {\n      switch (index) {\n        case Joystick.MOVEMENT: return target.set(gamepad.axes[0], gamepad.axes[1]);\n        case Joystick.ROTATION: return target.set(gamepad.axes[2], gamepad.axes[3]);\n      }\n    }\n    throw new Error('Unexpected joystick index \"%d\".', index);\n  },\n\n  /**\n   * Returns the state of the dpad as a THREE.Vector2.\n   * @param {THREE.Vector2} target\n   * @return {THREE.Vector2}\n   */\n  getDpad: function (target) {\n    const gamepad = this.getGamepad();\n    if (!gamepad.buttons[GamepadButton.DPAD_RIGHT]) {\n      return target.set(0, 0);\n    }\n    return target.set(\n      (gamepad.buttons[GamepadButton.DPAD_RIGHT].pressed ? 1 : 0)\n      + (gamepad.buttons[GamepadButton.DPAD_LEFT].pressed ? -1 : 0),\n      (gamepad.buttons[GamepadButton.DPAD_UP].pressed ? -1 : 0)\n      + (gamepad.buttons[GamepadButton.DPAD_DOWN].pressed ? 1 : 0)\n    );\n  },\n\n  /**\n   * Returns true if the gamepad is currently connected to the system.\n   * @return {boolean}\n   */\n  isConnected: function () {\n    const gamepad = this.getGamepad();\n    return !!(gamepad && gamepad.connected);\n  },\n\n  /**\n   * Returns a string containing some information about the controller. Result\n   * may vary across browsers, for a given controller.\n   * @return {string}\n   */\n  getID: function () {\n    return this.getGamepad().id;\n  }\n});\n","module.exports = Object.assign(function GamepadButton () {}, {\n\tFACE_1: 0,\n\tFACE_2: 1,\n\tFACE_3: 2,\n\tFACE_4: 3,\n\n\tL_SHOULDER_1: 4,\n\tR_SHOULDER_1: 5,\n\tL_SHOULDER_2: 6,\n\tR_SHOULDER_2: 7,\n\n\tSELECT: 8,\n\tSTART: 9,\n\n\tDPAD_UP: 12,\n\tDPAD_DOWN: 13,\n\tDPAD_LEFT: 14,\n\tDPAD_RIGHT: 15,\n\n\tVENDOR: 16,\n});\n","function GamepadButtonEvent (type, index, details) {\n  this.type = type;\n  this.index = index;\n  this.pressed = details.pressed;\n  this.value = details.value;\n}\n\nmodule.exports = GamepadButtonEvent;\n","require('../../lib/keyboard.polyfill');\n\nconst MAX_DELTA = 0.2,\n    PROXY_FLAG = '__keyboard-controls-proxy';\n\nconst KeyboardEvent = window.KeyboardEvent;\n\n/**\n * Keyboard Controls component.\n *\n * Stripped-down version of: https://github.com/donmccurdy/aframe-keyboard-controls\n *\n * Bind keyboard events to components, or control your entities with the WASD keys.\n *\n * Why use KeyboardEvent.code? \"This is set to a string representing the key that was pressed to\n * generate the KeyboardEvent, without taking the current keyboard layout (e.g., QWERTY vs.\n * Dvorak), locale (e.g., English vs. French), or any modifier keys into account. This is useful\n * when you care about which physical key was pressed, rather thanwhich character it corresponds\n * to. For example, if youre a writing a game, you might want a certain set of keys to move the\n * player in different directions, and that mapping should ideally be independent of keyboard\n * layout. See: https://developers.google.com/web/updates/2016/04/keyboardevent-keys-codes\n *\n * @namespace wasd-controls\n * keys the entity moves and if you release it will stop. Easing simulates friction.\n * to the entity when pressing the keys.\n * @param {bool} [enabled=true] - To completely enable or disable the controls\n */\nmodule.exports = AFRAME.registerComponent('keyboard-controls', {\n  schema: {\n    enabled:           { default: true },\n    debug:             { default: false }\n  },\n\n  init: function () {\n    this.dVelocity = new THREE.Vector3();\n    this.localKeys = {};\n    this.listeners = {\n      keydown: this.onKeyDown.bind(this),\n      keyup: this.onKeyUp.bind(this),\n      blur: this.onBlur.bind(this)\n    };\n    this.attachEventListeners();\n  },\n\n  /*******************************************************************\n  * Movement\n  */\n\n  isVelocityActive: function () {\n    return this.data.enabled && !!Object.keys(this.getKeys()).length;\n  },\n\n  getVelocityDelta: function () {\n    const data = this.data,\n        keys = this.getKeys();\n\n    this.dVelocity.set(0, 0, 0);\n    if (data.enabled) {\n      if (keys.KeyW || keys.ArrowUp)    { this.dVelocity.z -= 1; }\n      if (keys.KeyA || keys.ArrowLeft)  { this.dVelocity.x -= 1; }\n      if (keys.KeyS || keys.ArrowDown)  { this.dVelocity.z += 1; }\n      if (keys.KeyD || keys.ArrowRight) { this.dVelocity.x += 1; }\n    }\n\n    return this.dVelocity.clone();\n  },\n\n  /*******************************************************************\n  * Events\n  */\n\n  play: function () {\n    this.attachEventListeners();\n  },\n\n  pause: function () {\n    this.removeEventListeners();\n  },\n\n  remove: function () {\n    this.pause();\n  },\n\n  attachEventListeners: function () {\n    window.addEventListener('keydown', this.listeners.keydown, false);\n    window.addEventListener('keyup', this.listeners.keyup, false);\n    window.addEventListener('blur', this.listeners.blur, false);\n  },\n\n  removeEventListeners: function () {\n    window.removeEventListener('keydown', this.listeners.keydown);\n    window.removeEventListener('keyup', this.listeners.keyup);\n    window.removeEventListener('blur', this.listeners.blur);\n  },\n\n  onKeyDown: function (event) {\n    if (AFRAME.utils.shouldCaptureKeyEvent(event)) {\n      this.localKeys[event.code] = true;\n      this.emit(event);\n    }\n  },\n\n  onKeyUp: function (event) {\n    if (AFRAME.utils.shouldCaptureKeyEvent(event)) {\n      delete this.localKeys[event.code];\n      this.emit(event);\n    }\n  },\n\n  onBlur: function () {\n    for (let code in this.localKeys) {\n      if (this.localKeys.hasOwnProperty(code)) {\n        delete this.localKeys[code];\n      }\n    }\n  },\n\n  emit: function (event) {\n    // TODO - keydown only initially?\n    // TODO - where the f is the spacebar\n\n    // Emit original event.\n    if (PROXY_FLAG in event) {\n      // TODO - Method never triggered.\n      this.el.emit(event.type, event);\n    }\n\n    // Emit convenience event, identifying key.\n    this.el.emit(event.type + ':' + event.code, new KeyboardEvent(event.type, event));\n    if (this.data.debug) console.log(event.type + ':' + event.code);\n  },\n\n  /*******************************************************************\n  * Accessors\n  */\n\n  isPressed: function (code) {\n    return code in this.getKeys();\n  },\n\n  getKeys: function () {\n    if (this.isProxied()) {\n      return this.el.sceneEl.components['proxy-controls'].getKeyboard();\n    }\n    return this.localKeys;\n  },\n\n  isProxied: function () {\n    const proxyControls = this.el.sceneEl.components['proxy-controls'];\n    return proxyControls && proxyControls.isConnected();\n  }\n\n});\n","/**\n * Polyfill for the additional KeyboardEvent properties defined in the D3E and\n * D4E draft specifications, by @inexorabletash.\n *\n * See: https://github.com/inexorabletash/polyfill\n */\n(function(global) {\n  var nativeKeyboardEvent = ('KeyboardEvent' in global);\n  if (!nativeKeyboardEvent)\n    global.KeyboardEvent = function KeyboardEvent() { throw TypeError('Illegal constructor'); };\n\n  if (!('DOM_KEY_LOCATION_STANDARD' in global.KeyboardEvent)) global.KeyboardEvent.DOM_KEY_LOCATION_STANDARD = 0x00; // Default or unknown location\n  if (!('DOM_KEY_LOCATION_LEFT' in global.KeyboardEvent)) global.KeyboardEvent.DOM_KEY_LOCATION_LEFT          = 0x01; // e.g. Left Alt key\n  if (!('DOM_KEY_LOCATION_RIGHT' in global.KeyboardEvent)) global.KeyboardEvent.DOM_KEY_LOCATION_RIGHT         = 0x02; // e.g. Right Alt key\n  if (!('DOM_KEY_LOCATION_NUMPAD' in global.KeyboardEvent)) global.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD        = 0x03; // e.g. Numpad 0 or +\n\n  var STANDARD = window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,\n      LEFT = window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,\n      RIGHT = window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,\n      NUMPAD = window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;\n\n  //--------------------------------------------------------------------\n  //\n  // Utilities\n  //\n  //--------------------------------------------------------------------\n\n  function contains(s, ss) { return String(s).indexOf(ss) !== -1; }\n\n  var os = (function() {\n    if (contains(navigator.platform, 'Win')) { return 'win'; }\n    if (contains(navigator.platform, 'Mac')) { return 'mac'; }\n    if (contains(navigator.platform, 'CrOS')) { return 'cros'; }\n    if (contains(navigator.platform, 'Linux')) { return 'linux'; }\n    if (contains(navigator.userAgent, 'iPad') || contains(navigator.platform, 'iPod') || contains(navigator.platform, 'iPhone')) { return 'ios'; }\n    return '';\n  } ());\n\n  var browser = (function() {\n    if (contains(navigator.userAgent, 'Chrome/')) { return 'chrome'; }\n    if (contains(navigator.vendor, 'Apple')) { return 'safari'; }\n    if (contains(navigator.userAgent, 'MSIE')) { return 'ie'; }\n    if (contains(navigator.userAgent, 'Gecko/')) { return 'moz'; }\n    if (contains(navigator.userAgent, 'Opera/')) { return 'opera'; }\n    return '';\n  } ());\n\n  var browser_os = browser + '-' + os;\n\n  function mergeIf(baseTable, select, table) {\n    if (browser_os === select || browser === select || os === select) {\n      Object.keys(table).forEach(function(keyCode) {\n        baseTable[keyCode] = table[keyCode];\n      });\n    }\n  }\n\n  function remap(o, key) {\n    var r = {};\n    Object.keys(o).forEach(function(k) {\n      var item = o[k];\n      if (key in item) {\n        r[item[key]] = item;\n      }\n    });\n    return r;\n  }\n\n  function invert(o) {\n    var r = {};\n    Object.keys(o).forEach(function(k) {\n      r[o[k]] = k;\n    });\n    return r;\n  }\n\n  //--------------------------------------------------------------------\n  //\n  // Generic Mappings\n  //\n  //--------------------------------------------------------------------\n\n  // \"keyInfo\" is a dictionary:\n  //   code: string - name from DOM Level 3 KeyboardEvent code Values\n  //     https://dvcs.w3.org/hg/dom3events/raw-file/tip/html/DOM3Events-code.html\n  //   location (optional): number - one of the DOM_KEY_LOCATION values\n  //   keyCap (optional): string - keyboard label in en-US locale\n  // USB code Usage ID from page 0x07 unless otherwise noted (Informative)\n\n  // Map of keyCode to keyInfo\n  var keyCodeToInfoTable = {\n    // 0x01 - VK_LBUTTON\n    // 0x02 - VK_RBUTTON\n    0x03: { code: 'Cancel' }, // [USB: 0x9b] char \\x0018 ??? (Not in D3E)\n    // 0x04 - VK_MBUTTON\n    // 0x05 - VK_XBUTTON1\n    // 0x06 - VK_XBUTTON2\n    0x06: { code: 'Help' }, // [USB: 0x75] ???\n    // 0x07 - undefined\n    0x08: { code: 'Backspace' }, // [USB: 0x2a] Labelled Delete on Macintosh keyboards.\n    0x09: { code: 'Tab' }, // [USB: 0x2b]\n    // 0x0A-0x0B - reserved\n    0X0C: { code: 'Clear' }, // [USB: 0x9c] NumPad Center (Not in D3E)\n    0X0D: { code: 'Enter' }, // [USB: 0x28]\n    // 0x0E-0x0F - undefined\n\n    0x10: { code: 'Shift' },\n    0x11: { code: 'Control' },\n    0x12: { code: 'Alt' },\n    0x13: { code: 'Pause' }, // [USB: 0x48]\n    0x14: { code: 'CapsLock' }, // [USB: 0x39]\n    0x15: { code: 'KanaMode' }, // [USB: 0x88] - \"HangulMode\" for Korean layout\n    0x16: { code: 'HangulMode' }, // [USB: 0x90] 0x15 as well in MSDN VK table ???\n    0x17: { code: 'JunjaMode' }, // (Not in D3E)\n    0x18: { code: 'FinalMode' }, // (Not in D3E)\n    0x19: { code: 'KanjiMode' }, // [USB: 0x91] - \"HanjaMode\" for Korean layout\n    // 0x1A - undefined\n    0x1B: { code: 'Escape' }, // [USB: 0x29]\n    0x1C: { code: 'Convert' }, // [USB: 0x8a]\n    0x1D: { code: 'NonConvert' }, // [USB: 0x8b]\n    0x1E: { code: 'Accept' }, // (Not in D3E)\n    0x1F: { code: 'ModeChange' }, // (Not in D3E)\n\n    0x20: { code: 'Space' }, // [USB: 0x2c]\n    0x21: { code: 'PageUp' }, // [USB: 0x4b]\n    0x22: { code: 'PageDown' }, // [USB: 0x4e]\n    0x23: { code: 'End' }, // [USB: 0x4d]\n    0x24: { code: 'Home' }, // [USB: 0x4a]\n    0x25: { code: 'ArrowLeft' }, // [USB: 0x50]\n    0x26: { code: 'ArrowUp' }, // [USB: 0x52]\n    0x27: { code: 'ArrowRight' }, // [USB: 0x4f]\n    0x28: { code: 'ArrowDown' }, // [USB: 0x51]\n    0x29: { code: 'Select' }, // (Not in D3E)\n    0x2A: { code: 'Print' }, // (Not in D3E)\n    0x2B: { code: 'Execute' }, // [USB: 0x74] (Not in D3E)\n    0x2C: { code: 'PrintScreen' }, // [USB: 0x46]\n    0x2D: { code: 'Insert' }, // [USB: 0x49]\n    0x2E: { code: 'Delete' }, // [USB: 0x4c]\n    0x2F: { code: 'Help' }, // [USB: 0x75] ???\n\n    0x30: { code: 'Digit0', keyCap: '0' }, // [USB: 0x27] 0)\n    0x31: { code: 'Digit1', keyCap: '1' }, // [USB: 0x1e] 1!\n    0x32: { code: 'Digit2', keyCap: '2' }, // [USB: 0x1f] 2@\n    0x33: { code: 'Digit3', keyCap: '3' }, // [USB: 0x20] 3#\n    0x34: { code: 'Digit4', keyCap: '4' }, // [USB: 0x21] 4$\n    0x35: { code: 'Digit5', keyCap: '5' }, // [USB: 0x22] 5%\n    0x36: { code: 'Digit6', keyCap: '6' }, // [USB: 0x23] 6^\n    0x37: { code: 'Digit7', keyCap: '7' }, // [USB: 0x24] 7&\n    0x38: { code: 'Digit8', keyCap: '8' }, // [USB: 0x25] 8*\n    0x39: { code: 'Digit9', keyCap: '9' }, // [USB: 0x26] 9(\n    // 0x3A-0x40 - undefined\n\n    0x41: { code: 'KeyA', keyCap: 'a' }, // [USB: 0x04]\n    0x42: { code: 'KeyB', keyCap: 'b' }, // [USB: 0x05]\n    0x43: { code: 'KeyC', keyCap: 'c' }, // [USB: 0x06]\n    0x44: { code: 'KeyD', keyCap: 'd' }, // [USB: 0x07]\n    0x45: { code: 'KeyE', keyCap: 'e' }, // [USB: 0x08]\n    0x46: { code: 'KeyF', keyCap: 'f' }, // [USB: 0x09]\n    0x47: { code: 'KeyG', keyCap: 'g' }, // [USB: 0x0a]\n    0x48: { code: 'KeyH', keyCap: 'h' }, // [USB: 0x0b]\n    0x49: { code: 'KeyI', keyCap: 'i' }, // [USB: 0x0c]\n    0x4A: { code: 'KeyJ', keyCap: 'j' }, // [USB: 0x0d]\n    0x4B: { code: 'KeyK', keyCap: 'k' }, // [USB: 0x0e]\n    0x4C: { code: 'KeyL', keyCap: 'l' }, // [USB: 0x0f]\n    0x4D: { code: 'KeyM', keyCap: 'm' }, // [USB: 0x10]\n    0x4E: { code: 'KeyN', keyCap: 'n' }, // [USB: 0x11]\n    0x4F: { code: 'KeyO', keyCap: 'o' }, // [USB: 0x12]\n\n    0x50: { code: 'KeyP', keyCap: 'p' }, // [USB: 0x13]\n    0x51: { code: 'KeyQ', keyCap: 'q' }, // [USB: 0x14]\n    0x52: { code: 'KeyR', keyCap: 'r' }, // [USB: 0x15]\n    0x53: { code: 'KeyS', keyCap: 's' }, // [USB: 0x16]\n    0x54: { code: 'KeyT', keyCap: 't' }, // [USB: 0x17]\n    0x55: { code: 'KeyU', keyCap: 'u' }, // [USB: 0x18]\n    0x56: { code: 'KeyV', keyCap: 'v' }, // [USB: 0x19]\n    0x57: { code: 'KeyW', keyCap: 'w' }, // [USB: 0x1a]\n    0x58: { code: 'KeyX', keyCap: 'x' }, // [USB: 0x1b]\n    0x59: { code: 'KeyY', keyCap: 'y' }, // [USB: 0x1c]\n    0x5A: { code: 'KeyZ', keyCap: 'z' }, // [USB: 0x1d]\n    0x5B: { code: 'OSLeft', location: LEFT }, // [USB: 0xe3]\n    0x5C: { code: 'OSRight', location: RIGHT }, // [USB: 0xe7]\n    0x5D: { code: 'ContextMenu' }, // [USB: 0x65] Context Menu\n    // 0x5E - reserved\n    0x5F: { code: 'Standby' }, // [USB: 0x82] Sleep\n\n    0x60: { code: 'Numpad0', keyCap: '0', location: NUMPAD }, // [USB: 0x62]\n    0x61: { code: 'Numpad1', keyCap: '1', location: NUMPAD }, // [USB: 0x59]\n    0x62: { code: 'Numpad2', keyCap: '2', location: NUMPAD }, // [USB: 0x5a]\n    0x63: { code: 'Numpad3', keyCap: '3', location: NUMPAD }, // [USB: 0x5b]\n    0x64: { code: 'Numpad4', keyCap: '4', location: NUMPAD }, // [USB: 0x5c]\n    0x65: { code: 'Numpad5', keyCap: '5', location: NUMPAD }, // [USB: 0x5d]\n    0x66: { code: 'Numpad6', keyCap: '6', location: NUMPAD }, // [USB: 0x5e]\n    0x67: { code: 'Numpad7', keyCap: '7', location: NUMPAD }, // [USB: 0x5f]\n    0x68: { code: 'Numpad8', keyCap: '8', location: NUMPAD }, // [USB: 0x60]\n    0x69: { code: 'Numpad9', keyCap: '9', location: NUMPAD }, // [USB: 0x61]\n    0x6A: { code: 'NumpadMultiply', keyCap: '*', location: NUMPAD }, // [USB: 0x55]\n    0x6B: { code: 'NumpadAdd', keyCap: '+', location: NUMPAD }, // [USB: 0x57]\n    0x6C: { code: 'NumpadComma', keyCap: ',', location: NUMPAD }, // [USB: 0x85]\n    0x6D: { code: 'NumpadSubtract', keyCap: '-', location: NUMPAD }, // [USB: 0x56]\n    0x6E: { code: 'NumpadDecimal', keyCap: '.', location: NUMPAD }, // [USB: 0x63]\n    0x6F: { code: 'NumpadDivide', keyCap: '/', location: NUMPAD }, // [USB: 0x54]\n\n    0x70: { code: 'F1' }, // [USB: 0x3a]\n    0x71: { code: 'F2' }, // [USB: 0x3b]\n    0x72: { code: 'F3' }, // [USB: 0x3c]\n    0x73: { code: 'F4' }, // [USB: 0x3d]\n    0x74: { code: 'F5' }, // [USB: 0x3e]\n    0x75: { code: 'F6' }, // [USB: 0x3f]\n    0x76: { code: 'F7' }, // [USB: 0x40]\n    0x77: { code: 'F8' }, // [USB: 0x41]\n    0x78: { code: 'F9' }, // [USB: 0x42]\n    0x79: { code: 'F10' }, // [USB: 0x43]\n    0x7A: { code: 'F11' }, // [USB: 0x44]\n    0x7B: { code: 'F12' }, // [USB: 0x45]\n    0x7C: { code: 'F13' }, // [USB: 0x68]\n    0x7D: { code: 'F14' }, // [USB: 0x69]\n    0x7E: { code: 'F15' }, // [USB: 0x6a]\n    0x7F: { code: 'F16' }, // [USB: 0x6b]\n\n    0x80: { code: 'F17' }, // [USB: 0x6c]\n    0x81: { code: 'F18' }, // [USB: 0x6d]\n    0x82: { code: 'F19' }, // [USB: 0x6e]\n    0x83: { code: 'F20' }, // [USB: 0x6f]\n    0x84: { code: 'F21' }, // [USB: 0x70]\n    0x85: { code: 'F22' }, // [USB: 0x71]\n    0x86: { code: 'F23' }, // [USB: 0x72]\n    0x87: { code: 'F24' }, // [USB: 0x73]\n    // 0x88-0x8F - unassigned\n\n    0x90: { code: 'NumLock', location: NUMPAD }, // [USB: 0x53]\n    0x91: { code: 'ScrollLock' }, // [USB: 0x47]\n    // 0x92-0x96 - OEM specific\n    // 0x97-0x9F - unassigned\n\n    // NOTE: 0xA0-0xA5 usually mapped to 0x10-0x12 in browsers\n    0xA0: { code: 'ShiftLeft', location: LEFT }, // [USB: 0xe1]\n    0xA1: { code: 'ShiftRight', location: RIGHT }, // [USB: 0xe5]\n    0xA2: { code: 'ControlLeft', location: LEFT }, // [USB: 0xe0]\n    0xA3: { code: 'ControlRight', location: RIGHT }, // [USB: 0xe4]\n    0xA4: { code: 'AltLeft', location: LEFT }, // [USB: 0xe2]\n    0xA5: { code: 'AltRight', location: RIGHT }, // [USB: 0xe6]\n\n    0xA6: { code: 'BrowserBack' }, // [USB: 0x0c/0x0224]\n    0xA7: { code: 'BrowserForward' }, // [USB: 0x0c/0x0225]\n    0xA8: { code: 'BrowserRefresh' }, // [USB: 0x0c/0x0227]\n    0xA9: { code: 'BrowserStop' }, // [USB: 0x0c/0x0226]\n    0xAA: { code: 'BrowserSearch' }, // [USB: 0x0c/0x0221]\n    0xAB: { code: 'BrowserFavorites' }, // [USB: 0x0c/0x0228]\n    0xAC: { code: 'BrowserHome' }, // [USB: 0x0c/0x0222]\n    0xAD: { code: 'VolumeMute' }, // [USB: 0x7f]\n    0xAE: { code: 'VolumeDown' }, // [USB: 0x81]\n    0xAF: { code: 'VolumeUp' }, // [USB: 0x80]\n\n    0xB0: { code: 'MediaTrackNext' }, // [USB: 0x0c/0x00b5]\n    0xB1: { code: 'MediaTrackPrevious' }, // [USB: 0x0c/0x00b6]\n    0xB2: { code: 'MediaStop' }, // [USB: 0x0c/0x00b7]\n    0xB3: { code: 'MediaPlayPause' }, // [USB: 0x0c/0x00cd]\n    0xB4: { code: 'LaunchMail' }, // [USB: 0x0c/0x018a]\n    0xB5: { code: 'MediaSelect' },\n    0xB6: { code: 'LaunchApp1' },\n    0xB7: { code: 'LaunchApp2' },\n    // 0xB8-0xB9 - reserved\n    0xBA: { code: 'Semicolon',  keyCap: ';' }, // [USB: 0x33] ;: (US Standard 101)\n    0xBB: { code: 'Equal', keyCap: '=' }, // [USB: 0x2e] =+\n    0xBC: { code: 'Comma', keyCap: ',' }, // [USB: 0x36] ,<\n    0xBD: { code: 'Minus', keyCap: '-' }, // [USB: 0x2d] -_\n    0xBE: { code: 'Period', keyCap: '.' }, // [USB: 0x37] .>\n    0xBF: { code: 'Slash', keyCap: '/' }, // [USB: 0x38] /? (US Standard 101)\n\n    0xC0: { code: 'Backquote', keyCap: '`' }, // [USB: 0x35] `~ (US Standard 101)\n    // 0xC1-0xCF - reserved\n\n    // 0xD0-0xD7 - reserved\n    // 0xD8-0xDA - unassigned\n    0xDB: { code: 'BracketLeft', keyCap: '[' }, // [USB: 0x2f] [{ (US Standard 101)\n    0xDC: { code: 'Backslash',  keyCap: '\\\\' }, // [USB: 0x31] \\| (US Standard 101)\n    0xDD: { code: 'BracketRight', keyCap: ']' }, // [USB: 0x30] ]} (US Standard 101)\n    0xDE: { code: 'Quote', keyCap: '\\'' }, // [USB: 0x34] '\" (US Standard 101)\n    // 0xDF - miscellaneous/varies\n\n    // 0xE0 - reserved\n    // 0xE1 - OEM specific\n    0xE2: { code: 'IntlBackslash',  keyCap: '\\\\' }, // [USB: 0x64] \\| (UK Standard 102)\n    // 0xE3-0xE4 - OEM specific\n    0xE5: { code: 'Process' }, // (Not in D3E)\n    // 0xE6 - OEM specific\n    // 0xE7 - VK_PACKET\n    // 0xE8 - unassigned\n    // 0xE9-0xEF - OEM specific\n\n    // 0xF0-0xF5 - OEM specific\n    0xF6: { code: 'Attn' }, // [USB: 0x9a] (Not in D3E)\n    0xF7: { code: 'CrSel' }, // [USB: 0xa3] (Not in D3E)\n    0xF8: { code: 'ExSel' }, // [USB: 0xa4] (Not in D3E)\n    0xF9: { code: 'EraseEof' }, // (Not in D3E)\n    0xFA: { code: 'Play' }, // (Not in D3E)\n    0xFB: { code: 'ZoomToggle' }, // (Not in D3E)\n    // 0xFC - VK_NONAME - reserved\n    // 0xFD - VK_PA1\n    0xFE: { code: 'Clear' } // [USB: 0x9c] (Not in D3E)\n  };\n\n  // No legacy keyCode, but listed in D3E:\n\n  // code: usb\n  // 'IntlHash': 0x070032,\n  // 'IntlRo': 0x070087,\n  // 'IntlYen': 0x070089,\n  // 'NumpadBackspace': 0x0700bb,\n  // 'NumpadClear': 0x0700d8,\n  // 'NumpadClearEntry': 0x0700d9,\n  // 'NumpadMemoryAdd': 0x0700d3,\n  // 'NumpadMemoryClear': 0x0700d2,\n  // 'NumpadMemoryRecall': 0x0700d1,\n  // 'NumpadMemoryStore': 0x0700d0,\n  // 'NumpadMemorySubtract': 0x0700d4,\n  // 'NumpadParenLeft': 0x0700b6,\n  // 'NumpadParenRight': 0x0700b7,\n\n  //--------------------------------------------------------------------\n  //\n  // Browser/OS Specific Mappings\n  //\n  //--------------------------------------------------------------------\n\n  mergeIf(keyCodeToInfoTable,\n          'moz', {\n            0x3B: { code: 'Semicolon', keyCap: ';' }, // [USB: 0x33] ;: (US Standard 101)\n            0x3D: { code: 'Equal', keyCap: '=' }, // [USB: 0x2e] =+\n            0x6B: { code: 'Equal', keyCap: '=' }, // [USB: 0x2e] =+\n            0x6D: { code: 'Minus', keyCap: '-' }, // [USB: 0x2d] -_\n            0xBB: { code: 'NumpadAdd', keyCap: '+', location: NUMPAD }, // [USB: 0x57]\n            0xBD: { code: 'NumpadSubtract', keyCap: '-', location: NUMPAD } // [USB: 0x56]\n          });\n\n  mergeIf(keyCodeToInfoTable,\n          'moz-mac', {\n            0x0C: { code: 'NumLock', location: NUMPAD }, // [USB: 0x53]\n            0xAD: { code: 'Minus', keyCap: '-' } // [USB: 0x2d] -_\n          });\n\n  mergeIf(keyCodeToInfoTable,\n          'moz-win', {\n            0xAD: { code: 'Minus', keyCap: '-' } // [USB: 0x2d] -_\n          });\n\n  mergeIf(keyCodeToInfoTable,\n          'chrome-mac', {\n            0x5D: { code: 'OSRight', location: RIGHT } // [USB: 0xe7]\n          });\n\n  // Windows via Bootcamp (!)\n  if (0) {\n    mergeIf(keyCodeToInfoTable,\n            'chrome-win', {\n              0xC0: { code: 'Quote', keyCap: '\\'' }, // [USB: 0x34] '\" (US Standard 101)\n              0xDE: { code: 'Backslash',  keyCap: '\\\\' }, // [USB: 0x31] \\| (US Standard 101)\n              0xDF: { code: 'Backquote', keyCap: '`' } // [USB: 0x35] `~ (US Standard 101)\n            });\n\n    mergeIf(keyCodeToInfoTable,\n            'ie', {\n              0xC0: { code: 'Quote', keyCap: '\\'' }, // [USB: 0x34] '\" (US Standard 101)\n              0xDE: { code: 'Backslash',  keyCap: '\\\\' }, // [USB: 0x31] \\| (US Standard 101)\n              0xDF: { code: 'Backquote', keyCap: '`' } // [USB: 0x35] `~ (US Standard 101)\n            });\n  }\n\n  mergeIf(keyCodeToInfoTable,\n          'safari', {\n            0x03: { code: 'Enter' }, // [USB: 0x28] old Safari\n            0x19: { code: 'Tab' } // [USB: 0x2b] old Safari for Shift+Tab\n          });\n\n  mergeIf(keyCodeToInfoTable,\n          'ios', {\n            0x0A: { code: 'Enter', location: STANDARD } // [USB: 0x28]\n          });\n\n  mergeIf(keyCodeToInfoTable,\n          'safari-mac', {\n            0x5B: { code: 'OSLeft', location: LEFT }, // [USB: 0xe3]\n            0x5D: { code: 'OSRight', location: RIGHT }, // [USB: 0xe7]\n            0xE5: { code: 'KeyQ', keyCap: 'Q' } // [USB: 0x14] On alternate presses, Ctrl+Q sends this\n          });\n\n  //--------------------------------------------------------------------\n  //\n  // Identifier Mappings\n  //\n  //--------------------------------------------------------------------\n\n  // Cases where newer-ish browsers send keyIdentifier which can be\n  // used to disambiguate keys.\n\n  // keyIdentifierTable[keyIdentifier] -> keyInfo\n\n  var keyIdentifierTable = {};\n  if ('cros' === os) {\n    keyIdentifierTable['U+00A0'] = { code: 'ShiftLeft', location: LEFT };\n    keyIdentifierTable['U+00A1'] = { code: 'ShiftRight', location: RIGHT };\n    keyIdentifierTable['U+00A2'] = { code: 'ControlLeft', location: LEFT };\n    keyIdentifierTable['U+00A3'] = { code: 'ControlRight', location: RIGHT };\n    keyIdentifierTable['U+00A4'] = { code: 'AltLeft', location: LEFT };\n    keyIdentifierTable['U+00A5'] = { code: 'AltRight', location: RIGHT };\n  }\n  if ('chrome-mac' === browser_os) {\n    keyIdentifierTable['U+0010'] = { code: 'ContextMenu' };\n  }\n  if ('safari-mac' === browser_os) {\n    keyIdentifierTable['U+0010'] = { code: 'ContextMenu' };\n  }\n  if ('ios' === os) {\n    // These only generate keyup events\n    keyIdentifierTable['U+0010'] = { code: 'Function' };\n\n    keyIdentifierTable['U+001C'] = { code: 'ArrowLeft' };\n    keyIdentifierTable['U+001D'] = { code: 'ArrowRight' };\n    keyIdentifierTable['U+001E'] = { code: 'ArrowUp' };\n    keyIdentifierTable['U+001F'] = { code: 'ArrowDown' };\n\n    keyIdentifierTable['U+0001'] = { code: 'Home' }; // [USB: 0x4a] Fn + ArrowLeft\n    keyIdentifierTable['U+0004'] = { code: 'End' }; // [USB: 0x4d] Fn + ArrowRight\n    keyIdentifierTable['U+000B'] = { code: 'PageUp' }; // [USB: 0x4b] Fn + ArrowUp\n    keyIdentifierTable['U+000C'] = { code: 'PageDown' }; // [USB: 0x4e] Fn + ArrowDown\n  }\n\n  //--------------------------------------------------------------------\n  //\n  // Location Mappings\n  //\n  //--------------------------------------------------------------------\n\n  // Cases where newer-ish browsers send location/keyLocation which\n  // can be used to disambiguate keys.\n\n  // locationTable[location][keyCode] -> keyInfo\n  var locationTable = [];\n  locationTable[LEFT] = {\n    0x10: { code: 'ShiftLeft', location: LEFT }, // [USB: 0xe1]\n    0x11: { code: 'ControlLeft', location: LEFT }, // [USB: 0xe0]\n    0x12: { code: 'AltLeft', location: LEFT } // [USB: 0xe2]\n  };\n  locationTable[RIGHT] = {\n    0x10: { code: 'ShiftRight', location: RIGHT }, // [USB: 0xe5]\n    0x11: { code: 'ControlRight', location: RIGHT }, // [USB: 0xe4]\n    0x12: { code: 'AltRight', location: RIGHT } // [USB: 0xe6]\n  };\n  locationTable[NUMPAD] = {\n    0x0D: { code: 'NumpadEnter', location: NUMPAD } // [USB: 0x58]\n  };\n\n  mergeIf(locationTable[NUMPAD], 'moz', {\n    0x6D: { code: 'NumpadSubtract', location: NUMPAD }, // [USB: 0x56]\n    0x6B: { code: 'NumpadAdd', location: NUMPAD } // [USB: 0x57]\n  });\n  mergeIf(locationTable[LEFT], 'moz-mac', {\n    0xE0: { code: 'OSLeft', location: LEFT } // [USB: 0xe3]\n  });\n  mergeIf(locationTable[RIGHT], 'moz-mac', {\n    0xE0: { code: 'OSRight', location: RIGHT } // [USB: 0xe7]\n  });\n  mergeIf(locationTable[RIGHT], 'moz-win', {\n    0x5B: { code: 'OSRight', location: RIGHT } // [USB: 0xe7]\n  });\n\n\n  mergeIf(locationTable[RIGHT], 'mac', {\n    0x5D: { code: 'OSRight', location: RIGHT } // [USB: 0xe7]\n  });\n\n  mergeIf(locationTable[NUMPAD], 'chrome-mac', {\n    0x0C: { code: 'NumLock', location: NUMPAD } // [USB: 0x53]\n  });\n\n  mergeIf(locationTable[NUMPAD], 'safari-mac', {\n    0x0C: { code: 'NumLock', location: NUMPAD }, // [USB: 0x53]\n    0xBB: { code: 'NumpadAdd', location: NUMPAD }, // [USB: 0x57]\n    0xBD: { code: 'NumpadSubtract', location: NUMPAD }, // [USB: 0x56]\n    0xBE: { code: 'NumpadDecimal', location: NUMPAD }, // [USB: 0x63]\n    0xBF: { code: 'NumpadDivide', location: NUMPAD } // [USB: 0x54]\n  });\n\n\n  //--------------------------------------------------------------------\n  //\n  // Key Values\n  //\n  //--------------------------------------------------------------------\n\n  // Mapping from `code` values to `key` values. Values defined at:\n  // https://dvcs.w3.org/hg/dom3events/raw-file/tip/html/DOM3Events-key.html\n  // Entries are only provided when `key` differs from `code`. If\n  // printable, `shiftKey` has the shifted printable character. This\n  // assumes US Standard 101 layout\n\n  var codeToKeyTable = {\n    // Modifier Keys\n    ShiftLeft: { key: 'Shift' },\n    ShiftRight: { key: 'Shift' },\n    ControlLeft: { key: 'Control' },\n    ControlRight: { key: 'Control' },\n    AltLeft: { key: 'Alt' },\n    AltRight: { key: 'Alt' },\n    OSLeft: { key: 'OS' },\n    OSRight: { key: 'OS' },\n\n    // Whitespace Keys\n    NumpadEnter: { key: 'Enter' },\n    Space: { key: ' ' },\n\n    // Printable Keys\n    Digit0: { key: '0', shiftKey: ')' },\n    Digit1: { key: '1', shiftKey: '!' },\n    Digit2: { key: '2', shiftKey: '@' },\n    Digit3: { key: '3', shiftKey: '#' },\n    Digit4: { key: '4', shiftKey: '$' },\n    Digit5: { key: '5', shiftKey: '%' },\n    Digit6: { key: '6', shiftKey: '^' },\n    Digit7: { key: '7', shiftKey: '&' },\n    Digit8: { key: '8', shiftKey: '*' },\n    Digit9: { key: '9', shiftKey: '(' },\n    KeyA: { key: 'a', shiftKey: 'A' },\n    KeyB: { key: 'b', shiftKey: 'B' },\n    KeyC: { key: 'c', shiftKey: 'C' },\n    KeyD: { key: 'd', shiftKey: 'D' },\n    KeyE: { key: 'e', shiftKey: 'E' },\n    KeyF: { key: 'f', shiftKey: 'F' },\n    KeyG: { key: 'g', shiftKey: 'G' },\n    KeyH: { key: 'h', shiftKey: 'H' },\n    KeyI: { key: 'i', shiftKey: 'I' },\n    KeyJ: { key: 'j', shiftKey: 'J' },\n    KeyK: { key: 'k', shiftKey: 'K' },\n    KeyL: { key: 'l', shiftKey: 'L' },\n    KeyM: { key: 'm', shiftKey: 'M' },\n    KeyN: { key: 'n', shiftKey: 'N' },\n    KeyO: { key: 'o', shiftKey: 'O' },\n    KeyP: { key: 'p', shiftKey: 'P' },\n    KeyQ: { key: 'q', shiftKey: 'Q' },\n    KeyR: { key: 'r', shiftKey: 'R' },\n    KeyS: { key: 's', shiftKey: 'S' },\n    KeyT: { key: 't', shiftKey: 'T' },\n    KeyU: { key: 'u', shiftKey: 'U' },\n    KeyV: { key: 'v', shiftKey: 'V' },\n    KeyW: { key: 'w', shiftKey: 'W' },\n    KeyX: { key: 'x', shiftKey: 'X' },\n    KeyY: { key: 'y', shiftKey: 'Y' },\n    KeyZ: { key: 'z', shiftKey: 'Z' },\n    Numpad0: { key: '0' },\n    Numpad1: { key: '1' },\n    Numpad2: { key: '2' },\n    Numpad3: { key: '3' },\n    Numpad4: { key: '4' },\n    Numpad5: { key: '5' },\n    Numpad6: { key: '6' },\n    Numpad7: { key: '7' },\n    Numpad8: { key: '8' },\n    Numpad9: { key: '9' },\n    NumpadMultiply: { key: '*' },\n    NumpadAdd: { key: '+' },\n    NumpadComma: { key: ',' },\n    NumpadSubtract: { key: '-' },\n    NumpadDecimal: { key: '.' },\n    NumpadDivide: { key: '/' },\n    Semicolon: { key: ';', shiftKey: ':' },\n    Equal: { key: '=', shiftKey: '+' },\n    Comma: { key: ',', shiftKey: '<' },\n    Minus: { key: '-', shiftKey: '_' },\n    Period: { key: '.', shiftKey: '>' },\n    Slash: { key: '/', shiftKey: '?' },\n    Backquote: { key: '`', shiftKey: '~' },\n    BracketLeft: { key: '[', shiftKey: '{' },\n    Backslash: { key: '\\\\', shiftKey: '|' },\n    BracketRight: { key: ']', shiftKey: '}' },\n    Quote: { key: '\\'', shiftKey: '\"' },\n    IntlBackslash: { key: '\\\\', shiftKey: '|' }\n  };\n\n  mergeIf(codeToKeyTable, 'mac', {\n    OSLeft: { key: 'Meta' },\n    OSRight: { key: 'Meta' }\n  });\n\n  // Corrections for 'key' names in older browsers (e.g. FF36-)\n  // https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent.key#Key_values\n  var keyFixTable = {\n    Esc: 'Escape',\n    Nonconvert: 'NonConvert',\n    Left: 'ArrowLeft',\n    Up: 'ArrowUp',\n    Right: 'ArrowRight',\n    Down: 'ArrowDown',\n    Del: 'Delete',\n    Menu: 'ContextMenu',\n    MediaNextTrack: 'MediaTrackNext',\n    MediaPreviousTrack: 'MediaTrackPrevious',\n    SelectMedia: 'MediaSelect',\n    HalfWidth: 'Hankaku',\n    FullWidth: 'Zenkaku',\n    RomanCharacters: 'Romaji',\n    Crsel: 'CrSel',\n    Exsel: 'ExSel',\n    Zoom: 'ZoomToggle'\n  };\n\n  //--------------------------------------------------------------------\n  //\n  // Exported Functions\n  //\n  //--------------------------------------------------------------------\n\n\n  var codeTable = remap(keyCodeToInfoTable, 'code');\n\n  try {\n    var nativeLocation = nativeKeyboardEvent && ('location' in new KeyboardEvent(''));\n  } catch (_) {}\n\n  function keyInfoForEvent(event) {\n    var keyCode = 'keyCode' in event ? event.keyCode : 'which' in event ? event.which : 0;\n\n    var keyInfo = (function(){\n      if (nativeLocation || 'keyLocation' in event) {\n        var location = nativeLocation ? event.location : event.keyLocation;\n        if (location && keyCode in locationTable[location]) {\n          return locationTable[location][keyCode];\n        }\n      }\n      if ('keyIdentifier' in event && event.keyIdentifier in keyIdentifierTable) {\n        return keyIdentifierTable[event.keyIdentifier];\n      }\n      if (keyCode in keyCodeToInfoTable) {\n        return keyCodeToInfoTable[keyCode];\n      }\n      return null;\n    }());\n\n    // TODO: Track these down and move to general tables\n    if (0) {\n      // TODO: Map these for newerish browsers?\n      // TODO: iOS only?\n      // TODO: Override with more common keyIdentifier name?\n      switch (event.keyIdentifier) {\n      case 'U+0010': keyInfo = { code: 'Function' }; break;\n      case 'U+001C': keyInfo = { code: 'ArrowLeft' }; break;\n      case 'U+001D': keyInfo = { code: 'ArrowRight' }; break;\n      case 'U+001E': keyInfo = { code: 'ArrowUp' }; break;\n      case 'U+001F': keyInfo = { code: 'ArrowDown' }; break;\n      }\n    }\n\n    if (!keyInfo)\n      return null;\n\n    var key = (function() {\n      var entry = codeToKeyTable[keyInfo.code];\n      if (!entry) return keyInfo.code;\n      return (event.shiftKey && 'shiftKey' in entry) ? entry.shiftKey : entry.key;\n    }());\n\n    return {\n      code: keyInfo.code,\n      key: key,\n      location: keyInfo.location,\n      keyCap: keyInfo.keyCap\n    };\n  }\n\n  function queryKeyCap(code, locale) {\n    code = String(code);\n    if (!codeTable.hasOwnProperty(code)) return 'Undefined';\n    if (locale && String(locale).toLowerCase() !== 'en-us') throw Error('Unsupported locale');\n    var keyInfo = codeTable[code];\n    return keyInfo.keyCap || keyInfo.code || 'Undefined';\n  }\n\n  if ('KeyboardEvent' in global && 'defineProperty' in Object) {\n    (function() {\n      function define(o, p, v) {\n        if (p in o) return;\n        Object.defineProperty(o, p, v);\n      }\n\n      define(KeyboardEvent.prototype, 'code', { get: function() {\n        var keyInfo = keyInfoForEvent(this);\n        return keyInfo ? keyInfo.code : '';\n      }});\n\n      // Fix for nonstandard `key` values (FF36-)\n      if ('key' in KeyboardEvent.prototype) {\n        var desc = Object.getOwnPropertyDescriptor(KeyboardEvent.prototype, 'key');\n        Object.defineProperty(KeyboardEvent.prototype, 'key', { get: function() {\n          var key = desc.get.call(this);\n          return keyFixTable.hasOwnProperty(key) ? keyFixTable[key] : key;\n        }});\n      }\n\n      define(KeyboardEvent.prototype, 'key', { get: function() {\n        var keyInfo = keyInfoForEvent(this);\n        return (keyInfo && 'key' in keyInfo) ? keyInfo.key : 'Unidentified';\n      }});\n\n      define(KeyboardEvent.prototype, 'location', { get: function() {\n        var keyInfo = keyInfoForEvent(this);\n        return (keyInfo && 'location' in keyInfo) ? keyInfo.location : STANDARD;\n      }});\n\n      define(KeyboardEvent.prototype, 'locale', { get: function() {\n        return '';\n      }});\n    }());\n  }\n\n  if (!('queryKeyCap' in global.KeyboardEvent))\n    global.KeyboardEvent.queryKeyCap = queryKeyCap;\n\n  // Helper for IE8-\n  global.identifyKey = function(event) {\n    if ('code' in event)\n      return;\n\n    var keyInfo = keyInfoForEvent(event);\n    event.code = keyInfo ? keyInfo.code : '';\n    event.key = (keyInfo && 'key' in keyInfo) ? keyInfo.key : 'Unidentified';\n    event.location = ('location' in event) ? event.location :\n      ('keyLocation' in event) ? event.keyLocation :\n      (keyInfo && 'location' in keyInfo) ? keyInfo.location : STANDARD;\n    event.locale = '';\n  };\n\n} (window));\n","/**\n * Touch-to-move-forward controls for mobile.\n */\nmodule.exports = AFRAME.registerComponent('touch-controls', {\n  schema: {\n    enabled: { default: true },\n    reverseEnabled: { default: true }\n  },\n\n  init: function () {\n    this.dVelocity = new THREE.Vector3();\n    this.bindMethods();\n    this.direction = 0;\n  },\n\n  play: function () {\n    this.addEventListeners();\n  },\n\n  pause: function () {\n    this.removeEventListeners();\n    this.dVelocity.set(0, 0, 0);\n  },\n\n  remove: function () {\n    this.pause();\n  },\n\n  addEventListeners: function () {\n    const sceneEl = this.el.sceneEl;\n    const canvasEl = sceneEl.canvas;\n\n    if (!canvasEl) {\n      sceneEl.addEventListener('render-target-loaded', this.addEventListeners.bind(this));\n      return;\n    }\n\n    canvasEl.addEventListener('touchstart', this.onTouchStart);\n    canvasEl.addEventListener('touchend', this.onTouchEnd);\n  },\n\n  removeEventListeners: function () {\n    const canvasEl = this.el.sceneEl && this.el.sceneEl.canvas;\n    if (!canvasEl) { return; }\n\n    canvasEl.removeEventListener('touchstart', this.onTouchStart);\n    canvasEl.removeEventListener('touchend', this.onTouchEnd);\n  },\n\n  isVelocityActive: function () {\n    return this.data.enabled && !!this.direction;\n  },\n\n  getVelocityDelta: function () {\n    this.dVelocity.z = this.direction;\n    return this.dVelocity.clone();\n  },\n\n  bindMethods: function () {\n    this.onTouchStart = this.onTouchStart.bind(this);\n    this.onTouchEnd = this.onTouchEnd.bind(this);\n  },\n\n  onTouchStart: function (e) {\n    this.direction = -1;\n    if (this.data.reverseEnabled && e.touches.length === 2) {\n      this.direction = 1;\n    }\n    e.preventDefault();\n  },\n\n  onTouchEnd: function (e) {\n    this.direction = 0;\n    e.preventDefault();\n  }\n});\n","/**\n * Movement Controls\n *\n * @author Don McCurdy <dm@donmccurdy.com>\n */\n\nconst COMPONENT_SUFFIX = '-controls',\n    MAX_DELTA = 0.2, // ms\n    EPS = 10e-6;\n\nmodule.exports = AFRAME.registerComponent('movement-controls', {\n\n  /*******************************************************************\n   * Schema\n   */\n\n  dependencies: ['rotation'],\n\n  schema: {\n    enabled:            { default: true },\n    controls:           { default: ['gamepad', 'trackpad', 'keyboard', 'touch'] },\n    speed:              { default: 0.3, min: 0 },\n    fly:                { default: false },\n    constrainToNavMesh: { default: false },\n    camera:             { default: '[movement-controls] [camera]', type: 'selector' }\n  },\n\n  /*******************************************************************\n   * Lifecycle\n   */\n\n  init: function () {\n    const el = this.el;\n\n    this.velocityCtrl = null;\n\n    this.velocity = new THREE.Vector3();\n    this.heading = new THREE.Quaternion();\n\n    // Navigation\n    this.navGroup = null;\n    this.navNode = null;\n\n    if (el.sceneEl.hasLoaded) {\n      this.injectControls();\n    } else {\n      el.sceneEl.addEventListener('loaded', this.injectControls.bind(this));\n    }\n  },\n\n  update: function (prevData) {\n    const el = this.el;\n    const data = this.data;\n    const nav = el.sceneEl.systems.nav;\n    if (el.sceneEl.hasLoaded) {\n      this.injectControls();\n    }\n    if (nav && data.constrainToNavMesh !== prevData.constrainToNavMesh) {\n      data.constrainToNavMesh\n        ? nav.addAgent(this)\n        : nav.removeAgent(this);\n    }\n  },\n\n  injectControls: function () {\n    const data = this.data;\n    var name;\n\n    for (let i = 0; i < data.controls.length; i++) {\n      name = data.controls[i] + COMPONENT_SUFFIX;\n      if (!this.el.components[name]) {\n        this.el.setAttribute(name, '');\n      }\n    }\n  },\n\n  updateNavLocation: function () {\n    this.navGroup = null;\n    this.navNode = null;\n  },\n\n  /*******************************************************************\n   * Tick\n   */\n\n  tick: (function () {\n    const start = new THREE.Vector3();\n    const end = new THREE.Vector3();\n    const clampedEnd = new THREE.Vector3();\n\n    return function (t, dt) {\n      if (!dt) return;\n\n      const el = this.el;\n      const data = this.data;\n\n      if (!data.enabled) return;\n\n      this.updateVelocityCtrl();\n      const velocityCtrl = this.velocityCtrl;\n      const velocity = this.velocity;\n\n      if (!velocityCtrl) return;\n\n      // Update velocity. If FPS is too low, reset.\n      if (dt / 1000 > MAX_DELTA) {\n        velocity.set(0, 0, 0);\n      } else {\n        this.updateVelocity(dt);\n      }\n\n      if (data.constrainToNavMesh\n          && velocityCtrl.isNavMeshConstrained !== false) {\n\n        if (velocity.lengthSq() < EPS) return;\n\n        start.copy(el.object3D.position);\n        end\n          .copy(velocity)\n          .multiplyScalar(dt / 1000)\n          .add(start);\n\n        const nav = el.sceneEl.systems.nav;\n        this.navGroup = this.navGroup === null ? nav.getGroup(start) : this.navGroup;\n        this.navNode = this.navNode || nav.getNode(start, this.navGroup);\n        this.navNode = nav.clampStep(start, end, this.navGroup, this.navNode, clampedEnd);\n        el.object3D.position.copy(clampedEnd);\n      } else if (el.hasAttribute('velocity')) {\n        el.setAttribute('velocity', velocity);\n      } else {\n        el.object3D.position.x += velocity.x * dt / 1000;\n        el.object3D.position.y += velocity.y * dt / 1000;\n        el.object3D.position.z += velocity.z * dt / 1000;\n      }\n\n    };\n  }()),\n\n  /*******************************************************************\n   * Movement\n   */\n\n  updateVelocityCtrl: function () {\n    const data = this.data;\n    if (data.enabled) {\n      for (let i = 0, l = data.controls.length; i < l; i++) {\n        const control = this.el.components[data.controls[i] + COMPONENT_SUFFIX];\n        if (control && control.isVelocityActive()) {\n          this.velocityCtrl = control;\n          return;\n        }\n      }\n      this.velocityCtrl = null;\n    }\n  },\n\n  updateVelocity: (function () {\n    const vector2 = new THREE.Vector2();\n    const quaternion = new THREE.Quaternion();\n\n    return function (dt) {\n      let dVelocity;\n      const el = this.el;\n      const control = this.velocityCtrl;\n      const velocity = this.velocity;\n      const data = this.data;\n\n      if (control) {\n        if (control.getVelocityDelta) {\n          dVelocity = control.getVelocityDelta(dt);\n        } else if (control.getVelocity) {\n          velocity.copy(control.getVelocity());\n          return;\n        } else if (control.getPositionDelta) {\n          velocity.copy(control.getPositionDelta(dt).multiplyScalar(1000 / dt));\n          return;\n        } else {\n          throw new Error('Incompatible movement controls: ', control);\n        }\n      }\n\n      if (el.hasAttribute('velocity') && !data.constrainToNavMesh) {\n        velocity.copy(this.el.getAttribute('velocity'));\n      }\n\n      if (dVelocity && data.enabled) {\n        const cameraEl = data.camera;\n\n        // Rotate to heading\n        quaternion.copy(cameraEl.object3D.quaternion);\n        quaternion.premultiply(el.object3D.quaternion);\n        dVelocity.applyQuaternion(quaternion);\n\n        const factor = dVelocity.length();\n        if (data.fly) {\n          velocity.copy(dVelocity);\n          velocity.multiplyScalar(this.data.speed * 16.66667);\n        } else {\n          vector2.set(dVelocity.x, dVelocity.z);\n          vector2.setLength(factor * this.data.speed * 16.66667);\n          velocity.x = vector2.x;\n          velocity.z = vector2.y;\n        }\n      }\n    };\n\n  }())\n});\n","/**\n * 3dof (Gear VR, Daydream) controls for mobile.\n */\nmodule.exports = AFRAME.registerComponent('trackpad-controls', {\n  schema: {\n    enabled: { default: true },\n    enableNegX: { default: true },\n    enablePosX: { default: true },\n    enableNegZ: { default: true },\n    enablePosZ: { default: true },\n    mode: { default: 'touch', oneOf: ['swipe', 'touch', 'press'] }\n\n  },\n\n  init: function () {\n    this.dVelocity = new THREE.Vector3();\n    this.zVel      = 0;\n    this.xVel      = 0;\n    this.bindMethods();\n  },\n\n  play: function () {\n    this.addEventListeners();\n  },\n\n  pause: function () {\n    this.removeEventListeners();\n    this.dVelocity.set(0, 0, 0);\n  },\n\n  remove: function () {\n    this.pause();\n  },\n\n  addEventListeners: function () {\n    const data = this.data;\n    const sceneEl = this.el.sceneEl;\n\n    sceneEl.addEventListener('axismove', this.onAxisMove);\n\n    switch (data.mode) {\n      case 'swipe':\n      case 'touch':\n        sceneEl.addEventListener('trackpadtouchstart', this.onTouchStart);\n        sceneEl.addEventListener('trackpadtouchend', this.onTouchEnd);\n        break;\n\n      case 'press':\n        sceneEl.addEventListener('trackpaddown', this.onTouchStart);\n        sceneEl.addEventListener('trackpadup', this.onTouchEnd);\n        break;\n    }\n\n  },\n\n  removeEventListeners: function () {\n    const sceneEl = this.el.sceneEl;\n\n    sceneEl.removeEventListener('axismove', this.onAxisMove);\n    sceneEl.removeEventListener('trackpadtouchstart', this.onTouchStart);\n    sceneEl.removeEventListener('trackpadtouchend', this.onTouchEnd);\n    sceneEl.removeEventListener('trackpaddown', this.onTouchStart);\n    sceneEl.removeEventListener('trackpadup', this.onTouchEnd);\n  },\n\n  isVelocityActive: function () {\n    return this.data.enabled && this.isMoving;\n  },\n\n  getVelocityDelta: function () {\n    this.dVelocity.z = this.isMoving ? -this.zVel : 1;\n    this.dVelocity.x = this.isMoving ? this.xVel : 1;\n    return this.dVelocity.clone();\n  },\n\n  bindMethods: function () {\n    this.onTouchStart = this.onTouchStart.bind(this);\n    this.onTouchEnd = this.onTouchEnd.bind(this);\n    this.onAxisMove = this.onAxisMove.bind(this);\n  },\n\n  onTouchStart: function (e) {\n    switch(this.data.mode){\n      case 'swipe':\n        this.canRecordAxis = true;\n        this.startingAxisData = [];\n        break;\n      case 'touch':\n        this.isMoving = true;\n        break;\n      case 'press':\n        this.isMoving = true;\n        break;\n    }\n\n    e.preventDefault();\n  },\n\n  onTouchEnd: function (e) {\n    if(this.data.mode == 'swipe') {\n        this.startingAxisData = [];\n    }\n\n    this.isMoving = false;\n    e.preventDefault();\n  },\n\n  onAxisMove: function(e){\n    switch (this.data.mode) {\n      case 'swipe':\n        return this.handleSwipeAxis(e);\n      case 'touch':\n      case 'press':\n        return this.handleTouchAxis(e);\n    }\n  },\n\n  handleSwipeAxis: function(e) {\n    const data = this.data;\n    const axisData = e.detail.axis;\n\n    if(this.startingAxisData.length === 0 && this.canRecordAxis){\n      this.canRecordAxis = false;\n      this.startingAxisData[0] = axisData[0];\n      this.startingAxisData[1] = axisData[1];\n    }\n\n    if(this.startingAxisData.length > 0){\n      let velX = 0;\n      let velZ = 0;\n\n      if (data.enableNegX && axisData[0] < this.startingAxisData[0]) {\n        velX = -1;\n      }\n\n      if (data.enablePosX && axisData[0] > this.startingAxisData[0]) {\n        velX = 1;\n      }\n\n      if (data.enablePosZ && axisData[1] > this.startingAxisData[1]) {\n        velZ = -1;\n      }\n\n      if (data.enableNegZ && axisData[1] < this.startingAxisData[1]) {\n        velZ = 1;\n      }\n\n      const absChangeZ  = Math.abs(this.startingAxisData[1] - axisData[1]);\n      const absChangeX  = Math.abs(this.startingAxisData[0] - axisData[0]);\n\n      if (absChangeX > absChangeZ) {\n        this.zVel = 0;\n        this.xVel = velX;\n        this.isMoving = true;\n      } else {\n        this.xVel = 0;\n        this.zVel = velZ;\n        this.isMoving = true;\n      }\n\n    }\n  },\n\n  handleTouchAxis: function(e) {\n    const data = this.data;\n    const axisData = e.detail.axis;\n\n    let velX = 0;\n    let velZ = 0;\n\n    if (data.enableNegX && axisData[0] < 0) {\n      velX = -1;\n    }\n\n    if (data.enablePosX && axisData[0] > 0) {\n      velX = 1;\n    }\n\n    if (data.enablePosZ && axisData[1] > 0) {\n      velZ = -1;\n    }\n\n    if (data.enableNegZ && axisData[1] < 0) {\n      velZ = 1;\n    }\n\n    if (Math.abs(axisData[0]) > Math.abs(axisData[1])) {\n      this.zVel = 0;\n      this.xVel = velX;\n    } else {\n      this.xVel = 0;\n      this.zVel = velZ;\n    }\n\n  }\n\n});\n\n","require('./animation-mixer');\nrequire('./collada-model-legacy');\nrequire('./fbx-model');\nrequire('./gltf-model-legacy');\nrequire('./object-model');\n","const LoopMode = {\n  once: THREE.LoopOnce,\n  repeat: THREE.LoopRepeat,\n  pingpong: THREE.LoopPingPong\n};\n\n/**\n * animation-mixer\n *\n * Player for animation clips. Intended to be compatible with any model format that supports\n * skeletal or morph animations through THREE.AnimationMixer.\n * See: https://threejs.org/docs/?q=animation#Reference/Animation/AnimationMixer\n */\nmodule.exports = AFRAME.registerComponent('animation-mixer', {\n  schema: {\n    clip:  {default: '*'},\n    duration: {default: 0},\n    clampWhenFinished: {default: false, type: 'boolean'},\n    crossFadeDuration: {default: 0},\n    loop: {default: 'repeat', oneOf: Object.keys(LoopMode)},\n    repetitions: {default: Infinity, min: 0},\n    timeScale: {default: 1}\n  },\n\n  init: function () {\n    /** @type {THREE.Mesh} */\n    this.model = null;\n    /** @type {THREE.AnimationMixer} */\n    this.mixer = null;\n    /** @type {Array<THREE.AnimationAction>} */\n    this.activeActions = [];\n\n    const model = this.el.getObject3D('mesh');\n\n    if (model) {\n      this.load(model);\n    } else {\n      this.el.addEventListener('model-loaded', (e) => {\n        this.load(e.detail.model);\n      });\n    }\n  },\n\n  load: function (model) {\n    const el = this.el;\n    this.model = model;\n    this.mixer = new THREE.AnimationMixer(model);\n    this.mixer.addEventListener('loop', (e) => {\n      el.emit('animation-loop', {action: e.action, loopDelta: e.loopDelta});\n    });\n    this.mixer.addEventListener('finished', (e) => {\n      el.emit('animation-finished', {action: e.action, direction: e.direction});\n    });\n    if (this.data.clip) this.update({});\n  },\n\n  remove: function () {\n    if (this.mixer) this.mixer.stopAllAction();\n  },\n\n  update: function (prevData) {\n    if (!prevData) return;\n\n    const data = this.data;\n    const changes = AFRAME.utils.diff(data, prevData);\n\n    // If selected clips have changed, restart animation.\n    if ('clip' in changes) {\n      this.stopAction();\n      if (data.clip) this.playAction();\n      return;\n    }\n\n    // Otherwise, modify running actions.\n    this.activeActions.forEach((action) => {\n      if ('duration' in changes && data.duration) {\n        action.setDuration(data.duration);\n      }\n      if ('clampWhenFinished' in changes) {\n        action.clampWhenFinished = data.clampWhenFinished;\n      }\n      if ('loop' in changes || 'repetitions' in changes) {\n        action.setLoop(LoopMode[data.loop], data.repetitions);\n      }\n      if ('timeScale' in changes) {\n        action.setEffectiveTimeScale(data.timeScale);\n      }\n    });\n  },\n\n  stopAction: function () {\n    const data = this.data;\n    for (let i = 0; i < this.activeActions.length; i++) {\n      data.crossFadeDuration\n        ? this.activeActions[i].fadeOut(data.crossFadeDuration)\n        : this.activeActions[i].stop();\n    }\n    this.activeActions.length = 0;\n  },\n\n  playAction: function () {\n    if (!this.mixer) return;\n\n    const model = this.model,\n        data = this.data,\n        clips = model.animations || (model.geometry || {}).animations || [];\n\n    if (!clips.length) return;\n\n    const re = wildcardToRegExp(data.clip);\n\n    for (let clip, i = 0; (clip = clips[i]); i++) {\n      if (clip.name.match(re)) {\n        const action = this.mixer.clipAction(clip, model);\n        action.enabled = true;\n        action.clampWhenFinished = data.clampWhenFinished;\n        if (data.duration) action.setDuration(data.duration);\n        if (data.timeScale !== 1) action.setEffectiveTimeScale(data.timeScale);\n        action\n          .setLoop(LoopMode[data.loop], data.repetitions)\n          .fadeIn(data.crossFadeDuration)\n          .play();\n        this.activeActions.push(action);\n      }\n    }\n  },\n\n  tick: function (t, dt) {\n    if (this.mixer && !isNaN(dt)) this.mixer.update(dt / 1000);\n  }\n});\n\n/**\n * Creates a RegExp from the given string, converting asterisks to .* expressions,\n * and escaping all other characters.\n */\nfunction wildcardToRegExp (s) {\n  return new RegExp('^' + s.split(/\\*+/).map(regExpEscape).join('.*') + '$');\n}\n\n/**\n * RegExp-escapes all characters in the given string.\n */\nfunction regExpEscape (s) {\n  return s.replace(/[|\\\\{}()[\\]^$+*?.]/g, '\\\\$&');\n}\n","THREE.ColladaLoader = require('../../lib/ColladaLoader');\n\n/**\n * collada-model-legacy\n *\n * Loader for COLLADA (.dae) format.\n */\nmodule.exports.Component = AFRAME.registerComponent('collada-model-legacy', {\n  schema: {type: 'asset'},\n\n  init: function () {\n    this.model = null;\n    this.loader = new THREE.ColladaLoader();\n  },\n\n  update: function () {\n    var self = this;\n    var el = this.el;\n    var src = this.data;\n    var rendererSystem = this.el.sceneEl.systems.renderer;\n\n    if (!src) { return; }\n\n    this.remove();\n\n    this.loader.load(src, function (colladaModel) {\n      self.model = colladaModel.scene;\n      self.model.traverse(function (object) {\n        if (object.isMesh) {\n          var material = object.material;\n          if (material.color) rendererSystem.applyColorCorrection(material.color);\n          if (material.map) rendererSystem.applyColorCorrection(material.map);\n          if (material.emissive) rendererSystem.applyColorCorrection(material.emissive);\n          if (material.emissiveMap) rendererSystem.applyColorCorrection(material.emissiveMap);\n        }\n      });\n      el.setObject3D('mesh', self.model);\n      el.emit('model-loaded', {format: 'collada', model: self.model});\n    });\n  },\n\n  remove: function () {\n    if (!this.model) { return; }\n    this.el.removeObject3D('mesh');\n  }\n});\n","/**\n * @author mrdoob / http://mrdoob.com/\n * @author Mugen87 / https://github.com/Mugen87\n */\n\nmodule.exports = THREE.ColladaLoader = function ( manager ) {\n\n  this.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\n};\n\nTHREE.ColladaLoader.prototype = {\n\n  constructor: THREE.ColladaLoader,\n\n  crossOrigin: 'anonymous',\n\n  load: function ( url, onLoad, onProgress, onError ) {\n\n    var scope = this;\n\n    var path = ( scope.path === undefined ) ? THREE.LoaderUtils.extractUrlBase( url ) : scope.path;\n\n    var loader = new THREE.FileLoader( scope.manager );\n    loader.setPath( scope.path );\n    loader.load( url, function ( text ) {\n\n      onLoad( scope.parse( text, path ) );\n\n    }, onProgress, onError );\n\n  },\n\n  setPath: function ( value ) {\n\n    this.path = value;\n    return this;\n\n  },\n\n  setResourcePath: function ( value ) {\n\n    this.resourcePath = value;\n    return this;\n\n  },\n\n  options: {\n\n    set convertUpAxis( value ) {\n\n      console.warn( 'THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.' );\n\n    }\n\n  },\n\n  setCrossOrigin: function ( value ) {\n\n    this.crossOrigin = value;\n    return this;\n\n  },\n\n  parse: function ( text, path ) {\n\n    function getElementsByTagName( xml, name ) {\n\n      // Non recursive xml.getElementsByTagName() ...\n\n      var array = [];\n      var childNodes = xml.childNodes;\n\n      for ( var i = 0, l = childNodes.length; i < l; i ++ ) {\n\n        var child = childNodes[ i ];\n\n        if ( child.nodeName === name ) {\n\n          array.push( child );\n\n        }\n\n      }\n\n      return array;\n\n    }\n\n    function parseStrings( text ) {\n\n      if ( text.length === 0 ) return [];\n\n      var parts = text.trim().split( /\\s+/ );\n      var array = new Array( parts.length );\n\n      for ( var i = 0, l = parts.length; i < l; i ++ ) {\n\n        array[ i ] = parts[ i ];\n\n      }\n\n      return array;\n\n    }\n\n    function parseFloats( text ) {\n\n      if ( text.length === 0 ) return [];\n\n      var parts = text.trim().split( /\\s+/ );\n      var array = new Array( parts.length );\n\n      for ( var i = 0, l = parts.length; i < l; i ++ ) {\n\n        array[ i ] = parseFloat( parts[ i ] );\n\n      }\n\n      return array;\n\n    }\n\n    function parseInts( text ) {\n\n      if ( text.length === 0 ) return [];\n\n      var parts = text.trim().split( /\\s+/ );\n      var array = new Array( parts.length );\n\n      for ( var i = 0, l = parts.length; i < l; i ++ ) {\n\n        array[ i ] = parseInt( parts[ i ] );\n\n      }\n\n      return array;\n\n    }\n\n    function parseId( text ) {\n\n      return text.substring( 1 );\n\n    }\n\n    function generateId() {\n\n      return 'three_default_' + ( count ++ );\n\n    }\n\n    function isEmpty( object ) {\n\n      return Object.keys( object ).length === 0;\n\n    }\n\n    // asset\n\n    function parseAsset( xml ) {\n\n      return {\n        unit: parseAssetUnit( getElementsByTagName( xml, 'unit' )[ 0 ] ),\n        upAxis: parseAssetUpAxis( getElementsByTagName( xml, 'up_axis' )[ 0 ] )\n      };\n\n    }\n\n    function parseAssetUnit( xml ) {\n\n      if ( ( xml !== undefined ) && ( xml.hasAttribute( 'meter' ) === true ) ) {\n\n        return parseFloat( xml.getAttribute( 'meter' ) );\n\n      } else {\n\n        return 1; // default 1 meter\n\n      }\n\n    }\n\n    function parseAssetUpAxis( xml ) {\n\n      return xml !== undefined ? xml.textContent : 'Y_UP';\n\n    }\n\n    // library\n\n    function parseLibrary( xml, libraryName, nodeName, parser ) {\n\n      var library = getElementsByTagName( xml, libraryName )[ 0 ];\n\n      if ( library !== undefined ) {\n\n        var elements = getElementsByTagName( library, nodeName );\n\n        for ( var i = 0; i < elements.length; i ++ ) {\n\n          parser( elements[ i ] );\n\n        }\n\n      }\n\n    }\n\n    function buildLibrary( data, builder ) {\n\n      for ( var name in data ) {\n\n        var object = data[ name ];\n        object.build = builder( data[ name ] );\n\n      }\n\n    }\n\n    // get\n\n    function getBuild( data, builder ) {\n\n      if ( data.build !== undefined ) return data.build;\n\n      data.build = builder( data );\n\n      return data.build;\n\n    }\n\n    // animation\n\n    function parseAnimation( xml ) {\n\n      var data = {\n        sources: {},\n        samplers: {},\n        channels: {}\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        var id;\n\n        switch ( child.nodeName ) {\n\n          case 'source':\n            id = child.getAttribute( 'id' );\n            data.sources[ id ] = parseSource( child );\n            break;\n\n          case 'sampler':\n            id = child.getAttribute( 'id' );\n            data.samplers[ id ] = parseAnimationSampler( child );\n            break;\n\n          case 'channel':\n            id = child.getAttribute( 'target' );\n            data.channels[ id ] = parseAnimationChannel( child );\n            break;\n\n          default:\n            console.log( child );\n\n        }\n\n      }\n\n      library.animations[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function parseAnimationSampler( xml ) {\n\n      var data = {\n        inputs: {},\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'input':\n            var id = parseId( child.getAttribute( 'source' ) );\n            var semantic = child.getAttribute( 'semantic' );\n            data.inputs[ semantic ] = id;\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseAnimationChannel( xml ) {\n\n      var data = {};\n\n      var target = xml.getAttribute( 'target' );\n\n      // parsing SID Addressing Syntax\n\n      var parts = target.split( '/' );\n\n      var id = parts.shift();\n      var sid = parts.shift();\n\n      // check selection syntax\n\n      var arraySyntax = ( sid.indexOf( '(' ) !== - 1 );\n      var memberSyntax = ( sid.indexOf( '.' ) !== - 1 );\n\n      if ( memberSyntax ) {\n\n        //  member selection access\n\n        parts = sid.split( '.' );\n        sid = parts.shift();\n        data.member = parts.shift();\n\n      } else if ( arraySyntax ) {\n\n        // array-access syntax. can be used to express fields in one-dimensional vectors or two-dimensional matrices.\n\n        var indices = sid.split( '(' );\n        sid = indices.shift();\n\n        for ( var i = 0; i < indices.length; i ++ ) {\n\n          indices[ i ] = parseInt( indices[ i ].replace( /\\)/, '' ) );\n\n        }\n\n        data.indices = indices;\n\n      }\n\n      data.id = id;\n      data.sid = sid;\n\n      data.arraySyntax = arraySyntax;\n      data.memberSyntax = memberSyntax;\n\n      data.sampler = parseId( xml.getAttribute( 'source' ) );\n\n      return data;\n\n    }\n\n    function buildAnimation( data ) {\n\n      var tracks = [];\n\n      var channels = data.channels;\n      var samplers = data.samplers;\n      var sources = data.sources;\n\n      for ( var target in channels ) {\n\n        if ( channels.hasOwnProperty( target ) ) {\n\n          var channel = channels[ target ];\n          var sampler = samplers[ channel.sampler ];\n\n          var inputId = sampler.inputs.INPUT;\n          var outputId = sampler.inputs.OUTPUT;\n\n          var inputSource = sources[ inputId ];\n          var outputSource = sources[ outputId ];\n\n          var animation = buildAnimationChannel( channel, inputSource, outputSource );\n\n          createKeyframeTracks( animation, tracks );\n\n        }\n\n      }\n\n      return tracks;\n\n    }\n\n    function getAnimation( id ) {\n\n      return getBuild( library.animations[ id ], buildAnimation );\n\n    }\n\n    function buildAnimationChannel( channel, inputSource, outputSource ) {\n\n      var node = library.nodes[ channel.id ];\n      var object3D = getNode( node.id );\n\n      var transform = node.transforms[ channel.sid ];\n      var defaultMatrix = node.matrix.clone().transpose();\n\n      var time, stride;\n      var i, il, j, jl;\n\n      var data = {};\n\n      // the collada spec allows the animation of data in various ways.\n      // depending on the transform type (matrix, translate, rotate, scale), we execute different logic\n\n      switch ( transform ) {\n\n        case 'matrix':\n\n          for ( i = 0, il = inputSource.array.length; i < il; i ++ ) {\n\n            time = inputSource.array[ i ];\n            stride = i * outputSource.stride;\n\n            if ( data[ time ] === undefined ) data[ time ] = {};\n\n            if ( channel.arraySyntax === true ) {\n\n              var value = outputSource.array[ stride ];\n              var index = channel.indices[ 0 ] + 4 * channel.indices[ 1 ];\n\n              data[ time ][ index ] = value;\n\n            } else {\n\n              for ( j = 0, jl = outputSource.stride; j < jl; j ++ ) {\n\n                data[ time ][ j ] = outputSource.array[ stride + j ];\n\n              }\n\n            }\n\n          }\n\n          break;\n\n        case 'translate':\n          console.warn( 'THREE.ColladaLoader: Animation transform type \"%s\" not yet implemented.', transform );\n          break;\n\n        case 'rotate':\n          console.warn( 'THREE.ColladaLoader: Animation transform type \"%s\" not yet implemented.', transform );\n          break;\n\n        case 'scale':\n          console.warn( 'THREE.ColladaLoader: Animation transform type \"%s\" not yet implemented.', transform );\n          break;\n\n      }\n\n      var keyframes = prepareAnimationData( data, defaultMatrix );\n\n      var animation = {\n        name: object3D.uuid,\n        keyframes: keyframes\n      };\n\n      return animation;\n\n    }\n\n    function prepareAnimationData( data, defaultMatrix ) {\n\n      var keyframes = [];\n\n      // transfer data into a sortable array\n\n      for ( var time in data ) {\n\n        keyframes.push( { time: parseFloat( time ), value: data[ time ] } );\n\n      }\n\n      // ensure keyframes are sorted by time\n\n      keyframes.sort( ascending );\n\n      // now we clean up all animation data, so we can use them for keyframe tracks\n\n      for ( var i = 0; i < 16; i ++ ) {\n\n        transformAnimationData( keyframes, i, defaultMatrix.elements[ i ] );\n\n      }\n\n      return keyframes;\n\n      // array sort function\n\n      function ascending( a, b ) {\n\n        return a.time - b.time;\n\n      }\n\n    }\n\n    var position = new THREE.Vector3();\n    var scale = new THREE.Vector3();\n    var quaternion = new THREE.Quaternion();\n\n    function createKeyframeTracks( animation, tracks ) {\n\n      var keyframes = animation.keyframes;\n      var name = animation.name;\n\n      var times = [];\n      var positionData = [];\n      var quaternionData = [];\n      var scaleData = [];\n\n      for ( var i = 0, l = keyframes.length; i < l; i ++ ) {\n\n        var keyframe = keyframes[ i ];\n\n        var time = keyframe.time;\n        var value = keyframe.value;\n\n        matrix.fromArray( value ).transpose();\n        matrix.decompose( position, quaternion, scale );\n\n        times.push( time );\n        positionData.push( position.x, position.y, position.z );\n        quaternionData.push( quaternion.x, quaternion.y, quaternion.z, quaternion.w );\n        scaleData.push( scale.x, scale.y, scale.z );\n\n      }\n\n      if ( positionData.length > 0 ) tracks.push( new THREE.VectorKeyframeTrack( name + '.position', times, positionData ) );\n      if ( quaternionData.length > 0 ) tracks.push( new THREE.QuaternionKeyframeTrack( name + '.quaternion', times, quaternionData ) );\n      if ( scaleData.length > 0 ) tracks.push( new THREE.VectorKeyframeTrack( name + '.scale', times, scaleData ) );\n\n      return tracks;\n\n    }\n\n    function transformAnimationData( keyframes, property, defaultValue ) {\n\n      var keyframe;\n\n      var empty = true;\n      var i, l;\n\n      // check, if values of a property are missing in our keyframes\n\n      for ( i = 0, l = keyframes.length; i < l; i ++ ) {\n\n        keyframe = keyframes[ i ];\n\n        if ( keyframe.value[ property ] === undefined ) {\n\n          keyframe.value[ property ] = null; // mark as missing\n\n        } else {\n\n          empty = false;\n\n        }\n\n      }\n\n      if ( empty === true ) {\n\n        // no values at all, so we set a default value\n\n        for ( i = 0, l = keyframes.length; i < l; i ++ ) {\n\n          keyframe = keyframes[ i ];\n\n          keyframe.value[ property ] = defaultValue;\n\n        }\n\n      } else {\n\n        // filling gaps\n\n        createMissingKeyframes( keyframes, property );\n\n      }\n\n    }\n\n    function createMissingKeyframes( keyframes, property ) {\n\n      var prev, next;\n\n      for ( var i = 0, l = keyframes.length; i < l; i ++ ) {\n\n        var keyframe = keyframes[ i ];\n\n        if ( keyframe.value[ property ] === null ) {\n\n          prev = getPrev( keyframes, i, property );\n          next = getNext( keyframes, i, property );\n\n          if ( prev === null ) {\n\n            keyframe.value[ property ] = next.value[ property ];\n            continue;\n\n          }\n\n          if ( next === null ) {\n\n            keyframe.value[ property ] = prev.value[ property ];\n            continue;\n\n          }\n\n          interpolate( keyframe, prev, next, property );\n\n        }\n\n      }\n\n    }\n\n    function getPrev( keyframes, i, property ) {\n\n      while ( i >= 0 ) {\n\n        var keyframe = keyframes[ i ];\n\n        if ( keyframe.value[ property ] !== null ) return keyframe;\n\n        i --;\n\n      }\n\n      return null;\n\n    }\n\n    function getNext( keyframes, i, property ) {\n\n      while ( i < keyframes.length ) {\n\n        var keyframe = keyframes[ i ];\n\n        if ( keyframe.value[ property ] !== null ) return keyframe;\n\n        i ++;\n\n      }\n\n      return null;\n\n    }\n\n    function interpolate( key, prev, next, property ) {\n\n      if ( ( next.time - prev.time ) === 0 ) {\n\n        key.value[ property ] = prev.value[ property ];\n        return;\n\n      }\n\n      key.value[ property ] = ( ( key.time - prev.time ) * ( next.value[ property ] - prev.value[ property ] ) / ( next.time - prev.time ) ) + prev.value[ property ];\n\n    }\n\n    // animation clips\n\n    function parseAnimationClip( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'id' ) || 'default',\n        start: parseFloat( xml.getAttribute( 'start' ) || 0 ),\n        end: parseFloat( xml.getAttribute( 'end' ) || 0 ),\n        animations: []\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'instance_animation':\n            data.animations.push( parseId( child.getAttribute( 'url' ) ) );\n            break;\n\n        }\n\n      }\n\n      library.clips[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function buildAnimationClip( data ) {\n\n      var tracks = [];\n\n      var name = data.name;\n      var duration = ( data.end - data.start ) || - 1;\n      var animations = data.animations;\n\n      for ( var i = 0, il = animations.length; i < il; i ++ ) {\n\n        var animationTracks = getAnimation( animations[ i ] );\n\n        for ( var j = 0, jl = animationTracks.length; j < jl; j ++ ) {\n\n          tracks.push( animationTracks[ j ] );\n\n        }\n\n      }\n\n      return new THREE.AnimationClip( name, duration, tracks );\n\n    }\n\n    function getAnimationClip( id ) {\n\n      return getBuild( library.clips[ id ], buildAnimationClip );\n\n    }\n\n    // controller\n\n    function parseController( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'skin':\n            // there is exactly one skin per controller\n            data.id = parseId( child.getAttribute( 'source' ) );\n            data.skin = parseSkin( child );\n            break;\n\n          case 'morph':\n            data.id = parseId( child.getAttribute( 'source' ) );\n            console.warn( 'THREE.ColladaLoader: Morph target animation not supported yet.' );\n            break;\n\n        }\n\n      }\n\n      library.controllers[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function parseSkin( xml ) {\n\n      var data = {\n        sources: {}\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'bind_shape_matrix':\n            data.bindShapeMatrix = parseFloats( child.textContent );\n            break;\n\n          case 'source':\n            var id = child.getAttribute( 'id' );\n            data.sources[ id ] = parseSource( child );\n            break;\n\n          case 'joints':\n            data.joints = parseJoints( child );\n            break;\n\n          case 'vertex_weights':\n            data.vertexWeights = parseVertexWeights( child );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseJoints( xml ) {\n\n      var data = {\n        inputs: {}\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'input':\n            var semantic = child.getAttribute( 'semantic' );\n            var id = parseId( child.getAttribute( 'source' ) );\n            data.inputs[ semantic ] = id;\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseVertexWeights( xml ) {\n\n      var data = {\n        inputs: {}\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'input':\n            var semantic = child.getAttribute( 'semantic' );\n            var id = parseId( child.getAttribute( 'source' ) );\n            var offset = parseInt( child.getAttribute( 'offset' ) );\n            data.inputs[ semantic ] = { id: id, offset: offset };\n            break;\n\n          case 'vcount':\n            data.vcount = parseInts( child.textContent );\n            break;\n\n          case 'v':\n            data.v = parseInts( child.textContent );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function buildController( data ) {\n\n      var build = {\n        id: data.id\n      };\n\n      var geometry = library.geometries[ build.id ];\n\n      if ( data.skin !== undefined ) {\n\n        build.skin = buildSkin( data.skin );\n\n        // we enhance the 'sources' property of the corresponding geometry with our skin data\n\n        geometry.sources.skinIndices = build.skin.indices;\n        geometry.sources.skinWeights = build.skin.weights;\n\n      }\n\n      return build;\n\n    }\n\n    function buildSkin( data ) {\n\n      var BONE_LIMIT = 4;\n\n      var build = {\n        joints: [], // this must be an array to preserve the joint order\n        indices: {\n          array: [],\n          stride: BONE_LIMIT\n        },\n        weights: {\n          array: [],\n          stride: BONE_LIMIT\n        }\n      };\n\n      var sources = data.sources;\n      var vertexWeights = data.vertexWeights;\n\n      var vcount = vertexWeights.vcount;\n      var v = vertexWeights.v;\n      var jointOffset = vertexWeights.inputs.JOINT.offset;\n      var weightOffset = vertexWeights.inputs.WEIGHT.offset;\n\n      var jointSource = data.sources[ data.joints.inputs.JOINT ];\n      var inverseSource = data.sources[ data.joints.inputs.INV_BIND_MATRIX ];\n\n      var weights = sources[ vertexWeights.inputs.WEIGHT.id ].array;\n      var stride = 0;\n\n      var i, j, l;\n\n      // procces skin data for each vertex\n\n      for ( i = 0, l = vcount.length; i < l; i ++ ) {\n\n        var jointCount = vcount[ i ]; // this is the amount of joints that affect a single vertex\n        var vertexSkinData = [];\n\n        for ( j = 0; j < jointCount; j ++ ) {\n\n          var skinIndex = v[ stride + jointOffset ];\n          var weightId = v[ stride + weightOffset ];\n          var skinWeight = weights[ weightId ];\n\n          vertexSkinData.push( { index: skinIndex, weight: skinWeight } );\n\n          stride += 2;\n\n        }\n\n        // we sort the joints in descending order based on the weights.\n        // this ensures, we only procced the most important joints of the vertex\n\n        vertexSkinData.sort( descending );\n\n        // now we provide for each vertex a set of four index and weight values.\n        // the order of the skin data matches the order of vertices\n\n        for ( j = 0; j < BONE_LIMIT; j ++ ) {\n\n          var d = vertexSkinData[ j ];\n\n          if ( d !== undefined ) {\n\n            build.indices.array.push( d.index );\n            build.weights.array.push( d.weight );\n\n          } else {\n\n            build.indices.array.push( 0 );\n            build.weights.array.push( 0 );\n\n          }\n\n        }\n\n      }\n\n      // setup bind matrix\n\n      if ( data.bindShapeMatrix ) {\n\n        build.bindMatrix = new THREE.Matrix4().fromArray( data.bindShapeMatrix ).transpose();\n\n      } else {\n\n        build.bindMatrix = new THREE.Matrix4().identity();\n\n      }\n\n      // process bones and inverse bind matrix data\n\n      for ( i = 0, l = jointSource.array.length; i < l; i ++ ) {\n\n        var name = jointSource.array[ i ];\n        var boneInverse = new THREE.Matrix4().fromArray( inverseSource.array, i * inverseSource.stride ).transpose();\n\n        build.joints.push( { name: name, boneInverse: boneInverse } );\n\n      }\n\n      return build;\n\n      // array sort function\n\n      function descending( a, b ) {\n\n        return b.weight - a.weight;\n\n      }\n\n    }\n\n    function getController( id ) {\n\n      return getBuild( library.controllers[ id ], buildController );\n\n    }\n\n    // image\n\n    function parseImage( xml ) {\n\n      var data = {\n        init_from: getElementsByTagName( xml, 'init_from' )[ 0 ].textContent\n      };\n\n      library.images[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function buildImage( data ) {\n\n      if ( data.build !== undefined ) return data.build;\n\n      return data.init_from;\n\n    }\n\n    function getImage( id ) {\n\n      var data = library.images[ id ];\n\n      if ( data !== undefined ) {\n\n        return getBuild( data, buildImage );\n\n      }\n\n      console.warn( 'THREE.ColladaLoader: Couldn\\'t find image with ID:', id );\n\n      return null;\n\n    }\n\n    // effect\n\n    function parseEffect( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'profile_COMMON':\n            data.profile = parseEffectProfileCOMMON( child );\n            break;\n\n        }\n\n      }\n\n      library.effects[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function parseEffectProfileCOMMON( xml ) {\n\n      var data = {\n        surfaces: {},\n        samplers: {}\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'newparam':\n            parseEffectNewparam( child, data );\n            break;\n\n          case 'technique':\n            data.technique = parseEffectTechnique( child );\n            break;\n\n          case 'extra':\n            data.extra = parseEffectExtra( child );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectNewparam( xml, data ) {\n\n      var sid = xml.getAttribute( 'sid' );\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'surface':\n            data.surfaces[ sid ] = parseEffectSurface( child );\n            break;\n\n          case 'sampler2D':\n            data.samplers[ sid ] = parseEffectSampler( child );\n            break;\n\n        }\n\n      }\n\n    }\n\n    function parseEffectSurface( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'init_from':\n            data.init_from = child.textContent;\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectSampler( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'source':\n            data.source = child.textContent;\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectTechnique( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'constant':\n          case 'lambert':\n          case 'blinn':\n          case 'phong':\n            data.type = child.nodeName;\n            data.parameters = parseEffectParameters( child );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectParameters( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'emission':\n          case 'diffuse':\n          case 'specular':\n          case 'bump':\n          case 'ambient':\n          case 'shininess':\n          case 'transparency':\n            data[ child.nodeName ] = parseEffectParameter( child );\n            break;\n          case 'transparent':\n            data[ child.nodeName ] = {\n              opaque: child.getAttribute( 'opaque' ),\n              data: parseEffectParameter( child )\n            };\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectParameter( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'color':\n            data[ child.nodeName ] = parseFloats( child.textContent );\n            break;\n\n          case 'float':\n            data[ child.nodeName ] = parseFloat( child.textContent );\n            break;\n\n          case 'texture':\n            data[ child.nodeName ] = { id: child.getAttribute( 'texture' ), extra: parseEffectParameterTexture( child ) };\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectParameterTexture( xml ) {\n\n      var data = {\n        technique: {}\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'extra':\n            parseEffectParameterTextureExtra( child, data );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectParameterTextureExtra( xml, data ) {\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'technique':\n            parseEffectParameterTextureExtraTechnique( child, data );\n            break;\n\n        }\n\n      }\n\n    }\n\n    function parseEffectParameterTextureExtraTechnique( xml, data ) {\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'repeatU':\n          case 'repeatV':\n          case 'offsetU':\n          case 'offsetV':\n            data.technique[ child.nodeName ] = parseFloat( child.textContent );\n            break;\n\n          case 'wrapU':\n          case 'wrapV':\n\n            // some files have values for wrapU/wrapV which become NaN via parseInt\n\n            if ( child.textContent.toUpperCase() === 'TRUE' ) {\n\n              data.technique[ child.nodeName ] = 1;\n\n            } else if ( child.textContent.toUpperCase() === 'FALSE' ) {\n\n              data.technique[ child.nodeName ] = 0;\n\n            } else {\n\n              data.technique[ child.nodeName ] = parseInt( child.textContent );\n\n            }\n\n            break;\n\n        }\n\n      }\n\n    }\n\n    function parseEffectExtra( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'technique':\n            data.technique = parseEffectExtraTechnique( child );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectExtraTechnique( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'double_sided':\n            data[ child.nodeName ] = parseInt( child.textContent );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function buildEffect( data ) {\n\n      return data;\n\n    }\n\n    function getEffect( id ) {\n\n      return getBuild( library.effects[ id ], buildEffect );\n\n    }\n\n    // material\n\n    function parseMaterial( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'name' )\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'instance_effect':\n            data.url = parseId( child.getAttribute( 'url' ) );\n            break;\n\n        }\n\n      }\n\n      library.materials[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function getTextureLoader( image ) {\n\n      var loader;\n\n      var extension = image.slice( ( image.lastIndexOf( '.' ) - 1 >>> 0 ) + 2 ); // http://www.jstips.co/en/javascript/get-file-extension/\n      extension = extension.toLowerCase();\n\n      switch ( extension ) {\n\n        case 'tga':\n          loader = tgaLoader;\n          break;\n\n        default:\n          loader = textureLoader;\n\n      }\n\n      return loader;\n\n    }\n\n    function buildMaterial( data ) {\n\n      var effect = getEffect( data.url );\n      var technique = effect.profile.technique;\n      var extra = effect.profile.extra;\n\n      var material;\n\n      switch ( technique.type ) {\n\n        case 'phong':\n        case 'blinn':\n          material = new THREE.MeshPhongMaterial();\n          break;\n\n        case 'lambert':\n          material = new THREE.MeshLambertMaterial();\n          break;\n\n        default:\n          material = new THREE.MeshBasicMaterial();\n          break;\n\n      }\n\n      material.name = data.name;\n\n      function getTexture( textureObject ) {\n\n        var sampler = effect.profile.samplers[ textureObject.id ];\n        var image = null;\n\n        // get image\n\n        if ( sampler !== undefined ) {\n\n          var surface = effect.profile.surfaces[ sampler.source ];\n          image = getImage( surface.init_from );\n\n        } else {\n\n          console.warn( 'THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530).' );\n          image = getImage( textureObject.id );\n\n        }\n\n        // create texture if image is avaiable\n\n        if ( image !== null ) {\n\n          var loader = getTextureLoader( image );\n\n          if ( loader !== undefined ) {\n\n            var texture = loader.load( image );\n\n            var extra = textureObject.extra;\n\n            if ( extra !== undefined && extra.technique !== undefined && isEmpty( extra.technique ) === false ) {\n\n              var technique = extra.technique;\n\n              texture.wrapS = technique.wrapU ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;\n              texture.wrapT = technique.wrapV ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;\n\n              texture.offset.set( technique.offsetU || 0, technique.offsetV || 0 );\n              texture.repeat.set( technique.repeatU || 1, technique.repeatV || 1 );\n\n            } else {\n\n              texture.wrapS = THREE.RepeatWrapping;\n              texture.wrapT = THREE.RepeatWrapping;\n\n            }\n\n            return texture;\n\n          } else {\n\n            console.warn( 'THREE.ColladaLoader: Loader for texture %s not found.', image );\n\n            return null;\n\n          }\n\n        } else {\n\n          console.warn( 'THREE.ColladaLoader: Couldn\\'t create texture with ID:', textureObject.id );\n\n          return null;\n\n        }\n\n      }\n\n      var parameters = technique.parameters;\n\n      for ( var key in parameters ) {\n\n        var parameter = parameters[ key ];\n\n        switch ( key ) {\n\n          case 'diffuse':\n            if ( parameter.color ) material.color.fromArray( parameter.color );\n            if ( parameter.texture ) material.map = getTexture( parameter.texture );\n            break;\n          case 'specular':\n            if ( parameter.color && material.specular ) material.specular.fromArray( parameter.color );\n            if ( parameter.texture ) material.specularMap = getTexture( parameter.texture );\n            break;\n          case 'bump':\n            if ( parameter.texture ) material.normalMap = getTexture( parameter.texture );\n            break;\n          case 'ambient':\n            if ( parameter.texture ) material.lightMap = getTexture( parameter.texture );\n            break;\n          case 'shininess':\n            if ( parameter.float && material.shininess ) material.shininess = parameter.float;\n            break;\n          case 'emission':\n            if ( parameter.color && material.emissive ) material.emissive.fromArray( parameter.color );\n            if ( parameter.texture ) material.emissiveMap = getTexture( parameter.texture );\n            break;\n\n        }\n\n      }\n\n      //\n\n      var transparent = parameters[ 'transparent' ];\n      var transparency = parameters[ 'transparency' ];\n\n      // <transparency> does not exist but <transparent>\n\n      if ( transparency === undefined && transparent ) {\n\n        transparency = {\n          float: 1\n        };\n\n      }\n\n      // <transparent> does not exist but <transparency>\n\n      if ( transparent === undefined && transparency ) {\n\n        transparent = {\n          opaque: 'A_ONE',\n          data: {\n            color: [ 1, 1, 1, 1 ]\n          } };\n\n      }\n\n      if ( transparent && transparency ) {\n\n        // handle case if a texture exists but no color\n\n        if ( transparent.data.texture ) {\n\n          // we do not set an alpha map (see #13792)\n\n          material.transparent = true;\n\n        } else {\n\n          var color = transparent.data.color;\n\n          switch ( transparent.opaque ) {\n\n            case 'A_ONE':\n              material.opacity = color[ 3 ] * transparency.float;\n              break;\n            case 'RGB_ZERO':\n              material.opacity = 1 - ( color[ 0 ] * transparency.float );\n              break;\n            case 'A_ZERO':\n              material.opacity = 1 - ( color[ 3 ] * transparency.float );\n              break;\n            case 'RGB_ONE':\n              material.opacity = color[ 0 ] * transparency.float;\n              break;\n            default:\n              console.warn( 'THREE.ColladaLoader: Invalid opaque type \"%s\" of transparent tag.', transparent.opaque );\n\n          }\n\n          if ( material.opacity < 1 ) material.transparent = true;\n\n        }\n\n      }\n\n      //\n\n      if ( extra !== undefined && extra.technique !== undefined && extra.technique.double_sided === 1 ) {\n\n        material.side = THREE.DoubleSide;\n\n      }\n\n      return material;\n\n    }\n\n    function getMaterial( id ) {\n\n      return getBuild( library.materials[ id ], buildMaterial );\n\n    }\n\n    // camera\n\n    function parseCamera( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'name' )\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'optics':\n            data.optics = parseCameraOptics( child );\n            break;\n\n        }\n\n      }\n\n      library.cameras[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function parseCameraOptics( xml ) {\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        switch ( child.nodeName ) {\n\n          case 'technique_common':\n            return parseCameraTechnique( child );\n\n        }\n\n      }\n\n      return {};\n\n    }\n\n    function parseCameraTechnique( xml ) {\n\n      var data = {};\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        switch ( child.nodeName ) {\n\n          case 'perspective':\n          case 'orthographic':\n\n            data.technique = child.nodeName;\n            data.parameters = parseCameraParameters( child );\n\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseCameraParameters( xml ) {\n\n      var data = {};\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        switch ( child.nodeName ) {\n\n          case 'xfov':\n          case 'yfov':\n          case 'xmag':\n          case 'ymag':\n          case 'znear':\n          case 'zfar':\n          case 'aspect_ratio':\n            data[ child.nodeName ] = parseFloat( child.textContent );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function buildCamera( data ) {\n\n      var camera;\n\n      switch ( data.optics.technique ) {\n\n        case 'perspective':\n          camera = new THREE.PerspectiveCamera(\n            data.optics.parameters.yfov,\n            data.optics.parameters.aspect_ratio,\n            data.optics.parameters.znear,\n            data.optics.parameters.zfar\n          );\n          break;\n\n        case 'orthographic':\n          var ymag = data.optics.parameters.ymag;\n          var xmag = data.optics.parameters.xmag;\n          var aspectRatio = data.optics.parameters.aspect_ratio;\n\n          xmag = ( xmag === undefined ) ? ( ymag * aspectRatio ) : xmag;\n          ymag = ( ymag === undefined ) ? ( xmag / aspectRatio ) : ymag;\n\n          xmag *= 0.5;\n          ymag *= 0.5;\n\n          camera = new THREE.OrthographicCamera(\n            - xmag, xmag, ymag, - ymag, // left, right, top, bottom\n            data.optics.parameters.znear,\n            data.optics.parameters.zfar\n          );\n          break;\n\n        default:\n          camera = new THREE.PerspectiveCamera();\n          break;\n\n      }\n\n      camera.name = data.name;\n\n      return camera;\n\n    }\n\n    function getCamera( id ) {\n\n      var data = library.cameras[ id ];\n\n      if ( data !== undefined ) {\n\n        return getBuild( data, buildCamera );\n\n      }\n\n      console.warn( 'THREE.ColladaLoader: Couldn\\'t find camera with ID:', id );\n\n      return null;\n\n    }\n\n    // light\n\n    function parseLight( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'technique_common':\n            data = parseLightTechnique( child );\n            break;\n\n        }\n\n      }\n\n      library.lights[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function parseLightTechnique( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'directional':\n          case 'point':\n          case 'spot':\n          case 'ambient':\n\n            data.technique = child.nodeName;\n            data.parameters = parseLightParameters( child );\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseLightParameters( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'color':\n            var array = parseFloats( child.textContent );\n            data.color = new THREE.Color().fromArray( array );\n            break;\n\n          case 'falloff_angle':\n            data.falloffAngle = parseFloat( child.textContent );\n            break;\n\n          case 'quadratic_attenuation':\n            var f = parseFloat( child.textContent );\n            data.distance = f ? Math.sqrt( 1 / f ) : 0;\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function buildLight( data ) {\n\n      var light;\n\n      switch ( data.technique ) {\n\n        case 'directional':\n          light = new THREE.DirectionalLight();\n          break;\n\n        case 'point':\n          light = new THREE.PointLight();\n          break;\n\n        case 'spot':\n          light = new THREE.SpotLight();\n          break;\n\n        case 'ambient':\n          light = new THREE.AmbientLight();\n          break;\n\n      }\n\n      if ( data.parameters.color ) light.color.copy( data.parameters.color );\n      if ( data.parameters.distance ) light.distance = data.parameters.distance;\n\n      return light;\n\n    }\n\n    function getLight( id ) {\n\n      var data = library.lights[ id ];\n\n      if ( data !== undefined ) {\n\n        return getBuild( data, buildLight );\n\n      }\n\n      console.warn( 'THREE.ColladaLoader: Couldn\\'t find light with ID:', id );\n\n      return null;\n\n    }\n\n    // geometry\n\n    function parseGeometry( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'name' ),\n        sources: {},\n        vertices: {},\n        primitives: []\n      };\n\n      var mesh = getElementsByTagName( xml, 'mesh' )[ 0 ];\n\n      // the following tags inside geometry are not supported yet (see https://github.com/mrdoob/three.js/pull/12606): convex_mesh, spline, brep\n      if ( mesh === undefined ) return;\n\n      for ( var i = 0; i < mesh.childNodes.length; i ++ ) {\n\n        var child = mesh.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        var id = child.getAttribute( 'id' );\n\n        switch ( child.nodeName ) {\n\n          case 'source':\n            data.sources[ id ] = parseSource( child );\n            break;\n\n          case 'vertices':\n            // data.sources[ id ] = data.sources[ parseId( getElementsByTagName( child, 'input' )[ 0 ].getAttribute( 'source' ) ) ];\n            data.vertices = parseGeometryVertices( child );\n            break;\n\n          case 'polygons':\n            console.warn( 'THREE.ColladaLoader: Unsupported primitive type: ', child.nodeName );\n            break;\n\n          case 'lines':\n          case 'linestrips':\n          case 'polylist':\n          case 'triangles':\n            data.primitives.push( parseGeometryPrimitive( child ) );\n            break;\n\n          default:\n            console.log( child );\n\n        }\n\n      }\n\n      library.geometries[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function parseSource( xml ) {\n\n      var data = {\n        array: [],\n        stride: 3\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'float_array':\n            data.array = parseFloats( child.textContent );\n            break;\n\n          case 'Name_array':\n            data.array = parseStrings( child.textContent );\n            break;\n\n          case 'technique_common':\n            var accessor = getElementsByTagName( child, 'accessor' )[ 0 ];\n\n            if ( accessor !== undefined ) {\n\n              data.stride = parseInt( accessor.getAttribute( 'stride' ) );\n\n            }\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseGeometryVertices( xml ) {\n\n      var data = {};\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        data[ child.getAttribute( 'semantic' ) ] = parseId( child.getAttribute( 'source' ) );\n\n      }\n\n      return data;\n\n    }\n\n    function parseGeometryPrimitive( xml ) {\n\n      var primitive = {\n        type: xml.nodeName,\n        material: xml.getAttribute( 'material' ),\n        count: parseInt( xml.getAttribute( 'count' ) ),\n        inputs: {},\n        stride: 0,\n        hasUV: false\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'input':\n            var id = parseId( child.getAttribute( 'source' ) );\n            var semantic = child.getAttribute( 'semantic' );\n            var offset = parseInt( child.getAttribute( 'offset' ) );\n            var set = parseInt( child.getAttribute( 'set' ) );\n            var inputname = ( set > 0 ? semantic + set : semantic );\n            primitive.inputs[ inputname ] = { id: id, offset: offset };\n            primitive.stride = Math.max( primitive.stride, offset + 1 );\n            if ( semantic === 'TEXCOORD' ) primitive.hasUV = true;\n            break;\n\n          case 'vcount':\n            primitive.vcount = parseInts( child.textContent );\n            break;\n\n          case 'p':\n            primitive.p = parseInts( child.textContent );\n            break;\n\n        }\n\n      }\n\n      return primitive;\n\n    }\n\n    function groupPrimitives( primitives ) {\n\n      var build = {};\n\n      for ( var i = 0; i < primitives.length; i ++ ) {\n\n        var primitive = primitives[ i ];\n\n        if ( build[ primitive.type ] === undefined ) build[ primitive.type ] = [];\n\n        build[ primitive.type ].push( primitive );\n\n      }\n\n      return build;\n\n    }\n\n    function checkUVCoordinates( primitives ) {\n\n      var count = 0;\n\n      for ( var i = 0, l = primitives.length; i < l; i ++ ) {\n\n        var primitive = primitives[ i ];\n\n        if ( primitive.hasUV === true ) {\n\n          count ++;\n\n        }\n\n      }\n\n      if ( count > 0 && count < primitives.length ) {\n\n        primitives.uvsNeedsFix = true;\n\n      }\n\n    }\n\n    function buildGeometry( data ) {\n\n      var build = {};\n\n      var sources = data.sources;\n      var vertices = data.vertices;\n      var primitives = data.primitives;\n\n      if ( primitives.length === 0 ) return {};\n\n      // our goal is to create one buffer geometry for a single type of primitives\n      // first, we group all primitives by their type\n\n      var groupedPrimitives = groupPrimitives( primitives );\n\n      for ( var type in groupedPrimitives ) {\n\n        var primitiveType = groupedPrimitives[ type ];\n\n        // second, ensure consistent uv coordinates for each type of primitives (polylist,triangles or lines)\n\n        checkUVCoordinates( primitiveType );\n\n        // third, create a buffer geometry for each type of primitives\n\n        build[ type ] = buildGeometryType( primitiveType, sources, vertices );\n\n      }\n\n      return build;\n\n    }\n\n    function buildGeometryType( primitives, sources, vertices ) {\n\n      var build = {};\n\n      var position = { array: [], stride: 0 };\n      var normal = { array: [], stride: 0 };\n      var uv = { array: [], stride: 0 };\n      var uv2 = { array: [], stride: 0 };\n      var color = { array: [], stride: 0 };\n\n      var skinIndex = { array: [], stride: 4 };\n      var skinWeight = { array: [], stride: 4 };\n\n      var geometry = new THREE.BufferGeometry();\n\n      var materialKeys = [];\n\n      var start = 0;\n\n      for ( var p = 0; p < primitives.length; p ++ ) {\n\n        var primitive = primitives[ p ];\n        var inputs = primitive.inputs;\n\n        // groups\n\n        var count = 0;\n\n        switch ( primitive.type ) {\n\n          case 'lines':\n          case 'linestrips':\n            count = primitive.count * 2;\n            break;\n\n          case 'triangles':\n            count = primitive.count * 3;\n            break;\n\n          case 'polylist':\n\n            for ( var g = 0; g < primitive.count; g ++ ) {\n\n              var vc = primitive.vcount[ g ];\n\n              switch ( vc ) {\n\n                case 3:\n                  count += 3; // single triangle\n                  break;\n\n                case 4:\n                  count += 6; // quad, subdivided into two triangles\n                  break;\n\n                default:\n                  count += ( vc - 2 ) * 3; // polylist with more than four vertices\n                  break;\n\n              }\n\n            }\n\n            break;\n\n          default:\n            console.warn( 'THREE.ColladaLoader: Unknow primitive type:', primitive.type );\n\n        }\n\n        geometry.addGroup( start, count, p );\n        start += count;\n\n        // material\n\n        if ( primitive.material ) {\n\n          materialKeys.push( primitive.material );\n\n        }\n\n        // geometry data\n\n        for ( var name in inputs ) {\n\n          var input = inputs[ name ];\n\n          switch ( name ) {\n\n            case 'VERTEX':\n              for ( var key in vertices ) {\n\n                var id = vertices[ key ];\n\n                switch ( key ) {\n\n                  case 'POSITION':\n                    var prevLength = position.array.length;\n                    buildGeometryData( primitive, sources[ id ], input.offset, position.array );\n                    position.stride = sources[ id ].stride;\n\n                    if ( sources.skinWeights && sources.skinIndices ) {\n\n                      buildGeometryData( primitive, sources.skinIndices, input.offset, skinIndex.array );\n                      buildGeometryData( primitive, sources.skinWeights, input.offset, skinWeight.array );\n\n                    }\n\n                    // see #3803\n\n                    if ( primitive.hasUV === false && primitives.uvsNeedsFix === true ) {\n\n                      var count = ( position.array.length - prevLength ) / position.stride;\n\n                      for ( var i = 0; i < count; i ++ ) {\n\n                        // fill missing uv coordinates\n\n                        uv.array.push( 0, 0 );\n\n                      }\n\n                    }\n                    break;\n\n                  case 'NORMAL':\n                    buildGeometryData( primitive, sources[ id ], input.offset, normal.array );\n                    normal.stride = sources[ id ].stride;\n                    break;\n\n                  case 'COLOR':\n                    buildGeometryData( primitive, sources[ id ], input.offset, color.array );\n                    color.stride = sources[ id ].stride;\n                    break;\n\n                  case 'TEXCOORD':\n                    buildGeometryData( primitive, sources[ id ], input.offset, uv.array );\n                    uv.stride = sources[ id ].stride;\n                    break;\n\n                  case 'TEXCOORD1':\n                    buildGeometryData( primitive, sources[ id ], input.offset, uv2.array );\n                    uv.stride = sources[ id ].stride;\n                    break;\n\n                  default:\n                    console.warn( 'THREE.ColladaLoader: Semantic \"%s\" not handled in geometry build process.', key );\n\n                }\n\n              }\n              break;\n\n            case 'NORMAL':\n              buildGeometryData( primitive, sources[ input.id ], input.offset, normal.array );\n              normal.stride = sources[ input.id ].stride;\n              break;\n\n            case 'COLOR':\n              buildGeometryData( primitive, sources[ input.id ], input.offset, color.array );\n              color.stride = sources[ input.id ].stride;\n              break;\n\n            case 'TEXCOORD':\n              buildGeometryData( primitive, sources[ input.id ], input.offset, uv.array );\n              uv.stride = sources[ input.id ].stride;\n              break;\n\n            case 'TEXCOORD1':\n              buildGeometryData( primitive, sources[ input.id ], input.offset, uv2.array );\n              uv2.stride = sources[ input.id ].stride;\n              break;\n\n          }\n\n        }\n\n      }\n\n      // build geometry\n\n      if ( position.array.length > 0 ) geometry.addAttribute( 'position', new THREE.Float32BufferAttribute( position.array, position.stride ) );\n      if ( normal.array.length > 0 ) geometry.addAttribute( 'normal', new THREE.Float32BufferAttribute( normal.array, normal.stride ) );\n      if ( color.array.length > 0 ) geometry.addAttribute( 'color', new THREE.Float32BufferAttribute( color.array, color.stride ) );\n      if ( uv.array.length > 0 ) geometry.addAttribute( 'uv', new THREE.Float32BufferAttribute( uv.array, uv.stride ) );\n      if ( uv2.array.length > 0 ) geometry.addAttribute( 'uv2', new THREE.Float32BufferAttribute( uv2.array, uv2.stride ) );\n\n      if ( skinIndex.array.length > 0 ) geometry.addAttribute( 'skinIndex', new THREE.Float32BufferAttribute( skinIndex.array, skinIndex.stride ) );\n      if ( skinWeight.array.length > 0 ) geometry.addAttribute( 'skinWeight', new THREE.Float32BufferAttribute( skinWeight.array, skinWeight.stride ) );\n\n      build.data = geometry;\n      build.type = primitives[ 0 ].type;\n      build.materialKeys = materialKeys;\n\n      return build;\n\n    }\n\n    function buildGeometryData( primitive, source, offset, array ) {\n\n      var indices = primitive.p;\n      var stride = primitive.stride;\n      var vcount = primitive.vcount;\n\n      function pushVector( i ) {\n\n        var index = indices[ i + offset ] * sourceStride;\n        var length = index + sourceStride;\n\n        for ( ; index < length; index ++ ) {\n\n          array.push( sourceArray[ index ] );\n\n        }\n\n      }\n\n      var sourceArray = source.array;\n      var sourceStride = source.stride;\n\n      if ( primitive.vcount !== undefined ) {\n\n        var index = 0;\n\n        for ( var i = 0, l = vcount.length; i < l; i ++ ) {\n\n          var count = vcount[ i ];\n\n          if ( count === 4 ) {\n\n            var a = index + stride * 0;\n            var b = index + stride * 1;\n            var c = index + stride * 2;\n            var d = index + stride * 3;\n\n            pushVector( a ); pushVector( b ); pushVector( d );\n            pushVector( b ); pushVector( c ); pushVector( d );\n\n          } else if ( count === 3 ) {\n\n            var a = index + stride * 0;\n            var b = index + stride * 1;\n            var c = index + stride * 2;\n\n            pushVector( a ); pushVector( b ); pushVector( c );\n\n          } else if ( count > 4 ) {\n\n            for ( var k = 1, kl = ( count - 2 ); k <= kl; k ++ ) {\n\n              var a = index + stride * 0;\n              var b = index + stride * k;\n              var c = index + stride * ( k + 1 );\n\n              pushVector( a ); pushVector( b ); pushVector( c );\n\n            }\n\n          }\n\n          index += stride * count;\n\n        }\n\n      } else {\n\n        for ( var i = 0, l = indices.length; i < l; i += stride ) {\n\n          pushVector( i );\n\n        }\n\n      }\n\n    }\n\n    function getGeometry( id ) {\n\n      return getBuild( library.geometries[ id ], buildGeometry );\n\n    }\n\n    // kinematics\n\n    function parseKinematicsModel( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'name' ) || '',\n        joints: {},\n        links: []\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'technique_common':\n            parseKinematicsTechniqueCommon( child, data );\n            break;\n\n        }\n\n      }\n\n      library.kinematicsModels[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function buildKinematicsModel( data ) {\n\n      if ( data.build !== undefined ) return data.build;\n\n      return data;\n\n    }\n\n    function getKinematicsModel( id ) {\n\n      return getBuild( library.kinematicsModels[ id ], buildKinematicsModel );\n\n    }\n\n    function parseKinematicsTechniqueCommon( xml, data ) {\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'joint':\n            data.joints[ child.getAttribute( 'sid' ) ] = parseKinematicsJoint( child );\n            break;\n\n          case 'link':\n            data.links.push( parseKinematicsLink( child ) );\n            break;\n\n        }\n\n      }\n\n    }\n\n    function parseKinematicsJoint( xml ) {\n\n      var data;\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'prismatic':\n          case 'revolute':\n            data = parseKinematicsJointParameter( child );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseKinematicsJointParameter( xml, data ) {\n\n      var data = {\n        sid: xml.getAttribute( 'sid' ),\n        name: xml.getAttribute( 'name' ) || '',\n        axis: new THREE.Vector3(),\n        limits: {\n          min: 0,\n          max: 0\n        },\n        type: xml.nodeName,\n        static: false,\n        zeroPosition: 0,\n        middlePosition: 0\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'axis':\n            var array = parseFloats( child.textContent );\n            data.axis.fromArray( array );\n            break;\n          case 'limits':\n            var max = child.getElementsByTagName( 'max' )[ 0 ];\n            var min = child.getElementsByTagName( 'min' )[ 0 ];\n\n            data.limits.max = parseFloat( max.textContent );\n            data.limits.min = parseFloat( min.textContent );\n            break;\n\n        }\n\n      }\n\n      // if min is equal to or greater than max, consider the joint static\n\n      if ( data.limits.min >= data.limits.max ) {\n\n        data.static = true;\n\n      }\n\n      // calculate middle position\n\n      data.middlePosition = ( data.limits.min + data.limits.max ) / 2.0;\n\n      return data;\n\n    }\n\n    function parseKinematicsLink( xml ) {\n\n      var data = {\n        sid: xml.getAttribute( 'sid' ),\n        name: xml.getAttribute( 'name' ) || '',\n        attachments: [],\n        transforms: []\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'attachment_full':\n            data.attachments.push( parseKinematicsAttachment( child ) );\n            break;\n\n          case 'matrix':\n          case 'translate':\n          case 'rotate':\n            data.transforms.push( parseKinematicsTransform( child ) );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseKinematicsAttachment( xml ) {\n\n      var data = {\n        joint: xml.getAttribute( 'joint' ).split( '/' ).pop(),\n        transforms: [],\n        links: []\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'link':\n            data.links.push( parseKinematicsLink( child ) );\n            break;\n\n          case 'matrix':\n          case 'translate':\n          case 'rotate':\n            data.transforms.push( parseKinematicsTransform( child ) );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseKinematicsTransform( xml ) {\n\n      var data = {\n        type: xml.nodeName\n      };\n\n      var array = parseFloats( xml.textContent );\n\n      switch ( data.type ) {\n\n        case 'matrix':\n          data.obj = new THREE.Matrix4();\n          data.obj.fromArray( array ).transpose();\n          break;\n\n        case 'translate':\n          data.obj = new THREE.Vector3();\n          data.obj.fromArray( array );\n          break;\n\n        case 'rotate':\n          data.obj = new THREE.Vector3();\n          data.obj.fromArray( array );\n          data.angle = THREE.Math.degToRad( array[ 3 ] );\n          break;\n\n      }\n\n      return data;\n\n    }\n\n    // physics\n\n    function parsePhysicsModel( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'name' ) || '',\n        rigidBodies: {}\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'rigid_body':\n            data.rigidBodies[ child.getAttribute( 'name' ) ] = {};\n            parsePhysicsRigidBody( child, data.rigidBodies[ child.getAttribute( 'name' ) ] );\n            break;\n\n        }\n\n      }\n\n      library.physicsModels[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function parsePhysicsRigidBody( xml, data ) {\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'technique_common':\n            parsePhysicsTechniqueCommon( child, data );\n            break;\n\n        }\n\n      }\n\n    }\n\n    function parsePhysicsTechniqueCommon( xml, data ) {\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'inertia':\n            data.inertia = parseFloats( child.textContent );\n            break;\n\n          case 'mass':\n            data.mass = parseFloats( child.textContent )[ 0 ];\n            break;\n\n        }\n\n      }\n\n    }\n\n    // scene\n\n    function parseKinematicsScene( xml ) {\n\n      var data = {\n        bindJointAxis: []\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'bind_joint_axis':\n            data.bindJointAxis.push( parseKinematicsBindJointAxis( child ) );\n            break;\n\n        }\n\n      }\n\n      library.kinematicsScenes[ parseId( xml.getAttribute( 'url' ) ) ] = data;\n\n    }\n\n    function parseKinematicsBindJointAxis( xml ) {\n\n      var data = {\n        target: xml.getAttribute( 'target' ).split( '/' ).pop()\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'axis':\n            var param = child.getElementsByTagName( 'param' )[ 0 ];\n            data.axis = param.textContent;\n            var tmpJointIndex = data.axis.split( 'inst_' ).pop().split( 'axis' )[ 0 ];\n            data.jointIndex = tmpJointIndex.substr( 0, tmpJointIndex.length - 1 );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function buildKinematicsScene( data ) {\n\n      if ( data.build !== undefined ) return data.build;\n\n      return data;\n\n    }\n\n    function getKinematicsScene( id ) {\n\n      return getBuild( library.kinematicsScenes[ id ], buildKinematicsScene );\n\n    }\n\n    function setupKinematics() {\n\n      var kinematicsModelId = Object.keys( library.kinematicsModels )[ 0 ];\n      var kinematicsSceneId = Object.keys( library.kinematicsScenes )[ 0 ];\n      var visualSceneId = Object.keys( library.visualScenes )[ 0 ];\n\n      if ( kinematicsModelId === undefined || kinematicsSceneId === undefined ) return;\n\n      var kinematicsModel = getKinematicsModel( kinematicsModelId );\n      var kinematicsScene = getKinematicsScene( kinematicsSceneId );\n      var visualScene = getVisualScene( visualSceneId );\n\n      var bindJointAxis = kinematicsScene.bindJointAxis;\n      var jointMap = {};\n\n      for ( var i = 0, l = bindJointAxis.length; i < l; i ++ ) {\n\n        var axis = bindJointAxis[ i ];\n\n        // the result of the following query is an element of type 'translate', 'rotate','scale' or 'matrix'\n\n        var targetElement = collada.querySelector( '[sid=\"' + axis.target + '\"]' );\n\n        if ( targetElement ) {\n\n          // get the parent of the transfrom element\n\n          var parentVisualElement = targetElement.parentElement;\n\n          // connect the joint of the kinematics model with the element in the visual scene\n\n          connect( axis.jointIndex, parentVisualElement );\n\n        }\n\n      }\n\n      function connect( jointIndex, visualElement ) {\n\n        var visualElementName = visualElement.getAttribute( 'name' );\n        var joint = kinematicsModel.joints[ jointIndex ];\n\n        visualScene.traverse( function ( object ) {\n\n          if ( object.name === visualElementName ) {\n\n            jointMap[ jointIndex ] = {\n              object: object,\n              transforms: buildTransformList( visualElement ),\n              joint: joint,\n              position: joint.zeroPosition\n            };\n\n          }\n\n        } );\n\n      }\n\n      var m0 = new THREE.Matrix4();\n\n      kinematics = {\n\n        joints: kinematicsModel && kinematicsModel.joints,\n\n        getJointValue: function ( jointIndex ) {\n\n          var jointData = jointMap[ jointIndex ];\n\n          if ( jointData ) {\n\n            return jointData.position;\n\n          } else {\n\n            console.warn( 'THREE.ColladaLoader: Joint ' + jointIndex + ' doesn\\'t exist.' );\n\n          }\n\n        },\n\n        setJointValue: function ( jointIndex, value ) {\n\n          var jointData = jointMap[ jointIndex ];\n\n          if ( jointData ) {\n\n            var joint = jointData.joint;\n\n            if ( value > joint.limits.max || value < joint.limits.min ) {\n\n              console.warn( 'THREE.ColladaLoader: Joint ' + jointIndex + ' value ' + value + ' outside of limits (min: ' + joint.limits.min + ', max: ' + joint.limits.max + ').' );\n\n            } else if ( joint.static ) {\n\n              console.warn( 'THREE.ColladaLoader: Joint ' + jointIndex + ' is static.' );\n\n            } else {\n\n              var object = jointData.object;\n              var axis = joint.axis;\n              var transforms = jointData.transforms;\n\n              matrix.identity();\n\n              // each update, we have to apply all transforms in the correct order\n\n              for ( var i = 0; i < transforms.length; i ++ ) {\n\n                var transform = transforms[ i ];\n\n                // if there is a connection of the transform node with a joint, apply the joint value\n\n                if ( transform.sid && transform.sid.indexOf( jointIndex ) !== - 1 ) {\n\n                  switch ( joint.type ) {\n\n                    case 'revolute':\n                      matrix.multiply( m0.makeRotationAxis( axis, THREE.Math.degToRad( value ) ) );\n                      break;\n\n                    case 'prismatic':\n                      matrix.multiply( m0.makeTranslation( axis.x * value, axis.y * value, axis.z * value ) );\n                      break;\n\n                    default:\n                      console.warn( 'THREE.ColladaLoader: Unknown joint type: ' + joint.type );\n                      break;\n\n                  }\n\n                } else {\n\n                  switch ( transform.type ) {\n\n                    case 'matrix':\n                      matrix.multiply( transform.obj );\n                      break;\n\n                    case 'translate':\n                      matrix.multiply( m0.makeTranslation( transform.obj.x, transform.obj.y, transform.obj.z ) );\n                      break;\n\n                    case 'scale':\n                      matrix.scale( transform.obj );\n                      break;\n\n                    case 'rotate':\n                      matrix.multiply( m0.makeRotationAxis( transform.obj, transform.angle ) );\n                      break;\n\n                  }\n\n                }\n\n              }\n\n              object.matrix.copy( matrix );\n              object.matrix.decompose( object.position, object.quaternion, object.scale );\n\n              jointMap[ jointIndex ].position = value;\n\n            }\n\n          } else {\n\n            console.log( 'THREE.ColladaLoader: ' + jointIndex + ' does not exist.' );\n\n          }\n\n        }\n\n      };\n\n    }\n\n    function buildTransformList( node ) {\n\n      var transforms = [];\n\n      var xml = collada.querySelector( '[id=\"' + node.id + '\"]' );\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'matrix':\n            var array = parseFloats( child.textContent );\n            var matrix = new THREE.Matrix4().fromArray( array ).transpose();\n            transforms.push( {\n              sid: child.getAttribute( 'sid' ),\n              type: child.nodeName,\n              obj: matrix\n            } );\n            break;\n\n          case 'translate':\n          case 'scale':\n            var array = parseFloats( child.textContent );\n            var vector = new THREE.Vector3().fromArray( array );\n            transforms.push( {\n              sid: child.getAttribute( 'sid' ),\n              type: child.nodeName,\n              obj: vector\n            } );\n            break;\n\n          case 'rotate':\n            var array = parseFloats( child.textContent );\n            var vector = new THREE.Vector3().fromArray( array );\n            var angle = THREE.Math.degToRad( array[ 3 ] );\n            transforms.push( {\n              sid: child.getAttribute( 'sid' ),\n              type: child.nodeName,\n              obj: vector,\n              angle: angle\n            } );\n            break;\n\n        }\n\n      }\n\n      return transforms;\n\n    }\n\n    // nodes\n\n    function prepareNodes( xml ) {\n\n      var elements = xml.getElementsByTagName( 'node' );\n\n      // ensure all node elements have id attributes\n\n      for ( var i = 0; i < elements.length; i ++ ) {\n\n        var element = elements[ i ];\n\n        if ( element.hasAttribute( 'id' ) === false ) {\n\n          element.setAttribute( 'id', generateId() );\n\n        }\n\n      }\n\n    }\n\n    var matrix = new THREE.Matrix4();\n    var vector = new THREE.Vector3();\n\n    function parseNode( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'name' ) || '',\n        type: xml.getAttribute( 'type' ),\n        id: xml.getAttribute( 'id' ),\n        sid: xml.getAttribute( 'sid' ),\n        matrix: new THREE.Matrix4(),\n        nodes: [],\n        instanceCameras: [],\n        instanceControllers: [],\n        instanceLights: [],\n        instanceGeometries: [],\n        instanceNodes: [],\n        transforms: {}\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'node':\n            data.nodes.push( child.getAttribute( 'id' ) );\n            parseNode( child );\n            break;\n\n          case 'instance_camera':\n            data.instanceCameras.push( parseId( child.getAttribute( 'url' ) ) );\n            break;\n\n          case 'instance_controller':\n            data.instanceControllers.push( parseNodeInstance( child ) );\n            break;\n\n          case 'instance_light':\n            data.instanceLights.push( parseId( child.getAttribute( 'url' ) ) );\n            break;\n\n          case 'instance_geometry':\n            data.instanceGeometries.push( parseNodeInstance( child ) );\n            break;\n\n          case 'instance_node':\n            data.instanceNodes.push( parseId( child.getAttribute( 'url' ) ) );\n            break;\n\n          case 'matrix':\n            var array = parseFloats( child.textContent );\n            data.matrix.multiply( matrix.fromArray( array ).transpose() );\n            data.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\n            break;\n\n          case 'translate':\n            var array = parseFloats( child.textContent );\n            vector.fromArray( array );\n            data.matrix.multiply( matrix.makeTranslation( vector.x, vector.y, vector.z ) );\n            data.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\n            break;\n\n          case 'rotate':\n            var array = parseFloats( child.textContent );\n            var angle = THREE.Math.degToRad( array[ 3 ] );\n            data.matrix.multiply( matrix.makeRotationAxis( vector.fromArray( array ), angle ) );\n            data.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\n            break;\n\n          case 'scale':\n            var array = parseFloats( child.textContent );\n            data.matrix.scale( vector.fromArray( array ) );\n            data.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\n            break;\n\n          case 'extra':\n            break;\n\n          default:\n            console.log( child );\n\n        }\n\n      }\n\n      if ( hasNode( data.id ) ) {\n\n        console.warn( 'THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.', data.id );\n\n      } else {\n\n        library.nodes[ data.id ] = data;\n\n      }\n\n      return data;\n\n    }\n\n    function parseNodeInstance( xml ) {\n\n      var data = {\n        id: parseId( xml.getAttribute( 'url' ) ),\n        materials: {},\n        skeletons: []\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        switch ( child.nodeName ) {\n\n          case 'bind_material':\n            var instances = child.getElementsByTagName( 'instance_material' );\n\n            for ( var j = 0; j < instances.length; j ++ ) {\n\n              var instance = instances[ j ];\n              var symbol = instance.getAttribute( 'symbol' );\n              var target = instance.getAttribute( 'target' );\n\n              data.materials[ symbol ] = parseId( target );\n\n            }\n\n            break;\n\n          case 'skeleton':\n            data.skeletons.push( parseId( child.textContent ) );\n            break;\n\n          default:\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function buildSkeleton( skeletons, joints ) {\n\n      var boneData = [];\n      var sortedBoneData = [];\n\n      var i, j, data;\n\n      // a skeleton can have multiple root bones. collada expresses this\n      // situtation with multiple \"skeleton\" tags per controller instance\n\n      for ( i = 0; i < skeletons.length; i ++ ) {\n\n        var skeleton = skeletons[ i ];\n\n        var root;\n\n        if ( hasNode( skeleton ) ) {\n\n          root = getNode( skeleton );\n          buildBoneHierarchy( root, joints, boneData );\n\n        } else if ( hasVisualScene( skeleton ) ) {\n\n          // handle case where the skeleton refers to the visual scene (#13335)\n\n          var visualScene = library.visualScenes[ skeleton ];\n          var children = visualScene.children;\n\n          for ( var j = 0; j < children.length; j ++ ) {\n\n            var child = children[ j ];\n\n            if ( child.type === 'JOINT' ) {\n\n              var root = getNode( child.id );\n              buildBoneHierarchy( root, joints, boneData );\n\n            }\n\n          }\n\n        } else {\n\n          console.error( 'THREE.ColladaLoader: Unable to find root bone of skeleton with ID:', skeleton );\n\n        }\n\n      }\n\n      // sort bone data (the order is defined in the corresponding controller)\n\n      for ( i = 0; i < joints.length; i ++ ) {\n\n        for ( j = 0; j < boneData.length; j ++ ) {\n\n          data = boneData[ j ];\n\n          if ( data.bone.name === joints[ i ].name ) {\n\n            sortedBoneData[ i ] = data;\n            data.processed = true;\n            break;\n\n          }\n\n        }\n\n      }\n\n      // add unprocessed bone data at the end of the list\n\n      for ( i = 0; i < boneData.length; i ++ ) {\n\n        data = boneData[ i ];\n\n        if ( data.processed === false ) {\n\n          sortedBoneData.push( data );\n          data.processed = true;\n\n        }\n\n      }\n\n      // setup arrays for skeleton creation\n\n      var bones = [];\n      var boneInverses = [];\n\n      for ( i = 0; i < sortedBoneData.length; i ++ ) {\n\n        data = sortedBoneData[ i ];\n\n        bones.push( data.bone );\n        boneInverses.push( data.boneInverse );\n\n      }\n\n      return new THREE.Skeleton( bones, boneInverses );\n\n    }\n\n    function buildBoneHierarchy( root, joints, boneData ) {\n\n      // setup bone data from visual scene\n\n      root.traverse( function ( object ) {\n\n        if ( object.isBone === true ) {\n\n          var boneInverse;\n\n          // retrieve the boneInverse from the controller data\n\n          for ( var i = 0; i < joints.length; i ++ ) {\n\n            var joint = joints[ i ];\n\n            if ( joint.name === object.name ) {\n\n              boneInverse = joint.boneInverse;\n              break;\n\n            }\n\n          }\n\n          if ( boneInverse === undefined ) {\n\n            // Unfortunately, there can be joints in the visual scene that are not part of the\n            // corresponding controller. In this case, we have to create a dummy boneInverse matrix\n            // for the respective bone. This bone won't affect any vertices, because there are no skin indices\n            // and weights defined for it. But we still have to add the bone to the sorted bone list in order to\n            // ensure a correct animation of the model.\n\n            boneInverse = new THREE.Matrix4();\n\n          }\n\n          boneData.push( { bone: object, boneInverse: boneInverse, processed: false } );\n\n        }\n\n      } );\n\n    }\n\n    function buildNode( data ) {\n\n      var objects = [];\n\n      var matrix = data.matrix;\n      var nodes = data.nodes;\n      var type = data.type;\n      var instanceCameras = data.instanceCameras;\n      var instanceControllers = data.instanceControllers;\n      var instanceLights = data.instanceLights;\n      var instanceGeometries = data.instanceGeometries;\n      var instanceNodes = data.instanceNodes;\n\n      // nodes\n\n      for ( var i = 0, l = nodes.length; i < l; i ++ ) {\n\n        objects.push( getNode( nodes[ i ] ) );\n\n      }\n\n      // instance cameras\n\n      for ( var i = 0, l = instanceCameras.length; i < l; i ++ ) {\n\n        var instanceCamera = getCamera( instanceCameras[ i ] );\n\n        if ( instanceCamera !== null ) {\n\n          objects.push( instanceCamera.clone() );\n\n        }\n\n      }\n\n      // instance controllers\n\n      for ( var i = 0, l = instanceControllers.length; i < l; i ++ ) {\n\n        var instance = instanceControllers[ i ];\n        var controller = getController( instance.id );\n        var geometries = getGeometry( controller.id );\n        var newObjects = buildObjects( geometries, instance.materials );\n\n        var skeletons = instance.skeletons;\n        var joints = controller.skin.joints;\n\n        var skeleton = buildSkeleton( skeletons, joints );\n\n        for ( var j = 0, jl = newObjects.length; j < jl; j ++ ) {\n\n          var object = newObjects[ j ];\n\n          if ( object.isSkinnedMesh ) {\n\n            object.bind( skeleton, controller.skin.bindMatrix );\n            object.normalizeSkinWeights();\n\n          }\n\n          objects.push( object );\n\n        }\n\n      }\n\n      // instance lights\n\n      for ( var i = 0, l = instanceLights.length; i < l; i ++ ) {\n\n        var instanceLight = getLight( instanceLights[ i ] );\n\n        if ( instanceLight !== null ) {\n\n          objects.push( instanceLight.clone() );\n\n        }\n\n      }\n\n      // instance geometries\n\n      for ( var i = 0, l = instanceGeometries.length; i < l; i ++ ) {\n\n        var instance = instanceGeometries[ i ];\n\n        // a single geometry instance in collada can lead to multiple object3Ds.\n        // this is the case when primitives are combined like triangles and lines\n\n        var geometries = getGeometry( instance.id );\n        var newObjects = buildObjects( geometries, instance.materials );\n\n        for ( var j = 0, jl = newObjects.length; j < jl; j ++ ) {\n\n          objects.push( newObjects[ j ] );\n\n        }\n\n      }\n\n      // instance nodes\n\n      for ( var i = 0, l = instanceNodes.length; i < l; i ++ ) {\n\n        objects.push( getNode( instanceNodes[ i ] ).clone() );\n\n      }\n\n      var object;\n\n      if ( nodes.length === 0 && objects.length === 1 ) {\n\n        object = objects[ 0 ];\n\n      } else {\n\n        object = ( type === 'JOINT' ) ? new THREE.Bone() : new THREE.Group();\n\n        for ( var i = 0; i < objects.length; i ++ ) {\n\n          object.add( objects[ i ] );\n\n        }\n\n      }\n\n      if ( object.name === '' ) {\n\n        object.name = ( type === 'JOINT' ) ? data.sid : data.name;\n\n      }\n\n      object.matrix.copy( matrix );\n      object.matrix.decompose( object.position, object.quaternion, object.scale );\n\n      return object;\n\n    }\n\n    var fallbackMaterial = new THREE.MeshBasicMaterial( { color: 0xff00ff } );\n\n    function resolveMaterialBinding( keys, instanceMaterials ) {\n\n      var materials = [];\n\n      for ( var i = 0, l = keys.length; i < l; i ++ ) {\n\n        var id = instanceMaterials[ keys[ i ] ];\n\n        if ( id === undefined ) {\n\n          console.warn( 'THREE.ColladaLoader: Material with key %s not found. Apply fallback material.', keys[ i ] );\n          materials.push( fallbackMaterial );\n\n        } else {\n\n          materials.push( getMaterial( id ) );\n\n        }\n\n      }\n\n      return materials;\n\n    }\n\n    function buildObjects( geometries, instanceMaterials ) {\n\n      var objects = [];\n\n      for ( var type in geometries ) {\n\n        var geometry = geometries[ type ];\n\n        var materials = resolveMaterialBinding( geometry.materialKeys, instanceMaterials );\n\n        // handle case if no materials are defined\n\n        if ( materials.length === 0 ) {\n\n          if ( type === 'lines' || type === 'linestrips' ) {\n\n            materials.push( new THREE.LineBasicMaterial() );\n\n          } else {\n\n            materials.push( new THREE.MeshPhongMaterial() );\n\n          }\n\n        }\n\n        // regard skinning\n\n        var skinning = ( geometry.data.attributes.skinIndex !== undefined );\n\n        if ( skinning ) {\n\n          for ( var i = 0, l = materials.length; i < l; i ++ ) {\n\n            materials[ i ].skinning = true;\n\n          }\n\n        }\n\n        // choose between a single or multi materials (material array)\n\n        var material = ( materials.length === 1 ) ? materials[ 0 ] : materials;\n\n        // now create a specific 3D object\n\n        var object;\n\n        switch ( type ) {\n\n          case 'lines':\n            object = new THREE.LineSegments( geometry.data, material );\n            break;\n\n          case 'linestrips':\n            object = new THREE.Line( geometry.data, material );\n            break;\n\n          case 'triangles':\n          case 'polylist':\n            if ( skinning ) {\n\n              object = new THREE.SkinnedMesh( geometry.data, material );\n\n            } else {\n\n              object = new THREE.Mesh( geometry.data, material );\n\n            }\n            break;\n\n        }\n\n        objects.push( object );\n\n      }\n\n      return objects;\n\n    }\n\n    function hasNode( id ) {\n\n      return library.nodes[ id ] !== undefined;\n\n    }\n\n    function getNode( id ) {\n\n      return getBuild( library.nodes[ id ], buildNode );\n\n    }\n\n    // visual scenes\n\n    function parseVisualScene( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'name' ),\n        children: []\n      };\n\n      prepareNodes( xml );\n\n      var elements = getElementsByTagName( xml, 'node' );\n\n      for ( var i = 0; i < elements.length; i ++ ) {\n\n        data.children.push( parseNode( elements[ i ] ) );\n\n      }\n\n      library.visualScenes[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function buildVisualScene( data ) {\n\n      var group = new THREE.Group();\n      group.name = data.name;\n\n      var children = data.children;\n\n      for ( var i = 0; i < children.length; i ++ ) {\n\n        var child = children[ i ];\n\n        group.add( getNode( child.id ) );\n\n      }\n\n      return group;\n\n    }\n\n    function hasVisualScene( id ) {\n\n      return library.visualScenes[ id ] !== undefined;\n\n    }\n\n    function getVisualScene( id ) {\n\n      return getBuild( library.visualScenes[ id ], buildVisualScene );\n\n    }\n\n    // scenes\n\n    function parseScene( xml ) {\n\n      var instance = getElementsByTagName( xml, 'instance_visual_scene' )[ 0 ];\n      return getVisualScene( parseId( instance.getAttribute( 'url' ) ) );\n\n    }\n\n    function setupAnimations() {\n\n      var clips = library.clips;\n\n      if ( isEmpty( clips ) === true ) {\n\n        if ( isEmpty( library.animations ) === false ) {\n\n          // if there are animations but no clips, we create a default clip for playback\n\n          var tracks = [];\n\n          for ( var id in library.animations ) {\n\n            var animationTracks = getAnimation( id );\n\n            for ( var i = 0, l = animationTracks.length; i < l; i ++ ) {\n\n              tracks.push( animationTracks[ i ] );\n\n            }\n\n          }\n\n          animations.push( new THREE.AnimationClip( 'default', - 1, tracks ) );\n\n        }\n\n      } else {\n\n        for ( var id in clips ) {\n\n          animations.push( getAnimationClip( id ) );\n\n        }\n\n      }\n\n    }\n\n    if ( text.length === 0 ) {\n\n      return { scene: new THREE.Scene() };\n\n    }\n\n    var xml = new DOMParser().parseFromString( text, 'application/xml' );\n\n    var collada = getElementsByTagName( xml, 'COLLADA' )[ 0 ];\n\n    // metadata\n\n    var version = collada.getAttribute( 'version' );\n    console.log( 'THREE.ColladaLoader: File version', version );\n\n    var asset = parseAsset( getElementsByTagName( collada, 'asset' )[ 0 ] );\n    var textureLoader = new THREE.TextureLoader( this.manager );\n    textureLoader.setPath( this.resourcePath || path ).setCrossOrigin( this.crossOrigin );\n\n    var tgaLoader;\n\n    if ( THREE.TGALoader ) {\n\n      tgaLoader = new THREE.TGALoader( this.manager );\n      tgaLoader.setPath( this.resourcePath || path );\n\n    }\n\n    //\n\n    var animations = [];\n    var kinematics = {};\n    var count = 0;\n\n    //\n\n    var library = {\n      animations: {},\n      clips: {},\n      controllers: {},\n      images: {},\n      effects: {},\n      materials: {},\n      cameras: {},\n      lights: {},\n      geometries: {},\n      nodes: {},\n      visualScenes: {},\n      kinematicsModels: {},\n      physicsModels: {},\n      kinematicsScenes: {}\n    };\n\n    parseLibrary( collada, 'library_animations', 'animation', parseAnimation );\n    parseLibrary( collada, 'library_animation_clips', 'animation_clip', parseAnimationClip );\n    parseLibrary( collada, 'library_controllers', 'controller', parseController );\n    parseLibrary( collada, 'library_images', 'image', parseImage );\n    parseLibrary( collada, 'library_effects', 'effect', parseEffect );\n    parseLibrary( collada, 'library_materials', 'material', parseMaterial );\n    parseLibrary( collada, 'library_cameras', 'camera', parseCamera );\n    parseLibrary( collada, 'library_lights', 'light', parseLight );\n    parseLibrary( collada, 'library_geometries', 'geometry', parseGeometry );\n    parseLibrary( collada, 'library_nodes', 'node', parseNode );\n    parseLibrary( collada, 'library_visual_scenes', 'visual_scene', parseVisualScene );\n    parseLibrary( collada, 'library_kinematics_models', 'kinematics_model', parseKinematicsModel );\n    parseLibrary( collada, 'library_physics_models', 'physics_model', parsePhysicsModel );\n    parseLibrary( collada, 'scene', 'instance_kinematics_scene', parseKinematicsScene );\n\n    buildLibrary( library.animations, buildAnimation );\n    buildLibrary( library.clips, buildAnimationClip );\n    buildLibrary( library.controllers, buildController );\n    buildLibrary( library.images, buildImage );\n    buildLibrary( library.effects, buildEffect );\n    buildLibrary( library.materials, buildMaterial );\n    buildLibrary( library.cameras, buildCamera );\n    buildLibrary( library.lights, buildLight );\n    buildLibrary( library.geometries, buildGeometry );\n    buildLibrary( library.visualScenes, buildVisualScene );\n\n    setupAnimations();\n    setupKinematics();\n\n    var scene = parseScene( getElementsByTagName( collada, 'scene' )[ 0 ] );\n\n    if ( asset.upAxis === 'Z_UP' ) {\n\n      scene.quaternion.setFromEuler( new THREE.Euler( - Math.PI / 2, 0, 0 ) );\n\n    }\n\n    scene.scale.multiplyScalar( asset.unit );\n\n    return {\n      animations: animations,\n      kinematics: kinematics,\n      library: library,\n      scene: scene\n    };\n\n  }\n\n};\n","THREE.FBXLoader = require('../../lib/FBXLoader');\n\n/**\n * fbx-model\n *\n * Loader for FBX format. Supports ASCII, but *not* binary, models.\n */\nmodule.exports = AFRAME.registerComponent('fbx-model', {\n  schema: {\n    src:         { type: 'asset' },\n    crossorigin: { default: '' }\n  },\n\n  init: function () {\n    this.model = null;\n  },\n\n  update: function () {\n    const data = this.data;\n    if (!data.src) return;\n\n    this.remove();\n    const loader = new THREE.FBXLoader();\n    if (data.crossorigin) loader.setCrossOrigin(data.crossorigin);\n    loader.load(data.src, this.load.bind(this));\n  },\n\n  load: function (model) {\n    this.model = model;\n    this.el.setObject3D('mesh', model);\n    this.el.emit('model-loaded', {format: 'fbx', model: model});\n  },\n\n  remove: function () {\n    if (this.model) this.el.removeObject3D('mesh');\n  }\n});\n","/**\n * @author Kyle-Larson https://github.com/Kyle-Larson\n * @author Takahiro https://github.com/takahirox\n * @author Lewy Blue https://github.com/looeee\n *\n * Loader loads FBX file and generates Group representing FBX scene.\n * Requires FBX file to be >= 7.0 and in ASCII or >= 6400 in Binary format\n * Versions lower than this may load but will probably have errors\n *\n * Needs Support:\n *  Morph normals / blend shape normals\n *\n * FBX format references:\n * \thttps://wiki.blender.org/index.php/User:Mont29/Foundation/FBX_File_Structure\n * \thttp://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_index_html (C++ SDK reference)\n *\n * \tBinary format specification:\n *\t\thttps://code.blender.org/2013/08/fbx-binary-file-format-specification/\n */\n\n\nmodule.exports = THREE.FBXLoader = ( function () {\n\n\tvar fbxTree;\n\tvar connections;\n\tvar sceneGraph;\n\n\tfunction FBXLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\n\t}\n\n\tFBXLoader.prototype = {\n\n\t\tconstructor: FBXLoader,\n\n\t\tcrossOrigin: 'anonymous',\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\t\t\tvar self = this;\n\n\t\t\tvar resourceDirectory = THREE.LoaderUtils.extractUrlBase( url );\n\n\t\t\tvar loader = new THREE.FileLoader( this.manager );\n\t\t\tloader.setResponseType( 'arraybuffer' );\n\t\t\tloader.load( url, function ( buffer ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\tvar scene = self.parse( buffer, resourceDirectory );\n\t\t\t\t\tonLoad( scene );\n\n\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\tsetTimeout( function () {\n\n\t\t\t\t\t\tif ( onError ) onError( error );\n\n\t\t\t\t\t\tself.manager.itemError( url );\n\n\t\t\t\t\t}, 0 );\n\n\t\t\t\t}\n\n\t\t\t}, onProgress, onError );\n\t\t},\n\n\t\tsetCrossOrigin: function ( value ) {\n\n\t\t\tthis.crossOrigin = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tparse: function ( FBXBuffer, resourceDirectory ) {\n\n\t\t\tif ( isFbxFormatBinary( FBXBuffer ) ) {\n\n\t\t\t\tfbxTree = new BinaryParser().parse( FBXBuffer );\n\n\t\t\t} else {\n\n\t\t\t\tvar FBXText = convertArrayBufferToString( FBXBuffer );\n\n\t\t\t\tif ( ! isFbxFormatASCII( FBXText ) ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown format.' );\n\n\t\t\t\t}\n\n\t\t\t\tif ( getFbxVersion( FBXText ) < 7000 ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.FBXLoader: FBX version not supported, FileVersion: ' + getFbxVersion( FBXText ) );\n\n\t\t\t\t}\n\n\t\t\t\tfbxTree = new TextParser().parse( FBXText );\n\n\t\t\t}\n\n\t\t\t//console.log( FBXTree );\n\n\t\t\tvar textureLoader = new THREE.TextureLoader( this.manager ).setPath( resourceDirectory ).setCrossOrigin( this.crossOrigin );\n\n\t\t\treturn new FBXTreeParser( textureLoader ).parse( fbxTree );\n\n\t\t}\n\n\t};\n\n\t// Parse the FBXTree object returned by the BinaryParser or TextParser and return a THREE.Group\n\tfunction FBXTreeParser( textureLoader ) {\n\n\t\tthis.textureLoader = textureLoader;\n\n\t}\n\n\tFBXTreeParser.prototype = {\n\n\t\tconstructor: FBXTreeParser,\n\n\t\tparse: function () {\n\n\t\t\tconnections = this.parseConnections();\n\n\t\t\tvar images = this.parseImages();\n\t\t\tvar textures = this.parseTextures( images );\n\t\t\tvar materials = this.parseMaterials( textures );\n\t\t\tvar deformers = this.parseDeformers();\n\t\t\tvar geometryMap = new GeometryParser().parse( deformers );\n\n\t\t\tthis.parseScene( deformers, geometryMap, materials );\n\n\t\t\treturn sceneGraph;\n\n\t\t},\n\n\t\t// Parses FBXTree.Connections which holds parent-child connections between objects (e.g. material -> texture, model->geometry )\n\t\t// and details the connection type\n\t\tparseConnections: function () {\n\n\t\t\tvar connectionMap = new Map();\n\n\t\t\tif ( 'Connections' in fbxTree ) {\n\n\t\t\t\tvar rawConnections = fbxTree.Connections.connections;\n\n\t\t\t\trawConnections.forEach( function ( rawConnection ) {\n\n\t\t\t\t\tvar fromID = rawConnection[ 0 ];\n\t\t\t\t\tvar toID = rawConnection[ 1 ];\n\t\t\t\t\tvar relationship = rawConnection[ 2 ];\n\n\t\t\t\t\tif ( ! connectionMap.has( fromID ) ) {\n\n\t\t\t\t\t\tconnectionMap.set( fromID, {\n\t\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\t\tchildren: []\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvar parentRelationship = { ID: toID, relationship: relationship };\n\t\t\t\t\tconnectionMap.get( fromID ).parents.push( parentRelationship );\n\n\t\t\t\t\tif ( ! connectionMap.has( toID ) ) {\n\n\t\t\t\t\t\tconnectionMap.set( toID, {\n\t\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\t\tchildren: []\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvar childRelationship = { ID: fromID, relationship: relationship };\n\t\t\t\t\tconnectionMap.get( toID ).children.push( childRelationship );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn connectionMap;\n\n\t\t},\n\n\t\t// Parse FBXTree.Objects.Video for embedded image data\n\t\t// These images are connected to textures in FBXTree.Objects.Textures\n\t\t// via FBXTree.Connections.\n\t\tparseImages: function () {\n\n\t\t\tvar images = {};\n\t\t\tvar blobs = {};\n\n\t\t\tif ( 'Video' in fbxTree.Objects ) {\n\n\t\t\t\tvar videoNodes = fbxTree.Objects.Video;\n\n\t\t\t\tfor ( var nodeID in videoNodes ) {\n\n\t\t\t\t\tvar videoNode = videoNodes[ nodeID ];\n\n\t\t\t\t\tvar id = parseInt( nodeID );\n\n\t\t\t\t\timages[ id ] = videoNode.RelativeFilename || videoNode.Filename;\n\n\t\t\t\t\t// raw image data is in videoNode.Content\n\t\t\t\t\tif ( 'Content' in videoNode ) {\n\n\t\t\t\t\t\tvar arrayBufferContent = ( videoNode.Content instanceof ArrayBuffer ) && ( videoNode.Content.byteLength > 0 );\n\t\t\t\t\t\tvar base64Content = ( typeof videoNode.Content === 'string' ) && ( videoNode.Content !== '' );\n\n\t\t\t\t\t\tif ( arrayBufferContent || base64Content ) {\n\n\t\t\t\t\t\t\tvar image = this.parseImage( videoNodes[ nodeID ] );\n\n\t\t\t\t\t\t\tblobs[ videoNode.RelativeFilename || videoNode.Filename ] = image;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor ( var id in images ) {\n\n\t\t\t\tvar filename = images[ id ];\n\n\t\t\t\tif ( blobs[ filename ] !== undefined ) images[ id ] = blobs[ filename ];\n\t\t\t\telse images[ id ] = images[ id ].split( '\\\\' ).pop();\n\n\t\t\t}\n\n\t\t\treturn images;\n\n\t\t},\n\n\t\t// Parse embedded image data in FBXTree.Video.Content\n\t\tparseImage: function ( videoNode ) {\n\n\t\t\tvar content = videoNode.Content;\n\t\t\tvar fileName = videoNode.RelativeFilename || videoNode.Filename;\n\t\t\tvar extension = fileName.slice( fileName.lastIndexOf( '.' ) + 1 ).toLowerCase();\n\n\t\t\tvar type;\n\n\t\t\tswitch ( extension ) {\n\n\t\t\t\tcase 'bmp':\n\n\t\t\t\t\ttype = 'image/bmp';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'jpg':\n\t\t\t\tcase 'jpeg':\n\n\t\t\t\t\ttype = 'image/jpeg';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'png':\n\n\t\t\t\t\ttype = 'image/png';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'tif':\n\n\t\t\t\t\ttype = 'image/tiff';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'tga':\n\n\t\t\t\t\tif ( typeof THREE.TGALoader !== 'function' ) {\n\n\t\t\t\t\t\tconsole.warn( 'FBXLoader: THREE.TGALoader is required to load TGA textures' );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( THREE.Loader.Handlers.get( '.tga' ) === null ) {\n\n\t\t\t\t\t\t\tTHREE.Loader.Handlers.add( /\\.tga$/i, new THREE.TGALoader() );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttype = 'image/tga';\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tconsole.warn( 'FBXLoader: Image type \"' + extension + '\" is not supported.' );\n\t\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( typeof content === 'string' ) { // ASCII format\n\n\t\t\t\treturn 'data:' + type + ';base64,' + content;\n\n\t\t\t} else { // Binary Format\n\n\t\t\t\tvar array = new Uint8Array( content );\n\t\t\t\treturn window.URL.createObjectURL( new Blob( [ array ], { type: type } ) );\n\n\t\t\t}\n\n\t\t},\n\n\t\t// Parse nodes in FBXTree.Objects.Texture\n\t\t// These contain details such as UV scaling, cropping, rotation etc and are connected\n\t\t// to images in FBXTree.Objects.Video\n\t\tparseTextures: function ( images ) {\n\n\t\t\tvar textureMap = new Map();\n\n\t\t\tif ( 'Texture' in fbxTree.Objects ) {\n\n\t\t\t\tvar textureNodes = fbxTree.Objects.Texture;\n\t\t\t\tfor ( var nodeID in textureNodes ) {\n\n\t\t\t\t\tvar texture = this.parseTexture( textureNodes[ nodeID ], images );\n\t\t\t\t\ttextureMap.set( parseInt( nodeID ), texture );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn textureMap;\n\n\t\t},\n\n\t\t// Parse individual node in FBXTree.Objects.Texture\n\t\tparseTexture: function ( textureNode, images ) {\n\n\t\t\tvar texture = this.loadTexture( textureNode, images );\n\n\t\t\ttexture.ID = textureNode.id;\n\n\t\t\ttexture.name = textureNode.attrName;\n\n\t\t\tvar wrapModeU = textureNode.WrapModeU;\n\t\t\tvar wrapModeV = textureNode.WrapModeV;\n\n\t\t\tvar valueU = wrapModeU !== undefined ? wrapModeU.value : 0;\n\t\t\tvar valueV = wrapModeV !== undefined ? wrapModeV.value : 0;\n\n\t\t\t// http://download.autodesk.com/us/fbx/SDKdocs/FBX_SDK_Help/files/fbxsdkref/class_k_fbx_texture.html#889640e63e2e681259ea81061b85143a\n\t\t\t// 0: repeat(default), 1: clamp\n\n\t\t\ttexture.wrapS = valueU === 0 ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;\n\t\t\ttexture.wrapT = valueV === 0 ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;\n\n\t\t\tif ( 'Scaling' in textureNode ) {\n\n\t\t\t\tvar values = textureNode.Scaling.value;\n\n\t\t\t\ttexture.repeat.x = values[ 0 ];\n\t\t\t\ttexture.repeat.y = values[ 1 ];\n\n\t\t\t}\n\n\t\t\treturn texture;\n\n\t\t},\n\n\t\t// load a texture specified as a blob or data URI, or via an external URL using THREE.TextureLoader\n\t\tloadTexture: function ( textureNode, images ) {\n\n\t\t\tvar fileName;\n\n\t\t\tvar currentPath = this.textureLoader.path;\n\n\t\t\tvar children = connections.get( textureNode.id ).children;\n\n\t\t\tif ( children !== undefined && children.length > 0 && images[ children[ 0 ].ID ] !== undefined ) {\n\n\t\t\t\tfileName = images[ children[ 0 ].ID ];\n\n\t\t\t\tif ( fileName.indexOf( 'blob:' ) === 0 || fileName.indexOf( 'data:' ) === 0 ) {\n\n\t\t\t\t\tthis.textureLoader.setPath( undefined );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar texture;\n\n\t\t\tvar extension = textureNode.FileName.slice( - 3 ).toLowerCase();\n\n\t\t\tif ( extension === 'tga' ) {\n\n\t\t\t\tvar loader = THREE.Loader.Handlers.get( '.tga' );\n\n\t\t\t\tif ( loader === null ) {\n\n\t\t\t\t\tconsole.warn( 'FBXLoader: TGALoader not found, creating empty placeholder texture for', fileName );\n\t\t\t\t\ttexture = new THREE.Texture();\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttexture = loader.load( fileName );\n\n\t\t\t\t}\n\n\t\t\t} else if ( extension === 'psd' ) {\n\n\t\t\t\tconsole.warn( 'FBXLoader: PSD textures are not supported, creating empty placeholder texture for', fileName );\n\t\t\t\ttexture = new THREE.Texture();\n\n\t\t\t} else {\n\n\t\t\t\ttexture = this.textureLoader.load( fileName );\n\n\t\t\t}\n\n\t\t\tthis.textureLoader.setPath( currentPath );\n\n\t\t\treturn texture;\n\n\t\t},\n\n\t\t// Parse nodes in FBXTree.Objects.Material\n\t\tparseMaterials: function ( textureMap ) {\n\n\t\t\tvar materialMap = new Map();\n\n\t\t\tif ( 'Material' in fbxTree.Objects ) {\n\n\t\t\t\tvar materialNodes = fbxTree.Objects.Material;\n\n\t\t\t\tfor ( var nodeID in materialNodes ) {\n\n\t\t\t\t\tvar material = this.parseMaterial( materialNodes[ nodeID ], textureMap );\n\n\t\t\t\t\tif ( material !== null ) materialMap.set( parseInt( nodeID ), material );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn materialMap;\n\n\t\t},\n\n\t\t// Parse single node in FBXTree.Objects.Material\n\t\t// Materials are connected to texture maps in FBXTree.Objects.Textures\n\t\t// FBX format currently only supports Lambert and Phong shading models\n\t\tparseMaterial: function ( materialNode, textureMap ) {\n\n\t\t\tvar ID = materialNode.id;\n\t\t\tvar name = materialNode.attrName;\n\t\t\tvar type = materialNode.ShadingModel;\n\n\t\t\t// Case where FBX wraps shading model in property object.\n\t\t\tif ( typeof type === 'object' ) {\n\n\t\t\t\ttype = type.value;\n\n\t\t\t}\n\n\t\t\t// Ignore unused materials which don't have any connections.\n\t\t\tif ( ! connections.has( ID ) ) return null;\n\n\t\t\tvar parameters = this.parseParameters( materialNode, textureMap, ID );\n\n\t\t\tvar material;\n\n\t\t\tswitch ( type.toLowerCase() ) {\n\n\t\t\t\tcase 'phong':\n\t\t\t\t\tmaterial = new THREE.MeshPhongMaterial();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'lambert':\n\t\t\t\t\tmaterial = new THREE.MeshLambertMaterial();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: unknown material type \"%s\". Defaulting to MeshPhongMaterial.', type );\n\t\t\t\t\tmaterial = new THREE.MeshPhongMaterial( { color: 0x3300ff } );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tmaterial.setValues( parameters );\n\t\t\tmaterial.name = name;\n\n\t\t\treturn material;\n\n\t\t},\n\n\t\t// Parse FBX material and return parameters suitable for a three.js material\n\t\t// Also parse the texture map and return any textures associated with the material\n\t\tparseParameters: function ( materialNode, textureMap, ID ) {\n\n\t\t\tvar parameters = {};\n\n\t\t\tif ( materialNode.BumpFactor ) {\n\n\t\t\t\tparameters.bumpScale = materialNode.BumpFactor.value;\n\n\t\t\t}\n\t\t\tif ( materialNode.Diffuse ) {\n\n\t\t\t\tparameters.color = new THREE.Color().fromArray( materialNode.Diffuse.value );\n\n\t\t\t} else if ( materialNode.DiffuseColor && materialNode.DiffuseColor.type === 'Color' ) {\n\n\t\t\t\t// The blender exporter exports diffuse here instead of in materialNode.Diffuse\n\t\t\t\tparameters.color = new THREE.Color().fromArray( materialNode.DiffuseColor.value );\n\n\t\t\t}\n\t\t\tif ( materialNode.DisplacementFactor ) {\n\n\t\t\t\tparameters.displacementScale = materialNode.DisplacementFactor.value;\n\n\t\t\t}\n\t\t\tif ( materialNode.Emissive ) {\n\n\t\t\t\tparameters.emissive = new THREE.Color().fromArray( materialNode.Emissive.value );\n\n\t\t\t} else if ( materialNode.EmissiveColor && materialNode.EmissiveColor.type === 'Color' ) {\n\n\t\t\t\t// The blender exporter exports emissive color here instead of in materialNode.Emissive\n\t\t\t\tparameters.emissive = new THREE.Color().fromArray( materialNode.EmissiveColor.value );\n\n\t\t\t}\n\t\t\tif ( materialNode.EmissiveFactor ) {\n\n\t\t\t\tparameters.emissiveIntensity = parseFloat( materialNode.EmissiveFactor.value );\n\n\t\t\t}\n\t\t\tif ( materialNode.Opacity ) {\n\n\t\t\t\tparameters.opacity = parseFloat( materialNode.Opacity.value );\n\n\t\t\t}\n\t\t\tif ( parameters.opacity < 1.0 ) {\n\n\t\t\t\tparameters.transparent = true;\n\n\t\t\t}\n\t\t\tif ( materialNode.ReflectionFactor ) {\n\n\t\t\t\tparameters.reflectivity = materialNode.ReflectionFactor.value;\n\n\t\t\t}\n\t\t\tif ( materialNode.Shininess ) {\n\n\t\t\t\tparameters.shininess = materialNode.Shininess.value;\n\n\t\t\t}\n\t\t\tif ( materialNode.Specular ) {\n\n\t\t\t\tparameters.specular = new THREE.Color().fromArray( materialNode.Specular.value );\n\n\t\t\t} else if ( materialNode.SpecularColor && materialNode.SpecularColor.type === 'Color' ) {\n\n\t\t\t\t// The blender exporter exports specular color here instead of in materialNode.Specular\n\t\t\t\tparameters.specular = new THREE.Color().fromArray( materialNode.SpecularColor.value );\n\n\t\t\t}\n\n\t\t\tvar self = this;\n\t\t\tconnections.get( ID ).children.forEach( function ( child ) {\n\n\t\t\t\tvar type = child.relationship;\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase 'Bump':\n\t\t\t\t\t\tparameters.bumpMap = self.getTexture( textureMap, child.ID );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'DiffuseColor':\n\t\t\t\t\t\tparameters.map = self.getTexture( textureMap, child.ID );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'DisplacementColor':\n\t\t\t\t\t\tparameters.displacementMap = self.getTexture( textureMap, child.ID );\n\t\t\t\t\t\tbreak;\n\n\n\t\t\t\t\tcase 'EmissiveColor':\n\t\t\t\t\t\tparameters.emissiveMap = self.getTexture( textureMap, child.ID );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'NormalMap':\n\t\t\t\t\t\tparameters.normalMap = self.getTexture( textureMap, child.ID );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'ReflectionColor':\n\t\t\t\t\t\tparameters.envMap = self.getTexture( textureMap, child.ID );\n\t\t\t\t\t\tparameters.envMap.mapping = THREE.EquirectangularReflectionMapping;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'SpecularColor':\n\t\t\t\t\t\tparameters.specularMap = self.getTexture( textureMap, child.ID );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'TransparentColor':\n\t\t\t\t\t\tparameters.alphaMap = self.getTexture( textureMap, child.ID );\n\t\t\t\t\t\tparameters.transparent = true;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'AmbientColor':\n\t\t\t\t\tcase 'ShininessExponent': // AKA glossiness map\n\t\t\t\t\tcase 'SpecularFactor': // AKA specularLevel\n\t\t\t\t\tcase 'VectorDisplacementColor': // NOTE: Seems to be a copy of DisplacementColor\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: %s map is not supported in three.js, skipping texture.', type );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\treturn parameters;\n\n\t\t},\n\n\t\t// get a texture from the textureMap for use by a material.\n\t\tgetTexture: function ( textureMap, id ) {\n\n\t\t\t// if the texture is a layered texture, just use the first layer and issue a warning\n\t\t\tif ( 'LayeredTexture' in fbxTree.Objects && id in fbxTree.Objects.LayeredTexture ) {\n\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer.' );\n\t\t\t\tid = connections.get( id ).children[ 0 ].ID;\n\n\t\t\t}\n\n\t\t\treturn textureMap.get( id );\n\n\t\t},\n\n\t\t// Parse nodes in FBXTree.Objects.Deformer\n\t\t// Deformer node can contain skinning or Vertex Cache animation data, however only skinning is supported here\n\t\t// Generates map of Skeleton-like objects for use later when generating and binding skeletons.\n\t\tparseDeformers: function () {\n\n\t\t\tvar skeletons = {};\n\t\t\tvar morphTargets = {};\n\n\t\t\tif ( 'Deformer' in fbxTree.Objects ) {\n\n\t\t\t\tvar DeformerNodes = fbxTree.Objects.Deformer;\n\n\t\t\t\tfor ( var nodeID in DeformerNodes ) {\n\n\t\t\t\t\tvar deformerNode = DeformerNodes[ nodeID ];\n\n\t\t\t\t\tvar relationships = connections.get( parseInt( nodeID ) );\n\n\t\t\t\t\tif ( deformerNode.attrType === 'Skin' ) {\n\n\t\t\t\t\t\tvar skeleton = this.parseSkeleton( relationships, DeformerNodes );\n\t\t\t\t\t\tskeleton.ID = nodeID;\n\n\t\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: skeleton attached to more than one geometry is not supported.' );\n\t\t\t\t\t\tskeleton.geometryID = relationships.parents[ 0 ].ID;\n\n\t\t\t\t\t\tskeletons[ nodeID ] = skeleton;\n\n\t\t\t\t\t} else if ( deformerNode.attrType === 'BlendShape' ) {\n\n\t\t\t\t\t\tvar morphTarget = {\n\t\t\t\t\t\t\tid: nodeID,\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tmorphTarget.rawTargets = this.parseMorphTargets( relationships, DeformerNodes );\n\t\t\t\t\t\tmorphTarget.id = nodeID;\n\n\t\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: morph target attached to more than one geometry is not supported.' );\n\n\t\t\t\t\t\tmorphTargets[ nodeID ] = morphTarget;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {\n\n\t\t\t\tskeletons: skeletons,\n\t\t\t\tmorphTargets: morphTargets,\n\n\t\t\t};\n\n\t\t},\n\n\t\t// Parse single nodes in FBXTree.Objects.Deformer\n\t\t// The top level skeleton node has type 'Skin' and sub nodes have type 'Cluster'\n\t\t// Each skin node represents a skeleton and each cluster node represents a bone\n\t\tparseSkeleton: function ( relationships, deformerNodes ) {\n\n\t\t\tvar rawBones = [];\n\n\t\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\t\tvar boneNode = deformerNodes[ child.ID ];\n\n\t\t\t\tif ( boneNode.attrType !== 'Cluster' ) return;\n\n\t\t\t\tvar rawBone = {\n\n\t\t\t\t\tID: child.ID,\n\t\t\t\t\tindices: [],\n\t\t\t\t\tweights: [],\n\t\t\t\t\ttransform: new THREE.Matrix4().fromArray( boneNode.Transform.a ),\n\t\t\t\t\ttransformLink: new THREE.Matrix4().fromArray( boneNode.TransformLink.a ),\n\t\t\t\t\tlinkMode: boneNode.Mode,\n\n\t\t\t\t};\n\n\t\t\t\tif ( 'Indexes' in boneNode ) {\n\n\t\t\t\t\trawBone.indices = boneNode.Indexes.a;\n\t\t\t\t\trawBone.weights = boneNode.Weights.a;\n\n\t\t\t\t}\n\n\t\t\t\trawBones.push( rawBone );\n\n\t\t\t} );\n\n\t\t\treturn {\n\n\t\t\t\trawBones: rawBones,\n\t\t\t\tbones: []\n\n\t\t\t};\n\n\t\t},\n\n\t\t// The top level morph deformer node has type \"BlendShape\" and sub nodes have type \"BlendShapeChannel\"\n\t\tparseMorphTargets: function ( relationships, deformerNodes ) {\n\n\t\t\tvar rawMorphTargets = [];\n\n\t\t\tfor ( var i = 0; i < relationships.children.length; i ++ ) {\n\n\t\t\t\tif ( i === 8 ) {\n\n\t\t\t\t\tconsole.warn( 'FBXLoader: maximum of 8 morph targets supported. Ignoring additional targets.' );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tvar child = relationships.children[ i ];\n\n\t\t\t\tvar morphTargetNode = deformerNodes[ child.ID ];\n\n\t\t\t\tvar rawMorphTarget = {\n\n\t\t\t\t\tname: morphTargetNode.attrName,\n\t\t\t\t\tinitialWeight: morphTargetNode.DeformPercent,\n\t\t\t\t\tid: morphTargetNode.id,\n\t\t\t\t\tfullWeights: morphTargetNode.FullWeights.a\n\n\t\t\t\t};\n\n\t\t\t\tif ( morphTargetNode.attrType !== 'BlendShapeChannel' ) return;\n\n\t\t\t\tvar targetRelationships = connections.get( parseInt( child.ID ) );\n\n\t\t\t\ttargetRelationships.children.forEach( function ( child ) {\n\n\t\t\t\t\tif ( child.relationship === undefined ) rawMorphTarget.geoID = child.ID;\n\n\t\t\t\t} );\n\n\t\t\t\trawMorphTargets.push( rawMorphTarget );\n\n\t\t\t}\n\n\t\t\treturn rawMorphTargets;\n\n\t\t},\n\n\t\t// create the main THREE.Group() to be returned by the loader\n\t\tparseScene: function ( deformers, geometryMap, materialMap ) {\n\n\t\t\tsceneGraph = new THREE.Group();\n\n\t\t\tvar modelMap = this.parseModels( deformers.skeletons, geometryMap, materialMap );\n\n\t\t\tvar modelNodes = fbxTree.Objects.Model;\n\n\t\t\tvar self = this;\n\t\t\tmodelMap.forEach( function ( model ) {\n\n\t\t\t\tvar modelNode = modelNodes[ model.ID ];\n\t\t\t\tself.setLookAtProperties( model, modelNode );\n\n\t\t\t\tvar parentConnections = connections.get( model.ID ).parents;\n\n\t\t\t\tparentConnections.forEach( function ( connection ) {\n\n\t\t\t\t\tvar parent = modelMap.get( connection.ID );\n\t\t\t\t\tif ( parent !== undefined ) parent.add( model );\n\n\t\t\t\t} );\n\n\t\t\t\tif ( model.parent === null ) {\n\n\t\t\t\t\tsceneGraph.add( model );\n\n\t\t\t\t}\n\n\n\t\t\t} );\n\n\t\t\tthis.bindSkeleton( deformers.skeletons, geometryMap, modelMap );\n\n\t\t\tthis.createAmbientLight();\n\n\t\t\tthis.setupMorphMaterials();\n\n\t\t\tvar animations = new AnimationParser().parse();\n\n\t\t\t// if all the models where already combined in a single group, just return that\n\t\t\tif ( sceneGraph.children.length === 1 && sceneGraph.children[ 0 ].isGroup ) {\n\n\t\t\t\tsceneGraph.children[ 0 ].animations = animations;\n\t\t\t\tsceneGraph = sceneGraph.children[ 0 ];\n\n\t\t\t}\n\n\t\t\tsceneGraph.animations = animations;\n\n\t\t},\n\n\t\t// parse nodes in FBXTree.Objects.Model\n\t\tparseModels: function ( skeletons, geometryMap, materialMap ) {\n\n\t\t\tvar modelMap = new Map();\n\t\t\tvar modelNodes = fbxTree.Objects.Model;\n\n\t\t\tfor ( var nodeID in modelNodes ) {\n\n\t\t\t\tvar id = parseInt( nodeID );\n\t\t\t\tvar node = modelNodes[ nodeID ];\n\t\t\t\tvar relationships = connections.get( id );\n\n\t\t\t\tvar model = this.buildSkeleton( relationships, skeletons, id, node.attrName );\n\n\t\t\t\tif ( ! model ) {\n\n\t\t\t\t\tswitch ( node.attrType ) {\n\n\t\t\t\t\t\tcase 'Camera':\n\t\t\t\t\t\t\tmodel = this.createCamera( relationships );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'Light':\n\t\t\t\t\t\t\tmodel = this.createLight( relationships );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'Mesh':\n\t\t\t\t\t\t\tmodel = this.createMesh( relationships, geometryMap, materialMap );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'NurbsCurve':\n\t\t\t\t\t\t\tmodel = this.createCurve( relationships, geometryMap );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'LimbNode': // usually associated with a Bone, however if a Bone was not created we'll make a Group instead\n\t\t\t\t\t\tcase 'Null':\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tmodel = new THREE.Group();\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmodel.name = THREE.PropertyBinding.sanitizeNodeName( node.attrName );\n\t\t\t\t\tmodel.ID = id;\n\n\t\t\t\t}\n\n\t\t\t\tthis.setModelTransforms( model, node );\n\t\t\t\tmodelMap.set( id, model );\n\n\t\t\t}\n\n\t\t\treturn modelMap;\n\n\t\t},\n\n\t\tbuildSkeleton: function ( relationships, skeletons, id, name ) {\n\n\t\t\tvar bone = null;\n\n\t\t\trelationships.parents.forEach( function ( parent ) {\n\n\t\t\t\tfor ( var ID in skeletons ) {\n\n\t\t\t\t\tvar skeleton = skeletons[ ID ];\n\n\t\t\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t\t\tif ( rawBone.ID === parent.ID ) {\n\n\t\t\t\t\t\t\tvar subBone = bone;\n\t\t\t\t\t\t\tbone = new THREE.Bone();\n\t\t\t\t\t\t\tbone.matrixWorld.copy( rawBone.transformLink );\n\n\t\t\t\t\t\t\t// set name and id here - otherwise in cases where \"subBone\" is created it will not have a name / id\n\t\t\t\t\t\t\tbone.name = THREE.PropertyBinding.sanitizeNodeName( name );\n\t\t\t\t\t\t\tbone.ID = id;\n\n\t\t\t\t\t\t\tskeleton.bones[ i ] = bone;\n\n\t\t\t\t\t\t\t// In cases where a bone is shared between multiple meshes\n\t\t\t\t\t\t\t// duplicate the bone here and and it as a child of the first bone\n\t\t\t\t\t\t\tif ( subBone !== null ) {\n\n\t\t\t\t\t\t\t\tbone.add( subBone );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\treturn bone;\n\n\t\t},\n\n\t\t// create a THREE.PerspectiveCamera or THREE.OrthographicCamera\n\t\tcreateCamera: function ( relationships ) {\n\n\t\t\tvar model;\n\t\t\tvar cameraAttribute;\n\n\t\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\t\tvar attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\t\tcameraAttribute = attr;\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\tif ( cameraAttribute === undefined ) {\n\n\t\t\t\tmodel = new THREE.Object3D();\n\n\t\t\t} else {\n\n\t\t\t\tvar type = 0;\n\t\t\t\tif ( cameraAttribute.CameraProjectionType !== undefined && cameraAttribute.CameraProjectionType.value === 1 ) {\n\n\t\t\t\t\ttype = 1;\n\n\t\t\t\t}\n\n\t\t\t\tvar nearClippingPlane = 1;\n\t\t\t\tif ( cameraAttribute.NearPlane !== undefined ) {\n\n\t\t\t\t\tnearClippingPlane = cameraAttribute.NearPlane.value / 1000;\n\n\t\t\t\t}\n\n\t\t\t\tvar farClippingPlane = 1000;\n\t\t\t\tif ( cameraAttribute.FarPlane !== undefined ) {\n\n\t\t\t\t\tfarClippingPlane = cameraAttribute.FarPlane.value / 1000;\n\n\t\t\t\t}\n\n\n\t\t\t\tvar width = window.innerWidth;\n\t\t\t\tvar height = window.innerHeight;\n\n\t\t\t\tif ( cameraAttribute.AspectWidth !== undefined && cameraAttribute.AspectHeight !== undefined ) {\n\n\t\t\t\t\twidth = cameraAttribute.AspectWidth.value;\n\t\t\t\t\theight = cameraAttribute.AspectHeight.value;\n\n\t\t\t\t}\n\n\t\t\t\tvar aspect = width / height;\n\n\t\t\t\tvar fov = 45;\n\t\t\t\tif ( cameraAttribute.FieldOfView !== undefined ) {\n\n\t\t\t\t\tfov = cameraAttribute.FieldOfView.value;\n\n\t\t\t\t}\n\n\t\t\t\tvar focalLength = cameraAttribute.FocalLength ? cameraAttribute.FocalLength.value : null;\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase 0: // Perspective\n\t\t\t\t\t\tmodel = new THREE.PerspectiveCamera( fov, aspect, nearClippingPlane, farClippingPlane );\n\t\t\t\t\t\tif ( focalLength !== null ) model.setFocalLength( focalLength );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 1: // Orthographic\n\t\t\t\t\t\tmodel = new THREE.OrthographicCamera( - width / 2, width / 2, height / 2, - height / 2, nearClippingPlane, farClippingPlane );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown camera type ' + type + '.' );\n\t\t\t\t\t\tmodel = new THREE.Object3D();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn model;\n\n\t\t},\n\n\t\t// Create a THREE.DirectionalLight, THREE.PointLight or THREE.SpotLight\n\t\tcreateLight: function ( relationships ) {\n\n\t\t\tvar model;\n\t\t\tvar lightAttribute;\n\n\t\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\t\tvar attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\t\tlightAttribute = attr;\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\tif ( lightAttribute === undefined ) {\n\n\t\t\t\tmodel = new THREE.Object3D();\n\n\t\t\t} else {\n\n\t\t\t\tvar type;\n\n\t\t\t\t// LightType can be undefined for Point lights\n\t\t\t\tif ( lightAttribute.LightType === undefined ) {\n\n\t\t\t\t\ttype = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttype = lightAttribute.LightType.value;\n\n\t\t\t\t}\n\n\t\t\t\tvar color = 0xffffff;\n\n\t\t\t\tif ( lightAttribute.Color !== undefined ) {\n\n\t\t\t\t\tcolor = new THREE.Color().fromArray( lightAttribute.Color.value );\n\n\t\t\t\t}\n\n\t\t\t\tvar intensity = ( lightAttribute.Intensity === undefined ) ? 1 : lightAttribute.Intensity.value / 100;\n\n\t\t\t\t// light disabled\n\t\t\t\tif ( lightAttribute.CastLightOnObject !== undefined && lightAttribute.CastLightOnObject.value === 0 ) {\n\n\t\t\t\t\tintensity = 0;\n\n\t\t\t\t}\n\n\t\t\t\tvar distance = 0;\n\t\t\t\tif ( lightAttribute.FarAttenuationEnd !== undefined ) {\n\n\t\t\t\t\tif ( lightAttribute.EnableFarAttenuation !== undefined && lightAttribute.EnableFarAttenuation.value === 0 ) {\n\n\t\t\t\t\t\tdistance = 0;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tdistance = lightAttribute.FarAttenuationEnd.value;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// TODO: could this be calculated linearly from FarAttenuationStart to FarAttenuationEnd?\n\t\t\t\tvar decay = 1;\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase 0: // Point\n\t\t\t\t\t\tmodel = new THREE.PointLight( color, intensity, distance, decay );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 1: // Directional\n\t\t\t\t\t\tmodel = new THREE.DirectionalLight( color, intensity );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 2: // Spot\n\t\t\t\t\t\tvar angle = Math.PI / 3;\n\n\t\t\t\t\t\tif ( lightAttribute.InnerAngle !== undefined ) {\n\n\t\t\t\t\t\t\tangle = THREE.Math.degToRad( lightAttribute.InnerAngle.value );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar penumbra = 0;\n\t\t\t\t\t\tif ( lightAttribute.OuterAngle !== undefined ) {\n\n\t\t\t\t\t\t// TODO: this is not correct - FBX calculates outer and inner angle in degrees\n\t\t\t\t\t\t// with OuterAngle > InnerAngle && OuterAngle <= Math.PI\n\t\t\t\t\t\t// while three.js uses a penumbra between (0, 1) to attenuate the inner angle\n\t\t\t\t\t\t\tpenumbra = THREE.Math.degToRad( lightAttribute.OuterAngle.value );\n\t\t\t\t\t\t\tpenumbra = Math.max( penumbra, 1 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmodel = new THREE.SpotLight( color, intensity, distance, angle, penumbra, decay );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown light type ' + lightAttribute.LightType.value + ', defaulting to a THREE.PointLight.' );\n\t\t\t\t\t\tmodel = new THREE.PointLight( color, intensity );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tif ( lightAttribute.CastShadows !== undefined && lightAttribute.CastShadows.value === 1 ) {\n\n\t\t\t\t\tmodel.castShadow = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn model;\n\n\t\t},\n\n\t\tcreateMesh: function ( relationships, geometryMap, materialMap ) {\n\n\t\t\tvar model;\n\t\t\tvar geometry = null;\n\t\t\tvar material = null;\n\t\t\tvar materials = [];\n\n\t\t\t// get geometry and materials(s) from connections\n\t\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\t\tif ( geometryMap.has( child.ID ) ) {\n\n\t\t\t\t\tgeometry = geometryMap.get( child.ID );\n\n\t\t\t\t}\n\n\t\t\t\tif ( materialMap.has( child.ID ) ) {\n\n\t\t\t\t\tmaterials.push( materialMap.get( child.ID ) );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\tif ( materials.length > 1 ) {\n\n\t\t\t\tmaterial = materials;\n\n\t\t\t} else if ( materials.length > 0 ) {\n\n\t\t\t\tmaterial = materials[ 0 ];\n\n\t\t\t} else {\n\n\t\t\t\tmaterial = new THREE.MeshPhongMaterial( { color: 0xcccccc } );\n\t\t\t\tmaterials.push( material );\n\n\t\t\t}\n\n\t\t\tif ( 'color' in geometry.attributes ) {\n\n\t\t\t\tmaterials.forEach( function ( material ) {\n\n\t\t\t\t\tmaterial.vertexColors = THREE.VertexColors;\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tif ( geometry.FBX_Deformer ) {\n\n\t\t\t\tmaterials.forEach( function ( material ) {\n\n\t\t\t\t\tmaterial.skinning = true;\n\n\t\t\t\t} );\n\n\t\t\t\tmodel = new THREE.SkinnedMesh( geometry, material );\n\n\t\t\t} else {\n\n\t\t\t\tmodel = new THREE.Mesh( geometry, material );\n\n\t\t\t}\n\n\t\t\treturn model;\n\n\t\t},\n\n\t\tcreateCurve: function ( relationships, geometryMap ) {\n\n\t\t\tvar geometry = relationships.children.reduce( function ( geo, child ) {\n\n\t\t\t\tif ( geometryMap.has( child.ID ) ) geo = geometryMap.get( child.ID );\n\n\t\t\t\treturn geo;\n\n\t\t\t}, null );\n\n\t\t\t// FBX does not list materials for Nurbs lines, so we'll just put our own in here.\n\t\t\tvar material = new THREE.LineBasicMaterial( { color: 0x3300ff, linewidth: 1 } );\n\t\t\treturn new THREE.Line( geometry, material );\n\n\t\t},\n\n\t\t// parse the model node for transform details and apply them to the model\n\t\tsetModelTransforms: function ( model, modelNode ) {\n\n\t\t\tvar transformData = {};\n\n\t\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = parseInt( modelNode.RotationOrder.value );\n\t\t\tif ( 'Lcl_Translation' in modelNode ) transformData.translation = modelNode.Lcl_Translation.value;\n\t\t\tif ( 'RotationOffset' in modelNode ) transformData.rotationOffset = modelNode.RotationOffset.value;\n\t\t\tif ( 'Lcl_Rotation' in modelNode ) transformData.rotation = modelNode.Lcl_Rotation.value;\n\t\t\tif ( 'PreRotation' in modelNode ) transformData.preRotation = modelNode.PreRotation.value;\n\t\t\tif ( 'PostRotation' in modelNode ) transformData.postRotation = modelNode.PostRotation.value;\n\t\t\tif ( 'Lcl_Scaling' in modelNode ) transformData.scale = modelNode.Lcl_Scaling.value;\n\n\t\t\tvar transform = generateTransform( transformData );\n\n\t\t\tmodel.applyMatrix( transform );\n\n\t\t},\n\n\t\tsetLookAtProperties: function ( model, modelNode ) {\n\n\t\t\tif ( 'LookAtProperty' in modelNode ) {\n\n\t\t\t\tvar children = connections.get( model.ID ).children;\n\n\t\t\t\tchildren.forEach( function ( child ) {\n\n\t\t\t\t\tif ( child.relationship === 'LookAtProperty' ) {\n\n\t\t\t\t\t\tvar lookAtTarget = fbxTree.Objects.Model[ child.ID ];\n\n\t\t\t\t\t\tif ( 'Lcl_Translation' in lookAtTarget ) {\n\n\t\t\t\t\t\t\tvar pos = lookAtTarget.Lcl_Translation.value;\n\n\t\t\t\t\t\t\t// DirectionalLight, SpotLight\n\t\t\t\t\t\t\tif ( model.target !== undefined ) {\n\n\t\t\t\t\t\t\t\tmodel.target.position.fromArray( pos );\n\t\t\t\t\t\t\t\tsceneGraph.add( model.target );\n\n\t\t\t\t\t\t\t} else { // Cameras and other Object3Ds\n\n\t\t\t\t\t\t\t\tmodel.lookAt( new THREE.Vector3().fromArray( pos ) );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t},\n\n\t\tbindSkeleton: function ( skeletons, geometryMap, modelMap ) {\n\n\t\t\tvar bindMatrices = this.parsePoseNodes();\n\n\t\t\tfor ( var ID in skeletons ) {\n\n\t\t\t\tvar skeleton = skeletons[ ID ];\n\n\t\t\t\tvar parents = connections.get( parseInt( skeleton.ID ) ).parents;\n\n\t\t\t\tparents.forEach( function ( parent ) {\n\n\t\t\t\t\tif ( geometryMap.has( parent.ID ) ) {\n\n\t\t\t\t\t\tvar geoID = parent.ID;\n\t\t\t\t\t\tvar geoRelationships = connections.get( geoID );\n\n\t\t\t\t\t\tgeoRelationships.parents.forEach( function ( geoConnParent ) {\n\n\t\t\t\t\t\t\tif ( modelMap.has( geoConnParent.ID ) ) {\n\n\t\t\t\t\t\t\t\tvar model = modelMap.get( geoConnParent.ID );\n\n\t\t\t\t\t\t\t\tmodel.bind( new THREE.Skeleton( skeleton.bones ), bindMatrices[ geoConnParent.ID ] );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t},\n\n\t\tparsePoseNodes: function () {\n\n\t\t\tvar bindMatrices = {};\n\n\t\t\tif ( 'Pose' in fbxTree.Objects ) {\n\n\t\t\t\tvar BindPoseNode = fbxTree.Objects.Pose;\n\n\t\t\t\tfor ( var nodeID in BindPoseNode ) {\n\n\t\t\t\t\tif ( BindPoseNode[ nodeID ].attrType === 'BindPose' ) {\n\n\t\t\t\t\t\tvar poseNodes = BindPoseNode[ nodeID ].PoseNode;\n\n\t\t\t\t\t\tif ( Array.isArray( poseNodes ) ) {\n\n\t\t\t\t\t\t\tposeNodes.forEach( function ( poseNode ) {\n\n\t\t\t\t\t\t\t\tbindMatrices[ poseNode.Node ] = new THREE.Matrix4().fromArray( poseNode.Matrix.a );\n\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tbindMatrices[ poseNodes.Node ] = new THREE.Matrix4().fromArray( poseNodes.Matrix.a );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn bindMatrices;\n\n\t\t},\n\n\t\t// Parse ambient color in FBXTree.GlobalSettings - if it's not set to black (default), create an ambient light\n\t\tcreateAmbientLight: function () {\n\n\t\t\tif ( 'GlobalSettings' in fbxTree && 'AmbientColor' in fbxTree.GlobalSettings ) {\n\n\t\t\t\tvar ambientColor = fbxTree.GlobalSettings.AmbientColor.value;\n\t\t\t\tvar r = ambientColor[ 0 ];\n\t\t\t\tvar g = ambientColor[ 1 ];\n\t\t\t\tvar b = ambientColor[ 2 ];\n\n\t\t\t\tif ( r !== 0 || g !== 0 || b !== 0 ) {\n\n\t\t\t\t\tvar color = new THREE.Color( r, g, b );\n\t\t\t\t\tsceneGraph.add( new THREE.AmbientLight( color, 1 ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\tsetupMorphMaterials: function () {\n\n\t\t\tsceneGraph.traverse( function ( child ) {\n\n\t\t\t\tif ( child.isMesh ) {\n\n\t\t\t\t\tif ( child.geometry.morphAttributes.position || child.geometry.morphAttributes.normal ) {\n\n\t\t\t\t\t\tvar uuid = child.uuid;\n\t\t\t\t\t\tvar matUuid = child.material.uuid;\n\n\t\t\t\t\t\t// if a geometry has morph targets, it cannot share the material with other geometries\n\t\t\t\t\t\tvar sharedMat = false;\n\n\t\t\t\t\t\tsceneGraph.traverse( function ( child ) {\n\n\t\t\t\t\t\t\tif ( child.isMesh ) {\n\n\t\t\t\t\t\t\t\tif ( child.material.uuid === matUuid && child.uuid !== uuid ) sharedMat = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tif ( sharedMat === true ) child.material = child.material.clone();\n\n\t\t\t\t\t\tchild.material.morphTargets = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t},\n\n\t};\n\n\t// parse Geometry data from FBXTree and return map of BufferGeometries\n\tfunction GeometryParser() {}\n\n\tGeometryParser.prototype = {\n\n\t\tconstructor: GeometryParser,\n\n\t\t// Parse nodes in FBXTree.Objects.Geometry\n\t\tparse: function ( deformers ) {\n\n\t\t\tvar geometryMap = new Map();\n\n\t\t\tif ( 'Geometry' in fbxTree.Objects ) {\n\n\t\t\t\tvar geoNodes = fbxTree.Objects.Geometry;\n\n\t\t\t\tfor ( var nodeID in geoNodes ) {\n\n\t\t\t\t\tvar relationships = connections.get( parseInt( nodeID ) );\n\t\t\t\t\tvar geo = this.parseGeometry( relationships, geoNodes[ nodeID ], deformers );\n\n\t\t\t\t\tgeometryMap.set( parseInt( nodeID ), geo );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn geometryMap;\n\n\t\t},\n\n\t\t// Parse single node in FBXTree.Objects.Geometry\n\t\tparseGeometry: function ( relationships, geoNode, deformers ) {\n\n\t\t\tswitch ( geoNode.attrType ) {\n\n\t\t\t\tcase 'Mesh':\n\t\t\t\t\treturn this.parseMeshGeometry( relationships, geoNode, deformers );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'NurbsCurve':\n\t\t\t\t\treturn this.parseNurbsGeometry( geoNode );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t},\n\n\t\t// Parse single node mesh geometry in FBXTree.Objects.Geometry\n\t\tparseMeshGeometry: function ( relationships, geoNode, deformers ) {\n\n\t\t\tvar skeletons = deformers.skeletons;\n\t\t\tvar morphTargets = deformers.morphTargets;\n\n\t\t\tvar modelNodes = relationships.parents.map( function ( parent ) {\n\n\t\t\t\treturn fbxTree.Objects.Model[ parent.ID ];\n\n\t\t\t} );\n\n\t\t\t// don't create geometry if it is not associated with any models\n\t\t\tif ( modelNodes.length === 0 ) return;\n\n\t\t\tvar skeleton = relationships.children.reduce( function ( skeleton, child ) {\n\n\t\t\t\tif ( skeletons[ child.ID ] !== undefined ) skeleton = skeletons[ child.ID ];\n\n\t\t\t\treturn skeleton;\n\n\t\t\t}, null );\n\n\t\t\tvar morphTarget = relationships.children.reduce( function ( morphTarget, child ) {\n\n\t\t\t\tif ( morphTargets[ child.ID ] !== undefined ) morphTarget = morphTargets[ child.ID ];\n\n\t\t\t\treturn morphTarget;\n\n\t\t\t}, null );\n\n\t\t\t// TODO: if there is more than one model associated with the geometry, AND the models have\n\t\t\t// different geometric transforms, then this will cause problems\n\t\t\t// if ( modelNodes.length > 1 ) { }\n\n\t\t\t// For now just assume one model and get the preRotations from that\n\t\t\tvar modelNode = modelNodes[ 0 ];\n\n\t\t\tvar transformData = {};\n\n\t\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = modelNode.RotationOrder.value;\n\t\t\tif ( 'GeometricTranslation' in modelNode ) transformData.translation = modelNode.GeometricTranslation.value;\n\t\t\tif ( 'GeometricRotation' in modelNode ) transformData.rotation = modelNode.GeometricRotation.value;\n\t\t\tif ( 'GeometricScaling' in modelNode ) transformData.scale = modelNode.GeometricScaling.value;\n\n\t\t\tvar transform = generateTransform( transformData );\n\n\t\t\treturn this.genGeometry( geoNode, skeleton, morphTarget, transform );\n\n\t\t},\n\n\t\t// Generate a THREE.BufferGeometry from a node in FBXTree.Objects.Geometry\n\t\tgenGeometry: function ( geoNode, skeleton, morphTarget, preTransform ) {\n\n\t\t\tvar geo = new THREE.BufferGeometry();\n\t\t\tif ( geoNode.attrName ) geo.name = geoNode.attrName;\n\n\t\t\tvar geoInfo = this.parseGeoNode( geoNode, skeleton );\n\t\t\tvar buffers = this.genBuffers( geoInfo );\n\n\t\t\tvar positionAttribute = new THREE.Float32BufferAttribute( buffers.vertex, 3 );\n\n\t\t\tpreTransform.applyToBufferAttribute( positionAttribute );\n\n\t\t\tgeo.addAttribute( 'position', positionAttribute );\n\n\t\t\tif ( buffers.colors.length > 0 ) {\n\n\t\t\t\tgeo.addAttribute( 'color', new THREE.Float32BufferAttribute( buffers.colors, 3 ) );\n\n\t\t\t}\n\n\t\t\tif ( skeleton ) {\n\n\t\t\t\tgeo.addAttribute( 'skinIndex', new THREE.Uint16BufferAttribute( buffers.weightsIndices, 4 ) );\n\n\t\t\t\tgeo.addAttribute( 'skinWeight', new THREE.Float32BufferAttribute( buffers.vertexWeights, 4 ) );\n\n\t\t\t\t// used later to bind the skeleton to the model\n\t\t\t\tgeo.FBX_Deformer = skeleton;\n\n\t\t\t}\n\n\t\t\tif ( buffers.normal.length > 0 ) {\n\n\t\t\t\tvar normalAttribute = new THREE.Float32BufferAttribute( buffers.normal, 3 );\n\n\t\t\t\tvar normalMatrix = new THREE.Matrix3().getNormalMatrix( preTransform );\n\t\t\t\tnormalMatrix.applyToBufferAttribute( normalAttribute );\n\n\t\t\t\tgeo.addAttribute( 'normal', normalAttribute );\n\n\t\t\t}\n\n\t\t\tbuffers.uvs.forEach( function ( uvBuffer, i ) {\n\n\t\t\t\t// subsequent uv buffers are called 'uv1', 'uv2', ...\n\t\t\t\tvar name = 'uv' + ( i + 1 ).toString();\n\n\t\t\t\t// the first uv buffer is just called 'uv'\n\t\t\t\tif ( i === 0 ) {\n\n\t\t\t\t\tname = 'uv';\n\n\t\t\t\t}\n\n\t\t\t\tgeo.addAttribute( name, new THREE.Float32BufferAttribute( buffers.uvs[ i ], 2 ) );\n\n\t\t\t} );\n\n\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\t// Convert the material indices of each vertex into rendering groups on the geometry.\n\t\t\t\tvar prevMaterialIndex = buffers.materialIndex[ 0 ];\n\t\t\t\tvar startIndex = 0;\n\n\t\t\t\tbuffers.materialIndex.forEach( function ( currentIndex, i ) {\n\n\t\t\t\t\tif ( currentIndex !== prevMaterialIndex ) {\n\n\t\t\t\t\t\tgeo.addGroup( startIndex, i - startIndex, prevMaterialIndex );\n\n\t\t\t\t\t\tprevMaterialIndex = currentIndex;\n\t\t\t\t\t\tstartIndex = i;\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\t// the loop above doesn't add the last group, do that here.\n\t\t\t\tif ( geo.groups.length > 0 ) {\n\n\t\t\t\t\tvar lastGroup = geo.groups[ geo.groups.length - 1 ];\n\t\t\t\t\tvar lastIndex = lastGroup.start + lastGroup.count;\n\n\t\t\t\t\tif ( lastIndex !== buffers.materialIndex.length ) {\n\n\t\t\t\t\t\tgeo.addGroup( lastIndex, buffers.materialIndex.length - lastIndex, prevMaterialIndex );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// case where there are multiple materials but the whole geometry is only\n\t\t\t\t// using one of them\n\t\t\t\tif ( geo.groups.length === 0 ) {\n\n\t\t\t\t\tgeo.addGroup( 0, buffers.materialIndex.length, buffers.materialIndex[ 0 ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.addMorphTargets( geo, geoNode, morphTarget, preTransform );\n\n\t\t\treturn geo;\n\n\t\t},\n\n\t\tparseGeoNode: function ( geoNode, skeleton ) {\n\n\t\t\tvar geoInfo = {};\n\n\t\t\tgeoInfo.vertexPositions = ( geoNode.Vertices !== undefined ) ? geoNode.Vertices.a : [];\n\t\t\tgeoInfo.vertexIndices = ( geoNode.PolygonVertexIndex !== undefined ) ? geoNode.PolygonVertexIndex.a : [];\n\n\t\t\tif ( geoNode.LayerElementColor ) {\n\n\t\t\t\tgeoInfo.color = this.parseVertexColors( geoNode.LayerElementColor[ 0 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoNode.LayerElementMaterial ) {\n\n\t\t\t\tgeoInfo.material = this.parseMaterialIndices( geoNode.LayerElementMaterial[ 0 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoNode.LayerElementNormal ) {\n\n\t\t\t\tgeoInfo.normal = this.parseNormals( geoNode.LayerElementNormal[ 0 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoNode.LayerElementUV ) {\n\n\t\t\t\tgeoInfo.uv = [];\n\n\t\t\t\tvar i = 0;\n\t\t\t\twhile ( geoNode.LayerElementUV[ i ] ) {\n\n\t\t\t\t\tgeoInfo.uv.push( this.parseUVs( geoNode.LayerElementUV[ i ] ) );\n\t\t\t\t\ti ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tgeoInfo.weightTable = {};\n\n\t\t\tif ( skeleton !== null ) {\n\n\t\t\t\tgeoInfo.skeleton = skeleton;\n\n\t\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t\t// loop over the bone's vertex indices and weights\n\t\t\t\t\trawBone.indices.forEach( function ( index, j ) {\n\n\t\t\t\t\t\tif ( geoInfo.weightTable[ index ] === undefined ) geoInfo.weightTable[ index ] = [];\n\n\t\t\t\t\t\tgeoInfo.weightTable[ index ].push( {\n\n\t\t\t\t\t\t\tid: i,\n\t\t\t\t\t\t\tweight: rawBone.weights[ j ],\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn geoInfo;\n\n\t\t},\n\n\t\tgenBuffers: function ( geoInfo ) {\n\n\t\t\tvar buffers = {\n\t\t\t\tvertex: [],\n\t\t\t\tnormal: [],\n\t\t\t\tcolors: [],\n\t\t\t\tuvs: [],\n\t\t\t\tmaterialIndex: [],\n\t\t\t\tvertexWeights: [],\n\t\t\t\tweightsIndices: [],\n\t\t\t};\n\n\t\t\tvar polygonIndex = 0;\n\t\t\tvar faceLength = 0;\n\t\t\tvar displayedWeightsWarning = false;\n\n\t\t\t// these will hold data for a single face\n\t\t\tvar facePositionIndexes = [];\n\t\t\tvar faceNormals = [];\n\t\t\tvar faceColors = [];\n\t\t\tvar faceUVs = [];\n\t\t\tvar faceWeights = [];\n\t\t\tvar faceWeightIndices = [];\n\n\t\t\tvar self = this;\n\t\t\tgeoInfo.vertexIndices.forEach( function ( vertexIndex, polygonVertexIndex ) {\n\n\t\t\t\tvar endOfFace = false;\n\n\t\t\t\t// Face index and vertex index arrays are combined in a single array\n\t\t\t\t// A cube with quad faces looks like this:\n\t\t\t\t// PolygonVertexIndex: *24 {\n\t\t\t\t//  a: 0, 1, 3, -3, 2, 3, 5, -5, 4, 5, 7, -7, 6, 7, 1, -1, 1, 7, 5, -4, 6, 0, 2, -5\n\t\t\t\t//  }\n\t\t\t\t// Negative numbers mark the end of a face - first face here is 0, 1, 3, -3\n\t\t\t\t// to find index of last vertex bit shift the index: ^ - 1\n\t\t\t\tif ( vertexIndex < 0 ) {\n\n\t\t\t\t\tvertexIndex = vertexIndex ^ - 1; // equivalent to ( x * -1 ) - 1\n\t\t\t\t\tendOfFace = true;\n\n\t\t\t\t}\n\n\t\t\t\tvar weightIndices = [];\n\t\t\t\tvar weights = [];\n\n\t\t\t\tfacePositionIndexes.push( vertexIndex * 3, vertexIndex * 3 + 1, vertexIndex * 3 + 2 );\n\n\t\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\t\tvar data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.color );\n\n\t\t\t\t\tfaceColors.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\t\tif ( geoInfo.weightTable[ vertexIndex ] !== undefined ) {\n\n\t\t\t\t\t\tgeoInfo.weightTable[ vertexIndex ].forEach( function ( wt ) {\n\n\t\t\t\t\t\t\tweights.push( wt.weight );\n\t\t\t\t\t\t\tweightIndices.push( wt.id );\n\n\t\t\t\t\t\t} );\n\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( weights.length > 4 ) {\n\n\t\t\t\t\t\tif ( ! displayedWeightsWarning ) {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights.' );\n\t\t\t\t\t\t\tdisplayedWeightsWarning = true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar wIndex = [ 0, 0, 0, 0 ];\n\t\t\t\t\t\tvar Weight = [ 0, 0, 0, 0 ];\n\n\t\t\t\t\t\tweights.forEach( function ( weight, weightIndex ) {\n\n\t\t\t\t\t\t\tvar currentWeight = weight;\n\t\t\t\t\t\t\tvar currentIndex = weightIndices[ weightIndex ];\n\n\t\t\t\t\t\t\tWeight.forEach( function ( comparedWeight, comparedWeightIndex, comparedWeightArray ) {\n\n\t\t\t\t\t\t\t\tif ( currentWeight > comparedWeight ) {\n\n\t\t\t\t\t\t\t\t\tcomparedWeightArray[ comparedWeightIndex ] = currentWeight;\n\t\t\t\t\t\t\t\t\tcurrentWeight = comparedWeight;\n\n\t\t\t\t\t\t\t\t\tvar tmp = wIndex[ comparedWeightIndex ];\n\t\t\t\t\t\t\t\t\twIndex[ comparedWeightIndex ] = currentIndex;\n\t\t\t\t\t\t\t\t\tcurrentIndex = tmp;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tweightIndices = wIndex;\n\t\t\t\t\t\tweights = Weight;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// if the weight array is shorter than 4 pad with 0s\n\t\t\t\t\twhile ( weights.length < 4 ) {\n\n\t\t\t\t\t\tweights.push( 0 );\n\t\t\t\t\t\tweightIndices.push( 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( var i = 0; i < 4; ++ i ) {\n\n\t\t\t\t\t\tfaceWeights.push( weights[ i ] );\n\t\t\t\t\t\tfaceWeightIndices.push( weightIndices[ i ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\t\tvar data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.normal );\n\n\t\t\t\t\tfaceNormals.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\t\tvar materialIndex = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.material )[ 0 ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\t\tgeoInfo.uv.forEach( function ( uv, i ) {\n\n\t\t\t\t\t\tvar data = getData( polygonVertexIndex, polygonIndex, vertexIndex, uv );\n\n\t\t\t\t\t\tif ( faceUVs[ i ] === undefined ) {\n\n\t\t\t\t\t\t\tfaceUVs[ i ] = [];\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfaceUVs[ i ].push( data[ 0 ] );\n\t\t\t\t\t\tfaceUVs[ i ].push( data[ 1 ] );\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\tfaceLength ++;\n\n\t\t\t\tif ( endOfFace ) {\n\n\t\t\t\t\tself.genFace( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength );\n\n\t\t\t\t\tpolygonIndex ++;\n\t\t\t\t\tfaceLength = 0;\n\n\t\t\t\t\t// reset arrays for the next face\n\t\t\t\t\tfacePositionIndexes = [];\n\t\t\t\t\tfaceNormals = [];\n\t\t\t\t\tfaceColors = [];\n\t\t\t\t\tfaceUVs = [];\n\t\t\t\t\tfaceWeights = [];\n\t\t\t\t\tfaceWeightIndices = [];\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\treturn buffers;\n\n\t\t},\n\n\t\t// Generate data for a single face in a geometry. If the face is a quad then split it into 2 tris\n\t\tgenFace: function ( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength ) {\n\n\t\t\tfor ( var i = 2; i < faceLength; i ++ ) {\n\n\t\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 0 ] ] );\n\t\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 1 ] ] );\n\t\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 2 ] ] );\n\n\t\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 ] ] );\n\t\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 + 1 ] ] );\n\t\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 + 2 ] ] );\n\n\t\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 ] ] );\n\t\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 + 1 ] ] );\n\t\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 + 2 ] ] );\n\n\t\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 0 ] );\n\t\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 1 ] );\n\t\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 2 ] );\n\t\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 3 ] );\n\n\t\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 ] );\n\t\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 1 ] );\n\t\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 2 ] );\n\t\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 3 ] );\n\n\t\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 ] );\n\t\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 1 ] );\n\t\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 2 ] );\n\t\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 3 ] );\n\n\t\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 0 ] );\n\t\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 1 ] );\n\t\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 2 ] );\n\t\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 3 ] );\n\n\t\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 ] );\n\t\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 1 ] );\n\t\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 2 ] );\n\t\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 3 ] );\n\n\t\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 ] );\n\t\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 1 ] );\n\t\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 2 ] );\n\t\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 3 ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\t\tbuffers.colors.push( faceColors[ 0 ] );\n\t\t\t\t\tbuffers.colors.push( faceColors[ 1 ] );\n\t\t\t\t\tbuffers.colors.push( faceColors[ 2 ] );\n\n\t\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 ] );\n\t\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 + 1 ] );\n\t\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 + 2 ] );\n\n\t\t\t\t\tbuffers.colors.push( faceColors[ i * 3 ] );\n\t\t\t\t\tbuffers.colors.push( faceColors[ i * 3 + 1 ] );\n\t\t\t\t\tbuffers.colors.push( faceColors[ i * 3 + 2 ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\n\t\t\t\t}\n\n\t\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\t\tbuffers.normal.push( faceNormals[ 0 ] );\n\t\t\t\t\tbuffers.normal.push( faceNormals[ 1 ] );\n\t\t\t\t\tbuffers.normal.push( faceNormals[ 2 ] );\n\n\t\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 ] );\n\t\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 + 1 ] );\n\t\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 + 2 ] );\n\n\t\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 ] );\n\t\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 + 1 ] );\n\t\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 + 2 ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\t\tgeoInfo.uv.forEach( function ( uv, j ) {\n\n\t\t\t\t\t\tif ( buffers.uvs[ j ] === undefined ) buffers.uvs[ j ] = [];\n\n\t\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ 0 ] );\n\t\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ 1 ] );\n\n\t\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ ( i - 1 ) * 2 ] );\n\t\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ ( i - 1 ) * 2 + 1 ] );\n\n\t\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i * 2 ] );\n\t\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i * 2 + 1 ] );\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\taddMorphTargets: function ( parentGeo, parentGeoNode, morphTarget, preTransform ) {\n\n\t\t\tif ( morphTarget === null ) return;\n\n\t\t\tparentGeo.morphAttributes.position = [];\n\t\t\tparentGeo.morphAttributes.normal = [];\n\n\t\t\tvar self = this;\n\t\t\tmorphTarget.rawTargets.forEach( function ( rawTarget ) {\n\n\t\t\t\tvar morphGeoNode = fbxTree.Objects.Geometry[ rawTarget.geoID ];\n\n\t\t\t\tif ( morphGeoNode !== undefined ) {\n\n\t\t\t\t\tself.genMorphGeometry( parentGeo, parentGeoNode, morphGeoNode, preTransform );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t},\n\n\t\t// a morph geometry node is similar to a standard  node, and the node is also contained\n\t\t// in FBXTree.Objects.Geometry, however it can only have attributes for position, normal\n\t\t// and a special attribute Index defining which vertices of the original geometry are affected\n\t\t// Normal and position attributes only have data for the vertices that are affected by the morph\n\t\tgenMorphGeometry: function ( parentGeo, parentGeoNode, morphGeoNode, preTransform ) {\n\n\t\t\tvar morphGeo = new THREE.BufferGeometry();\n\t\t\tif ( morphGeoNode.attrName ) morphGeo.name = morphGeoNode.attrName;\n\n\t\t\tvar vertexIndices = ( parentGeoNode.PolygonVertexIndex !== undefined ) ? parentGeoNode.PolygonVertexIndex.a : [];\n\n\t\t\t// make a copy of the parent's vertex positions\n\t\t\tvar vertexPositions = ( parentGeoNode.Vertices !== undefined ) ? parentGeoNode.Vertices.a.slice() : [];\n\n\t\t\tvar morphPositions = ( morphGeoNode.Vertices !== undefined ) ? morphGeoNode.Vertices.a : [];\n\t\t\tvar indices = ( morphGeoNode.Indexes !== undefined ) ? morphGeoNode.Indexes.a : [];\n\n\t\t\tfor ( var i = 0; i < indices.length; i ++ ) {\n\n\t\t\t\tvar morphIndex = indices[ i ] * 3;\n\n\t\t\t\t// FBX format uses blend shapes rather than morph targets. This can be converted\n\t\t\t\t// by additively combining the blend shape positions with the original geometry's positions\n\t\t\t\tvertexPositions[ morphIndex ] += morphPositions[ i * 3 ];\n\t\t\t\tvertexPositions[ morphIndex + 1 ] += morphPositions[ i * 3 + 1 ];\n\t\t\t\tvertexPositions[ morphIndex + 2 ] += morphPositions[ i * 3 + 2 ];\n\n\t\t\t}\n\n\t\t\t// TODO: add morph normal support\n\t\t\tvar morphGeoInfo = {\n\t\t\t\tvertexIndices: vertexIndices,\n\t\t\t\tvertexPositions: vertexPositions,\n\t\t\t};\n\n\t\t\tvar morphBuffers = this.genBuffers( morphGeoInfo );\n\n\t\t\tvar positionAttribute = new THREE.Float32BufferAttribute( morphBuffers.vertex, 3 );\n\t\t\tpositionAttribute.name = morphGeoNode.attrName;\n\n\t\t\tpreTransform.applyToBufferAttribute( positionAttribute );\n\n\t\t\tparentGeo.morphAttributes.position.push( positionAttribute );\n\n\t\t},\n\n\t\t// Parse normal from FBXTree.Objects.Geometry.LayerElementNormal if it exists\n\t\tparseNormals: function ( NormalNode ) {\n\n\t\t\tvar mappingType = NormalNode.MappingInformationType;\n\t\t\tvar referenceType = NormalNode.ReferenceInformationType;\n\t\t\tvar buffer = NormalNode.Normals.a;\n\t\t\tvar indexBuffer = [];\n\t\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\t\tif ( 'NormalIndex' in NormalNode ) {\n\n\t\t\t\t\tindexBuffer = NormalNode.NormalIndex.a;\n\n\t\t\t\t} else if ( 'NormalsIndex' in NormalNode ) {\n\n\t\t\t\t\tindexBuffer = NormalNode.NormalsIndex.a;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdataSize: 3,\n\t\t\t\tbuffer: buffer,\n\t\t\t\tindices: indexBuffer,\n\t\t\t\tmappingType: mappingType,\n\t\t\t\treferenceType: referenceType\n\t\t\t};\n\n\t\t},\n\n\t\t// Parse UVs from FBXTree.Objects.Geometry.LayerElementUV if it exists\n\t\tparseUVs: function ( UVNode ) {\n\n\t\t\tvar mappingType = UVNode.MappingInformationType;\n\t\t\tvar referenceType = UVNode.ReferenceInformationType;\n\t\t\tvar buffer = UVNode.UV.a;\n\t\t\tvar indexBuffer = [];\n\t\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\t\tindexBuffer = UVNode.UVIndex.a;\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdataSize: 2,\n\t\t\t\tbuffer: buffer,\n\t\t\t\tindices: indexBuffer,\n\t\t\t\tmappingType: mappingType,\n\t\t\t\treferenceType: referenceType\n\t\t\t};\n\n\t\t},\n\n\t\t// Parse Vertex Colors from FBXTree.Objects.Geometry.LayerElementColor if it exists\n\t\tparseVertexColors: function ( ColorNode ) {\n\n\t\t\tvar mappingType = ColorNode.MappingInformationType;\n\t\t\tvar referenceType = ColorNode.ReferenceInformationType;\n\t\t\tvar buffer = ColorNode.Colors.a;\n\t\t\tvar indexBuffer = [];\n\t\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\t\tindexBuffer = ColorNode.ColorIndex.a;\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdataSize: 4,\n\t\t\t\tbuffer: buffer,\n\t\t\t\tindices: indexBuffer,\n\t\t\t\tmappingType: mappingType,\n\t\t\t\treferenceType: referenceType\n\t\t\t};\n\n\t\t},\n\n\t\t// Parse mapping and material data in FBXTree.Objects.Geometry.LayerElementMaterial if it exists\n\t\tparseMaterialIndices: function ( MaterialNode ) {\n\n\t\t\tvar mappingType = MaterialNode.MappingInformationType;\n\t\t\tvar referenceType = MaterialNode.ReferenceInformationType;\n\n\t\t\tif ( mappingType === 'NoMappingInformation' ) {\n\n\t\t\t\treturn {\n\t\t\t\t\tdataSize: 1,\n\t\t\t\t\tbuffer: [ 0 ],\n\t\t\t\t\tindices: [ 0 ],\n\t\t\t\t\tmappingType: 'AllSame',\n\t\t\t\t\treferenceType: referenceType\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\tvar materialIndexBuffer = MaterialNode.Materials.a;\n\n\t\t\t// Since materials are stored as indices, there's a bit of a mismatch between FBX and what\n\t\t\t// we expect.So we create an intermediate buffer that points to the index in the buffer,\n\t\t\t// for conforming with the other functions we've written for other data.\n\t\t\tvar materialIndices = [];\n\n\t\t\tfor ( var i = 0; i < materialIndexBuffer.length; ++ i ) {\n\n\t\t\t\tmaterialIndices.push( i );\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdataSize: 1,\n\t\t\t\tbuffer: materialIndexBuffer,\n\t\t\t\tindices: materialIndices,\n\t\t\t\tmappingType: mappingType,\n\t\t\t\treferenceType: referenceType\n\t\t\t};\n\n\t\t},\n\n\t\t// Generate a NurbGeometry from a node in FBXTree.Objects.Geometry\n\t\tparseNurbsGeometry: function ( geoNode ) {\n\n\t\t\tif ( THREE.NURBSCurve === undefined ) {\n\n\t\t\t\tconsole.error( 'THREE.FBXLoader: The loader relies on THREE.NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry.' );\n\t\t\t\treturn new THREE.BufferGeometry();\n\n\t\t\t}\n\n\t\t\tvar order = parseInt( geoNode.Order );\n\n\t\t\tif ( isNaN( order ) ) {\n\n\t\t\t\tconsole.error( 'THREE.FBXLoader: Invalid Order %s given for geometry ID: %s', geoNode.Order, geoNode.id );\n\t\t\t\treturn new THREE.BufferGeometry();\n\n\t\t\t}\n\n\t\t\tvar degree = order - 1;\n\n\t\t\tvar knots = geoNode.KnotVector.a;\n\t\t\tvar controlPoints = [];\n\t\t\tvar pointsValues = geoNode.Points.a;\n\n\t\t\tfor ( var i = 0, l = pointsValues.length; i < l; i += 4 ) {\n\n\t\t\t\tcontrolPoints.push( new THREE.Vector4().fromArray( pointsValues, i ) );\n\n\t\t\t}\n\n\t\t\tvar startKnot, endKnot;\n\n\t\t\tif ( geoNode.Form === 'Closed' ) {\n\n\t\t\t\tcontrolPoints.push( controlPoints[ 0 ] );\n\n\t\t\t} else if ( geoNode.Form === 'Periodic' ) {\n\n\t\t\t\tstartKnot = degree;\n\t\t\t\tendKnot = knots.length - 1 - startKnot;\n\n\t\t\t\tfor ( var i = 0; i < degree; ++ i ) {\n\n\t\t\t\t\tcontrolPoints.push( controlPoints[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar curve = new THREE.NURBSCurve( degree, knots, controlPoints, startKnot, endKnot );\n\t\t\tvar vertices = curve.getPoints( controlPoints.length * 7 );\n\n\t\t\tvar positions = new Float32Array( vertices.length * 3 );\n\n\t\t\tvertices.forEach( function ( vertex, i ) {\n\n\t\t\t\tvertex.toArray( positions, i * 3 );\n\n\t\t\t} );\n\n\t\t\tvar geometry = new THREE.BufferGeometry();\n\t\t\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\n\n\t\t\treturn geometry;\n\n\t\t},\n\n\t};\n\n\t// parse animation data from FBXTree\n\tfunction AnimationParser() {}\n\n\tAnimationParser.prototype = {\n\n\t\tconstructor: AnimationParser,\n\n\t\t// take raw animation clips and turn them into three.js animation clips\n\t\tparse: function () {\n\n\t\t\tvar animationClips = [];\n\n\n\t\t\tvar rawClips = this.parseClips();\n\n\t\t\tif ( rawClips === undefined ) return animationClips;\n\n\t\t\tfor ( var key in rawClips ) {\n\n\t\t\t\tvar rawClip = rawClips[ key ];\n\n\t\t\t\tvar clip = this.addClip( rawClip );\n\n\t\t\t\tanimationClips.push( clip );\n\n\t\t\t}\n\n\t\t\treturn animationClips;\n\n\t\t},\n\n\t\tparseClips: function () {\n\n\t\t\t// since the actual transformation data is stored in FBXTree.Objects.AnimationCurve,\n\t\t\t// if this is undefined we can safely assume there are no animations\n\t\t\tif ( fbxTree.Objects.AnimationCurve === undefined ) return undefined;\n\n\t\t\tvar curveNodesMap = this.parseAnimationCurveNodes();\n\n\t\t\tthis.parseAnimationCurves( curveNodesMap );\n\n\t\t\tvar layersMap = this.parseAnimationLayers( curveNodesMap );\n\t\t\tvar rawClips = this.parseAnimStacks( layersMap );\n\n\t\t\treturn rawClips;\n\n\t\t},\n\n\t\t// parse nodes in FBXTree.Objects.AnimationCurveNode\n\t\t// each AnimationCurveNode holds data for an animation transform for a model (e.g. left arm rotation )\n\t\t// and is referenced by an AnimationLayer\n\t\tparseAnimationCurveNodes: function () {\n\n\t\t\tvar rawCurveNodes = fbxTree.Objects.AnimationCurveNode;\n\n\t\t\tvar curveNodesMap = new Map();\n\n\t\t\tfor ( var nodeID in rawCurveNodes ) {\n\n\t\t\t\tvar rawCurveNode = rawCurveNodes[ nodeID ];\n\n\t\t\t\tif ( rawCurveNode.attrName.match( /S|R|T|DeformPercent/ ) !== null ) {\n\n\t\t\t\t\tvar curveNode = {\n\n\t\t\t\t\t\tid: rawCurveNode.id,\n\t\t\t\t\t\tattr: rawCurveNode.attrName,\n\t\t\t\t\t\tcurves: {},\n\n\t\t\t\t\t};\n\n\t\t\t\t\tcurveNodesMap.set( curveNode.id, curveNode );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn curveNodesMap;\n\n\t\t},\n\n\t\t// parse nodes in FBXTree.Objects.AnimationCurve and connect them up to\n\t\t// previously parsed AnimationCurveNodes. Each AnimationCurve holds data for a single animated\n\t\t// axis ( e.g. times and values of x rotation)\n\t\tparseAnimationCurves: function ( curveNodesMap ) {\n\n\t\t\tvar rawCurves = fbxTree.Objects.AnimationCurve;\n\n\t\t\t// TODO: Many values are identical up to roundoff error, but won't be optimised\n\t\t\t// e.g. position times: [0, 0.4, 0. 8]\n\t\t\t// position values: [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.235384487103147e-7, 93.67520904541016, -0.9982695579528809]\n\t\t\t// clearly, this should be optimised to\n\t\t\t// times: [0], positions [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809]\n\t\t\t// this shows up in nearly every FBX file, and generally time array is length > 100\n\n\t\t\tfor ( var nodeID in rawCurves ) {\n\n\t\t\t\tvar animationCurve = {\n\n\t\t\t\t\tid: rawCurves[ nodeID ].id,\n\t\t\t\t\ttimes: rawCurves[ nodeID ].KeyTime.a.map( convertFBXTimeToSeconds ),\n\t\t\t\t\tvalues: rawCurves[ nodeID ].KeyValueFloat.a,\n\n\t\t\t\t};\n\n\t\t\t\tvar relationships = connections.get( animationCurve.id );\n\n\t\t\t\tif ( relationships !== undefined ) {\n\n\t\t\t\t\tvar animationCurveID = relationships.parents[ 0 ].ID;\n\t\t\t\t\tvar animationCurveRelationship = relationships.parents[ 0 ].relationship;\n\n\t\t\t\t\tif ( animationCurveRelationship.match( /X/ ) ) {\n\n\t\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'x' ] = animationCurve;\n\n\t\t\t\t\t} else if ( animationCurveRelationship.match( /Y/ ) ) {\n\n\t\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'y' ] = animationCurve;\n\n\t\t\t\t\t} else if ( animationCurveRelationship.match( /Z/ ) ) {\n\n\t\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'z' ] = animationCurve;\n\n\t\t\t\t\t} else if ( animationCurveRelationship.match( /d|DeformPercent/ ) && curveNodesMap.has( animationCurveID ) ) {\n\n\t\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'morph' ] = animationCurve;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\t// parse nodes in FBXTree.Objects.AnimationLayer. Each layers holds references\n\t\t// to various AnimationCurveNodes and is referenced by an AnimationStack node\n\t\t// note: theoretically a stack can have multiple layers, however in practice there always seems to be one per stack\n\t\tparseAnimationLayers: function ( curveNodesMap ) {\n\n\t\t\tvar rawLayers = fbxTree.Objects.AnimationLayer;\n\n\t\t\tvar layersMap = new Map();\n\n\t\t\tfor ( var nodeID in rawLayers ) {\n\n\t\t\t\tvar layerCurveNodes = [];\n\n\t\t\t\tvar connection = connections.get( parseInt( nodeID ) );\n\n\t\t\t\tif ( connection !== undefined ) {\n\n\t\t\t\t\t// all the animationCurveNodes used in the layer\n\t\t\t\t\tvar children = connection.children;\n\n\t\t\t\t\tvar self = this;\n\t\t\t\t\tchildren.forEach( function ( child, i ) {\n\n\t\t\t\t\t\tif ( curveNodesMap.has( child.ID ) ) {\n\n\t\t\t\t\t\t\tvar curveNode = curveNodesMap.get( child.ID );\n\n\t\t\t\t\t\t\t// check that the curves are defined for at least one axis, otherwise ignore the curveNode\n\t\t\t\t\t\t\tif ( curveNode.curves.x !== undefined || curveNode.curves.y !== undefined || curveNode.curves.z !== undefined ) {\n\n\t\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\t\tvar modelID;\n\n\t\t\t\t\t\t\t\t\tconnections.get( child.ID ).parents.forEach( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\t\tif ( parent.relationship !== undefined ) modelID = parent.ID;\n\n\t\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t\t\tvar rawModel = fbxTree.Objects.Model[ modelID.toString() ];\n\n\t\t\t\t\t\t\t\t\tvar node = {\n\n\t\t\t\t\t\t\t\t\t\tmodelName: THREE.PropertyBinding.sanitizeNodeName( rawModel.attrName ),\n\t\t\t\t\t\t\t\t\t\tinitialPosition: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialRotation: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialScale: [ 1, 1, 1 ],\n\t\t\t\t\t\t\t\t\t\ttransform: self.getModelAnimTransform( rawModel ),\n\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\t// if the animated model is pre rotated, we'll have to apply the pre rotations to every\n\t\t\t\t\t\t\t\t\t// animation value as well\n\t\t\t\t\t\t\t\t\tif ( 'PreRotation' in rawModel ) node.preRotations = rawModel.PreRotation.value;\n\t\t\t\t\t\t\t\t\tif ( 'PostRotation' in rawModel ) node.postRotations = rawModel.PostRotation.value;\n\n\t\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tlayerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t\t} else if ( curveNode.curves.morph !== undefined ) {\n\n\t\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\t\tvar deformerID;\n\n\t\t\t\t\t\t\t\t\tconnections.get( child.ID ).parents.forEach( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\t\tif ( parent.relationship !== undefined ) deformerID = parent.ID;\n\n\t\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t\t\tvar morpherID = connections.get( deformerID ).parents[ 0 ].ID;\n\t\t\t\t\t\t\t\t\tvar geoID = connections.get( morpherID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\t\t// assuming geometry is not used in more than one model\n\t\t\t\t\t\t\t\t\tvar modelID = connections.get( geoID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\t\tvar rawModel = fbxTree.Objects.Model[ modelID ];\n\n\t\t\t\t\t\t\t\t\tvar node = {\n\n\t\t\t\t\t\t\t\t\t\tmodelName: THREE.PropertyBinding.sanitizeNodeName( rawModel.attrName ),\n\t\t\t\t\t\t\t\t\t\tmorphName: fbxTree.Objects.Deformer[ deformerID ].attrName,\n\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tlayerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tlayersMap.set( parseInt( nodeID ), layerCurveNodes );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn layersMap;\n\n\t\t},\n\n\t\tgetModelAnimTransform: function ( modelNode ) {\n\n\t\t\tvar transformData = {};\n\n\t\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = parseInt( modelNode.RotationOrder.value );\n\n\t\t\tif ( 'Lcl_Translation' in modelNode ) transformData.translation = modelNode.Lcl_Translation.value;\n\t\t\tif ( 'RotationOffset' in modelNode ) transformData.rotationOffset = modelNode.RotationOffset.value;\n\n\t\t\tif ( 'Lcl_Rotation' in modelNode ) transformData.rotation = modelNode.Lcl_Rotation.value;\n\t\t\tif ( 'PreRotation' in modelNode ) transformData.preRotation = modelNode.PreRotation.value;\n\n\t\t\tif ( 'PostRotation' in modelNode ) transformData.postRotation = modelNode.PostRotation.value;\n\n\t\t\tif ( 'Lcl_Scaling' in modelNode ) transformData.scale = modelNode.Lcl_Scaling.value;\n\n\t\t\treturn generateTransform( transformData );\n\n\t\t},\n\n\t\t// parse nodes in FBXTree.Objects.AnimationStack. These are the top level node in the animation\n\t\t// hierarchy. Each Stack node will be used to create a THREE.AnimationClip\n\t\tparseAnimStacks: function ( layersMap ) {\n\n\t\t\tvar rawStacks = fbxTree.Objects.AnimationStack;\n\n\t\t\t// connect the stacks (clips) up to the layers\n\t\t\tvar rawClips = {};\n\n\t\t\tfor ( var nodeID in rawStacks ) {\n\n\t\t\t\tvar children = connections.get( parseInt( nodeID ) ).children;\n\n\t\t\t\tif ( children.length > 1 ) {\n\n\t\t\t\t\t// it seems like stacks will always be associated with a single layer. But just in case there are files\n\t\t\t\t\t// where there are multiple layers per stack, we'll display a warning\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.' );\n\n\t\t\t\t}\n\n\t\t\t\tvar layer = layersMap.get( children[ 0 ].ID );\n\n\t\t\t\trawClips[ nodeID ] = {\n\n\t\t\t\t\tname: rawStacks[ nodeID ].attrName,\n\t\t\t\t\tlayer: layer,\n\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\treturn rawClips;\n\n\t\t},\n\n\t\taddClip: function ( rawClip ) {\n\n\t\t\tvar tracks = [];\n\n\t\t\tvar self = this;\n\t\t\trawClip.layer.forEach( function ( rawTracks ) {\n\n\t\t\t\ttracks = tracks.concat( self.generateTracks( rawTracks ) );\n\n\t\t\t} );\n\n\t\t\treturn new THREE.AnimationClip( rawClip.name, - 1, tracks );\n\n\t\t},\n\n\t\tgenerateTracks: function ( rawTracks ) {\n\n\t\t\tvar tracks = [];\n\n\t\t\tvar initialPosition = new THREE.Vector3();\n\t\t\tvar initialRotation = new THREE.Quaternion();\n\t\t\tvar initialScale = new THREE.Vector3();\n\n\t\t\tif ( rawTracks.transform ) rawTracks.transform.decompose( initialPosition, initialRotation, initialScale );\n\n\t\t\tinitialPosition = initialPosition.toArray();\n\t\t\tinitialRotation = new THREE.Euler().setFromQuaternion( initialRotation ).toArray(); // todo: euler order\n\t\t\tinitialScale = initialScale.toArray();\n\n\t\t\tif ( rawTracks.T !== undefined && Object.keys( rawTracks.T.curves ).length > 0 ) {\n\n\t\t\t\tvar positionTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.T.curves, initialPosition, 'position' );\n\t\t\t\tif ( positionTrack !== undefined ) tracks.push( positionTrack );\n\n\t\t\t}\n\n\t\t\tif ( rawTracks.R !== undefined && Object.keys( rawTracks.R.curves ).length > 0 ) {\n\n\t\t\t\tvar rotationTrack = this.generateRotationTrack( rawTracks.modelName, rawTracks.R.curves, initialRotation, rawTracks.preRotations, rawTracks.postRotations );\n\t\t\t\tif ( rotationTrack !== undefined ) tracks.push( rotationTrack );\n\n\t\t\t}\n\n\t\t\tif ( rawTracks.S !== undefined && Object.keys( rawTracks.S.curves ).length > 0 ) {\n\n\t\t\t\tvar scaleTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.S.curves, initialScale, 'scale' );\n\t\t\t\tif ( scaleTrack !== undefined ) tracks.push( scaleTrack );\n\n\t\t\t}\n\n\t\t\tif ( rawTracks.DeformPercent !== undefined ) {\n\n\t\t\t\tvar morphTrack = this.generateMorphTrack( rawTracks );\n\t\t\t\tif ( morphTrack !== undefined ) tracks.push( morphTrack );\n\n\t\t\t}\n\n\t\t\treturn tracks;\n\n\t\t},\n\n\t\tgenerateVectorTrack: function ( modelName, curves, initialValue, type ) {\n\n\t\t\tvar times = this.getTimesForAllAxes( curves );\n\t\t\tvar values = this.getKeyframeTrackValues( times, curves, initialValue );\n\n\t\t\treturn new THREE.VectorKeyframeTrack( modelName + '.' + type, times, values );\n\n\t\t},\n\n\t\tgenerateRotationTrack: function ( modelName, curves, initialValue, preRotations, postRotations ) {\n\n\t\t\tif ( curves.x !== undefined ) {\n\n\t\t\t\tthis.interpolateRotations( curves.x );\n\t\t\t\tcurves.x.values = curves.x.values.map( THREE.Math.degToRad );\n\n\t\t\t}\n\t\t\tif ( curves.y !== undefined ) {\n\n\t\t\t\tthis.interpolateRotations( curves.y );\n\t\t\t\tcurves.y.values = curves.y.values.map( THREE.Math.degToRad );\n\n\t\t\t}\n\t\t\tif ( curves.z !== undefined ) {\n\n\t\t\t\tthis.interpolateRotations( curves.z );\n\t\t\t\tcurves.z.values = curves.z.values.map( THREE.Math.degToRad );\n\n\t\t\t}\n\n\t\t\tvar times = this.getTimesForAllAxes( curves );\n\t\t\tvar values = this.getKeyframeTrackValues( times, curves, initialValue );\n\n\t\t\tif ( preRotations !== undefined ) {\n\n\t\t\t\tpreRotations = preRotations.map( THREE.Math.degToRad );\n\t\t\t\tpreRotations.push( 'ZYX' );\n\n\t\t\t\tpreRotations = new THREE.Euler().fromArray( preRotations );\n\t\t\t\tpreRotations = new THREE.Quaternion().setFromEuler( preRotations );\n\n\t\t\t}\n\n\t\t\tif ( postRotations !== undefined ) {\n\n\t\t\t\tpostRotations = postRotations.map( THREE.Math.degToRad );\n\t\t\t\tpostRotations.push( 'ZYX' );\n\n\t\t\t\tpostRotations = new THREE.Euler().fromArray( postRotations );\n\t\t\t\tpostRotations = new THREE.Quaternion().setFromEuler( postRotations ).inverse();\n\n\t\t\t}\n\n\t\t\tvar quaternion = new THREE.Quaternion();\n\t\t\tvar euler = new THREE.Euler();\n\n\t\t\tvar quaternionValues = [];\n\n\t\t\tfor ( var i = 0; i < values.length; i += 3 ) {\n\n\t\t\t\teuler.set( values[ i ], values[ i + 1 ], values[ i + 2 ], 'ZYX' );\n\n\t\t\t\tquaternion.setFromEuler( euler );\n\n\t\t\t\tif ( preRotations !== undefined ) quaternion.premultiply( preRotations );\n\t\t\t\tif ( postRotations !== undefined ) quaternion.multiply( postRotations );\n\n\t\t\t\tquaternion.toArray( quaternionValues, ( i / 3 ) * 4 );\n\n\t\t\t}\n\n\t\t\treturn new THREE.QuaternionKeyframeTrack( modelName + '.quaternion', times, quaternionValues );\n\n\t\t},\n\n\t\tgenerateMorphTrack: function ( rawTracks ) {\n\n\t\t\tvar curves = rawTracks.DeformPercent.curves.morph;\n\t\t\tvar values = curves.values.map( function ( val ) {\n\n\t\t\t\treturn val / 100;\n\n\t\t\t} );\n\n\t\t\tvar morphNum = sceneGraph.getObjectByName( rawTracks.modelName ).morphTargetDictionary[ rawTracks.morphName ];\n\n\t\t\treturn new THREE.NumberKeyframeTrack( rawTracks.modelName + '.morphTargetInfluences[' + morphNum + ']', curves.times, values );\n\n\t\t},\n\n\t\t// For all animated objects, times are defined separately for each axis\n\t\t// Here we'll combine the times into one sorted array without duplicates\n\t\tgetTimesForAllAxes: function ( curves ) {\n\n\t\t\tvar times = [];\n\n\t\t\t// first join together the times for each axis, if defined\n\t\t\tif ( curves.x !== undefined ) times = times.concat( curves.x.times );\n\t\t\tif ( curves.y !== undefined ) times = times.concat( curves.y.times );\n\t\t\tif ( curves.z !== undefined ) times = times.concat( curves.z.times );\n\n\t\t\t// then sort them and remove duplicates\n\t\t\ttimes = times.sort( function ( a, b ) {\n\n\t\t\t\treturn a - b;\n\n\t\t\t} ).filter( function ( elem, index, array ) {\n\n\t\t\t\treturn array.indexOf( elem ) == index;\n\n\t\t\t} );\n\n\t\t\treturn times;\n\n\t\t},\n\n\t\tgetKeyframeTrackValues: function ( times, curves, initialValue ) {\n\n\t\t\tvar prevValue = initialValue;\n\n\t\t\tvar values = [];\n\n\t\t\tvar xIndex = - 1;\n\t\t\tvar yIndex = - 1;\n\t\t\tvar zIndex = - 1;\n\n\t\t\ttimes.forEach( function ( time ) {\n\n\t\t\t\tif ( curves.x ) xIndex = curves.x.times.indexOf( time );\n\t\t\t\tif ( curves.y ) yIndex = curves.y.times.indexOf( time );\n\t\t\t\tif ( curves.z ) zIndex = curves.z.times.indexOf( time );\n\n\t\t\t\t// if there is an x value defined for this frame, use that\n\t\t\t\tif ( xIndex !== - 1 ) {\n\n\t\t\t\t\tvar xValue = curves.x.values[ xIndex ];\n\t\t\t\t\tvalues.push( xValue );\n\t\t\t\t\tprevValue[ 0 ] = xValue;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// otherwise use the x value from the previous frame\n\t\t\t\t\tvalues.push( prevValue[ 0 ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( yIndex !== - 1 ) {\n\n\t\t\t\t\tvar yValue = curves.y.values[ yIndex ];\n\t\t\t\t\tvalues.push( yValue );\n\t\t\t\t\tprevValue[ 1 ] = yValue;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvalues.push( prevValue[ 1 ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( zIndex !== - 1 ) {\n\n\t\t\t\t\tvar zValue = curves.z.values[ zIndex ];\n\t\t\t\t\tvalues.push( zValue );\n\t\t\t\t\tprevValue[ 2 ] = zValue;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvalues.push( prevValue[ 2 ] );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\treturn values;\n\n\t\t},\n\n\t\t// Rotations are defined as Euler angles which can have values  of any size\n\t\t// These will be converted to quaternions which don't support values greater than\n\t\t// PI, so we'll interpolate large rotations\n\t\tinterpolateRotations: function ( curve ) {\n\n\t\t\tfor ( var i = 1; i < curve.values.length; i ++ ) {\n\n\t\t\t\tvar initialValue = curve.values[ i - 1 ];\n\t\t\t\tvar valuesSpan = curve.values[ i ] - initialValue;\n\n\t\t\t\tvar absoluteSpan = Math.abs( valuesSpan );\n\n\t\t\t\tif ( absoluteSpan >= 180 ) {\n\n\t\t\t\t\tvar numSubIntervals = absoluteSpan / 180;\n\n\t\t\t\t\tvar step = valuesSpan / numSubIntervals;\n\t\t\t\t\tvar nextValue = initialValue + step;\n\n\t\t\t\t\tvar initialTime = curve.times[ i - 1 ];\n\t\t\t\t\tvar timeSpan = curve.times[ i ] - initialTime;\n\t\t\t\t\tvar interval = timeSpan / numSubIntervals;\n\t\t\t\t\tvar nextTime = initialTime + interval;\n\n\t\t\t\t\tvar interpolatedTimes = [];\n\t\t\t\t\tvar interpolatedValues = [];\n\n\t\t\t\t\twhile ( nextTime < curve.times[ i ] ) {\n\n\t\t\t\t\t\tinterpolatedTimes.push( nextTime );\n\t\t\t\t\t\tnextTime += interval;\n\n\t\t\t\t\t\tinterpolatedValues.push( nextValue );\n\t\t\t\t\t\tnextValue += step;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcurve.times = inject( curve.times, i, interpolatedTimes );\n\t\t\t\t\tcurve.values = inject( curve.values, i, interpolatedValues );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t};\n\n\t// parse an FBX file in ASCII format\n\tfunction TextParser() {}\n\n\tTextParser.prototype = {\n\n\t\tconstructor: TextParser,\n\n\t\tgetPrevNode: function () {\n\n\t\t\treturn this.nodeStack[ this.currentIndent - 2 ];\n\n\t\t},\n\n\t\tgetCurrentNode: function () {\n\n\t\t\treturn this.nodeStack[ this.currentIndent - 1 ];\n\n\t\t},\n\n\t\tgetCurrentProp: function () {\n\n\t\t\treturn this.currentProp;\n\n\t\t},\n\n\t\tpushStack: function ( node ) {\n\n\t\t\tthis.nodeStack.push( node );\n\t\t\tthis.currentIndent += 1;\n\n\t\t},\n\n\t\tpopStack: function () {\n\n\t\t\tthis.nodeStack.pop();\n\t\t\tthis.currentIndent -= 1;\n\n\t\t},\n\n\t\tsetCurrentProp: function ( val, name ) {\n\n\t\t\tthis.currentProp = val;\n\t\t\tthis.currentPropName = name;\n\n\t\t},\n\n\t\tparse: function ( text ) {\n\n\t\t\tthis.currentIndent = 0;\n\t\t\tconsole.log(\"FBXTree: \", FBXTree);\n\t\t\tthis.allNodes = new FBXTree();\n\t\t\tthis.nodeStack = [];\n\t\t\tthis.currentProp = [];\n\t\t\tthis.currentPropName = '';\n\n\t\t\tvar self = this;\n\n\t\t\tvar split = text.split( /[\\r\\n]+/ );\n\n\t\t\tsplit.forEach( function ( line, i ) {\n\n\t\t\t\tvar matchComment = line.match( /^[\\s\\t]*;/ );\n\t\t\t\tvar matchEmpty = line.match( /^[\\s\\t]*$/ );\n\n\t\t\t\tif ( matchComment || matchEmpty ) return;\n\n\t\t\t\tvar matchBeginning = line.match( '^\\\\t{' + self.currentIndent + '}(\\\\w+):(.*){', '' );\n\t\t\t\tvar matchProperty = line.match( '^\\\\t{' + ( self.currentIndent ) + '}(\\\\w+):[\\\\s\\\\t\\\\r\\\\n](.*)' );\n\t\t\t\tvar matchEnd = line.match( '^\\\\t{' + ( self.currentIndent - 1 ) + '}}' );\n\n\t\t\t\tif ( matchBeginning ) {\n\n\t\t\t\t\tself.parseNodeBegin( line, matchBeginning );\n\n\t\t\t\t} else if ( matchProperty ) {\n\n\t\t\t\t\tself.parseNodeProperty( line, matchProperty, split[ ++ i ] );\n\n\t\t\t\t} else if ( matchEnd ) {\n\n\t\t\t\t\tself.popStack();\n\n\t\t\t\t} else if ( line.match( /^[^\\s\\t}]/ ) ) {\n\n\t\t\t\t\t// large arrays are split over multiple lines terminated with a ',' character\n\t\t\t\t\t// if this is encountered the line needs to be joined to the previous line\n\t\t\t\t\tself.parseNodePropertyContinued( line );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\treturn this.allNodes;\n\n\t\t},\n\n\t\tparseNodeBegin: function ( line, property ) {\n\n\t\t\tvar nodeName = property[ 1 ].trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\t\tvar nodeAttrs = property[ 2 ].split( ',' ).map( function ( attr ) {\n\n\t\t\t\treturn attr.trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\t\t} );\n\n\t\t\tvar node = { name: nodeName };\n\t\t\tvar attrs = this.parseNodeAttr( nodeAttrs );\n\n\t\t\tvar currentNode = this.getCurrentNode();\n\n\t\t\t// a top node\n\t\t\tif ( this.currentIndent === 0 ) {\n\n\t\t\t\tthis.allNodes.add( nodeName, node );\n\n\t\t\t} else { // a subnode\n\n\t\t\t\t// if the subnode already exists, append it\n\t\t\t\tif ( nodeName in currentNode ) {\n\n\t\t\t\t// special case Pose needs PoseNodes as an array\n\t\t\t\t\tif ( nodeName === 'PoseNode' ) {\n\n\t\t\t\t\t\tcurrentNode.PoseNode.push( node );\n\n\t\t\t\t\t} else if ( currentNode[ nodeName ].id !== undefined ) {\n\n\t\t\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\t\t\tcurrentNode[ nodeName ][ currentNode[ nodeName ].id ] = currentNode[ nodeName ];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attrs.id !== '' ) currentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t\t} else if ( typeof attrs.id === 'number' ) {\n\n\t\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\t\tcurrentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t\t} else if ( nodeName !== 'Properties70' ) {\n\n\t\t\t\t\tif ( nodeName === 'PoseNode' )\tcurrentNode[ nodeName ] = [ node ];\n\t\t\t\t\telse currentNode[ nodeName ] = node;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( typeof attrs.id === 'number' ) node.id = attrs.id;\n\t\t\tif ( attrs.name !== '' ) node.attrName = attrs.name;\n\t\t\tif ( attrs.type !== '' ) node.attrType = attrs.type;\n\n\t\t\tthis.pushStack( node );\n\n\t\t},\n\n\t\tparseNodeAttr: function ( attrs ) {\n\n\t\t\tvar id = attrs[ 0 ];\n\n\t\t\tif ( attrs[ 0 ] !== '' ) {\n\n\t\t\t\tid = parseInt( attrs[ 0 ] );\n\n\t\t\t\tif ( isNaN( id ) ) {\n\n\t\t\t\t\tid = attrs[ 0 ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar name = '', type = '';\n\n\t\t\tif ( attrs.length > 1 ) {\n\n\t\t\t\tname = attrs[ 1 ].replace( /^(\\w+)::/, '' );\n\t\t\t\ttype = attrs[ 2 ];\n\n\t\t\t}\n\n\t\t\treturn { id: id, name: name, type: type };\n\n\t\t},\n\n\t\tparseNodeProperty: function ( line, property, contentLine ) {\n\n\t\t\tvar propName = property[ 1 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\t\t\tvar propValue = property[ 2 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\n\t\t\t// for special case: base64 image data follows \"Content: ,\" line\n\t\t\t//\tContent: ,\n\t\t\t//\t \"/9j/4RDaRXhpZgAATU0A...\"\n\t\t\tif ( propName === 'Content' && propValue === ',' ) {\n\n\t\t\t\tpropValue = contentLine.replace( /\"/g, '' ).replace( /,$/, '' ).trim();\n\n\t\t\t}\n\n\t\t\tvar currentNode = this.getCurrentNode();\n\t\t\tvar parentName = currentNode.name;\n\n\t\t\tif ( parentName === 'Properties70' ) {\n\n\t\t\t\tthis.parseNodeSpecialProperty( line, propName, propValue );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\t// Connections\n\t\t\tif ( propName === 'C' ) {\n\n\t\t\t\tvar connProps = propValue.split( ',' ).slice( 1 );\n\t\t\t\tvar from = parseInt( connProps[ 0 ] );\n\t\t\t\tvar to = parseInt( connProps[ 1 ] );\n\n\t\t\t\tvar rest = propValue.split( ',' ).slice( 3 );\n\n\t\t\t\trest = rest.map( function ( elem ) {\n\n\t\t\t\t\treturn elem.trim().replace( /^\"/, '' );\n\n\t\t\t\t} );\n\n\t\t\t\tpropName = 'connections';\n\t\t\t\tpropValue = [ from, to ];\n\t\t\t\tappend( propValue, rest );\n\n\t\t\t\tif ( currentNode[ propName ] === undefined ) {\n\n\t\t\t\t\tcurrentNode[ propName ] = [];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Node\n\t\t\tif ( propName === 'Node' ) currentNode.id = propValue;\n\n\t\t\t// connections\n\t\t\tif ( propName in currentNode && Array.isArray( currentNode[ propName ] ) ) {\n\n\t\t\t\tcurrentNode[ propName ].push( propValue );\n\n\t\t\t} else {\n\n\t\t\t\tif ( propName !== 'a' ) currentNode[ propName ] = propValue;\n\t\t\t\telse currentNode.a = propValue;\n\n\t\t\t}\n\n\t\t\tthis.setCurrentProp( currentNode, propName );\n\n\t\t\t// convert string to array, unless it ends in ',' in which case more will be added to it\n\t\t\tif ( propName === 'a' && propValue.slice( - 1 ) !== ',' ) {\n\n\t\t\t\tcurrentNode.a = parseNumberArray( propValue );\n\n\t\t\t}\n\n\t\t},\n\n\t\tparseNodePropertyContinued: function ( line ) {\n\n\t\t\tvar currentNode = this.getCurrentNode();\n\n\t\t\tcurrentNode.a += line;\n\n\t\t\t// if the line doesn't end in ',' we have reached the end of the property value\n\t\t\t// so convert the string to an array\n\t\t\tif ( line.slice( - 1 ) !== ',' ) {\n\n\t\t\t\tcurrentNode.a = parseNumberArray( currentNode.a );\n\n\t\t\t}\n\n\t\t},\n\n\t\t// parse \"Property70\"\n\t\tparseNodeSpecialProperty: function ( line, propName, propValue ) {\n\n\t\t\t// split this\n\t\t\t// P: \"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\",1,1,1\n\t\t\t// into array like below\n\t\t\t// [\"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\", \"1,1,1\" ]\n\t\t\tvar props = propValue.split( '\",' ).map( function ( prop ) {\n\n\t\t\t\treturn prop.trim().replace( /^\\\"/, '' ).replace( /\\s/, '_' );\n\n\t\t\t} );\n\n\t\t\tvar innerPropName = props[ 0 ];\n\t\t\tvar innerPropType1 = props[ 1 ];\n\t\t\tvar innerPropType2 = props[ 2 ];\n\t\t\tvar innerPropFlag = props[ 3 ];\n\t\t\tvar innerPropValue = props[ 4 ];\n\n\t\t\t// cast values where needed, otherwise leave as strings\n\t\t\tswitch ( innerPropType1 ) {\n\n\t\t\t\tcase 'int':\n\t\t\t\tcase 'enum':\n\t\t\t\tcase 'bool':\n\t\t\t\tcase 'ULongLong':\n\t\t\t\tcase 'double':\n\t\t\t\tcase 'Number':\n\t\t\t\tcase 'FieldOfView':\n\t\t\t\t\tinnerPropValue = parseFloat( innerPropValue );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'Color':\n\t\t\t\tcase 'ColorRGB':\n\t\t\t\tcase 'Vector3D':\n\t\t\t\tcase 'Lcl_Translation':\n\t\t\t\tcase 'Lcl_Rotation':\n\t\t\t\tcase 'Lcl_Scaling':\n\t\t\t\t\tinnerPropValue = parseNumberArray( innerPropValue );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\t// CAUTION: these props must append to parent's parent\n\t\t\tthis.getPrevNode()[ innerPropName ] = {\n\n\t\t\t\t'type': innerPropType1,\n\t\t\t\t'type2': innerPropType2,\n\t\t\t\t'flag': innerPropFlag,\n\t\t\t\t'value': innerPropValue\n\n\t\t\t};\n\n\t\t\tthis.setCurrentProp( this.getPrevNode(), innerPropName );\n\n\t\t},\n\n\t};\n\n\t// Parse an FBX file in Binary format\n\tfunction BinaryParser() {}\n\n\tBinaryParser.prototype = {\n\n\t\tconstructor: BinaryParser,\n\n\t\tparse: function ( buffer ) {\n\n\t\t\tvar reader = new BinaryReader( buffer );\n\t\t\treader.skip( 23 ); // skip magic 23 bytes\n\n\t\t\tvar version = reader.getUint32();\n\n\t\t\tconsole.log( 'THREE.FBXLoader: FBX binary version: ' + version );\n\n\t\t\tvar allNodes = new FBXTree();\n\n\t\t\twhile ( ! this.endOfContent( reader ) ) {\n\n\t\t\t\tvar node = this.parseNode( reader, version );\n\t\t\t\tif ( node !== null ) allNodes.add( node.name, node );\n\n\t\t\t}\n\n\t\t\treturn allNodes;\n\n\t\t},\n\n\t\t// Check if reader has reached the end of content.\n\t\tendOfContent: function ( reader ) {\n\n\t\t\t// footer size: 160bytes + 16-byte alignment padding\n\t\t\t// - 16bytes: magic\n\t\t\t// - padding til 16-byte alignment (at least 1byte?)\n\t\t\t//\t(seems like some exporters embed fixed 15 or 16bytes?)\n\t\t\t// - 4bytes: magic\n\t\t\t// - 4bytes: version\n\t\t\t// - 120bytes: zero\n\t\t\t// - 16bytes: magic\n\t\t\tif ( reader.size() % 16 === 0 ) {\n\n\t\t\t\treturn ( ( reader.getOffset() + 160 + 16 ) & ~ 0xf ) >= reader.size();\n\n\t\t\t} else {\n\n\t\t\t\treturn reader.getOffset() + 160 + 16 >= reader.size();\n\n\t\t\t}\n\n\t\t},\n\n\t\t// recursively parse nodes until the end of the file is reached\n\t\tparseNode: function ( reader, version ) {\n\n\t\t\tvar node = {};\n\n\t\t\t// The first three data sizes depends on version.\n\t\t\tvar endOffset = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\t\t\tvar numProperties = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\n\t\t\t// note: do not remove this even if you get a linter warning as it moves the buffer forward\n\t\t\tvar propertyListLen = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\n\t\t\tvar nameLen = reader.getUint8();\n\t\t\tvar name = reader.getString( nameLen );\n\n\t\t\t// Regards this node as NULL-record if endOffset is zero\n\t\t\tif ( endOffset === 0 ) return null;\n\n\t\t\tvar propertyList = [];\n\n\t\t\tfor ( var i = 0; i < numProperties; i ++ ) {\n\n\t\t\t\tpropertyList.push( this.parseProperty( reader ) );\n\n\t\t\t}\n\n\t\t\t// Regards the first three elements in propertyList as id, attrName, and attrType\n\t\t\tvar id = propertyList.length > 0 ? propertyList[ 0 ] : '';\n\t\t\tvar attrName = propertyList.length > 1 ? propertyList[ 1 ] : '';\n\t\t\tvar attrType = propertyList.length > 2 ? propertyList[ 2 ] : '';\n\n\t\t\t// check if this node represents just a single property\n\t\t\t// like (name, 0) set or (name2, [0, 1, 2]) set of {name: 0, name2: [0, 1, 2]}\n\t\t\tnode.singleProperty = ( numProperties === 1 && reader.getOffset() === endOffset ) ? true : false;\n\n\t\t\twhile ( endOffset > reader.getOffset() ) {\n\n\t\t\t\tvar subNode = this.parseNode( reader, version );\n\n\t\t\t\tif ( subNode !== null ) this.parseSubNode( name, node, subNode );\n\n\t\t\t}\n\n\t\t\tnode.propertyList = propertyList; // raw property list used by parent\n\n\t\t\tif ( typeof id === 'number' ) node.id = id;\n\t\t\tif ( attrName !== '' ) node.attrName = attrName;\n\t\t\tif ( attrType !== '' ) node.attrType = attrType;\n\t\t\tif ( name !== '' ) node.name = name;\n\n\t\t\treturn node;\n\n\t\t},\n\n\t\tparseSubNode: function ( name, node, subNode ) {\n\n\t\t\t// special case: child node is single property\n\t\t\tif ( subNode.singleProperty === true ) {\n\n\t\t\t\tvar value = subNode.propertyList[ 0 ];\n\n\t\t\t\tif ( Array.isArray( value ) ) {\n\n\t\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t\t\tsubNode.a = value;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tnode[ subNode.name ] = value;\n\n\t\t\t\t}\n\n\t\t\t} else if ( name === 'Connections' && subNode.name === 'C' ) {\n\n\t\t\t\tvar array = [];\n\n\t\t\t\tsubNode.propertyList.forEach( function ( property, i ) {\n\n\t\t\t\t\t// first Connection is FBX type (OO, OP, etc.). We'll discard these\n\t\t\t\t\tif ( i !== 0 ) array.push( property );\n\n\t\t\t\t} );\n\n\t\t\t\tif ( node.connections === undefined ) {\n\n\t\t\t\t\tnode.connections = [];\n\n\t\t\t\t}\n\n\t\t\t\tnode.connections.push( array );\n\n\t\t\t} else if ( subNode.name === 'Properties70' ) {\n\n\t\t\t\tvar keys = Object.keys( subNode );\n\n\t\t\t\tkeys.forEach( function ( key ) {\n\n\t\t\t\t\tnode[ key ] = subNode[ key ];\n\n\t\t\t\t} );\n\n\t\t\t} else if ( name === 'Properties70' && subNode.name === 'P' ) {\n\n\t\t\t\tvar innerPropName = subNode.propertyList[ 0 ];\n\t\t\t\tvar innerPropType1 = subNode.propertyList[ 1 ];\n\t\t\t\tvar innerPropType2 = subNode.propertyList[ 2 ];\n\t\t\t\tvar innerPropFlag = subNode.propertyList[ 3 ];\n\t\t\t\tvar innerPropValue;\n\n\t\t\t\tif ( innerPropName.indexOf( 'Lcl ' ) === 0 ) innerPropName = innerPropName.replace( 'Lcl ', 'Lcl_' );\n\t\t\t\tif ( innerPropType1.indexOf( 'Lcl ' ) === 0 ) innerPropType1 = innerPropType1.replace( 'Lcl ', 'Lcl_' );\n\n\t\t\t\tif ( innerPropType1 === 'Color' || innerPropType1 === 'ColorRGB' || innerPropType1 === 'Vector' || innerPropType1 === 'Vector3D' || innerPropType1.indexOf( 'Lcl_' ) === 0 ) {\n\n\t\t\t\t\tinnerPropValue = [\n\t\t\t\t\t\tsubNode.propertyList[ 4 ],\n\t\t\t\t\t\tsubNode.propertyList[ 5 ],\n\t\t\t\t\t\tsubNode.propertyList[ 6 ]\n\t\t\t\t\t];\n\n\t\t\t\t} else {\n\n\t\t\t\t\tinnerPropValue = subNode.propertyList[ 4 ];\n\n\t\t\t\t}\n\n\t\t\t\t// this will be copied to parent, see above\n\t\t\t\tnode[ innerPropName ] = {\n\n\t\t\t\t\t'type': innerPropType1,\n\t\t\t\t\t'type2': innerPropType2,\n\t\t\t\t\t'flag': innerPropFlag,\n\t\t\t\t\t'value': innerPropValue\n\n\t\t\t\t};\n\n\t\t\t} else if ( node[ subNode.name ] === undefined ) {\n\n\t\t\t\tif ( typeof subNode.id === 'number' ) {\n\n\t\t\t\t\tnode[ subNode.name ] = {};\n\t\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( subNode.name === 'PoseNode' ) {\n\n\t\t\t\t\tif ( ! Array.isArray( node[ subNode.name ] ) ) {\n\n\t\t\t\t\t\tnode[ subNode.name ] = [ node[ subNode.name ] ];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tnode[ subNode.name ].push( subNode );\n\n\t\t\t\t} else if ( node[ subNode.name ][ subNode.id ] === undefined ) {\n\n\t\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\n\t\tparseProperty: function ( reader ) {\n\n\t\t\tvar type = reader.getString( 1 );\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'C':\n\t\t\t\t\treturn reader.getBoolean();\n\n\t\t\t\tcase 'D':\n\t\t\t\t\treturn reader.getFloat64();\n\n\t\t\t\tcase 'F':\n\t\t\t\t\treturn reader.getFloat32();\n\n\t\t\t\tcase 'I':\n\t\t\t\t\treturn reader.getInt32();\n\n\t\t\t\tcase 'L':\n\t\t\t\t\treturn reader.getInt64();\n\n\t\t\t\tcase 'R':\n\t\t\t\t\tvar length = reader.getUint32();\n\t\t\t\t\treturn reader.getArrayBuffer( length );\n\n\t\t\t\tcase 'S':\n\t\t\t\t\tvar length = reader.getUint32();\n\t\t\t\t\treturn reader.getString( length );\n\n\t\t\t\tcase 'Y':\n\t\t\t\t\treturn reader.getInt16();\n\n\t\t\t\tcase 'b':\n\t\t\t\tcase 'c':\n\t\t\t\tcase 'd':\n\t\t\t\tcase 'f':\n\t\t\t\tcase 'i':\n\t\t\t\tcase 'l':\n\n\t\t\t\t\tvar arrayLength = reader.getUint32();\n\t\t\t\t\tvar encoding = reader.getUint32(); // 0: non-compressed, 1: compressed\n\t\t\t\t\tvar compressedLength = reader.getUint32();\n\n\t\t\t\t\tif ( encoding === 0 ) {\n\n\t\t\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\t\t\tcase 'b':\n\t\t\t\t\t\t\tcase 'c':\n\t\t\t\t\t\t\t\treturn reader.getBooleanArray( arrayLength );\n\n\t\t\t\t\t\t\tcase 'd':\n\t\t\t\t\t\t\t\treturn reader.getFloat64Array( arrayLength );\n\n\t\t\t\t\t\t\tcase 'f':\n\t\t\t\t\t\t\t\treturn reader.getFloat32Array( arrayLength );\n\n\t\t\t\t\t\t\tcase 'i':\n\t\t\t\t\t\t\t\treturn reader.getInt32Array( arrayLength );\n\n\t\t\t\t\t\t\tcase 'l':\n\t\t\t\t\t\t\t\treturn reader.getInt64Array( arrayLength );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( typeof Zlib === 'undefined' ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js' );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvar inflate = new Zlib.Inflate( new Uint8Array( reader.getArrayBuffer( compressedLength ) ) ); // eslint-disable-line no-undef\n\t\t\t\t\tvar reader2 = new BinaryReader( inflate.decompress().buffer );\n\n\t\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\t\tcase 'b':\n\t\t\t\t\t\tcase 'c':\n\t\t\t\t\t\t\treturn reader2.getBooleanArray( arrayLength );\n\n\t\t\t\t\t\tcase 'd':\n\t\t\t\t\t\t\treturn reader2.getFloat64Array( arrayLength );\n\n\t\t\t\t\t\tcase 'f':\n\t\t\t\t\t\t\treturn reader2.getFloat32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'i':\n\t\t\t\t\t\t\treturn reader2.getInt32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'l':\n\t\t\t\t\t\t\treturn reader2.getInt64Array( arrayLength );\n\n\t\t\t\t\t}\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown property type ' + type );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tfunction BinaryReader( buffer, littleEndian ) {\n\n\t\tthis.dv = new DataView( buffer );\n\t\tthis.offset = 0;\n\t\tthis.littleEndian = ( littleEndian !== undefined ) ? littleEndian : true;\n\n\t}\n\n\tBinaryReader.prototype = {\n\n\t\tconstructor: BinaryReader,\n\n\t\tgetOffset: function () {\n\n\t\t\treturn this.offset;\n\n\t\t},\n\n\t\tsize: function () {\n\n\t\t\treturn this.dv.buffer.byteLength;\n\n\t\t},\n\n\t\tskip: function ( length ) {\n\n\t\t\tthis.offset += length;\n\n\t\t},\n\n\t\t// seems like true/false representation depends on exporter.\n\t\t// true: 1 or 'Y'(=0x59), false: 0 or 'T'(=0x54)\n\t\t// then sees LSB.\n\t\tgetBoolean: function () {\n\n\t\t\treturn ( this.getUint8() & 1 ) === 1;\n\n\t\t},\n\n\t\tgetBooleanArray: function ( size ) {\n\n\t\t\tvar a = [];\n\n\t\t\tfor ( var i = 0; i < size; i ++ ) {\n\n\t\t\t\ta.push( this.getBoolean() );\n\n\t\t\t}\n\n\t\t\treturn a;\n\n\t\t},\n\n\t\tgetUint8: function () {\n\n\t\t\tvar value = this.dv.getUint8( this.offset );\n\t\t\tthis.offset += 1;\n\t\t\treturn value;\n\n\t\t},\n\n\t\tgetInt16: function () {\n\n\t\t\tvar value = this.dv.getInt16( this.offset, this.littleEndian );\n\t\t\tthis.offset += 2;\n\t\t\treturn value;\n\n\t\t},\n\n\t\tgetInt32: function () {\n\n\t\t\tvar value = this.dv.getInt32( this.offset, this.littleEndian );\n\t\t\tthis.offset += 4;\n\t\t\treturn value;\n\n\t\t},\n\n\t\tgetInt32Array: function ( size ) {\n\n\t\t\tvar a = [];\n\n\t\t\tfor ( var i = 0; i < size; i ++ ) {\n\n\t\t\t\ta.push( this.getInt32() );\n\n\t\t\t}\n\n\t\t\treturn a;\n\n\t\t},\n\n\t\tgetUint32: function () {\n\n\t\t\tvar value = this.dv.getUint32( this.offset, this.littleEndian );\n\t\t\tthis.offset += 4;\n\t\t\treturn value;\n\n\t\t},\n\n\t\t// JavaScript doesn't support 64-bit integer so calculate this here\n\t\t// 1 << 32 will return 1 so using multiply operation instead here.\n\t\t// There's a possibility that this method returns wrong value if the value\n\t\t// is out of the range between Number.MAX_SAFE_INTEGER and Number.MIN_SAFE_INTEGER.\n\t\t// TODO: safely handle 64-bit integer\n\t\tgetInt64: function () {\n\n\t\t\tvar low, high;\n\n\t\t\tif ( this.littleEndian ) {\n\n\t\t\t\tlow = this.getUint32();\n\t\t\t\thigh = this.getUint32();\n\n\t\t\t} else {\n\n\t\t\t\thigh = this.getUint32();\n\t\t\t\tlow = this.getUint32();\n\n\t\t\t}\n\n\t\t\t// calculate negative value\n\t\t\tif ( high & 0x80000000 ) {\n\n\t\t\t\thigh = ~ high & 0xFFFFFFFF;\n\t\t\t\tlow = ~ low & 0xFFFFFFFF;\n\n\t\t\t\tif ( low === 0xFFFFFFFF ) high = ( high + 1 ) & 0xFFFFFFFF;\n\n\t\t\t\tlow = ( low + 1 ) & 0xFFFFFFFF;\n\n\t\t\t\treturn - ( high * 0x100000000 + low );\n\n\t\t\t}\n\n\t\t\treturn high * 0x100000000 + low;\n\n\t\t},\n\n\t\tgetInt64Array: function ( size ) {\n\n\t\t\tvar a = [];\n\n\t\t\tfor ( var i = 0; i < size; i ++ ) {\n\n\t\t\t\ta.push( this.getInt64() );\n\n\t\t\t}\n\n\t\t\treturn a;\n\n\t\t},\n\n\t\t// Note: see getInt64() comment\n\t\tgetUint64: function () {\n\n\t\t\tvar low, high;\n\n\t\t\tif ( this.littleEndian ) {\n\n\t\t\t\tlow = this.getUint32();\n\t\t\t\thigh = this.getUint32();\n\n\t\t\t} else {\n\n\t\t\t\thigh = this.getUint32();\n\t\t\t\tlow = this.getUint32();\n\n\t\t\t}\n\n\t\t\treturn high * 0x100000000 + low;\n\n\t\t},\n\n\t\tgetFloat32: function () {\n\n\t\t\tvar value = this.dv.getFloat32( this.offset, this.littleEndian );\n\t\t\tthis.offset += 4;\n\t\t\treturn value;\n\n\t\t},\n\n\t\tgetFloat32Array: function ( size ) {\n\n\t\t\tvar a = [];\n\n\t\t\tfor ( var i = 0; i < size; i ++ ) {\n\n\t\t\t\ta.push( this.getFloat32() );\n\n\t\t\t}\n\n\t\t\treturn a;\n\n\t\t},\n\n\t\tgetFloat64: function () {\n\n\t\t\tvar value = this.dv.getFloat64( this.offset, this.littleEndian );\n\t\t\tthis.offset += 8;\n\t\t\treturn value;\n\n\t\t},\n\n\t\tgetFloat64Array: function ( size ) {\n\n\t\t\tvar a = [];\n\n\t\t\tfor ( var i = 0; i < size; i ++ ) {\n\n\t\t\t\ta.push( this.getFloat64() );\n\n\t\t\t}\n\n\t\t\treturn a;\n\n\t\t},\n\n\t\tgetArrayBuffer: function ( size ) {\n\n\t\t\tvar value = this.dv.buffer.slice( this.offset, this.offset + size );\n\t\t\tthis.offset += size;\n\t\t\treturn value;\n\n\t\t},\n\n\t\tgetString: function ( size ) {\n\n\t\t\t// note: safari 9 doesn't support Uint8Array.indexOf; create intermediate array instead\n\t\t\tvar a = [];\n\n\t\t\tfor ( var i = 0; i < size; i ++ ) {\n\n\t\t\t\ta[ i ] = this.getUint8();\n\n\t\t\t}\n\n\t\t\tvar nullByte = a.indexOf( 0 );\n\t\t\tif ( nullByte >= 0 ) a = a.slice( 0, nullByte );\n\n\t\t\treturn THREE.LoaderUtils.decodeText( new Uint8Array( a ) );\n\n\t\t}\n\n\t};\n\n\t// FBXTree holds a representation of the FBX data, returned by the TextParser ( FBX ASCII format)\n\t// and BinaryParser( FBX Binary format)\n\tfunction FBXTree() {}\n\n\tFBXTree.prototype = {\n\n\t\tconstructor: FBXTree,\n\n\t\tadd: function ( key, val ) {\n\n\t\t\tthis[ key ] = val;\n\n\t\t},\n\n\t};\n\n\t// ************** UTILITY FUNCTIONS **************\n\n\tfunction isFbxFormatBinary( buffer ) {\n\n\t\tvar CORRECT = 'Kaydara FBX Binary  \\0';\n\n\t\treturn buffer.byteLength >= CORRECT.length && CORRECT === convertArrayBufferToString( buffer, 0, CORRECT.length );\n\n\t}\n\n\tfunction isFbxFormatASCII( text ) {\n\n\t\tvar CORRECT = [ 'K', 'a', 'y', 'd', 'a', 'r', 'a', '\\\\', 'F', 'B', 'X', '\\\\', 'B', 'i', 'n', 'a', 'r', 'y', '\\\\', '\\\\' ];\n\n\t\tvar cursor = 0;\n\n\t\tfunction read( offset ) {\n\n\t\t\tvar result = text[ offset - 1 ];\n\t\t\ttext = text.slice( cursor + offset );\n\t\t\tcursor ++;\n\t\t\treturn result;\n\n\t\t}\n\n\t\tfor ( var i = 0; i < CORRECT.length; ++ i ) {\n\n\t\t\tvar num = read( 1 );\n\t\t\tif ( num === CORRECT[ i ] ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfunction getFbxVersion( text ) {\n\n\t\tvar versionRegExp = /FBXVersion: (\\d+)/;\n\t\tvar match = text.match( versionRegExp );\n\t\tif ( match ) {\n\n\t\t\tvar version = parseInt( match[ 1 ] );\n\t\t\treturn version;\n\n\t\t}\n\t\tthrow new Error( 'THREE.FBXLoader: Cannot find the version number for the file given.' );\n\n\t}\n\n\t// Converts FBX ticks into real time seconds.\n\tfunction convertFBXTimeToSeconds( time ) {\n\n\t\treturn time / 46186158000;\n\n\t}\n\n\tvar dataArray = [];\n\n\t// extracts the data from the correct position in the FBX array based on indexing type\n\tfunction getData( polygonVertexIndex, polygonIndex, vertexIndex, infoObject ) {\n\n\t\tvar index;\n\n\t\tswitch ( infoObject.mappingType ) {\n\n\t\t\tcase 'ByPolygonVertex' :\n\t\t\t\tindex = polygonVertexIndex;\n\t\t\t\tbreak;\n\t\t\tcase 'ByPolygon' :\n\t\t\t\tindex = polygonIndex;\n\t\t\t\tbreak;\n\t\t\tcase 'ByVertice' :\n\t\t\t\tindex = vertexIndex;\n\t\t\t\tbreak;\n\t\t\tcase 'AllSame' :\n\t\t\t\tindex = infoObject.indices[ 0 ];\n\t\t\t\tbreak;\n\t\t\tdefault :\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: unknown attribute mapping type ' + infoObject.mappingType );\n\n\t\t}\n\n\t\tif ( infoObject.referenceType === 'IndexToDirect' ) index = infoObject.indices[ index ];\n\n\t\tvar from = index * infoObject.dataSize;\n\t\tvar to = from + infoObject.dataSize;\n\n\t\treturn slice( dataArray, infoObject.buffer, from, to );\n\n\t}\n\n\tvar tempMat = new THREE.Matrix4();\n\tvar tempEuler = new THREE.Euler();\n\tvar tempVec = new THREE.Vector3();\n\tvar translation = new THREE.Vector3();\n\tvar rotation = new THREE.Matrix4();\n\n\t// generate transformation from FBX transform data\n\t// ref: https://help.autodesk.com/view/FBX/2017/ENU/?guid=__files_GUID_10CDD63C_79C1_4F2D_BB28_AD2BE65A02ED_htm\n\t// transformData = {\n\t//\t eulerOrder: int,\n\t//\t translation: [],\n\t//   rotationOffset: [],\n\t//\t preRotation\n\t//\t rotation\n\t//\t postRotation\n\t//   scale\n\t// }\n\t// all entries are optional\n\tfunction generateTransform( transformData ) {\n\n\t\tvar transform = new THREE.Matrix4();\n\t\ttranslation.set( 0, 0, 0 );\n\t\trotation.identity();\n\n\t\tvar order = ( transformData.eulerOrder ) ? getEulerOrder( transformData.eulerOrder ) : getEulerOrder( 0 );\n\n\t\tif ( transformData.translation ) translation.fromArray( transformData.translation );\n\t\tif ( transformData.rotationOffset ) translation.add( tempVec.fromArray( transformData.rotationOffset ) );\n\n\t\tif ( transformData.rotation ) {\n\n\t\t\tvar array = transformData.rotation.map( THREE.Math.degToRad );\n\t\t\tarray.push( order );\n\t\t\trotation.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t\t}\n\n\t\tif ( transformData.preRotation ) {\n\n\t\t\tvar array = transformData.preRotation.map( THREE.Math.degToRad );\n\t\t\tarray.push( order );\n\t\t\ttempMat.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t\t\trotation.premultiply( tempMat );\n\n\t\t}\n\n\t\tif ( transformData.postRotation ) {\n\n\t\t\tvar array = transformData.postRotation.map( THREE.Math.degToRad );\n\t\t\tarray.push( order );\n\t\t\ttempMat.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t\t\ttempMat.getInverse( tempMat );\n\n\t\t\trotation.multiply( tempMat );\n\n\t\t}\n\n\t\tif ( transformData.scale ) transform.scale( tempVec.fromArray( transformData.scale ) );\n\n\t\ttransform.setPosition( translation );\n\t\ttransform.multiply( rotation );\n\n\t\treturn transform;\n\n\t}\n\n\t// Returns the three.js intrinsic Euler order corresponding to FBX extrinsic Euler order\n\t// ref: http://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_class_fbx_euler_html\n\tfunction getEulerOrder( order ) {\n\n\t\tvar enums = [\n\t\t\t'ZYX', // -> XYZ extrinsic\n\t\t\t'YZX', // -> XZY extrinsic\n\t\t\t'XZY', // -> YZX extrinsic\n\t\t\t'ZXY', // -> YXZ extrinsic\n\t\t\t'YXZ', // -> ZXY extrinsic\n\t\t\t'XYZ', // -> ZYX extrinsic\n\t\t//'SphericXYZ', // not possible to support\n\t\t];\n\n\t\tif ( order === 6 ) {\n\n\t\t\tconsole.warn( 'THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.' );\n\t\t\treturn enums[ 0 ];\n\n\t\t}\n\n\t\treturn enums[ order ];\n\n\t}\n\n\t// Parses comma separated list of numbers and returns them an array.\n\t// Used internally by the TextParser\n\tfunction parseNumberArray( value ) {\n\n\t\tvar array = value.split( ',' ).map( function ( val ) {\n\n\t\t\treturn parseFloat( val );\n\n\t\t} );\n\n\t\treturn array;\n\n\t}\n\n\tfunction convertArrayBufferToString( buffer, from, to ) {\n\n\t\tif ( from === undefined ) from = 0;\n\t\tif ( to === undefined ) to = buffer.byteLength;\n\n\t\treturn THREE.LoaderUtils.decodeText( new Uint8Array( buffer, from, to ) );\n\n\t}\n\n\tfunction append( a, b ) {\n\n\t\tfor ( var i = 0, j = a.length, l = b.length; i < l; i ++, j ++ ) {\n\n\t\t\ta[ j ] = b[ i ];\n\n\t\t}\n\n\t}\n\n\tfunction slice( a, b, from, to ) {\n\n\t\tfor ( var i = from, j = 0; i < to; i ++, j ++ ) {\n\n\t\t\ta[ j ] = b[ i ];\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\t// inject array a2 into array a1 at index\n\tfunction inject( a1, index, a2 ) {\n\n\t\treturn a1.slice( 0, index ).concat( a2 ).concat( a1.slice( index ) );\n\n\t}\n\n\treturn FBXLoader;\n\n} )();\n","const fetchScript = require('../../lib/fetch-script')();\n\nconst LOADER_SRC = 'https://cdn.jsdelivr.net/gh/mrdoob/three.js@r86/examples/js/loaders/GLTFLoader.js';\n\nconst loadLoader = (function () {\n  let promise;\n  return function () {\n    promise = promise || fetchScript(LOADER_SRC);\n    return promise;\n  };\n}());\n\n/**\n * Legacy loader for glTF 1.0 models.\n * Asynchronously loads THREE.GLTFLoader from jsdelivr.\n */\nmodule.exports = AFRAME.registerComponent('gltf-model-legacy', {\n  schema: {type: 'model'},\n\n  init: function () {\n    this.model = null;\n    this.loader = null;\n    this.loaderPromise = loadLoader().then(() => {\n      this.loader = new THREE.GLTFLoader();\n      this.loader.setCrossOrigin('Anonymous');\n    });\n  },\n\n  update: function () {\n    const self = this;\n    const el = this.el;\n    const src = this.data;\n\n    if (!src) { return; }\n\n    this.remove();\n\n    this.loaderPromise.then(() => {\n      this.loader.load(src, function gltfLoaded (gltfModel) {\n        self.model = gltfModel.scene;\n        self.model.animations = gltfModel.animations;\n        el.setObject3D('mesh', self.model);\n        el.emit('model-loaded', {format: 'gltf', model: self.model});\n      });\n    });\n  },\n\n  remove: function () {\n    if (!this.model) { return; }\n    this.el.removeObject3D('mesh');\n  }\n});\n","/**\n * Source: https://github.com/Adobe-Marketing-Cloud/fetch-script\n */\n\nfunction getScriptId() {\n  return 'script_' + Date.now() + '_' + Math.ceil(Math.random() * 100000);\n}\n\nfunction createScript(url, id) {\n  var script = document.createElement('script');\n  script.type = 'text/javascript';\n  script.async = true;\n  script.id = id;\n  script.src = url;\n\n  return script;\n}\n\nfunction removeScript(id) {\n  const script = document.getElementById(id);\n  const parent = script.parentNode;\n\n  try {\n    parent && parent.removeChild(script);\n  } catch (e) {\n    // ignore\n  }\n}\n\nfunction appendScript(script) {\n  const firstScript = document.getElementsByTagName('script')[0];\n  firstScript.parentNode.insertBefore(script, firstScript);\n}\n\nfunction fetchScriptInternal(url, options, Promise) {\n  return new Promise(function(resolve, reject) {\n    const timeout = options.timeout || 5000;\n    const scriptId = getScriptId();\n    const script = createScript(url, scriptId);\n\n    const timeoutId = setTimeout(function() {\n      reject(new Error('Script request to ' + url + ' timed out'));\n\n      removeScript(scriptId);\n    }, timeout);\n\n    const disableTimeout = function(timeoutId) { clearTimeout(timeoutId); };\n\n    script.addEventListener('load', function(e) {\n      resolve({ok: true});\n\n      disableTimeout(timeoutId);\n      removeScript(scriptId);\n    });\n\n    script.addEventListener('error', function(e) {\n      reject(new Error('Script request to ' + url + ' failed ' + e));\n\n      disableTimeout(timeoutId);\n      removeScript(scriptId);\n    });\n\n    appendScript(script);\n  });\n}\n\nfunction fetchScript(settings) {\n  settings = settings || {};\n  return function (url, options) {\n    options = options || {};\n    return fetchScriptInternal(url, options, settings.Promise || Promise);\n  };\n}\n\nmodule.exports = fetchScript;\n","/**\n * object-model\n *\n * Loader for THREE.js JSON format. Somewhat confusingly, there are two different THREE.js formats,\n * both having the .json extension. This loader supports only THREE.ObjectLoader, which typically\n * includes multiple meshes or an entire scene.\n *\n * Check the console for errors, if in doubt. You may need to use `json-model` or\n * `blend-character-model` for some .js and .json files.\n *\n * See: https://clara.io/learn/user-guide/data_exchange/threejs_export\n */\nmodule.exports = AFRAME.registerComponent('object-model', {\n  schema: {\n    src:         { type: 'asset' },\n    crossorigin: { default: '' }\n  },\n\n  init: function () {\n    this.model = null;\n  },\n\n  update: function () {\n    let loader;\n    const data = this.data;\n    if (!data.src) return;\n\n    this.remove();\n    loader = new THREE.ObjectLoader();\n    if (data.crossorigin) loader.setCrossOrigin(data.crossorigin);\n    loader.load(data.src, (object) => {\n\n      // Enable skinning, if applicable.\n      object.traverse((o) => {\n        if (o instanceof THREE.SkinnedMesh && o.material) {\n          o.material.skinning = !!((o.geometry && o.geometry.bones) || []).length;\n        }\n      });\n\n      this.load(object);\n    });\n  },\n\n  load: function (model) {\n    this.model = model;\n    this.el.setObject3D('mesh', model);\n    this.el.emit('model-loaded', {format: 'json', model: model});\n  },\n\n  remove: function () {\n    if (this.model) this.el.removeObject3D('mesh');\n  }\n});\n","require('./checkpoint');\nrequire('./cube-env-map');\nrequire('./grab');\nrequire('./jump-ability');\nrequire('./kinematic-body');\nrequire('./mesh-smooth');\nrequire('./normal-material');\nrequire('./sphere-collider');\n","module.exports = AFRAME.registerComponent('checkpoint', {\n  schema: {\n    offset: {default: {x: 0, y: 0, z: 0}, type: 'vec3'}\n  },\n\n  init: function () {\n    this.active = false;\n    this.targetEl = null;\n    this.fire = this.fire.bind(this);\n    this.offset = new THREE.Vector3();\n  },\n\n  update: function () {\n    this.offset.copy(this.data.offset);\n  },\n\n  play: function () { this.el.addEventListener('click', this.fire); },\n  pause: function () { this.el.removeEventListener('click', this.fire); },\n  remove: function () { this.pause(); },\n\n  fire: function () {\n    const targetEl = this.el.sceneEl.querySelector('[checkpoint-controls]');\n    if (!targetEl) {\n      throw new Error('No `checkpoint-controls` component found.');\n    }\n    targetEl.components['checkpoint-controls'].setCheckpoint(this.el);\n  },\n\n  getOffset: function () {\n    return this.offset.copy(this.data.offset);\n  }\n});\n","/**\n * @param  {Array<THREE.Material>|THREE.Material} material\n * @return {Array<THREE.Material>}\n */\nfunction ensureMaterialArray (material) {\n  if (!material) {\n    return [];\n  } else if (Array.isArray(material)) {\n    return material;\n  } else if (material.materials) {\n    return material.materials;\n  } else {\n    return [material];\n  }\n}\n\n/**\n * @param  {THREE.Object3D} mesh\n * @param  {Array<string>} materialNames\n * @param  {THREE.Texture} envMap\n * @param  {number} reflectivity  [description]\n */\nfunction applyEnvMap (mesh, materialNames, envMap, reflectivity) {\n  if (!mesh) return;\n\n  materialNames = materialNames || [];\n\n  mesh.traverse((node) => {\n\n    if (!node.isMesh) return;\n\n    const meshMaterials = ensureMaterialArray(node.material);\n\n    meshMaterials.forEach((material) => {\n\n      if (material && !('envMap' in material)) return;\n      if (materialNames.length && materialNames.indexOf(material.name) === -1) return;\n\n      material.envMap = envMap;\n      material.reflectivity = reflectivity;\n      material.needsUpdate = true;\n\n    });\n\n  });\n}\n\n/**\n * Specifies an envMap on an entity, without replacing any existing material\n * properties.\n */\nmodule.exports = AFRAME.registerComponent('cube-env-map', {\n  multiple: true,\n\n  schema: {\n    path: {default: ''},\n    extension: {default: 'jpg', oneOf: ['jpg', 'png']},\n    format: {default: 'RGBFormat', oneOf: ['RGBFormat', 'RGBAFormat']},\n    enableBackground: {default: false},\n    reflectivity: {default: 1, min: 0, max: 1},\n    materials: {default: []}\n  },\n\n  init: function () {\n    const data = this.data;\n\n    this.texture = new THREE.CubeTextureLoader().load([\n      data.path + 'posx.' + data.extension, data.path + 'negx.' + data.extension,\n      data.path + 'posy.' + data.extension, data.path + 'negy.' + data.extension,\n      data.path + 'posz.' + data.extension, data.path + 'negz.' + data.extension\n    ]);\n    this.texture.format = THREE[data.format];\n\n    this.object3dsetHandler = () => {\n      const mesh = this.el.getObject3D('mesh');\n      const data = this.data;\n      applyEnvMap(mesh, data.materials, this.texture, data.reflectivity);\n    };\n    this.el.addEventListener('object3dset', this.object3dsetHandler);\n  },\n\n  update: function (oldData) {\n    const data = this.data;\n    const mesh = this.el.getObject3D('mesh');\n\n    let addedMaterialNames = [];\n    let removedMaterialNames = [];\n\n    if (data.materials.length) {\n      if (oldData.materials) {\n        addedMaterialNames = data.materials.filter((name) => !oldData.materials.includes(name));\n        removedMaterialNames = oldData.materials.filter((name) => !data.materials.includes(name));\n      } else {\n        addedMaterialNames = data.materials;\n      }\n    }\n    if (addedMaterialNames.length) {\n      applyEnvMap(mesh, addedMaterialNames, this.texture, data.reflectivity);\n    }\n    if (removedMaterialNames.length) {\n      applyEnvMap(mesh, removedMaterialNames, null, 1);\n    }\n\n    if (oldData.materials && data.reflectivity !== oldData.reflectivity) {\n      const maintainedMaterialNames = data.materials\n        .filter((name) => oldData.materials.includes(name));\n      if (maintainedMaterialNames.length) {\n        applyEnvMap(mesh, maintainedMaterialNames, this.texture, data.reflectivity);\n      }\n    }\n\n    if (this.data.enableBackground && !oldData.enableBackground) {\n      this.setBackground(this.texture);\n    } else if (!this.data.enableBackground && oldData.enableBackground) {\n      this.setBackground(null);\n    }\n  },\n\n  remove: function () {\n    this.el.removeEventListener('object3dset', this.object3dsetHandler);\n    const mesh = this.el.getObject3D('mesh');\n    const data = this.data;\n\n    applyEnvMap(mesh, data.materials, null, 1);\n    if (data.enableBackground) this.setBackground(null);\n  },\n\n  setBackground: function (texture) {\n    this.el.sceneEl.object3D.background = texture;\n  }\n});\n","/* global CANNON */\n\n/**\n * Based on aframe/examples/showcase/tracked-controls.\n *\n * Handles events coming from the hand-controls.\n * Determines if the entity is grabbed or released.\n * Updates its position to move along the controller.\n */\nmodule.exports = AFRAME.registerComponent('grab', {\n  init: function () {\n    this.system = this.el.sceneEl.systems.physics;\n\n    this.GRABBED_STATE = 'grabbed';\n\n    this.grabbing = false;\n    this.hitEl =      /** @type {AFRAME.Element}    */ null;\n    this.physics =    /** @type {AFRAME.System}     */ this.el.sceneEl.systems.physics;\n    this.constraint = /** @type {CANNON.Constraint} */ null;\n\n    // Bind event handlers\n    this.onHit = this.onHit.bind(this);\n    this.onGripOpen = this.onGripOpen.bind(this);\n    this.onGripClose = this.onGripClose.bind(this);\n  },\n\n  play: function () {\n    const el = this.el;\n    el.addEventListener('hit', this.onHit);\n    el.addEventListener('gripdown', this.onGripClose);\n    el.addEventListener('gripup', this.onGripOpen);\n    el.addEventListener('trackpaddown', this.onGripClose);\n    el.addEventListener('trackpadup', this.onGripOpen);\n    el.addEventListener('triggerdown', this.onGripClose);\n    el.addEventListener('triggerup', this.onGripOpen);\n  },\n\n  pause: function () {\n    const el = this.el;\n    el.removeEventListener('hit', this.onHit);\n    el.removeEventListener('gripdown', this.onGripClose);\n    el.removeEventListener('gripup', this.onGripOpen);\n    el.removeEventListener('trackpaddown', this.onGripClose);\n    el.removeEventListener('trackpadup', this.onGripOpen);\n    el.removeEventListener('triggerdown', this.onGripClose);\n    el.removeEventListener('triggerup', this.onGripOpen);\n  },\n\n  onGripClose: function () {\n    this.grabbing = true;\n  },\n\n  onGripOpen: function () {\n    const hitEl = this.hitEl;\n    this.grabbing = false;\n    if (!hitEl) { return; }\n    hitEl.removeState(this.GRABBED_STATE);\n    this.hitEl = undefined;\n    this.system.removeConstraint(this.constraint);\n    this.constraint = null;\n  },\n\n  onHit: function (evt) {\n    const hitEl = evt.detail.el;\n    // If the element is already grabbed (it could be grabbed by another controller).\n    // If the hand is not grabbing the element does not stick.\n    // If we're already grabbing something you can't grab again.\n    if (!hitEl || hitEl.is(this.GRABBED_STATE) || !this.grabbing || this.hitEl) { return; }\n    hitEl.addState(this.GRABBED_STATE);\n    this.hitEl = hitEl;\n    this.constraint = new CANNON.LockConstraint(this.el.body, hitEl.body);\n    this.system.addConstraint(this.constraint);\n  }\n});\n","const ACCEL_G = -9.8, // m/s^2\n    EASING = -15; // m/s^2\n\n/**\n * Jump ability.\n */\nmodule.exports = AFRAME.registerComponent('jump-ability', {\n  dependencies: ['velocity'],\n\n  /* Schema\n  */\n\n  schema: {\n    on: { default: 'keydown:Space gamepadbuttondown:0' },\n    playerHeight: { default: 1.764 },\n    maxJumps: { default: 1 },\n    distance: { default: 5 },\n    debug: { default: false }\n  },\n\n  init: function () {\n    this.velocity = 0;\n    this.numJumps = 0;\n\n    const beginJump = this.beginJump.bind(this),\n        events = this.data.on.split(' ');\n    this.bindings = {};\n    for (let i = 0; i <  events.length; i++) {\n      this.bindings[events[i]] = beginJump;\n      this.el.addEventListener(events[i], beginJump);\n    }\n    this.bindings.collide = this.onCollide.bind(this);\n    this.el.addEventListener('collide', this.bindings.collide);\n  },\n\n  remove: function () {\n    for (var event in this.bindings) {\n      if (this.bindings.hasOwnProperty(event)) {\n        this.el.removeEventListener(event, this.bindings[event]);\n        delete this.bindings[event];\n      }\n    }\n    this.el.removeEventListener('collide', this.bindings.collide);\n    delete this.bindings.collide;\n  },\n\n  beginJump: function () {\n    if (this.numJumps < this.data.maxJumps) {\n      const data = this.data,\n          initialVelocity = Math.sqrt(-2 * data.distance * (ACCEL_G + EASING)),\n          v = this.el.getAttribute('velocity');\n      this.el.setAttribute('velocity', {x: v.x, y: initialVelocity, z: v.z});\n      this.numJumps++;\n      this.el.emit('jumpstart');\n    }\n  },\n\n  onCollide: function () {\n    if (this.numJumps > 0) this.el.emit('jumpend');\n    this.numJumps = 0;\n  }\n});\n","/* global CANNON */\n\n/**\n * Kinematic body.\n *\n * Managed dynamic body, which moves but is not affected (directly) by the\n * physics engine. This is not a true kinematic body, in the sense that we are\n * letting the physics engine _compute_ collisions against it and selectively\n * applying those collisions to the object. The physics engine does not decide\n * the position/velocity/rotation of the element.\n *\n * Used for the camera object, because full physics simulation would create\n * movement that feels unnatural to the player. Bipedal movement does not\n * translate nicely to rigid body physics.\n *\n * See: http://www.learn-cocos2d.com/2013/08/physics-engine-platformer-terrible-idea/\n * And: http://oxleygamedev.blogspot.com/2011/04/player-physics-part-2.html\n */\nconst EPS = 0.000001;\n\nmodule.exports = AFRAME.registerComponent('kinematic-body', {\n  dependencies: ['velocity'],\n\n  /*******************************************************************\n   * Schema\n   */\n\n  schema: {\n    mass:           { default: 5 },\n    radius:         { default: 1.3 },\n    linearDamping:  { default: 0.05 },\n    enableSlopes:   { default: true },\n    enableJumps:    { default: false },\n  },\n\n  /*******************************************************************\n   * Lifecycle\n   */\n\n  init: function () {\n    this.system = this.el.sceneEl.systems.physics;\n    this.system.addComponent(this);\n\n    const el = this.el,\n        data = this.data,\n        position = (new CANNON.Vec3()).copy(el.object3D.getWorldPosition(new THREE.Vector3()));\n\n    this.body = new CANNON.Body({\n      material: this.system.getMaterial('staticMaterial'),\n      position: position,\n      mass: data.mass,\n      linearDamping: data.linearDamping,\n      fixedRotation: true\n    });\n    this.body.addShape(\n      new CANNON.Sphere(data.radius),\n      new CANNON.Vec3(0, data.radius, 0)\n    );\n\n    this.body.el = this.el;\n    this.el.body = this.body;\n    this.system.addBody(this.body);\n\n    if (el.hasAttribute('wasd-controls')) {\n      console.warn('[kinematic-body] Not compatible with wasd-controls, use movement-controls.');\n    }\n  },\n\n  remove: function () {\n    this.system.removeBody(this.body);\n    this.system.removeComponent(this);\n    delete this.el.body;\n  },\n\n  /*******************************************************************\n   * Update\n   */\n\n  /**\n   * Checks CANNON.World for collisions and attempts to apply them to the\n   * element automatically, in a player-friendly way.\n   *\n   * There's extra logic for horizontal surfaces here. The basic requirements:\n   * (1) Only apply gravity when not in contact with _any_ horizontal surface.\n   * (2) When moving, project the velocity against exactly one ground surface.\n   *     If in contact with two ground surfaces (e.g. ground + ramp), choose\n   *     the one that collides with current velocity, if any.\n   */\n  beforeStep: function (t, dt) {\n    if (!dt) return;\n\n    const el = this.el;\n    const data = this.data\n    const body = this.body;\n\n    if (!data.enableJumps) body.velocity.set(0, 0, 0);\n    body.position.copy(el.getAttribute('position'));\n  },\n\n  step: (function () {\n    const velocity = new THREE.Vector3(),\n        normalizedVelocity = new THREE.Vector3(),\n        currentSurfaceNormal = new THREE.Vector3(),\n        groundNormal = new THREE.Vector3();\n\n    return function (t, dt) {\n      if (!dt) return;\n\n      let body = this.body,\n          data = this.data,\n          didCollide = false,\n          height, groundHeight = -Infinity,\n          groundBody,\n          contacts = this.system.getContacts();\n\n      dt = Math.min(dt, this.system.data.maxInterval * 1000);\n\n      groundNormal.set(0, 0, 0);\n      velocity.copy(this.el.getAttribute('velocity'));\n      body.velocity.copy(velocity);\n\n      for (var i = 0, contact; contact = contacts[i]; i++) {\n        // 1. Find any collisions involving this element. Get the contact\n        // normal, and make sure it's oriented _out_ of the other object and\n        // enabled (body.collisionReponse is true for both bodies)\n        if (!contact.enabled) { continue; }\n        if (body.id === contact.bi.id) {\n          contact.ni.negate(currentSurfaceNormal);\n        } else if (body.id === contact.bj.id) {\n          currentSurfaceNormal.copy(contact.ni);\n        } else {\n          continue;\n        }\n\n        didCollide = body.velocity.dot(currentSurfaceNormal) < -EPS;\n        if (didCollide && currentSurfaceNormal.y <= 0.5) {\n          // 2. If current trajectory attempts to move _through_ another\n          // object, project the velocity against the collision plane to\n          // prevent passing through.\n          velocity.projectOnPlane(currentSurfaceNormal);\n        } else if (currentSurfaceNormal.y > 0.5) {\n          // 3. If in contact with something roughly horizontal (+/- 45) then\n          // consider that the current ground. Only the highest qualifying\n          // ground is retained.\n          height = body.id === contact.bi.id\n            ? Math.abs(contact.rj.y + contact.bj.position.y)\n            : Math.abs(contact.ri.y + contact.bi.position.y);\n          if (height > groundHeight) {\n            groundHeight = height;\n            groundNormal.copy(currentSurfaceNormal);\n            groundBody = body.id === contact.bi.id ? contact.bj : contact.bi;\n          }\n        }\n      }\n\n      normalizedVelocity.copy(velocity).normalize();\n      if (groundBody && (!data.enableJumps || normalizedVelocity.y < 0.5)) {\n        if (!data.enableSlopes) {\n          groundNormal.set(0, 1, 0);\n        } else if (groundNormal.y < 1 - EPS) {\n          groundNormal.copy(this.raycastToGround(groundBody, groundNormal));\n        }\n\n        // 4. Project trajectory onto the top-most ground object, unless\n        // trajectory is > 45.\n        velocity.projectOnPlane(groundNormal);\n\n      } else if (this.system.driver.world) {\n        // 5. If not in contact with anything horizontal, apply world gravity.\n        // TODO - Why is the 4x scalar necessary.\n        // NOTE: Does not work if physics runs on a worker.\n        velocity.add(this.system.driver.world.gravity.scale(dt * 4.0 / 1000));\n      }\n\n      body.velocity.copy(velocity);\n      this.el.setAttribute('velocity', body.velocity);\n      this.el.setAttribute('position', body.position);\n    };\n  }()),\n\n  /**\n   * When walking on complex surfaces (trimeshes, borders between two shapes),\n   * the collision normals returned for the player sphere can be very\n   * inconsistent. To address this, raycast straight down, find the collision\n   * normal, and return whichever normal is more vertical.\n   * @param  {CANNON.Body} groundBody\n   * @param  {CANNON.Vec3} groundNormal\n   * @return {CANNON.Vec3}\n   */\n  raycastToGround: function (groundBody, groundNormal) {\n    let ray,\n        hitNormal,\n        vFrom = this.body.position,\n        vTo = this.body.position.clone();\n\n    ray = new CANNON.Ray(vFrom, vTo);\n    ray._updateDirection(); // TODO - Report bug.\n    ray.intersectBody(groundBody);\n\n    if (!ray.hasHit) return groundNormal;\n\n    // Compare ABS, in case we're projecting against the inside of the face.\n    hitNormal = ray.result.hitNormalWorld;\n    return Math.abs(hitNormal.y) > Math.abs(groundNormal.y) ? hitNormal : groundNormal;\n  }\n});\n","/**\n * Apply this component to models that looks \"blocky\", to have Three.js compute\n * vertex normals on the fly for a \"smoother\" look.\n */\nmodule.exports = AFRAME.registerComponent('mesh-smooth', {\n  init: function () {\n    this.el.addEventListener('model-loaded', (e) => {\n      e.detail.model.traverse((node) => {\n        if (node.isMesh) node.geometry.computeVertexNormals();\n      });\n    });\n  }\n});\n","/**\n * Recursively applies a MeshNormalMaterial to the entity, such that\n * face colors are determined by their orientation. Helpful for\n * debugging geometry\n */\nmodule.exports = AFRAME.registerComponent('normal-material', {\n  init: function () {\n    this.material = new THREE.MeshNormalMaterial({flatShading: true});\n    this.applyMaterial = this.applyMaterial.bind(this);\n    this.el.addEventListener('object3dset', this.applyMaterial);\n  },\n\n  remove: function () {\n    this.el.removeEventListener('object3dset', this.applyMaterial);\n  },\n\n  applyMaterial: function () {\n    this.el.object3D.traverse((node) => {\n      if (node.isMesh) node.material = this.material;\n    });\n  }\n});\n","/**\n * Based on aframe/examples/showcase/tracked-controls.\n *\n * Implement bounding sphere collision detection for entities with a mesh.\n * Sets the specified state on the intersected entities.\n *\n * @property {string} objects - Selector of the entities to test for collision.\n * @property {string} state - State to set on collided entities.\n *\n */\nmodule.exports = AFRAME.registerComponent('sphere-collider', {\n  schema: {\n    objects: {default: ''},\n    state: {default: 'collided'},\n    radius: {default: 0.05},\n    watch: {default: true}\n  },\n\n  init: function () {\n    /** @type {MutationObserver} */\n    this.observer = null;\n    /** @type {Array<Element>} Elements to watch for collisions. */\n    this.els = [];\n    /** @type {Array<Element>} Elements currently in collision state. */\n    this.collisions = [];\n\n    this.handleHit = this.handleHit.bind(this);\n    this.handleHitEnd = this.handleHitEnd.bind(this);\n  },\n\n  remove: function () {\n    this.pause();\n  },\n\n  play: function () {\n    const sceneEl = this.el.sceneEl;\n\n    if (this.data.watch) {\n      this.observer = new MutationObserver(this.update.bind(this, null));\n      this.observer.observe(sceneEl, {childList: true, subtree: true});\n    }\n  },\n\n  pause: function () {\n    if (this.observer) {\n      this.observer.disconnect();\n      this.observer = null;\n    }\n  },\n\n  /**\n   * Update list of entities to test for collision.\n   */\n  update: function () {\n    const data = this.data;\n    let objectEls;\n\n    // Push entities into list of els to intersect.\n    if (data.objects) {\n      objectEls = this.el.sceneEl.querySelectorAll(data.objects);\n    } else {\n      // If objects not defined, intersect with everything.\n      objectEls = this.el.sceneEl.children;\n    }\n    // Convert from NodeList to Array\n    this.els = Array.prototype.slice.call(objectEls);\n  },\n\n  tick: (function () {\n    const position = new THREE.Vector3(),\n        meshPosition = new THREE.Vector3(),\n        colliderScale = new THREE.Vector3(),\n        size = new THREE.Vector3(),\n        box = new THREE.Box3(),\n        distanceMap = new Map();\n    return function () {\n      const el = this.el,\n          data = this.data,\n          mesh = el.getObject3D('mesh'),\n          collisions = [];\n      let colliderRadius;\n\n      if (!mesh) { return; }\n\n      distanceMap.clear();\n      el.object3D.getWorldPosition(position);\n      el.object3D.getWorldScale(colliderScale);\n      colliderRadius = data.radius * scaleFactor(colliderScale);\n      // Update collision list.\n      this.els.forEach(intersect);\n\n      // Emit events and add collision states, in order of distance.\n      collisions\n        .sort((a, b) => distanceMap.get(a) > distanceMap.get(b) ? 1 : -1)\n        .forEach(this.handleHit);\n\n      // Remove collision state from current element.\n      if (collisions.length === 0) { el.emit('hit', {el: null}); }\n\n      // Remove collision state from other elements.\n      this.collisions\n        .filter((el) => !distanceMap.has(el))\n        .forEach(this.handleHitEnd);\n\n      // Store new collisions\n      this.collisions = collisions;\n\n      // Bounding sphere collision detection\n      function intersect (el) {\n        let radius, mesh, distance, extent;\n\n        if (!el.isEntity) { return; }\n\n        mesh = el.getObject3D('mesh');\n\n        if (!mesh) { return; }\n\n        box.setFromObject(mesh).getSize(size);\n        extent = Math.max(size.x, size.y, size.z) / 2;\n        radius = Math.sqrt(2 * extent * extent);\n        box.getCenter(meshPosition);\n\n        if (!radius) { return; }\n\n        distance = position.distanceTo(meshPosition);\n        if (distance < radius + colliderRadius) {\n          collisions.push(el);\n          distanceMap.set(el, distance);\n        }\n      }\n      // use max of scale factors to maintain bounding sphere collision\n      function scaleFactor (scaleVec) {\n        return Math.max.apply(null, scaleVec.toArray());\n      }\n    };\n  })(),\n\n  handleHit: function (targetEl) {\n    targetEl.emit('hit');\n    targetEl.addState(this.data.state);\n    this.el.emit('hit', {el: targetEl});\n  },\n  handleHitEnd: function (targetEl) {\n    targetEl.emit('hitend');\n    targetEl.removeState(this.data.state);\n    this.el.emit('hitend', {el: targetEl});\n  }\n});\n","require('./nav-mesh');\nrequire('./nav-agent');\nrequire('./system');\n","/**\n * nav-mesh\n *\n * Waits for a mesh to be loaded on the current entity, then sets it as the\n * nav mesh in the pathfinding system.\n */\nmodule.exports = AFRAME.registerComponent('nav-mesh', {\n  init: function () {\n    this.system = this.el.sceneEl.systems.nav;\n    this.hasLoadedNavMesh = false;\n    this.el.addEventListener('object3dset', this.loadNavMesh.bind(this));\n  },\n\n  play: function () {\n    if (!this.hasLoadedNavMesh) this.loadNavMesh();\n  },\n\n  loadNavMesh: function () {\n    const object = this.el.getObject3D('mesh');\n    const scene = this.el.sceneEl.object3D;\n\n    if (!object) return;\n\n    let navMesh;\n    object.traverse((node) => {\n      if (node.isMesh) navMesh = node;\n    });\n\n    if (!navMesh) return;\n\n    const navMeshGeometry = navMesh.geometry.isBufferGeometry\n      ? new THREE.Geometry().fromBufferGeometry(navMesh.geometry)\n      : navMesh.geometry.clone();\n\n    scene.updateMatrixWorld();\n    navMeshGeometry.applyMatrix(navMesh.matrixWorld);\n    this.system.setNavMeshGeometry(navMeshGeometry);\n\n    this.hasLoadedNavMesh = true;\n  }\n});\n","module.exports = AFRAME.registerComponent('nav-agent', {\n  schema: {\n    destination: {type: 'vec3'},\n    active: {default: false},\n    speed: {default: 2}\n  },\n  init: function () {\n    this.system = this.el.sceneEl.systems.nav;\n    this.system.addAgent(this);\n    this.group = null;\n    this.path = [];\n    this.raycaster = new THREE.Raycaster();\n  },\n  remove: function () {\n    this.system.removeAgent(this);\n  },\n  update: function () {\n    this.path.length = 0;\n  },\n  updateNavLocation: function () {\n    this.group = null;\n    this.path = [];\n  },\n  tick: (function () {\n    const vDest = new THREE.Vector3();\n    const vDelta = new THREE.Vector3();\n    const vNext = new THREE.Vector3();\n\n    return function (t, dt) {\n      const el = this.el;\n      const data = this.data;\n      const raycaster = this.raycaster;\n      const speed = data.speed * dt / 1000;\n\n      if (!data.active) return;\n\n      // Use PatrolJS pathfinding system to get shortest path to target.\n      if (!this.path.length) {\n        const position = this.el.object3D.position;\n        this.group = this.group || this.system.getGroup(position);\n        this.path = this.system.getPath(position, vDest.copy(data.destination), this.group) || [];\n        el.emit('navigation-start');\n      }\n\n      // If no path is found, exit.\n      if (!this.path.length) {\n        console.warn('[nav] Unable to find path to %o.', data.destination);\n        this.el.setAttribute('nav-agent', {active: false});\n        el.emit('navigation-end');\n        return;\n      }\n\n      // Current segment is a vector from current position to next waypoint.\n      const vCurrent = el.object3D.position;\n      const vWaypoint = this.path[0];\n      vDelta.subVectors(vWaypoint, vCurrent);\n\n      const distance = vDelta.length();\n      let gazeTarget;\n\n      if (distance < speed) {\n        // If <1 step from current waypoint, discard it and move toward next.\n        this.path.shift();\n\n        // After discarding the last waypoint, exit pathfinding.\n        if (!this.path.length) {\n          this.el.setAttribute('nav-agent', {active: false});\n          el.emit('navigation-end');\n          return;\n        }\n\n        vNext.copy(vCurrent);\n        gazeTarget = this.path[0];\n      } else {\n        // If still far away from next waypoint, find next position for\n        // the current frame.\n        vNext.copy(vDelta.setLength(speed)).add(vCurrent);\n        gazeTarget = vWaypoint;\n      }\n\n      // Look at the next waypoint.\n      gazeTarget.y = vCurrent.y;\n      el.object3D.lookAt(gazeTarget);\n\n      // Raycast against the nav mesh, to keep the agent moving along the\n      // ground, not traveling in a straight line from higher to lower waypoints.\n      raycaster.ray.origin.copy(vNext);\n      raycaster.ray.origin.y += 1.5;\n      raycaster.ray.direction.y = -1;\n      const intersections = raycaster.intersectObject(this.system.getNavMesh());\n\n      if (!intersections.length) {\n        // Raycasting failed. Step toward the waypoint and hope for the best.\n        vCurrent.copy(vNext);\n      } else {\n        // Re-project next position onto nav mesh.\n        vDelta.subVectors(intersections[0].point, vCurrent);\n        vCurrent.add(vDelta.setLength(speed));\n      }\n\n    };\n  }())\n});\n","const { Pathfinding } = require('three-pathfinding');\n\nconst pathfinder = new Pathfinding();\nconst ZONE = 'level';\n\n/**\n * nav\n *\n * Pathfinding system, using PatrolJS.\n */\nmodule.exports = AFRAME.registerSystem('nav', {\n  init: function () {\n    this.navMesh = null;\n    this.agents = new Set();\n  },\n\n  /**\n   * @param {THREE.Geometry} geometry\n   */\n  setNavMeshGeometry: function (geometry) {\n    this.navMesh = new THREE.Mesh(geometry);\n    pathfinder.setZoneData(ZONE, Pathfinding.createZone(geometry));\n    Array.from(this.agents).forEach((agent) => agent.updateNavLocation());\n  },\n\n  /**\n   * @return {THREE.Mesh}\n   */\n  getNavMesh: function () {\n    return this.navMesh;\n  },\n\n  /**\n   * @param {NavAgent} ctrl\n   */\n  addAgent: function (ctrl) {\n    this.agents.add(ctrl);\n  },\n\n  /**\n   * @param {NavAgent} ctrl\n   */\n  removeAgent: function (ctrl) {\n    this.agents.delete(ctrl);\n  },\n\n  /**\n   * @param  {THREE.Vector3} start\n   * @param  {THREE.Vector3} end\n   * @param  {number} groupID\n   * @return {Array<THREE.Vector3>}\n   */\n  getPath: function (start, end, groupID) {\n    return this.navMesh\n      ? pathfinder.findPath(start, end, ZONE, groupID)\n      : null;\n  },\n\n  /**\n   * @param {THREE.Vector3} position\n   * @return {number}\n   */\n  getGroup: function (position) {\n    return this.navMesh\n      ? pathfinder.getGroup(ZONE, position)\n      : null;\n  },\n\n  /**\n   * @param  {THREE.Vector3} position\n   * @param  {number} groupID\n   * @return {Node}\n   */\n  getNode: function (position, groupID) {\n    return this.navMesh\n      ? pathfinder.getClosestNode(position, ZONE, groupID, true)\n      : null;\n  },\n\n  /**\n   * @param  {THREE.Vector3} start Starting position.\n   * @param  {THREE.Vector3} end Desired ending position.\n   * @param  {number} groupID\n   * @param  {Node} node\n   * @param  {THREE.Vector3} endTarget (Output) Adjusted step end position.\n   * @return {Node} Current node, after step is taken.\n   */\n  clampStep: function (start, end, groupID, node, endTarget) {\n    if (!this.navMesh) {\n      endTarget.copy(end);\n      return null;\n    } else if (!node) {\n      endTarget.copy(end);\n      return this.getNode(end, groupID);\n    }\n    return pathfinder.clampStep(start, end, node, ZONE, groupID, endTarget);\n  }\n});\n","var e=function(){};e.computeCentroids=function(e){var t,n,r;for(t=0,n=e.faces.length;t<n;t++)(r=e.faces[t]).centroid=new THREE.Vector3(0,0,0),r.centroid.add(e.vertices[r.a]),r.centroid.add(e.vertices[r.b]),r.centroid.add(e.vertices[r.c]),r.centroid.divideScalar(3)},e.roundNumber=function(e,t){return Number(e.toFixed(t))},e.sample=function(e){return e[Math.floor(Math.random()*e.length)]},e.mergeVertexIds=function(e,t){var n=[];if(e.forEach(function(e){t.indexOf(e)>=0&&n.push(e)}),n.length<2)return[];n.includes(e[0])&&n.includes(e[e.length-1])&&e.push(e.shift()),n.includes(t[0])&&n.includes(t[t.length-1])&&t.push(t.shift()),n=[],e.forEach(function(e){t.includes(e)&&n.push(e)});for(var r=n[1],o=n[0],i=e.slice();i[0]!==r;)i.push(i.shift());for(var s=0,u=t.slice();u[0]!==o;)if(u.push(u.shift()),s++>10)throw new Error(\"Unexpected state\");return u.shift(),u.pop(),i=i.concat(u)},e.setPolygonCentroid=function(e,t){var n=new THREE.Vector3,r=t.vertices;e.vertexIds.forEach(function(e){n.add(r[e])}),n.divideScalar(e.vertexIds.length),e.centroid.copy(n)},e.cleanPolygon=function(e,t){for(var n=[],r=t.vertices,o=0;o<e.vertexIds.length;o++){var i,s,u,c=r[e.vertexIds[o]];0===o?(i=e.vertexIds[1],s=e.vertexIds[e.vertexIds.length-1]):o===e.vertexIds.length-1?(i=e.vertexIds[0],s=e.vertexIds[e.vertexIds.length-2]):(i=e.vertexIds[o+1],s=e.vertexIds[o-1]),u=r[s];var h=r[i].clone().sub(c),a=u.clone().sub(c),d=h.angleTo(a);if(d>Math.PI-.01&&d<Math.PI+.01){var f=[];e.neighbours.forEach(function(t){t.vertexIds.includes(e.vertexIds[o])||f.push(t)}),e.neighbours=f}else n.push(e.vertexIds[o])}e.vertexIds=n,this.setPolygonCentroid(e,t)},e.isConvex=function(e,t){var n=t.vertices;if(e.vertexIds.length<3)return!1;for(var r=!0,o=[],i=0;i<e.vertexIds.length;i++){var s,u,c=n[e.vertexIds[i]];0===i?(s=n[e.vertexIds[1]],u=n[e.vertexIds[e.vertexIds.length-1]]):i===e.vertexIds.length-1?(s=n[e.vertexIds[0]],u=n[e.vertexIds[e.vertexIds.length-2]]):(s=n[e.vertexIds[i+1]],u=n[e.vertexIds[i-1]]);var h=s.clone().sub(c),a=u.clone().sub(c),d=h.angleTo(a);if(d===Math.PI||0===d)return!1;var f=h.cross(a).y;o.push(f)}return o.forEach(function(e){0===e&&(r=!1)}),o.forEach(o[0]>0?function(e){e<0&&(r=!1)}:function(e){e>0&&(r=!1)}),r},e.distanceToSquared=function(e,t){var n=e.x-t.x,r=e.y-t.y,o=e.z-t.z;return n*n+r*r+o*o},e.isPointInPoly=function(e,t){for(var n=!1,r=-1,o=e.length,i=o-1;++r<o;i=r)(e[r].z<=t.z&&t.z<e[i].z||e[i].z<=t.z&&t.z<e[r].z)&&t.x<(e[i].x-e[r].x)*(t.z-e[r].z)/(e[i].z-e[r].z)+e[r].x&&(n=!n);return n},e.isVectorInPolygon=function(e,t,n){var r=1e5,o=-1e5,i=[];return t.vertexIds.forEach(function(e){r=Math.min(n[e].y,r),o=Math.max(n[e].y,o),i.push(n[e])}),!!(e.y<o+.5&&e.y>r-.5&&this.isPointInPoly(i,e))},e.triarea2=function(e,t,n){return(n.x-e.x)*(t.z-e.z)-(t.x-e.x)*(n.z-e.z)},e.vequal=function(e,t){return this.distanceToSquared(e,t)<1e-5};var t=function(e){this.content=[],this.scoreFunction=e};t.prototype.push=function(e){this.content.push(e),this.sinkDown(this.content.length-1)},t.prototype.pop=function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e},t.prototype.remove=function(e){var t=this.content.indexOf(e),n=this.content.pop();t!==this.content.length-1&&(this.content[t]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))},t.prototype.size=function(){return this.content.length},t.prototype.rescoreElement=function(e){this.sinkDown(this.content.indexOf(e))},t.prototype.sinkDown=function(e){for(var t=this.content[e];e>0;){var n=(e+1>>1)-1,r=this.content[n];if(!(this.scoreFunction(t)<this.scoreFunction(r)))break;this.content[n]=t,this.content[e]=r,e=n}},t.prototype.bubbleUp=function(e){for(var t=this.content.length,n=this.content[e],r=this.scoreFunction(n);;){var o=e+1<<1,i=o-1,s=null,u=void 0;if(i<t)(u=this.scoreFunction(this.content[i]))<r&&(s=i);if(o<t)this.scoreFunction(this.content[o])<(null===s?r:u)&&(s=o);if(null===s)break;this.content[e]=this.content[s],this.content[s]=n,e=s}};var n=function(){};n.init=function(e){for(var t=0;t<e.length;t++){var n=e[t];n.f=0,n.g=0,n.h=0,n.cost=1,n.visited=!1,n.closed=!1,n.parent=null}},n.cleanUp=function(e){for(var t=0;t<e.length;t++){var n=e[t];delete n.f,delete n.g,delete n.h,delete n.cost,delete n.visited,delete n.closed,delete n.parent}},n.heap=function(){return new t(function(e){return e.f})},n.search=function(e,t,n){this.init(e);var r=this.heap();for(r.push(t);r.size()>0;){var o=r.pop();if(o===n){for(var i=o,s=[];i.parent;)s.push(i),i=i.parent;return this.cleanUp(s),s.reverse()}o.closed=!0;for(var u=this.neighbours(e,o),c=0,h=u.length;c<h;c++){var a=u[c];if(!a.closed){var d=o.g+a.cost,f=a.visited;if(!f||d<a.g){if(a.visited=!0,a.parent=o,!a.centroid||!n.centroid)throw new Error(\"Unexpected state\");a.h=a.h||this.heuristic(a.centroid,n.centroid),a.g=d,a.f=a.g+a.h,f?r.rescoreElement(a):r.push(a)}}}}return[]},n.heuristic=function(t,n){return e.distanceToSquared(t,n)},n.neighbours=function(e,t){for(var n=[],r=0;r<t.neighbours.length;r++)n.push(e[t.neighbours[r]]);return n};var r=1,o=function(){};o.buildZone=function(t){var n=this,r=this._buildNavigationMesh(t),o={};r.vertices.forEach(function(t){t.x=e.roundNumber(t.x,2),t.y=e.roundNumber(t.y,2),t.z=e.roundNumber(t.z,2)}),o.vertices=r.vertices;var i=this._buildPolygonGroups(r);o.groups=[];var s=function(e,t){for(var n=0;n<e.length;n++)if(t===e[n])return n};return i.forEach(function(t){var r=[];t.forEach(function(o){var i=o.neighbours.map(function(e){return s(t,e)}),u=o.neighbours.map(function(e){return n._getSharedVerticesInOrder(o,e)});o.centroid.x=e.roundNumber(o.centroid.x,2),o.centroid.y=e.roundNumber(o.centroid.y,2),o.centroid.z=e.roundNumber(o.centroid.z,2),r.push({id:s(t,o),neighbours:i,vertexIds:o.vertexIds,centroid:o.centroid,portals:u})}),o.groups.push(r)}),o},o._buildNavigationMesh=function(t){return e.computeCentroids(t),t.mergeVertices(),this._buildPolygonsFromGeometry(t)},o._buildPolygonGroups=function(e){var t=[],n=0,r=function(e){e.neighbours.forEach(function(t){void 0===t.group&&(t.group=e.group,r(t))})};return e.polygons.forEach(function(e){void 0===e.group&&(e.group=n++,r(e)),t[e.group]||(t[e.group]=[]),t[e.group].push(e)}),t},o._buildPolygonNeighbours=function(e,t,n){var r=new Set,o=n.get(e.vertexIds[0]),i=n.get(e.vertexIds[1]),s=n.get(e.vertexIds[2]);o.forEach(function(e){(i.has(e)||s.has(e))&&r.add(t.polygons[e])}),i.forEach(function(e){s.has(e)&&r.add(t.polygons[e])}),e.neighbours=Array.from(r)},o._buildPolygonsFromGeometry=function(e){for(var t=this,n=[],o=e.vertices,i=e.faceVertexUvs,s=new Map,u=0;u<o.length;u++)s.set(u,new Set);e.faces.forEach(function(e){n.push({id:r++,vertexIds:[e.a,e.b,e.c],centroid:e.centroid,normal:e.normal,neighbours:[]}),s.get(e.a).add(n.length-1),s.get(e.b).add(n.length-1),s.get(e.c).add(n.length-1)});var c={polygons:n,vertices:o,faceVertexUvs:i};return n.forEach(function(e){t._buildPolygonNeighbours(e,c,s)}),c},o._getSharedVerticesInOrder=function(e,t){var n=e.vertexIds,r=t.vertexIds,o=new Set;if(n.forEach(function(e){r.includes(e)&&o.add(e)}),o.size<2)return[];o.has(n[0])&&o.has(n[n.length-1])&&n.push(n.shift()),o.has(r[0])&&o.has(r[r.length-1])&&r.push(r.shift());var i=[];return n.forEach(function(e){r.includes(e)&&i.push(e)}),i};var i=function(){this.portals=[]};i.prototype.push=function(e,t){void 0===t&&(t=e),this.portals.push({left:e,right:t})},i.prototype.stringPull=function(){var t,n,r,o=this.portals,i=[],s=0,u=0,c=0;n=o[0].left,r=o[0].right,i.push(t=o[0].left);for(var h=1;h<o.length;h++){var a=o[h].left,d=o[h].right;if(e.triarea2(t,r,d)<=0){if(!(e.vequal(t,r)||e.triarea2(t,n,d)>0)){i.push(n),n=t=n,r=t,u=s=u,c=s,h=s;continue}r=d,c=h}if(e.triarea2(t,n,a)>=0){if(!(e.vequal(t,n)||e.triarea2(t,r,a)<0)){i.push(r),n=t=r,r=t,u=s=c,c=s,h=s;continue}n=a,u=h}}return 0!==i.length&&e.vequal(i[i.length-1],o[o.length-1].left)||i.push(o[o.length-1].left),this.path=i,i};var s,u,c,h,a,d,f=function(){this.zones={}};f.createZone=function(e){return o.buildZone(e)},f.prototype.setZoneData=function(e,t){this.zones[e]=t},f.prototype.getGroup=function(t,n){if(!this.zones[t])return null;var r=null,o=Math.pow(50,2);return this.zones[t].groups.forEach(function(t,i){t.forEach(function(t){var s=e.distanceToSquared(t.centroid,n);s<o&&(r=i,o=s)})}),r},f.prototype.getRandomNode=function(t,n,r,o){if(!this.zones[t])return new THREE.Vector3;r=r||null,o=o||0;var i=[];return this.zones[t].groups[n].forEach(function(t){r&&o?e.distanceToSquared(r,t.centroid)<o*o&&i.push(t.centroid):i.push(t.centroid)}),e.sample(i)||new THREE.Vector3},f.prototype.getClosestNode=function(t,n,r,o){void 0===o&&(o=!1);var i=this.zones[n].vertices,s=null,u=Infinity;return this.zones[n].groups[r].forEach(function(n){var r=e.distanceToSquared(n.centroid,t);r<u&&(!o||e.isVectorInPolygon(t,n,i))&&(s=n,u=r)}),s},f.prototype.findPath=function(e,t,r,o){var s=this.zones[r].groups[o],u=this.zones[r].vertices,c=this.getClosestNode(e,r,o),h=this.getClosestNode(t,r,o,!0);if(!c||!h)return null;var a=n.search(s,c,h),d=function(e,t){for(var n=0;n<e.neighbours.length;n++)if(e.neighbours[n]===t.id)return e.portals[n]},f=new i;f.push(e);for(var l=0;l<a.length;l++){var v=a[l+1];if(v){var p=d(a[l],v);f.push(u[p[0]],u[p[1]])}}f.push(t),f.stringPull();var g=f.path.map(function(e){return new THREE.Vector3(e.x,e.y,e.z)});return g.shift(),g},f.prototype.clampStep=(c=new THREE.Vector3,h=new THREE.Plane,a=new THREE.Triangle,d=new THREE.Vector3,function(e,t,n,r,o,i){var f=this.zones[r].vertices,l=this.zones[r].groups[o],v=[n],p={};p[n.id]=0,s=void 0,d.set(0,0,0),u=Infinity,h.setFromCoplanarPoints(f[n.vertexIds[0]],f[n.vertexIds[1]],f[n.vertexIds[2]]),h.projectPoint(t,c),t.copy(c);for(var g=v.pop();g;g=v.pop()){a.set(f[g.vertexIds[0]],f[g.vertexIds[1]],f[g.vertexIds[2]]),a.closestPointToPoint(t,c),c.distanceToSquared(t)<u&&(s=g,d.copy(c),u=c.distanceToSquared(t));var x=p[g];if(!(x>2))for(var I=0;I<g.neighbours.length;I++){var b=l[g.neighbours[I]];b.id in p||(v.push(b),p[b.id]=x+1)}}return i.copy(d),s});export{f as Pathfinding};\n//# sourceMappingURL=three-pathfinding.module.js.map\n","require('./a-grid');\nrequire('./a-hexgrid');\nrequire('./a-ocean');\nrequire('./a-tube');\n","/**\n * Flat grid.\n *\n * Defaults to 75x75.\n */\nmodule.exports = AFRAME.registerPrimitive('a-grid', {\n  defaultComponents: {\n    geometry: {\n      primitive: 'plane',\n      width: 75,\n      height: 75\n    },\n    rotation: {x: -90, y: 0, z: 0},\n    material: {\n      src: 'url(https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v1.16.3/assets/grid.png)',\n      repeat: '75 75'\n    }\n  },\n  mappings: {\n    width: 'geometry.width',\n    height: 'geometry.height',\n    src: 'material.src'\n  }\n});\n","const vg = require('../../lib/hex-grid.min.js');\nconst defaultHexGrid = require('../../lib/default-hex-grid');\n\n/**\n * Hex grid.\n */\nmodule.exports.Primitive = AFRAME.registerPrimitive('a-hexgrid', {\n  defaultComponents: {\n    'hexgrid': {}\n  },\n  mappings: {\n    src: 'hexgrid.src'\n  }\n});\n\nmodule.exports.Component = AFRAME.registerComponent('hexgrid', {\n  dependencies: ['material'],\n  schema: {\n    src: {type: 'asset'}\n  },\n  init: function () {\n    const data = this.data;\n    if (data.src) {\n      fetch(data.src)\n        .then((response) => response.json())\n        .then((json) => this.addMesh(json));\n    } else {\n      this.addMesh(defaultHexGrid);\n    }\n  },\n  addMesh: function (json) {\n    const grid = new vg.HexGrid();\n    grid.fromJSON(json);\n    const board = new vg.Board(grid);\n    board.generateTilemap();\n    this.el.setObject3D('mesh', board.group);\n    this.addMaterial();\n  },\n  addMaterial: function () {\n    const materialComponent = this.el.components.material;\n    const material = (materialComponent || {}).material;\n    if (!material) return;\n    this.el.object3D.traverse((node) => {\n      if (node.isMesh) {\n        node.material = material;\n      }\n    });\n  },\n  remove: function () {\n    this.el.removeObject3D('mesh');\n  }\n});\n","var vg=module.exports={VERSION:\"0.1.1\",PI:Math.PI,TAU:2*Math.PI,DEG_TO_RAD:.0174532925,RAD_TO_DEG:57.2957795,SQRT3:Math.sqrt(3),TILE:\"tile\",ENT:\"entity\",STR:\"structure\",HEX:\"hex\",SQR:\"square\",ABS:\"abstract\"};vg.Board=function(e,t){if(!e)throw new Error(\"You must pass in a grid system for the board to use.\");this.tiles=[],this.tileGroup=null,this.group=new THREE.Object3D,this.grid=null,this.overlay=null,this.finder=new vg.AStarFinder(t),vg.Loader.init(),this.setGrid(e)},vg.Board.prototype={setEntityOnTile:function(e,t){var i=this.grid.cellToPixel(t.cell);e.position.copy(i),e.position.y+=e.heightOffset||0,e.tile&&(e.tile.entity=null),e.tile=t,t.entity=e},addTile:function(e){var t=this.tiles.indexOf(e);-1===t&&(this.tiles.push(e),this.snapTileToGrid(e),e.position.y=0,this.tileGroup.add(e.mesh),this.grid.add(e.cell),e.cell.tile=e)},removeTile:function(e){if(e){var t=this.tiles.indexOf(e);this.grid.remove(e.cell),-1!==t&&this.tiles.splice(t,1),e.dispose()}},removeAllTiles:function(){if(this.tileGroup)for(var e=this.tileGroup.children,t=0;t<e.length;t++)this.tileGroup.remove(e[t])},getTileAtCell:function(e){var t=this.grid.cellToHash(e);return e.tile||(\"undefined\"!=typeof this.grid.cells[t]?this.grid.cells[t].tile:null)},snapToGrid:function(e){var t=this.grid.pixelToCell(e);e.copy(this.grid.cellToPixel(t))},snapTileToGrid:function(e){if(e.cell)e.position.copy(this.grid.cellToPixel(e.cell));else{var t=this.grid.pixelToCell(e.position);e.position.copy(this.grid.cellToPixel(t))}return e},getRandomTile:function(){var e=vg.Tools.randomInt(0,this.tiles.length-1);return this.tiles[e]},findPath:function(e,t,i){return this.finder.findPath(e.cell,t.cell,i,this.grid)},setGrid:function(e){this.group.remove(this.tileGroup),this.grid&&e!==this.grid&&(this.removeAllTiles(),this.tiles.forEach(function(e){this.grid.remove(e.cell),e.dispose()}),this.grid.dispose()),this.grid=e,this.tiles=[],this.tileGroup=new THREE.Object3D,this.group.add(this.tileGroup)},generateOverlay:function(e){var t=new THREE.LineBasicMaterial({color:0,opacity:.3});this.overlay&&this.group.remove(this.overlay),this.overlay=new THREE.Object3D,this.grid.generateOverlay(e,this.overlay,t),this.group.add(this.overlay)},generateTilemap:function(e){this.reset();var t=this.grid.generateTiles(e);this.tiles=t,this.tileGroup=new THREE.Object3D;for(var i=0;i<t.length;i++)this.tileGroup.add(t[i].mesh);this.group.add(this.tileGroup)},reset:function(){this.removeAllTiles(),this.tileGroup&&this.group.remove(this.tileGroup)}},vg.Board.prototype.constructor=vg.Board,vg.Cell=function(e,t,i,s){this.q=e||0,this.r=t||0,this.s=i||0,this.h=s||1,this.tile=null,this.userData={},this.walkable=!0,this._calcCost=0,this._priority=0,this._visited=!1,this._parent=null,this.uniqueID=vg.LinkedList.generateID()},vg.Cell.prototype={set:function(e,t,i){return this.q=e,this.r=t,this.s=i,this},copy:function(e){return this.q=e.q,this.r=e.r,this.s=e.s,this.h=e.h,this.tile=e.tile||null,this.userData=e.userData||{},this.walkable=e.walkable,this},add:function(e){return this.q+=e.q,this.r+=e.r,this.s+=e.s,this},equals:function(e){return this.q===e.q&&this.r===e.r&&this.s===e.s}},vg.Cell.prototype.constructor=vg.Cell,vg.HexGrid=function(e){e=e||{},this.type=vg.HEX,this.size=5,this.cellSize=\"undefined\"==typeof e.cellSize?10:e.cellSize,this.cells={},this.numCells=0,this.extrudeSettings=null,this.autogenerated=!1;var t,i=[];for(t=0;6>t;t++)i.push(this._createVertex(t));for(this.cellShape=new THREE.Shape,this.cellShape.moveTo(i[0].x,i[0].y),t=1;6>t;t++)this.cellShape.lineTo(i[t].x,i[t].y);this.cellShape.lineTo(i[0].x,i[0].y),this.cellShape.autoClose=!0,this.cellGeo=new THREE.Geometry,this.cellGeo.vertices=i,this.cellGeo.verticesNeedUpdate=!0,this.cellShapeGeo=new THREE.ShapeGeometry(this.cellShape),this._cellWidth=2*this.cellSize,this._cellLength=.5*vg.SQRT3*this._cellWidth,this._hashDelimeter=\".\",this._directions=[new vg.Cell(1,-1,0),new vg.Cell(1,0,-1),new vg.Cell(0,1,-1),new vg.Cell(-1,1,0),new vg.Cell(-1,0,1),new vg.Cell(0,-1,1)],this._diagonals=[new vg.Cell(2,-1,-1),new vg.Cell(1,1,-2),new vg.Cell(-1,2,-1),new vg.Cell(-2,1,1),new vg.Cell(-1,-1,2),new vg.Cell(1,-2,1)],this._list=[],this._vec3=new THREE.Vector3,this._cel=new vg.Cell,this._conversionVec=new THREE.Vector3,this._geoCache=[],this._matCache=[]},vg.HexGrid.TWO_THIRDS=2/3,vg.HexGrid.prototype={cellToPixel:function(e){return this._vec3.x=e.q*this._cellWidth*.75,this._vec3.y=e.h,this._vec3.z=-((e.s-e.r)*this._cellLength*.5),this._vec3},pixelToCell:function(e){var t=e.x*(vg.HexGrid.TWO_THIRDS/this.cellSize),i=(-e.x/3+vg.SQRT3/3*e.z)/this.cellSize;return this._cel.set(t,i,-t-i),this._cubeRound(this._cel)},getCellAt:function(e){var t=e.x*(vg.HexGrid.TWO_THIRDS/this.cellSize),i=(-e.x/3+vg.SQRT3/3*e.z)/this.cellSize;return this._cel.set(t,i,-t-i),this._cubeRound(this._cel),this.cells[this.cellToHash(this._cel)]},getNeighbors:function(e,t,i){var s,n,l=this._directions.length;for(this._list.length=0,s=0;l>s;s++)this._cel.copy(e),this._cel.add(this._directions[s]),n=this.cells[this.cellToHash(this._cel)],!n||i&&!i(e,n)||this._list.push(n);if(t)for(s=0;l>s;s++)this._cel.copy(e),this._cel.add(this._diagonals[s]),n=this.cells[this.cellToHash(this._cel)],!n||i&&!i(e,n)||this._list.push(n);return this._list},getRandomCell:function(){var e,t=0,i=vg.Tools.randomInt(0,this.numCells);for(e in this.cells){if(t===i)return this.cells[e];t++}return this.cells[e]},cellToHash:function(e){return e.q+this._hashDelimeter+e.r+this._hashDelimeter+e.s},distance:function(e,t){var i=Math.max(Math.abs(e.q-t.q),Math.abs(e.r-t.r),Math.abs(e.s-t.s));return i+=t.h-e.h},clearPath:function(){var e,t;for(e in this.cells)t=this.cells[e],t._calcCost=0,t._priority=0,t._parent=null,t._visited=!1},traverse:function(e){var t;for(t in this.cells)e(this.cells[t])},generateTile:function(e,t,i){var s=Math.abs(e.h);1>s&&(s=1);var n=this._geoCache[s];n||(this.extrudeSettings.amount=s,n=new THREE.ExtrudeGeometry(this.cellShape,this.extrudeSettings),this._geoCache[s]=n);var l=new vg.Tile({size:this.cellSize,scale:t,cell:e,geometry:n,material:i});return e.tile=l,l},generateTiles:function(e){e=e||{};var t=[],i={tileScale:.95,cellSize:this.cellSize,material:null,extrudeSettings:{amount:1,bevelEnabled:!0,bevelSegments:1,steps:1,bevelSize:.5,bevelThickness:.5}};i=vg.Tools.merge(i,e),this.cellSize=i.cellSize,this._cellWidth=2*this.cellSize,this._cellLength=.5*vg.SQRT3*this._cellWidth,this.autogenerated=!0,this.extrudeSettings=i.extrudeSettings;var s,n,l;for(s in this.cells)l=this.cells[s],n=this.generateTile(l,i.tileScale,i.material),n.position.copy(this.cellToPixel(l)),n.position.y=0,t.push(n);return t},generateTilePoly:function(e){e||(e=new THREE.MeshBasicMaterial({color:2405631}));var t=new THREE.Mesh(this.cellShapeGeo,e);return this._vec3.set(1,0,0),t.rotateOnAxis(this._vec3,vg.PI/2),t},generate:function(e){e=e||{},this.size=\"undefined\"==typeof e.size?this.size:e.size;var t,i,s,n;for(t=-this.size;t<this.size+1;t++)for(i=-this.size;i<this.size+1;i++)s=-t-i,Math.abs(t)<=this.size&&Math.abs(i)<=this.size&&Math.abs(s)<=this.size&&(n=new vg.Cell(t,i,s),this.add(n))},generateOverlay:function(e,t,i){var s,n,l,r=this.cellShape.createPointsGeometry();for(s=-e;e+1>s;s++)for(n=-e;e+1>n;n++)if(l=-s-n,Math.abs(s)<=e&&Math.abs(n)<=e&&Math.abs(l)<=e){this._cel.set(s,n,l);var h=new THREE.Line(r,i);h.position.copy(this.cellToPixel(this._cel)),h.rotation.x=90*vg.DEG_TO_RAD,t.add(h)}},add:function(e){var t=this.cellToHash(e);if(!this.cells[t])return this.cells[t]=e,this.numCells++,e},remove:function(e){var t=this.cellToHash(e);this.cells[t]&&(delete this.cells[t],this.numCells--)},dispose:function(){this.cells=null,this.numCells=0,this.cellShape=null,this.cellGeo.dispose(),this.cellGeo=null,this.cellShapeGeo.dispose(),this.cellShapeGeo=null,this._list=null,this._vec3=null,this._conversionVec=null,this._geoCache=null,this._matCache=null},load:function(e,t,i){var s=this;vg.Tools.getJSON({url:e,callback:function(e){s.fromJSON(e),t.call(i||null,e)},cache:!1,scope:s})},fromJSON:function(e){var t,i,s=e.cells;for(this.cells={},this.numCells=0,this.size=e.size,this.cellSize=e.cellSize,this._cellWidth=2*this.cellSize,this._cellLength=.5*vg.SQRT3*this._cellWidth,this.extrudeSettings=e.extrudeSettings,this.autogenerated=e.autogenerated,t=0;t<s.length;t++)i=new vg.Cell,i.copy(s[t]),this.add(i)},toJSON:function(){var e,t,i={size:this.size,cellSize:this.cellSize,extrudeSettings:this.extrudeSettings,autogenerated:this.autogenerated},s=[];for(t in this.cells)e=this.cells[t],s.push({q:e.q,r:e.r,s:e.s,h:e.h,walkable:e.walkable,userData:e.userData});return i.cells=s,i},_createVertex:function(e){var t=vg.TAU/6*e;return new THREE.Vector3(this.cellSize*Math.cos(t),this.cellSize*Math.sin(t),0)},_cubeRound:function(e){var t=Math.round(e.q),i=Math.round(e.r),s=Math.round(e.s),n=Math.abs(t-e.q),l=Math.abs(i-e.r),r=Math.abs(s-e.s);return n>l&&n>r?t=-i-s:l>r?i=-t-s:s=-t-i,this._cel.set(t,i,s)}},vg.HexGrid.prototype.constructor=vg.HexGrid,vg.SqrGrid=function(e){e=e||{},this.type=vg.SQR,this.size=5,this.cellSize=\"undefined\"==typeof e.cellSize?10:e.cellSize,this.cells={},this.numCells=0,this.extrudeSettings=null,this.autogenerated=!1;var t=[];t.push(new THREE.Vector3),t.push(new THREE.Vector3(-this.cellSize,this.cellSize)),t.push(new THREE.Vector3(this.cellSize,this.cellSize)),t.push(new THREE.Vector3(this.cellSize,-this.cellSize)),this.cellShape=new THREE.Shape,this.cellShape.moveTo(-this.cellSize,-this.cellSize),this.cellShape.lineTo(-this.cellSize,this.cellSize),this.cellShape.lineTo(this.cellSize,this.cellSize),this.cellShape.lineTo(this.cellSize,-this.cellSize),this.cellShape.lineTo(-this.cellSize,-this.cellSize),this.cellGeo=new THREE.Geometry,this.cellGeo.vertices=t,this.cellGeo.verticesNeedUpdate=!0,this.cellShapeGeo=new THREE.ShapeGeometry(this.cellShape),this._fullCellSize=2*this.cellSize,this._hashDelimeter=\".\",this._directions=[new vg.Cell(1,0,0),new vg.Cell(0,-1,0),new vg.Cell(-1,0,0),new vg.Cell(0,1,0)],this._diagonals=[new vg.Cell(-1,-1,0),new vg.Cell(-1,1,0),new vg.Cell(1,1,0),new vg.Cell(1,-1,0)],this._list=[],this._vec3=new THREE.Vector3,this._cel=new vg.Cell,this._conversionVec=new THREE.Vector3,this._geoCache=[],this._matCache=[]},vg.SqrGrid.prototype={cellToPixel:function(e){return this._vec3.x=e.q*this._fullCellSize,this._vec3.y=e.h,this._vec3.z=e.r*this._fullCellSize,this._vec3},pixelToCell:function(e){var t=Math.round(e.x/this._fullCellSize),i=Math.round(e.z/this._fullCellSize);return this._cel.set(t,i,0)},getCellAt:function(e){var t=Math.round(e.x/this._fullCellSize),i=Math.round(e.z/this._fullCellSize);return this._cel.set(t,i),this.cells[this.cellToHash(this._cel)]},getNeighbors:function(e,t,i){var s,n,l=this._directions.length;for(this._list.length=0,s=0;l>s;s++)this._cel.copy(e),this._cel.add(this._directions[s]),n=this.cells[this.cellToHash(this._cel)],!n||i&&!i(e,n)||this._list.push(n);if(t)for(s=0;l>s;s++)this._cel.copy(e),this._cel.add(this._diagonals[s]),n=this.cells[this.cellToHash(this._cel)],!n||i&&!i(e,n)||this._list.push(n);return this._list},getRandomCell:function(){var e,t=0,i=vg.Tools.randomInt(0,this.numCells);for(e in this.cells){if(t===i)return this.cells[e];t++}return this.cells[e]},cellToHash:function(e){return e.q+this._hashDelimeter+e.r},distance:function(e,t){var i=Math.max(Math.abs(e.q-t.q),Math.abs(e.r-t.r));return i+=t.h-e.h},clearPath:function(){var e,t;for(e in this.cells)t=this.cells[e],t._calcCost=0,t._priority=0,t._parent=null,t._visited=!1},traverse:function(e){var t;for(t in this.cells)e(this.cells[t])},generateTile:function(e,t,i){var s=Math.abs(e.h);1>s&&(s=1);var n=this._geoCache[s];n||(this.extrudeSettings.amount=s,n=new THREE.ExtrudeGeometry(this.cellShape,this.extrudeSettings),this._geoCache[s]=n);var l=new vg.Tile({size:this.cellSize,scale:t,cell:e,geometry:n,material:i});return e.tile=l,l},generateTiles:function(e){e=e||{};var t=[],i={tileScale:.95,cellSize:this.cellSize,material:null,extrudeSettings:{amount:1,bevelEnabled:!0,bevelSegments:1,steps:1,bevelSize:.5,bevelThickness:.5}};i=vg.Tools.merge(i,e),this.cellSize=i.cellSize,this._fullCellSize=2*this.cellSize,this.autogenerated=!0,this.extrudeSettings=i.extrudeSettings;var s,n,l;for(s in this.cells)l=this.cells[s],n=this.generateTile(l,i.tileScale,i.material),n.position.copy(this.cellToPixel(l)),n.position.y=0,t.push(n);return t},generateTilePoly:function(e){e||(e=new THREE.MeshBasicMaterial({color:2405631}));var t=new THREE.Mesh(this.cellShapeGeo,e);return this._vec3.set(1,0,0),t.rotateOnAxis(this._vec3,vg.PI/2),t},generate:function(e){e=e||{},this.size=\"undefined\"==typeof e.size?this.size:e.size;var t,i,s,n=Math.ceil(this.size/2);for(t=-n;n>t;t++)for(i=-n;n>i;i++)s=new vg.Cell(t,i+1),this.add(s)},generateOverlay:function(e,t,i){var s,n,l=Math.ceil(e/2);for(s=-l;l>s;s++)for(n=-l;l>n;n++){this._cel.set(s,n);var r=new THREE.Line(this.cellGeo,i);r.position.copy(this.cellToPixel(this._cel)),r.rotation.x=90*vg.DEG_TO_RAD,t.add(r)}},add:function(e){var t=this.cellToHash(e);if(!this.cells[t])return this.cells[t]=e,this.numCells++,e},remove:function(e){var t=this.cellToHash(e);this.cells[t]&&(delete this.cells[t],this.numCells--)},dispose:function(){this.cells=null,this.numCells=0,this.cellShape=null,this.cellGeo.dispose(),this.cellGeo=null,this.cellShapeGeo.dispose(),this.cellShapeGeo=null,this._list=null,this._vec3=null,this._conversionVec=null,this._geoCache=null,this._matCache=null},load:function(e,t,i){vg.Tools.getJSON({url:e,callback:function(e){this.fromJSON(e),t.call(i||null,e)},cache:!1,scope:this})},fromJSON:function(e){var t,i,s=e.cells;for(this.cells={},this.numCells=0,this.size=e.size,this.cellSize=e.cellSize,this._fullCellSize=2*this.cellSize,this.extrudeSettings=e.extrudeSettings,this.autogenerated=e.autogenerated,t=0;t<s.length;t++)i=new vg.Cell,i.copy(s[t]),this.add(i)},toJSON:function(){var e,t,i={size:this.size,cellSize:this.cellSize,extrudeSettings:this.extrudeSettings,autogenerated:this.autogenerated},s=[];for(t in this.cells)e=this.cells[t],s.push({q:e.q,r:e.r,s:e.s,h:e.h,walkable:e.walkable,userData:e.userData});return i.cells=s,i}},vg.SqrGrid.prototype.constructor=vg.SqrGrid,vg.Tile=function(e){e=e||{};var t={cell:null,geometry:null,material:null};if(t=vg.Tools.merge(t,e),!t.cell||!t.geometry)throw new Error(\"Missing vg.Tile configuration\");this.cell=t.cell,this.cell.tile&&this.cell.tile!==this&&this.cell.tile.dispose(),this.cell.tile=this,this.uniqueID=vg.Tools.generateID(),this.geometry=t.geometry,this.material=t.material,this.material||(this.material=new THREE.MeshPhongMaterial({color:vg.Tools.randomizeRGB(\"30, 30, 30\",13)})),this.objectType=vg.TILE,this.entity=null,this.userData={},this.selected=!1,this.highlight=\"0x0084cc\",this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.userData.structure=this,this.position=this.mesh.position,this.rotation=this.mesh.rotation,this.rotation.x=-90*vg.DEG_TO_RAD,this.mesh.scale.set(t.scale,t.scale,1),this.material.emissive?this._emissive=this.material.emissive.getHex():this._emissive=null},vg.Tile.prototype={select:function(){return this.material.emissive&&this.material.emissive.setHex(this.highlight),this.selected=!0,this},deselect:function(){return null!==this._emissive&&this.material.emissive&&this.material.emissive.setHex(this._emissive),this.selected=!1,this},toggle:function(){return this.selected?this.deselect():this.select(),this},dispose:function(){this.cell&&this.cell.tile&&(this.cell.tile=null),this.cell=null,this.position=null,this.rotation=null,this.mesh.parent&&this.mesh.parent.remove(this.mesh),this.mesh.userData.structure=null,this.mesh=null,this.material=null,this.userData=null,this.entity=null,this.geometry=null,this._emissive=null}},vg.Tile.prototype.constructor=vg.Tile,function(){var e=function(){this.obj=null,this.next=null,this.prev=null,this.free=!0},t=function(){this.first=null,this.last=null,this.length=0,this.objToNodeMap={},this.uniqueID=Date.now()+\"\"+Math.floor(1e3*Math.random()),this.sortArray=[]};t.generateID=function(){return Math.random().toString(36).slice(2)+Date.now()},t.prototype={getNode:function(e){return this.objToNodeMap[e.uniqueID]},addNode:function(i){var s=new e;if(!i.uniqueID)try{i.uniqueID=t.generateID()}catch(n){return console.error(\"[LinkedList.addNode] obj passed is immutable: cannot attach necessary identifier\"),null}return s.obj=i,s.free=!1,this.objToNodeMap[i.uniqueID]=s,s},swapObjects:function(e,t){this.objToNodeMap[e.obj.uniqueID]=null,this.objToNodeMap[t.uniqueID]=e,e.obj=t},add:function(e){var t=this.objToNodeMap[e.uniqueID];if(t){if(t.free===!1)return;t.obj=e,t.free=!1,t.next=null,t.prev=null}else t=this.addNode(e);if(this.first){if(!this.last)throw new Error(\"[LinkedList.add] No last in the list -- that shouldn't happen here\");this.last.next=t,t.prev=this.last,this.last=t,t.next=null}else this.first=t,this.last=t,t.next=null,t.prev=null;this.length++,this.showDebug&&this.dump(\"after add\")},has:function(e){return!!this.objToNodeMap[e.uniqueID]},moveUp:function(e){this.dump(\"before move up\");var t=this.getNode(e);if(!t)throw\"Oops, trying to move an object that isn't in the list\";if(t.prev){var i=t.prev,s=i.prev;t==this.last&&(this.last=i);var n=t.next;s&&(s.next=t),t.next=i,t.prev=i.prev,i.next=n,i.prev=t,this.first==i&&(this.first=t)}},moveDown:function(e){var t=this.getNode(e);if(!t)throw\"Oops, trying to move an object that isn't in the list\";if(t.next){var i=t.next;this.moveUp(i.obj),this.last==i&&(this.last=t)}},sort:function(e){var t,i,s=this.sortArray,n=this.first;for(s.length=0;n;)s.push(n.obj),n=n.next;for(this.clear(),s.sort(e),i=s.length,t=0;i>t;t++)this.add(s[t])},remove:function(e){var t=this.getNode(e);return!t||t.free?!1:(t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t.prev||(this.first=t.next),t.next||(this.last=t.prev),t.free=!0,t.prev=null,t.next=null,this.length--,!0)},shift:function(){var e=this.first;return 0===this.length?null:(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this.first=e.next,e.next||(this.last=null),e.free=!0,e.prev=null,e.next=null,this.length--,e.obj)},pop:function(){var e=this.last;return 0===this.length?null:(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this.last=e.prev,e.prev||(this.first=null),e.free=!0,e.prev=null,e.next=null,this.length--,e.obj)},concat:function(e){for(var t=e.first;t;)this.add(t.obj),t=t.next},clear:function(){for(var e=this.first;e;)e.free=!0,e=e.next;this.first=null,this.length=0},dispose:function(){for(var e=this.first;e;)e.obj=null,e=e.next;this.first=null,this.objToNodeMap=null},dump:function(e){console.log(\"====================\"+e+\"=====================\");for(var t=this.first;t;)console.log(\"{\"+t.obj.toString()+\"} previous=\"+(t.prev?t.prev.obj:\"NULL\")),t=t.next();console.log(\"===================================\"),console.log(\"Last: {\"+(this.last?this.last.obj:\"NULL\")+\"} First: {\"+(this.first?this.first.obj:\"NULL\")+\"}\")}},t.prototype.constructor=t,vg.LinkedList=t}(),function(){var e=function(e,t,i,s,n){this._listener=t,this.isOnce=i,this.context=s,this.signal=e,this._priority=n||0};e.prototype={active:!0,params:null,execute:function(e){var t,i;return this.active&&this._listener&&(i=this.params?this.params.concat(e):e,t=this._listener.apply(this.context,i),this.isOnce&&this.detach()),t},detach:function(){return this.isBound()?this.signal.remove(this._listener,this.context):null},isBound:function(){return!!this.signal&&!!this._listener},_destroy:function(){delete this.signal,delete this._listener,delete this.context},toString:function(){return\"[SignalBinding isOnce:\"+this.isOnce+\", isBound:\"+this.isBound()+\", active:\"+this.active+\"]\"}},e.prototype.constructor=e;var t=function(){this._bindings=[],this._prevParams=null;var e=this;this.dispatch=function(){t.prototype.dispatch.apply(e,arguments)}};t.prototype={memorize:!1,_shouldPropagate:!0,active:!0,validateListener:function(e,t){if(\"function\"!=typeof e)throw new Error(\"Signal: listener is a required param of {fn}() and should be a Function.\".replace(\"{fn}\",t))},_registerListener:function(t,i,s,n){var l,r=this._indexOfListener(t,s);if(-1!==r){if(l=this._bindings[r],l.isOnce!==i)throw new Error(\"You cannot add\"+(i?\"\":\"Once\")+\"() then add\"+(i?\"Once\":\"\")+\"() the same listener without removing the relationship first.\")}else l=new e(this,t,i,s,n),this._addBinding(l);return this.memorize&&this._prevParams&&l.execute(this._prevParams),l},_addBinding:function(e){var t=this._bindings.length;do t--;while(this._bindings[t]&&e._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e,t){for(var i,s=this._bindings.length;s--;)if(i=this._bindings[s],i._listener===e&&i.context===t)return s;return-1},has:function(e,t){return-1!==this._indexOfListener(e,t)},add:function(e,t,i){return this.validateListener(e,\"add\"),this._registerListener(e,!1,t,i)},addOnce:function(e,t,i){return this.validateListener(e,\"addOnce\"),this._registerListener(e,!0,t,i)},remove:function(e,t){this.validateListener(e,\"remove\");var i=this._indexOfListener(e,t);return-1!==i&&(this._bindings[i]._destroy(),this._bindings.splice(i,1)),e},removeAll:function(e){\"undefined\"==typeof e&&(e=null);for(var t=this._bindings.length;t--;)e?this._bindings[t].context===e&&(this._bindings[t]._destroy(),this._bindings.splice(t,1)):this._bindings[t]._destroy();e||(this._bindings.length=0)},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var e,t=Array.prototype.slice.call(arguments),i=this._bindings.length;if(this.memorize&&(this._prevParams=t),i){e=this._bindings.slice(),this._shouldPropagate=!0;do i--;while(e[i]&&this._shouldPropagate&&e[i].execute(t)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return\"[Signal active:\"+this.active+\" numListeners:\"+this.getNumListeners()+\"]\"}},t.prototype.constructor=t,vg.Signal=t}(),vg.AStarFinder=function(e){e=e||{};var t={allowDiagonal:!1,heuristicFilter:null};t=vg.Tools.merge(t,e),this.allowDiagonal=t.allowDiagonal,this.heuristicFilter=t.heuristicFilter,this.list=new vg.LinkedList},vg.AStarFinder.prototype={findPath:function(e,t,i,s){var n,l,r,h,o,a;for(i=i||this.heuristicFilter,s.clearPath(),this.list.clear(),this.list.add(e);this.list.length>0;){if(this.list.sort(this.compare),n=this.list.shift(),n._visited=!0,n===t)return vg.PathUtil.backtrace(t);for(r=s.getNeighbors(n,this.allowDiagonal,i),o=0,a=r.length;a>o;o++)if(h=r[o],h.walkable&&(l=n._calcCost+s.distance(n,h),!h._visited||l<h._calcCost)){if(h._visited=!0,h._parent=n,h._calcCost=l,h._priority=l+s.distance(t,h),h===t)return vg.PathUtil.backtrace(t);this.list.add(h)}}return null},compare:function(e,t){return e._priority-t._priority}},vg.AStarFinder.prototype.constructor=vg.AStarFinder,vg.PathUtil={backtrace:function(e){for(var t=[e];e._parent;)e=e._parent,t.push(e);return t.reverse()},biBacktrace:function(e,t){var i=this.backtrace(e),s=this.backtrace(t);return i.concat(s.reverse())},pathLength:function(e){var t,i,s,n,l,r=0;for(t=1;t<e.length;++t)i=e[t-1],s=e[t],n=i[0]-s[0],l=i[1]-s[1],r+=Math.sqrt(n*n+l*l);return r},interpolate:function(e,t,i,s){var n,l,r,h,o,a,c=Math.abs,u=[];for(r=c(i-e),h=c(s-t),n=i>e?1:-1,l=s>t?1:-1,o=r-h;e!==i||t!==s;)u.push([e,t]),a=2*o,a>-h&&(o-=h,e+=n),r>a&&(o+=r,t+=l);return u},expandPath:function(e){var t,i,s,n,l,r,h=[],o=e.length;if(2>o)return h;for(l=0;o-1>l;++l)for(t=e[l],i=e[l+1],s=this.interpolate(t[0],t[1],i[0],i[1]),n=s.length,r=0;n-1>r;++r)h.push(s[r]);return h.push(e[o-1]),h},smoothenPath:function(e,t){var i,s,n,l,r,h,o,a,c,u,d,g,p=t.length,v=t[0][0],f=t[0][1],m=t[p-1][0],_=t[p-1][1];for(i=v,s=f,r=[[i,s]],o=2;p>o;++o){for(c=t[o],n=c[0],l=c[1],u=this.interpolate(i,s,n,l),g=!1,a=1;a<u.length;++a)if(d=u[a],!e.isWalkableAt(d[0],d[1])){g=!0;break}g&&(h=t[o-1],r.push(h),i=h[0],s=h[1])}return r.push([m,_]),r},compressPath:function(e){if(e.length<3)return e;var t,i,s,n,l,r,h=[],o=e[0][0],a=e[0][1],c=e[1][0],u=e[1][1],d=c-o,g=u-a;for(l=Math.sqrt(d*d+g*g),d/=l,g/=l,h.push([o,a]),r=2;r<e.length;r++)t=c,i=u,s=d,n=g,c=e[r][0],u=e[r][1],d=c-t,g=u-i,l=Math.sqrt(d*d+g*g),d/=l,g/=l,(d!==s||g!==n)&&h.push([t,i]);return h.push([c,u]),h}},vg.Loader={manager:null,imageLoader:null,crossOrigin:!1,init:function(e){this.crossOrigin=e||!1,this.manager=new THREE.LoadingManager(function(){},function(){},function(){console.warn(\"Error loading images\")}),this.imageLoader=new THREE.ImageLoader(this.manager),this.imageLoader.crossOrigin=e},loadTexture:function(e,t,i,s){var n=new THREE.Texture(null,t);return this.imageLoader.load(e,function(e){n.image=e,n.needsUpdate=!0,i&&i(n)},null,function(e){s&&s(e)}),n.sourceFile=e,n}},vg.MouseCaster=function(e,t,i){this.down=!1,this.rightDown=!1,this.pickedObject=null,this.selectedObject=null,this.allHits=null,this.active=!0,this.shift=!1,this.ctrl=!1,this.wheel=0,this.position=new THREE.Vector3,this.screenPosition=new THREE.Vector2,this.signal=new vg.Signal,this.group=e,this._camera=t,this._raycaster=new THREE.Raycaster,this._preventDefault=!1,i=i||document,i.addEventListener(\"mousemove\",this._onDocumentMouseMove.bind(this),!1),i.addEventListener(\"mousedown\",this._onDocumentMouseDown.bind(this),!1),i.addEventListener(\"mouseup\",this._onDocumentMouseUp.bind(this),!1),i.addEventListener(\"mousewheel\",this._onMouseWheel.bind(this),!1),i.addEventListener(\"DOMMouseScroll\",this._onMouseWheel.bind(this),!1)},vg.MouseCaster.OVER=\"over\",vg.MouseCaster.OUT=\"out\",vg.MouseCaster.DOWN=\"down\",vg.MouseCaster.UP=\"up\",vg.MouseCaster.CLICK=\"click\",vg.MouseCaster.WHEEL=\"wheel\",vg.MouseCaster.prototype={update:function(){if(this.active){this._raycaster.setFromCamera(this.screenPosition,this._camera);var e,t,i=this._raycaster.intersectObject(this.group,!0);i.length>0?(e=i[0],t=e.object.userData.structure,this.pickedObject!=t&&(this.pickedObject&&this.signal.dispatch(vg.MouseCaster.OUT,this.pickedObject),this.pickedObject=t,this.selectedObject=null,this.signal.dispatch(vg.MouseCaster.OVER,this.pickedObject)),this.position.copy(e.point),this.screenPosition.z=e.distance):(this.pickedObject&&this.signal.dispatch(vg.MouseCaster.OUT,this.pickedObject),this.pickedObject=null,this.selectedObject=null),this.allHits=i}},preventDefault:function(){this._preventDefault=!0},_onDocumentMouseDown:function(e){return e=e||window.event,e.preventDefault(),this._preventDefault?(this._preventDefault=!1,!1):(this.pickedObject&&(this.selectedObject=this.pickedObject),this.shift=e.shiftKey,this.ctrl=e.ctrlKey,this.down=1===e.which,this.rightDown=3===e.which,void this.signal.dispatch(vg.MouseCaster.DOWN,this.pickedObject))},_onDocumentMouseUp:function(e){return e.preventDefault(),this._preventDefault?(this._preventDefault=!1,!1):(this.shift=e.shiftKey,this.ctrl=e.ctrlKey,this.signal.dispatch(vg.MouseCaster.UP,this.pickedObject),this.selectedObject&&this.pickedObject&&this.selectedObject.uniqueID===this.pickedObject.uniqueID&&this.signal.dispatch(vg.MouseCaster.CLICK,this.pickedObject),this.down=1===e.which?!1:this.down,void(this.rightDown=3===e.which?!1:this.rightDown))},_onDocumentMouseMove:function(e){e.preventDefault(),this.screenPosition.x=e.clientX/window.innerWidth*2-1,this.screenPosition.y=2*-(e.clientY/window.innerHeight)+1},_onMouseWheel:function(e){if(this.active){e.preventDefault(),e.stopPropagation();var t=0;void 0!==e.wheelDelta?t=e.wheelDelta:void 0!==e.detail&&(t=-e.detail),t>0?this.wheel++:this.wheel--,this.signal.dispatch(vg.MouseCaster.WHEEL,this.wheel)}}},vg.MouseCaster.prototype.constructor=vg.MouseCaster,vg.Scene=function(e,t){var i={element:document.body,alpha:!0,antialias:!0,clearColor:\"#fff\",sortObjects:!1,fog:null,light:new THREE.DirectionalLight(16777215),lightPosition:null,cameraType:\"PerspectiveCamera\",cameraPosition:null,orthoZoom:4},s={minDistance:100,maxDistance:1e3,zoomSpeed:2,noZoom:!1};if(i=vg.Tools.merge(i,e),\"boolean\"!=typeof t&&(s=vg.Tools.merge(s,t)),this.renderer=new THREE.WebGLRenderer({alpha:i.alpha,antialias:i.antialias}),this.renderer.setClearColor(i.clearColor,0),this.renderer.sortObjects=i.sortObjects,this.width=window.innerWidth,this.height=window.innerHeight,this.orthoZoom=i.orthoZoom,this.container=new THREE.Scene,this.container.fog=i.fog,this.container.add(new THREE.AmbientLight(14540253)),i.lightPosition||i.light.position.set(-1,1,-1).normalize(),this.container.add(i.light),\"OrthographicCamera\"===i.cameraType){var n=window.innerWidth/this.orthoZoom,l=window.innerHeight/this.orthoZoom;this.camera=new THREE.OrthographicCamera(n/-2,n/2,l/2,l/-2,1,5e3)}else this.camera=new THREE.PerspectiveCamera(50,this.width/this.height,1,5e3);this.contolled=!!t,this.contolled&&(this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement),this.controls.minDistance=s.minDistance,this.controls.maxDistance=s.maxDistance,this.controls.zoomSpeed=s.zoomSpeed,this.controls.noZoom=s.noZoom),i.cameraPosition&&this.camera.position.copy(i.cameraPosition),window.addEventListener(\"resize\",function(){if(this.width=window.innerWidth,this.height=window.innerHeight,\"OrthographicCamera\"===this.camera.type){var e=this.width/this.orthoZoom,t=this.height/this.orthoZoom;this.camera.left=e/-2,this.camera.right=e/2,this.camera.top=t/2,this.camera.bottom=t/-2}else this.camera.aspect=this.width/this.height;this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height)}.bind(this),!1),this.attachTo(i.element)},vg.Scene.prototype={attachTo:function(e){e.style.width=this.width+\"px\",e.style.height=this.height+\"px\",this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),e.appendChild(this.renderer.domElement)},add:function(e){this.container.add(e)},remove:function(e){this.container.remove(e)},render:function(){this.contolled&&this.controls.update(),this.renderer.render(this.container,this.camera)},updateOrthoZoom:function(){if(this.orthoZoom<=0)return void(this.orthoZoom=0);var e=this.width/this.orthoZoom,t=this.height/this.orthoZoom;this.camera.left=e/-2,this.camera.right=e/2,this.camera.top=t/2,this.camera.bottom=t/-2,this.camera.updateProjectionMatrix()},focusOn:function(e){this.camera.lookAt(e.position)}},vg.Scene.prototype.constructor=vg.Scene,vg.SelectionManager=function(e){this.mouse=e,this.onSelect=new vg.Signal,this.onDeselect=new vg.Signal,this.selected=null,this.toggleSelection=!1,this.mouse.signal.add(this.onMouse,this)},vg.SelectionManager.prototype={select:function(e,t){e&&(t=t||!0,this.selected!==e&&this.clearSelection(t),e.selected?this.toggleSelection&&(t&&this.onDeselect.dispatch(e),e.deselect()):e.select(),this.selected=e,t&&this.onSelect.dispatch(e))},clearSelection:function(e){e=e||!0,this.selected&&(e&&this.onDeselect.dispatch(this.selected),this.selected.deselect()),this.selected=null},onMouse:function(e,t){switch(e){case vg.MouseCaster.DOWN:t||this.clearSelection();break;case vg.MouseCaster.CLICK:this.select(t)}}},vg.SelectionManager.prototype.constructor=vg.SelectionManager,vg.Tools={clamp:function(e,t,i){return Math.max(t,Math.min(i,e))},sign:function(e){return e&&e/Math.abs(e)},random:function(e,t){return 1===arguments.length?Math.random()*e-.5*e:Math.random()*(t-e)+e},randomInt:function(e,t){return 1===arguments.length?Math.random()*e-.5*e|0:Math.random()*(t-e+1)+e|0},normalize:function(e,t,i){return(e-t)/(i-t)},getShortRotation:function(e){return e%=this.TAU,e>this.PI?e-=this.TAU:e<-this.PI&&(e+=this.TAU),e},generateID:function(){return Math.random().toString(36).slice(2)+Date.now()},isPlainObject:function(e){if(\"object\"!=typeof e||e.nodeType||e===e.window)return!1;try{if(e.constructor&&!Object.prototype.hasOwnProperty.call(e.constructor.prototype,\"isPrototypeOf\"))return!1}catch(t){return!1}return!0},merge:function(e,t){var i=this,s=Array.isArray(t),n=s&&[]||{};return s?(e=e||[],n=n.concat(e),t.forEach(function(t,s){\"undefined\"==typeof n[s]?n[s]=t:i.isPlainObject(t)?n[s]=i.merge(e[s],t):-1===e.indexOf(t)&&n.push(t)}),n):(e&&i.isPlainObject(e)&&Object.keys(e).forEach(function(t){n[t]=e[t];\n}),Object.keys(t).forEach(function(s){t[s]&&i.isPlainObject(t[s])&&e[s]?n[s]=i.merge(e[s],t[s]):n[s]=t[s]}),n)},now:function(){return window.nwf?window.nwf.system.Performance.elapsedTime:window.performance.now()},empty:function(e){for(;e.lastChild;)e.removeChild(e.lastChild)},radixSort:function(e,t,i,s){if(t=t||0,i=i||e.length,s=s||31,!(t>=i-1||0>s)){for(var n=t,l=i,r=1<<s;l>n;)if(e[n]&r){--l;var h=e[n];e[n]=e[l],e[l]=h}else++n;this.radixSort(e,t,l,s-1),this.radixSort(e,l,i,s-1)}},randomizeRGB:function(e,t){var i,s,n=e.split(\",\"),l=\"rgb(\";for(t=this.randomInt(t),i=0;3>i;i++)s=parseInt(n[i])+t,0>s?s=0:s>255&&(s=255),l+=s+\",\";return l=l.substring(0,l.length-1),l+=\")\"},getJSON:function(e){var t=new XMLHttpRequest,i=\"undefined\"==typeof e.cache?!1:e.cache,s=i?e.url:e.url+\"?t=\"+Math.floor(1e4*Math.random())+Date.now();t.onreadystatechange=function(){if(200===this.status){var t=null;try{t=JSON.parse(this.responseText)}catch(i){return}return void e.callback.call(e.scope||null,t)}0!==this.status&&console.warn(\"[Tools.getJSON] Error: \"+this.status+\" (\"+this.statusText+\") :: \"+e.url)},t.open(\"GET\",s,!0),t.setRequestHeader(\"Accept\",\"application/json\"),t.setRequestHeader(\"Content-Type\",\"application/json\"),t.send(\"\")}};\n//# sourceMappingURL=hex-grid.min.js.map\n","module.exports = {\n  \"size\": 5,\n  \"cellSize\": 10,\n  \"extrudeSettings\": {\n    \"amount\": 1,\n    \"bevelEnabled\": true,\n    \"bevelSegments\": 1,\n    \"steps\": 1,\n    \"bevelSize\": 0.5,\n    \"bevelThickness\": 0.5\n  },\n  \"autogenerated\": true,\n  \"cells\": [\n    {\n      \"q\": -1,\n      \"r\": 0,\n      \"s\": 1,\n      \"h\": 1,\n      \"walkable\": true,\n      \"userData\": {}\n    },\n    {\n      \"q\": 0,\n      \"r\": -1,\n      \"s\": 1,\n      \"h\": 1,\n      \"walkable\": true,\n      \"userData\": {}\n    },\n    {\n      \"q\": 0,\n      \"r\": 0,\n      \"s\": 0,\n      \"h\": 1,\n      \"walkable\": true,\n      \"userData\": {}\n    },\n    {\n      \"q\": 1,\n      \"r\": -1,\n      \"s\": 0,\n      \"h\": 1,\n      \"walkable\": true,\n      \"userData\": {}\n    },\n    {\n      \"q\": -1,\n      \"r\": 1,\n      \"s\": 0,\n      \"h\": 0,\n      \"walkable\": true,\n      \"userData\": {}\n    },\n    {\n      \"q\": 0,\n      \"r\": 1,\n      \"s\": -1,\n      \"h\": 0,\n      \"walkable\": true,\n      \"userData\": {}\n    },\n    {\n      \"q\": 1,\n      \"r\": 0,\n      \"s\": -1,\n      \"h\": 0,\n      \"walkable\": true,\n      \"userData\": {}\n    }]\n};\n","/**\n * Flat-shaded ocean primitive.\n *\n * Based on a Codrops tutorial:\n * http://tympanus.net/codrops/2016/04/26/the-aviator-animating-basic-3d-scene-threejs/\n */\nmodule.exports.Primitive = AFRAME.registerPrimitive('a-ocean', {\n  defaultComponents: {\n    ocean: {},\n    rotation: {x: -90, y: 0, z: 0}\n  },\n  mappings: {\n    width: 'ocean.width',\n    depth: 'ocean.depth',\n    density: 'ocean.density',\n    amplitude: 'ocean.amplitude',\n    amplitudeVariance: 'ocean.amplitudeVariance',\n    speed: 'ocean.speed',\n    speedVariance: 'ocean.speedVariance',\n    color: 'ocean.color',\n    opacity: 'ocean.opacity'\n  }\n});\n\nmodule.exports.Component = AFRAME.registerComponent('ocean', {\n  schema: {\n    // Dimensions of the ocean area.\n    width: {default: 10, min: 0},\n    depth: {default: 10, min: 0},\n\n    // Density of waves.\n    density: {default: 10},\n\n    // Wave amplitude and variance.\n    amplitude: {default: 0.1},\n    amplitudeVariance: {default: 0.3},\n\n    // Wave speed and variance.\n    speed: {default: 1},\n    speedVariance: {default: 2},\n\n    // Material.\n    color: {default: '#7AD2F7', type: 'color'},\n    opacity: {default: 0.8}\n  },\n\n  /**\n   * Use play() instead of init(), because component mappings  unavailable as dependencies  are\n   * not guaranteed to have parsed when this component is initialized.\n   */\n  play: function () {\n    const el = this.el,\n        data = this.data;\n    let material = el.components.material;\n\n    const geometry = new THREE.PlaneGeometry(data.width, data.depth, data.density, data.density);\n    geometry.mergeVertices();\n    this.waves = [];\n    for (let v, i = 0, l = geometry.vertices.length; i < l; i++) {\n      v = geometry.vertices[i];\n      this.waves.push({\n        z: v.z,\n        ang: Math.random() * Math.PI * 2,\n        amp: data.amplitude + Math.random() * data.amplitudeVariance,\n        speed: (data.speed + Math.random() * data.speedVariance) / 1000 // radians / frame\n      });\n    }\n\n    if (!material) {\n      material = {};\n      material.material = new THREE.MeshPhongMaterial({\n        color: data.color,\n        transparent: data.opacity < 1,\n        opacity: data.opacity,\n        shading: THREE.FlatShading,\n      });\n    }\n\n    this.mesh = new THREE.Mesh(geometry, material.material);\n    el.setObject3D('mesh', this.mesh);\n  },\n\n  remove: function () {\n    this.el.removeObject3D('mesh');\n  },\n\n  tick: function (t, dt) {\n    if (!dt) return;\n\n    const verts = this.mesh.geometry.vertices;\n    for (let v, vprops, i = 0; (v = verts[i]); i++){\n      vprops = this.waves[i];\n      v.z = vprops.z + Math.sin(vprops.ang) * vprops.amp;\n      vprops.ang += vprops.speed * dt;\n    }\n    this.mesh.geometry.verticesNeedUpdate = true;\n  }\n});\n","/**\n * Tube following a custom path.\n *\n * Usage:\n *\n * ```html\n * <a-tube path=\"5 0 5, 5 0 -5, -5 0 -5\" radius=\"0.5\"></a-tube>\n * ```\n */\nmodule.exports.Primitive = AFRAME.registerPrimitive('a-tube', {\n  defaultComponents: {\n    tube:           {},\n  },\n  mappings: {\n    path:           'tube.path',\n    segments:       'tube.segments',\n    radius:         'tube.radius',\n    'radial-segments': 'tube.radialSegments',\n    closed:         'tube.closed'\n  }\n});\n\nmodule.exports.Component = AFRAME.registerComponent('tube', {\n  schema: {\n    path:           {default: []},\n    segments:       {default: 64},\n    radius:         {default: 1},\n    radialSegments: {default: 8},\n    closed:         {default: false}\n  },\n\n  init: function () {\n    const el = this.el,\n        data = this.data;\n    let material = el.components.material;\n\n    if (!data.path.length) {\n      console.error('[a-tube] `path` property expected but not found.');\n      return;\n    }\n\n    const curve = new THREE.CatmullRomCurve3(data.path.map(function (point) {\n      point = point.split(' ');\n      return new THREE.Vector3(Number(point[0]), Number(point[1]), Number(point[2]));\n    }));\n    const geometry = new THREE.TubeGeometry(\n      curve, data.segments, data.radius, data.radialSegments, data.closed\n    );\n\n    if (!material) {\n      material = {};\n      material.material = new THREE.MeshPhongMaterial();\n    }\n\n    this.mesh = new THREE.Mesh(geometry, material.material);\n    this.el.setObject3D('mesh', this.mesh);\n  },\n\n  update: function (prevData) {\n    if (!Object.keys(prevData).length) return;\n\n    this.remove();\n    this.init();\n  },\n\n  remove: function () {\n    if (this.mesh) this.el.removeObject3D('mesh');\n  }\n});\n"],"sourceRoot":""}